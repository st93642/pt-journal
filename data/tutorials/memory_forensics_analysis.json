{
  "id": "memory_forensics_analysis",
  "title": "Memory Forensics Analysis",
  "description": "Advanced memory acquisition and analysis techniques for extracting volatile evidence including processes, network connections, credentials, and malware artifacts.",
  "type": "tutorial",
  "steps": [
    {
      "id": "memory_acquisition_techniques",
      "title": "Memory Acquisition Techniques",
      "content": "OBJECTIVE: Master memory acquisition methods for various operating systems while maintaining forensic integrity.\n\nACADEMIC BACKGROUND:\nMemory (RAM) contains volatile evidence that is lost when a system powers down. This includes running processes, network connections, encryption keys, passwords in plaintext, and malware that exists only in memory. Proper acquisition techniques preserve this critical evidence.\n\nACQUISITION FUNDAMENTALS:\n\n1. WHY MEMORY FORENSICS:\n   ```\n   Volatile Evidence in RAM:\n   \n   - Running processes and their memory\n   - Network connections (active and recent)\n   - Encryption keys (BitLocker, FileVault, LUKS)\n   - Plaintext passwords\n   - Clipboard contents\n   - Command history\n   - Malware that never touches disk\n   - Injected code\n   - Decrypted data\n   - User session information\n   - Registry hives (live)\n   \n   Memory vs Disk:\n   | Evidence | Disk | Memory |\n   |----------|------|--------|\n   | Deleted files | Yes | Partial |\n   | Running malware | Maybe | Yes |\n   | Network state | Logs | Live |\n   | Encryption keys | No | Yes |\n   | Passwords | Hashes | Plaintext |\n   | Fileless attacks | No | Yes |\n   ```\n\n2. WINDOWS MEMORY ACQUISITION:\n   ```powershell\n   # WinPmem (recommended)\n   # Download from: https://github.com/Velocidex/WinPmem\n   \n   winpmem_mini_x64.exe output.raw\n   \n   # With compression\n   winpmem_mini_x64.exe --output output.aff4 --format aff4\n   \n   # DumpIt (simple one-click)\n   DumpIt.exe\n   # Creates memory dump in current directory\n   \n   # Belkasoft RAM Capturer\n   # GUI tool, creates raw dump\n   \n   # FTK Imager\n   # File > Capture Memory > Select destination\n   \n   # Magnet RAM Capture\n   # Free tool, simple interface\n   ```\n   \n   ```cmd\n   :: Verification\n   :: Check file size approximately equals RAM size\n   dir output.raw\n   \n   :: Calculate hash\n   certutil -hashfile output.raw SHA256\n   ```\n\n3. LINUX MEMORY ACQUISITION:\n   ```bash\n   # LiME (Linux Memory Extractor)\n   # Build for target kernel version\n   \n   git clone https://github.com/504ensicsLabs/LiME\n   cd LiME/src\n   make\n   \n   # Load module and dump memory\n   sudo insmod lime-$(uname -r).ko \"path=/forensics/memory.lime format=lime\"\n   \n   # Alternative formats\n   sudo insmod lime.ko \"path=/tmp/memory.raw format=raw\"\n   sudo insmod lime.ko \"path=/tmp/memory.padded format=padded\"\n   \n   # Network acquisition (dump to remote system)\n   sudo insmod lime.ko \"path=tcp:4444 format=lime\"\n   # On receiver: nc -l 4444 > memory.lime\n   \n   # Using /dev/mem (limited, requires root)\n   dd if=/dev/mem of=/forensics/mem.raw bs=1M\n   # Note: Modern kernels restrict /dev/mem access\n   \n   # Using /proc/kcore (ELF format)\n   cp /proc/kcore /forensics/kcore\n   ```\n\n4. MACOS MEMORY ACQUISITION:\n   ```bash\n   # osxpmem (from Rekall)\n   sudo ./osxpmem.app/osxpmem -o /forensics/memory.raw\n   \n   # With compression\n   sudo ./osxpmem.app/osxpmem -o /forensics/memory.aff4 --format aff4\n   \n   # MacQuisition (commercial)\n   # GUI tool for Mac memory acquisition\n   \n   # Note: macOS System Integrity Protection (SIP) \n   # may need to be disabled for some tools\n   csrutil status\n   ```\n\n5. VIRTUAL MACHINE MEMORY:\n   ```bash\n   # VMware: Suspend VM, copy .vmem file\n   cp /vmware/machine.vmem /forensics/memory.vmem\n   \n   # VirtualBox: Debug console\n   VBoxManage debugvm \"VMName\" dumpguestcore --filename memory.elf\n   \n   # Hyper-V: Checkpoint creates .bin memory file\n   # Export checkpoint, extract memory\n   \n   # KVM/QEMU:\n   virsh dump domain_name /forensics/memory.raw --memory-only\n   \n   # Convert formats if needed\n   volatility -f memory.vmem --profile=Win10x64 imagecopy -O memory.raw\n   ```\n\n6. ACQUISITION BEST PRACTICES:\n   ```\n   Pre-Acquisition Checklist:\n   \n   [ ] Document system state (screenshot, photos)\n   [ ] Note running applications visible\n   [ ] Record date/time and timezone\n   [ ] Prepare acquisition media with sufficient space\n   [ ] Use write-blocked or dedicated forensic media\n   [ ] Test acquisition tool on similar system first\n   \n   During Acquisition:\n   \n   [ ] Run tool with minimal system impact\n   [ ] Avoid GUI tools if possible (less footprint)\n   [ ] Monitor acquisition progress\n   [ ] Document any errors or warnings\n   \n   Post-Acquisition:\n   \n   [ ] Calculate and record hash\n   [ ] Verify file size approximately equals RAM\n   [ ] Document acquisition parameters\n   [ ] Secure memory dump immediately\n   [ ] Begin disk acquisition if applicable\n   ```\n\n7. ACQUISITION DOCUMENTATION:\n   ```\n   Memory Acquisition Form:\n   \n   Case Number: 2024-FORENSIC-001\n   Evidence ID: MEM-001\n   Date/Time: 2024-03-15 10:30:00 UTC\n   \n   System Information:\n     Hostname: WORKSTATION-01\n     OS: Windows 10 Pro 22H2\n     RAM: 16 GB (17,179,869,184 bytes)\n     State: Running (user logged in)\n   \n   Acquisition Tool:\n     Name: WinPmem\n     Version: 4.0 RC2\n     Command: winpmem_mini_x64.exe memory.raw\n   \n   Output:\n     Filename: memory.raw\n     Size: 17,179,869,184 bytes\n     Format: Raw\n   \n   Verification:\n     SHA256: 4a7bd3e2c5e4f6a8b9c0d1e2f3a4b5c6d7e8f9...\n   \n   Notes:\n     - User was active at time of acquisition\n     - Chrome browser with multiple tabs open\n     - Encrypted disk (BitLocker) was mounted\n   \n   Examiner: J. Smith\n   ```\n\nDETECTION INDICATORS:\n- Acquisition completed without system crash\n- File size matches expected RAM size\n- Hash calculated and documented\n- System state documented before acquisition\n\nCOMMON PITFALLS:\n- Running acquisition tool from evidence disk\n- Not documenting system state before acquisition\n- Forgetting to hash the memory dump\n- Using incompatible acquisition tool version\n- Insufficient storage space\n\nFURTHER READING:\n- LiME documentation\n- WinPmem GitHub repository\n- \"The Art of Memory Forensics\" by Ligh et al.",
      "tags": ["forensics", "memory", "acquisition", "volatile-evidence", "dfir"],
      "related_tools": ["bulk_extractor"]
    },
    {
      "id": "volatility_framework_introduction",
      "title": "Volatility Framework Introduction",
      "content": "OBJECTIVE: Set up and configure Volatility for memory analysis, understand profiles, and perform initial image identification.\n\nACADEMIC BACKGROUND:\nVolatility is the leading open-source memory forensics framework. It provides plugins to extract artifacts from memory dumps across multiple operating systems. Understanding how to properly configure Volatility and select the correct profile is essential for accurate analysis.\n\nVOLATILITY SETUP:\n\n1. INSTALLATION:\n   ```bash\n   # Volatility 2 (Python 2, more plugins currently)\n   pip2 install volatility\n   \n   # Volatility 3 (Python 3, modern)\n   pip3 install volatility3\n   \n   # From source (Volatility 3)\n   git clone https://github.com/volatilityfoundation/volatility3.git\n   cd volatility3\n   pip3 install -r requirements.txt\n   python3 vol.py -h\n   \n   # Symbol tables (required for Vol3)\n   # Download from: \n   # https://downloads.volatilityfoundation.org/volatility3/symbols/\n   # Place in volatility3/symbols/\n   ```\n\n2. PROFILE IDENTIFICATION (VOLATILITY 2):\n   ```bash\n   # Volatility 2 requires correct profile\n   \n   # List available profiles\n   volatility --info | grep Profile\n   \n   # Attempt automatic profile detection\n   volatility -f memory.raw imageinfo\n   \n   # Output example:\n   # Suggested Profile(s): Win10x64_19041, Win10x64_18362\n   # AS Layer1: WindowsAMD64PagedMemory\n   # AS Layer2: FileAddressSpace\n   # DTB: 0x1ad000\n   # KDBG: 0xf8000200c0e0\n   # Number of Processors: 4\n   # Image Type: Service Pack 0\n   # Image date and time: 2024-03-15 10:30:45\n   \n   # Alternative: kdbgscan for more reliable detection\n   volatility -f memory.raw kdbgscan\n   \n   # Use identified profile in all subsequent commands\n   volatility -f memory.raw --profile=Win10x64_19041 pslist\n   ```\n\n3. VOLATILITY 3 USAGE:\n   ```bash\n   # Volatility 3 auto-detects OS (no profile needed)\n   \n   # Basic syntax\n   python3 vol.py -f memory.raw windows.info\n   \n   # List available plugins\n   python3 vol.py -h\n   python3 vol.py windows -h  # Windows plugins\n   python3 vol.py linux -h    # Linux plugins\n   python3 vol.py mac -h      # macOS plugins\n   \n   # Running a plugin\n   python3 vol.py -f memory.raw windows.pslist\n   \n   # With output file\n   python3 vol.py -f memory.raw -o /forensics/output windows.pslist\n   \n   # JSON output\n   python3 vol.py -f memory.raw -r json windows.pslist > pslist.json\n   ```\n\n4. LINUX MEMORY ANALYSIS:\n   ```bash\n   # Volatility 2: Need profile for exact kernel version\n   \n   # Create Linux profile (on similar system)\n   cd volatility/tools/linux\n   make\n   zip Linux_$(uname -r).zip module.dwarf /boot/System.map-$(uname -r)\n   # Copy to volatility/plugins/overlays/linux/\n   \n   # Volatility 3: Download symbols or use ISF\n   python3 vol.py -f memory.lime linux.bash\n   python3 vol.py -f memory.lime linux.pslist\n   python3 vol.py -f memory.lime linux.lsof\n   ```\n\n5. MACOS MEMORY ANALYSIS:\n   ```bash\n   # Volatility 3 macOS plugins\n   python3 vol.py -f memory.raw mac.pslist\n   python3 vol.py -f memory.raw mac.netstat\n   python3 vol.py -f memory.raw mac.lsmod\n   ```\n\n6. IMAGE VERIFICATION:\n   ```bash\n   # Verify image can be parsed\n   \n   # Volatility 2\n   volatility -f memory.raw imageinfo\n   \n   # Volatility 3\n   python3 vol.py -f memory.raw windows.info\n   \n   # Check for corruption\n   # Valid image should show:\n   # - Reasonable number of processes\n   # - Valid kernel base address\n   # - Consistent timestamps\n   \n   # If profile not found:\n   # 1. Check image format (raw, ELF, crash dump)\n   # 2. Try converting formats\n   # 3. Build custom profile for exotic systems\n   ```\n\n7. COMMON CONFIGURATION:\n   ```bash\n   # Environment variables\n   export VOLATILITY_LOCATION=/forensics/memory.raw\n   export VOLATILITY_PROFILE=Win10x64_19041\n   \n   # Now commands are shorter\n   volatility pslist\n   volatility netscan\n   \n   # Create shell alias for common options\n   alias vol2='volatility -f /forensics/memory.raw --profile=Win10x64_19041'\n   vol2 pslist\n   vol2 netscan\n   \n   # Volatility 3\n   alias vol3='python3 /tools/volatility3/vol.py -f /forensics/memory.raw'\n   vol3 windows.pslist\n   ```\n\n8. PLUGIN CATEGORIES:\n   ```\n   Volatility Plugin Categories:\n   \n   Process Analysis:\n   - pslist, psscan, pstree\n   - cmdline, dlllist, handles\n   - malfind, vadinfo, vaddump\n   \n   Network Analysis:\n   - netscan, connections, sockets\n   - connscan (closed connections)\n   \n   Registry Analysis:\n   - hivelist, hivedump\n   - printkey, userassist\n   - shimcache, shellbags\n   \n   File System:\n   - filescan, dumpfiles\n   - mftparser\n   \n   Malware Detection:\n   - malfind, apihooks\n   - svcscan, callbacks\n   - ssdt, idt\n   \n   Credentials:\n   - hashdump, lsadump\n   - mimikatz (third-party)\n   \n   Timeline:\n   - timeliner\n   ```\n\nQUICK REFERENCE:\n```bash\n# Volatility 2 Quick Start\nvolatility -f memory.raw imageinfo\nvolatility -f memory.raw --profile=PROFILE pslist\nvolatility -f memory.raw --profile=PROFILE netscan\nvolatility -f memory.raw --profile=PROFILE malfind\n\n# Volatility 3 Quick Start\npython3 vol.py -f memory.raw windows.info\npython3 vol.py -f memory.raw windows.pslist\npython3 vol.py -f memory.raw windows.netscan\npython3 vol.py -f memory.raw windows.malfind\n```\n\nDETECTION INDICATORS:\n- Correct profile/symbols identified\n- Image parses without errors\n- Process list looks reasonable\n- Timestamps are consistent\n\nCOMMON PITFALLS:\n- Wrong profile selection\n- Missing symbol tables (Vol3)\n- Incompatible Python version\n- Corrupted memory dump\n\nFURTHER READING:\n- Volatility Foundation documentation\n- \"The Art of Memory Forensics\"\n- Volatility GitHub wiki",
      "tags": ["forensics", "memory", "volatility", "analysis-framework", "dfir"],
      "related_tools": ["yara"]
    },
    {
      "id": "process_analysis",
      "title": "Process Analysis",
      "content": "OBJECTIVE: Analyze running processes in memory to identify suspicious activity, malware, and hidden processes.\n\nACADEMIC BACKGROUND:\nProcess analysis is fundamental to memory forensics. Examining process lists, parent-child relationships, command lines, loaded DLLs, and memory regions can reveal malware, unauthorized tools, and attacker activity. Multiple techniques expose processes that attempt to hide.\n\nPROCESS ENUMERATION:\n\n1. LISTING PROCESSES:\n   ```bash\n   # Volatility 2\n   volatility -f memory.raw --profile=Win10x64 pslist\n   \n   # Output columns:\n   # Offset(V) - Virtual address of EPROCESS\n   # Name - Process name\n   # PID - Process ID\n   # PPID - Parent Process ID\n   # Thds - Thread count\n   # Hnds - Handle count\n   # Sess - Session ID\n   # Wow64 - 32-bit on 64-bit\n   # Start - Process start time\n   # Exit - Process exit time\n   \n   # Volatility 3\n   python3 vol.py -f memory.raw windows.pslist\n   python3 vol.py -f memory.raw windows.pslist --pid 1234\n   ```\n\n2. PROCESS TREE:\n   ```bash\n   # Show parent-child relationships\n   volatility -f memory.raw --profile=Win10x64 pstree\n   \n   # Volatility 3\n   python3 vol.py -f memory.raw windows.pstree\n   \n   # Normal Windows process tree:\n   # System (4)\n   #   smss.exe\n   #     csrss.exe\n   #     wininit.exe\n   #       services.exe\n   #         svchost.exe (multiple)\n   #       lsass.exe\n   #     winlogon.exe\n   #       dwm.exe\n   #   explorer.exe\n   #     chrome.exe\n   #     notepad.exe\n   \n   # Suspicious indicators:\n   # - Unknown parent for system process\n   # - cmd.exe spawned by unusual parent\n   # - powershell.exe from Office apps\n   ```\n\n3. HIDDEN PROCESS DETECTION:\n   ```bash\n   # psscan - Scans for EPROCESS structures\n   # Can find terminated and hidden processes\n   volatility -f memory.raw --profile=Win10x64 psscan\n   \n   # Volatility 3\n   python3 vol.py -f memory.raw windows.psscan\n   \n   # Compare pslist vs psscan\n   # Processes in psscan but not pslist = potentially hidden\n   \n   # psxview - Cross-reference multiple sources\n   volatility -f memory.raw --profile=Win10x64 psxview\n   \n   # Checks: pslist, psscan, thrdproc, pspcid, csrss, session\n   # False in multiple columns = suspicious\n   ```\n\n4. COMMAND LINE ANALYSIS:\n   ```bash\n   # Get command lines for all processes\n   volatility -f memory.raw --profile=Win10x64 cmdline\n   \n   # Volatility 3\n   python3 vol.py -f memory.raw windows.cmdline\n   \n   # Suspicious patterns:\n   # - Encoded PowerShell: powershell -enc <base64>\n   # - Download cradles: IEX(New-Object...)\n   # - Living off the land: certutil, bitsadmin\n   # - Unusual paths: C:\\Users\\Public\\...\n   # - Hidden executables: .exe in temp folders\n   \n   # Example suspicious:\n   # cmd.exe: cmd.exe /c powershell -nop -w hidden -enc SQBFAFg...\n   ```\n\n5. DLL ANALYSIS:\n   ```bash\n   # List DLLs loaded by process\n   volatility -f memory.raw --profile=Win10x64 dlllist -p 1234\n   \n   # Volatility 3\n   python3 vol.py -f memory.raw windows.dlllist --pid 1234\n   \n   # All processes\n   volatility -f memory.raw --profile=Win10x64 dlllist\n   \n   # Suspicious DLLs:\n   # - DLLs from unusual paths\n   # - No version information\n   # - Names mimicking system DLLs\n   # - Unsigned DLLs in system processes\n   \n   # LDR modules (more comprehensive)\n   volatility -f memory.raw --profile=Win10x64 ldrmodules -p 1234\n   # Shows mapped vs in memory vs in init order\n   ```\n\n6. HANDLE ANALYSIS:\n   ```bash\n   # List handles for process\n   volatility -f memory.raw --profile=Win10x64 handles -p 1234\n   \n   # Filter by type\n   volatility -f memory.raw --profile=Win10x64 handles -p 1234 -t File\n   volatility -f memory.raw --profile=Win10x64 handles -p 1234 -t Key\n   volatility -f memory.raw --profile=Win10x64 handles -p 1234 -t Mutant\n   \n   # Volatility 3\n   python3 vol.py -f memory.raw windows.handles --pid 1234\n   \n   # Interesting handle types:\n   # - File: Open files, can indicate data access\n   # - Key: Registry keys being accessed\n   # - Mutant: Malware often uses mutex for single instance\n   # - Section: Memory-mapped files\n   ```\n\n7. SUSPICIOUS PROCESS INDICATORS:\n   ```\n   Red Flags Checklist:\n   \n   Process Anomalies:\n   [ ] System processes with wrong PPID\n   [ ] Multiple instances of unique processes (lsass, services)\n   [ ] Process names with typos (scvhost vs svchost)\n   [ ] Processes running from wrong location\n   [ ] Terminated process still in memory\n   [ ] Process with no threads\n   [ ] Wow64 flag on native 64-bit system process\n   \n   Expected Process Locations:\n   | Process | Expected Path |\n   |---------|---------------|\n   | smss.exe | %SystemRoot%\\System32 |\n   | csrss.exe | %SystemRoot%\\System32 |\n   | services.exe | %SystemRoot%\\System32 |\n   | lsass.exe | %SystemRoot%\\System32 |\n   | svchost.exe | %SystemRoot%\\System32 |\n   | explorer.exe | %SystemRoot% |\n   \n   Verify with:\n   volatility -f memory.raw --profile=Win10x64 dlllist | grep -E \"smss|csrss|services|lsass\"\n   ```\n\n8. PROCESS DUMPING:\n   ```bash\n   # Dump process executable\n   volatility -f memory.raw --profile=Win10x64 procdump -p 1234 -D /forensics/dumps/\n   \n   # Dump all processes\n   volatility -f memory.raw --profile=Win10x64 procdump -D /forensics/dumps/\n   \n   # Volatility 3\n   python3 vol.py -f memory.raw -o /forensics/dumps windows.dumpfiles --pid 1234\n   \n   # Dump memory regions (more complete)\n   volatility -f memory.raw --profile=Win10x64 memdump -p 1234 -D /forensics/dumps/\n   \n   # Analyze dumped executable\n   file /forensics/dumps/executable.1234.exe\n   strings /forensics/dumps/executable.1234.exe | head -100\n   sha256sum /forensics/dumps/executable.1234.exe\n   # Submit to VirusTotal\n   ```\n\nANALYSIS REPORT:\n```\nProcess Analysis Findings:\n\nTotal Processes: 89\nSuspicious Processes: 3\n\nFinding 1: Suspicious PowerShell Execution\nPID: 4532\nPPID: 2156 (WINWORD.EXE)\nCommand: powershell.exe -nop -w hidden -enc SQBFAFgAKA...\nStart Time: 2024-03-15 09:45:32\nAssessment: HIGH RISK - Encoded PowerShell from Office\n\nFinding 2: Process Masquerading\nPID: 2340\nName: scvhost.exe (typo - should be svchost)\nPath: C:\\Users\\Public\\scvhost.exe\nAssessment: HIGH RISK - Malware masquerading\n\nFinding 3: Hidden Process\nPID: 6780\nVisible in: psscan only (not pslist)\nName: backdoor.exe\nAssessment: CRITICAL - Rootkit hiding process\n\nRecommendations:\n1. Dump all suspicious processes for malware analysis\n2. Extract command line arguments for IOC development\n3. Analyze parent processes for infection vector\n```\n\nDETECTION INDICATORS:\n- All processes enumerated via multiple methods\n- Parent-child relationships verified\n- Command lines extracted\n- DLLs and handles analyzed\n- Suspicious processes identified\n\nCOMMON PITFALLS:\n- Only using pslist (misses hidden processes)\n- Not verifying process locations\n- Ignoring process relationships\n- Not dumping suspicious processes\n\nFURTHER READING:\n- \"Windows Internals\" by Russinovich\n- SANS FOR508 course materials\n- Volatility plugin documentation",
      "tags": ["forensics", "memory", "processes", "malware-detection", "dfir"],
      "related_tools": ["yara", "strings"]
    },
    {
      "id": "network_artifact_analysis",
      "title": "Network Artifact Analysis",
      "content": "OBJECTIVE: Extract and analyze network artifacts from memory including active connections, listening ports, and network history.\n\nACADEMIC BACKGROUND:\nMemory contains active network state that may not be visible in logs or on disk. This includes current connections, listening sockets, recently closed connections, and network-related credentials. Network artifacts are crucial for identifying command-and-control communications and data exfiltration.\n\nNETWORK ANALYSIS:\n\n1. ACTIVE CONNECTIONS:\n   ```bash\n   # Volatility 2 (Windows XP/2003)\n   volatility -f memory.raw --profile=WinXPSP3x86 connections\n   volatility -f memory.raw --profile=WinXPSP3x86 connscan\n   \n   # Volatility 2 (Vista+)\n   volatility -f memory.raw --profile=Win10x64 netscan\n   \n   # Volatility 3\n   python3 vol.py -f memory.raw windows.netscan\n   python3 vol.py -f memory.raw windows.netstat\n   \n   # Output includes:\n   # - Protocol (TCP/UDP)\n   # - Local Address:Port\n   # - Foreign Address:Port\n   # - State (ESTABLISHED, LISTENING, etc.)\n   # - PID and Process Name\n   # - Create Time\n   ```\n\n2. ANALYZING CONNECTION STATE:\n   ```\n   TCP States in Memory:\n   \n   LISTENING - Waiting for incoming connections\n   ESTABLISHED - Active connection\n   CLOSE_WAIT - Remote closed, waiting for local close\n   TIME_WAIT - Connection closed, waiting for timeout\n   SYN_SENT - Connection attempt initiated\n   SYN_RECEIVED - Received SYN, sent SYN-ACK\n   \n   Suspicious Patterns:\n   | Pattern | Indicator |\n   |---------|----------|\n   | High ports to foreign IPs | C2 communication |\n   | Multiple connections same foreign IP | Botnet activity |\n   | LISTENING on unusual ports | Backdoor |\n   | Connections from system processes | Process injection |\n   | Foreign IP in unusual country | Data exfiltration |\n   ```\n\n3. LINUX NETWORK ANALYSIS:\n   ```bash\n   # Volatility 2 (with Linux profile)\n   volatility -f memory.lime --profile=LinuxUbuntu_x64 linux_netstat\n   volatility -f memory.lime --profile=LinuxUbuntu_x64 linux_ifconfig\n   volatility -f memory.lime --profile=LinuxUbuntu_x64 linux_route_cache\n   \n   # Volatility 3\n   python3 vol.py -f memory.lime linux.sockstat\n   ```\n\n4. CORRELATING NETWORK WITH PROCESSES:\n   ```bash\n   # Filter netscan by PID\n   volatility -f memory.raw --profile=Win10x64 netscan | grep \"4532\"\n   \n   # After identifying suspicious connection, investigate process:\n   volatility -f memory.raw --profile=Win10x64 pstree | grep -A5 \"4532\"\n   volatility -f memory.raw --profile=Win10x64 cmdline -p 4532\n   volatility -f memory.raw --profile=Win10x64 dlllist -p 4532\n   \n   # Combined analysis script\n   #!/bin/bash\n   PID=$1\n   echo \"=== Process Info ===\"\n   volatility -f memory.raw --profile=Win10x64 pslist -p $PID\n   echo \"\\n=== Network Connections ===\"\n   volatility -f memory.raw --profile=Win10x64 netscan | grep $PID\n   echo \"\\n=== Command Line ===\"\n   volatility -f memory.raw --profile=Win10x64 cmdline -p $PID\n   ```\n\n5. DNS CACHE ANALYSIS:\n   ```bash\n   # Windows DNS cache in memory\n   # Custom plugin or manual analysis\n   \n   # Search for DNS strings in memory\n   strings memory.raw | grep -E \"\\.(com|net|org|ru|cn)\" | sort -u\n   \n   # Bulk extractor for domains\n   bulk_extractor -o /forensics/bulk -E domain memory.raw\n   cat /forensics/bulk/domain.txt | sort -u\n   ```\n\n6. BROWSER NETWORK ARTIFACTS:\n   ```bash\n   # Chrome/Firefox keep connections in memory\n   \n   # Extract URLs from memory\n   strings memory.raw | grep -E \"^https?://\" | sort -u > urls.txt\n   \n   # Bulk extractor URLs\n   bulk_extractor -o /forensics/bulk -E url memory.raw\n   \n   # Look for POST data\n   strings memory.raw | grep -i \"POST /\" | head -50\n   \n   # Extract potential credentials\n   strings memory.raw | grep -iE \"password|passwd|pwd\" | head -50\n   ```\n\n7. WIRELESS NETWORK ARTIFACTS:\n   ```bash\n   # WiFi passwords in Windows memory\n   # Stored in lsass.exe process\n   \n   # Use mimikatz plugin (Volatility 2)\n   volatility -f memory.raw --profile=Win10x64 mimikatz\n   \n   # Search for SSID names\n   strings memory.raw | grep -i \"SSID\" | head -20\n   ```\n\n8. SUSPICIOUS NETWORK INDICATORS:\n   ```\n   Network IOC Checklist:\n   \n   C2 Communication:\n   [ ] Connections to known bad IPs (threat intel)\n   [ ] Beaconing pattern (regular interval connections)\n   [ ] High-port to high-port connections\n   [ ] DNS to suspicious TLDs (.tk, .top, .xyz)\n   [ ] Non-standard ports for protocols (HTTP on 8080)\n   \n   Data Exfiltration:\n   [ ] Large outbound transfers\n   [ ] Connections to file sharing sites\n   [ ] Cloud storage APIs (Dropbox, OneDrive)\n   [ ] FTP/SFTP connections\n   \n   Lateral Movement:\n   [ ] SMB connections (445) to internal hosts\n   [ ] RDP connections (3389)\n   [ ] WMI/WinRM activity\n   [ ] PSExec patterns\n   \n   Sample netscan output analysis:\n   ```\n   Proto  Local                    Foreign                  State        PID   Process\n   TCP    192.168.1.100:49234     185.220.101.1:443        ESTABLISHED  4532  powershell.exe   <- SUSPICIOUS\n   TCP    192.168.1.100:49240     192.168.1.50:445         ESTABLISHED  2340  svchost.exe      <- Lateral movement?\n   TCP    0.0.0.0:4444            0.0.0.0:0                LISTENING    6780  backdoor.exe     <- Backdoor!\n   ```\n\nANALYSIS REPORT:\n```\nNetwork Artifact Analysis:\n\nActive Connections: 47\nListening Ports: 23\nSuspicious Connections: 5\n\nC2 Communication Detected:\n| Local | Foreign | Process | Assessment |\n|-------|---------|---------|------------|\n| :49234 | 185.220.101.1:443 | powershell.exe | Known Tor exit node |\n| :52341 | 91.234.99.42:8080 | scvhost.exe | Suspicious IP |\n\nBackdoor Detected:\nPID 6780 listening on port 4444 (common Metasploit port)\nProcess: backdoor.exe\nAssessment: CRITICAL - Active backdoor\n\nLateral Movement Indicators:\n- SMB connections to 192.168.1.50, 192.168.1.51\n- RDP connection attempt to 192.168.1.100\n- All from PID 2340 (svchost.exe - suspicious)\n\nIOCs Extracted:\n- 185.220.101.1\n- 91.234.99.42\n- backdoor.exe (SHA256: abc123...)\n```\n\nDETECTION INDICATORS:\n- All network connections enumerated\n- Processes correlated with connections\n- Suspicious IPs identified\n- Lateral movement detected\n\nCOMMON PITFALLS:\n- Ignoring closed connections (use connscan)\n- Not correlating with process analysis\n- Missing internal lateral movement\n- Not checking listening ports\n\nFURTHER READING:\n- Volatility network plugins documentation\n- SANS Network Forensics\n- Threat intelligence feeds for IP reputation",
      "tags": ["forensics", "memory", "network", "connections", "c2-detection", "dfir"],
      "related_tools": ["bulk_extractor"]
    },
    {
      "id": "credential_extraction",
      "title": "Credential Extraction",
      "content": "OBJECTIVE: Extract credentials, password hashes, and authentication tokens from memory for security assessment and incident response.\n\nACADEMIC BACKGROUND:\nMemory often contains credentials in plaintext or weakly protected forms. Windows stores authentication data in LSASS, while applications may cache passwords in their process memory. Extracting credentials helps assess breach scope and identify compromised accounts.\n\nIMPORTANT: Credential extraction should only be performed during authorized security assessments or incident response.\n\nCREDENTIAL SOURCES:\n\n1. WINDOWS CREDENTIAL EXTRACTION:\n   ```bash\n   # Registry hashes (SAM)\n   volatility -f memory.raw --profile=Win10x64 hashdump\n   \n   # Output:\n   # Administrator:500:aad3b435...:31d6cfe0...\n   # Guest:501:aad3b435...:31d6cfe0...\n   # User:1001:aad3b435...:5f4dcc3b...\n   \n   # LSA secrets\n   volatility -f memory.raw --profile=Win10x64 lsadump\n   \n   # Contains:\n   # - Service account passwords\n   # - Auto-logon credentials\n   # - VPN/RDP cached credentials\n   ```\n\n2. MIMIKATZ IN VOLATILITY:\n   ```bash\n   # Volatility 2 mimikatz plugin\n   volatility -f memory.raw --profile=Win10x64 mimikatz\n   \n   # May extract:\n   # - NTLM hashes\n   # - Kerberos tickets\n   # - Plaintext passwords (wdigest)\n   # - WDigest credentials\n   # - SSP credentials\n   # - LiveSSP credentials\n   \n   # Note: Requires correct Volatility version and dependencies\n   # Alternative: Dump lsass.exe and run mimikatz externally\n   ```\n\n3. LSASS PROCESS DUMPING:\n   ```bash\n   # Find LSASS PID\n   volatility -f memory.raw --profile=Win10x64 pslist | grep lsass\n   \n   # Dump LSASS memory\n   volatility -f memory.raw --profile=Win10x64 memdump -p <LSASS_PID> -D /forensics/\n   \n   # Volatility 3\n   python3 vol.py -f memory.raw -o /forensics/ windows.memmap --pid <LSASS_PID> --dump\n   \n   # Analyze with mimikatz (on Windows)\n   mimikatz.exe\n   sekurlsa::minidump /forensics/<pid>.dmp\n   sekurlsa::logonPasswords\n   \n   # Or use pypykatz (Python)\n   pypykatz lsa minidump /forensics/<pid>.dmp\n   ```\n\n4. CACHED CREDENTIALS:\n   ```bash\n   # Domain cached credentials (DCC2)\n   volatility -f memory.raw --profile=Win10x64 cachedump\n   \n   # Output format:\n   # domain\\user:$DCC2$iteration#hash\n   \n   # Crack with hashcat\n   hashcat -m 2100 hashes.txt wordlist.txt\n   ```\n\n5. BROWSER CREDENTIALS:\n   ```bash\n   # Extract browser process memory\n   volatility -f memory.raw --profile=Win10x64 memdump -p <CHROME_PID> -D /forensics/\n   \n   # Search for credentials\n   strings /forensics/*.dmp | grep -iE \"password|passwd|credential\"\n   \n   # Look for form data\n   strings /forensics/*.dmp | grep -E \"<input.*password\"\n   ```\n\n6. APPLICATION CREDENTIALS:\n   ```bash\n   # Search for common credential patterns\n   \n   # Database connection strings\n   strings memory.raw | grep -iE \"Data Source=|Server=|User Id=\"\n   \n   # API keys\n   strings memory.raw | grep -iE \"api_key|apikey|api-key\"\n   \n   # Private keys (headers)\n   strings memory.raw | grep -E \"BEGIN.*PRIVATE KEY\"\n   \n   # AWS credentials\n   strings memory.raw | grep -E \"AKIA[A-Z0-9]{16}\"\n   \n   # SSH connections\n   strings memory.raw | grep -E \"ssh .*@\"\n   ```\n\n7. KERBEROS TICKETS:\n   ```bash\n   # Extract Kerberos tickets\n   volatility -f memory.raw --profile=Win10x64 kerberos\n   \n   # Volatility 3\n   python3 vol.py -f memory.raw windows.kerberos\n   \n   # Tickets can be used for:\n   # - Pass-the-ticket attacks (in incident scope assessment)\n   # - Identifying compromised accounts\n   # - Timeline of authentication events\n   ```\n\n8. LINUX CREDENTIALS:\n   ```bash\n   # Search for SSH keys\n   strings memory.lime | grep -A5 \"BEGIN.*PRIVATE KEY\"\n   \n   # Search for passwords in bash history\n   python3 vol.py -f memory.lime linux.bash\n   \n   # MySQL/PostgreSQL credentials\n   strings memory.lime | grep -iE \"mysql.*-p|psql.*password\"\n   \n   # Environment variables with credentials\n   python3 vol.py -f memory.lime linux.envars | grep -iE \"pass|secret|key\"\n   ```\n\n9. CREDENTIAL ANALYSIS WORKFLOW:\n   ```bash\n   #!/bin/bash\n   # Comprehensive credential extraction\n   \n   MEMORY=\"$1\"\n   PROFILE=\"$2\"\n   OUTPUT=\"/forensics/credentials\"\n   mkdir -p $OUTPUT\n   \n   echo \"[*] Extracting SAM hashes...\"\n   volatility -f $MEMORY --profile=$PROFILE hashdump > $OUTPUT/hashdump.txt 2>&1\n   \n   echo \"[*] Extracting LSA secrets...\"\n   volatility -f $MEMORY --profile=$PROFILE lsadump > $OUTPUT/lsadump.txt 2>&1\n   \n   echo \"[*] Extracting cached credentials...\"\n   volatility -f $MEMORY --profile=$PROFILE cachedump > $OUTPUT/cachedump.txt 2>&1\n   \n   echo \"[*] Running mimikatz...\"\n   volatility -f $MEMORY --profile=$PROFILE mimikatz > $OUTPUT/mimikatz.txt 2>&1\n   \n   echo \"[*] Searching for plaintext credentials...\"\n   strings $MEMORY | grep -iE \"password\\s*[:=]\\s*\\w\" > $OUTPUT/plaintext_search.txt\n   \n   echo \"[*] Done. Results in $OUTPUT\"\n   ```\n\nCREDENTIAL REPORT:\n```\nCredential Extraction Results:\n\nWARNING: Handle extracted credentials securely\n\nLocal Accounts (SAM):\n| Account | RID | LM Hash | NTLM Hash |\n|---------|-----|---------|----------|\n| Administrator | 500 | (empty) | 31d6cfe0... |\n| jsmith | 1001 | (empty) | 5f4dcc3b... |\n\nDomain Credentials (from LSASS):\n| Domain\\User | Type | Value |\n|-------------|------|------|\n| CORP\\admin | NTLM | a1b2c3d4... |\n| CORP\\admin | Plaintext | P@ssw0rd123 |\n| CORP\\svc_sql | NTLM | e5f6a7b8... |\n\nCached Credentials:\n- CORP\\jsmith (DCC2 hash extracted)\n- CORP\\admin (DCC2 hash extracted)\n\nService Account Credentials:\n- SQL Server: sa / DBp@ss2024\n- Backup Service: backup_svc / BackupPwd!\n\nCompromise Assessment:\n- 3 domain accounts compromised\n- 1 service account with plaintext password\n- Administrative credentials present in memory\n\nRecommendations:\n1. Force password reset for all extracted accounts\n2. Rotate service account credentials\n3. Enable Credential Guard to protect LSASS\n4. Disable WDigest authentication\n```\n\nDETECTION INDICATORS:\n- All credential stores examined\n- LSASS memory analyzed\n- Plaintext credential search completed\n- Service accounts identified\n\nCOMMON PITFALLS:\n- Not dumping LSASS memory for offline analysis\n- Missing service account credentials\n- Forgetting Linux/application credentials\n- Not securing extracted credentials\n\nFURTHER READING:\n- Mimikatz documentation\n- pypykatz documentation\n- Windows authentication internals",
      "tags": ["forensics", "memory", "credentials", "passwords", "dfir"],
      "related_tools": ["bulk_extractor"]
    },
    {
      "id": "malware_detection_memory",
      "title": "Malware Detection in Memory",
      "content": "OBJECTIVE: Identify and analyze malware artifacts in memory using code injection detection, rootkit discovery, and YARA scanning.\n\nACADEMIC BACKGROUND:\nMemory forensics excels at detecting malware that may be invisible on disk. This includes fileless malware, packed executables that only unpack in memory, injected code, and rootkits that hide from the operating system. Multiple detection techniques increase coverage.\n\nMALWARE DETECTION TECHNIQUES:\n\n1. MALFIND - CODE INJECTION DETECTION:\n   ```bash\n   # Volatility 2\n   volatility -f memory.raw --profile=Win10x64 malfind\n   \n   # Volatility 3\n   python3 vol.py -f memory.raw windows.malfind\n   \n   # Malfind looks for:\n   # - PAGE_EXECUTE_READWRITE memory regions (suspicious)\n   # - Memory without backing file (potential injection)\n   # - MZ header in non-file-backed memory\n   \n   # Output includes:\n   # - Process name and PID\n   # - VAD (Virtual Address Descriptor) information\n   # - Memory protection flags\n   # - Hex dump of suspicious region\n   # - Disassembly of first bytes\n   \n   # Dump suspicious regions\n   volatility -f memory.raw --profile=Win10x64 malfind -D /forensics/malfind/\n   ```\n\n2. VAD ANALYSIS:\n   ```bash\n   # VAD tree for process\n   volatility -f memory.raw --profile=Win10x64 vadinfo -p 1234\n   \n   # VAD walk (all regions)\n   volatility -f memory.raw --profile=Win10x64 vadwalk -p 1234\n   \n   # Suspicious VAD indicators:\n   # - PAGE_EXECUTE_READWRITE (RWX) on non-DLL memory\n   # - Private memory with execute permission\n   # - Large private committed regions\n   # - Memory marked as NO_ACCESS containing data\n   \n   # Dump specific VAD region\n   volatility -f memory.raw --profile=Win10x64 vaddump -p 1234 -b 0x7f000000 -D /forensics/\n   ```\n\n3. YARA SCANNING:\n   ```bash\n   # Scan memory with YARA rules\n   volatility -f memory.raw --profile=Win10x64 yarascan -y /rules/malware.yar\n   \n   # Scan specific process\n   volatility -f memory.raw --profile=Win10x64 yarascan -y /rules/malware.yar -p 1234\n   \n   # Volatility 3\n   python3 vol.py -f memory.raw yarascan.YaraScan --yara-file /rules/malware.yar\n   \n   # Sample YARA rule for shellcode:\n   rule shellcode_patterns {\n       strings:\n           $mz = \"MZ\"\n           $ws2 = \"ws2_32\" nocase\n           $shell = { 6a 40 68 00 10 00 00 }  // VirtualAlloc shellcode\n       condition:\n           any of them\n   }\n   ```\n\n4. API HOOKS DETECTION:\n   ```bash\n   # Detect inline API hooks\n   volatility -f memory.raw --profile=Win10x64 apihooks\n   \n   # Typical hook targets:\n   # - NtQueryDirectoryFile (hide files)\n   # - NtQuerySystemInformation (hide processes)\n   # - NtReadVirtualMemory (anti-debugging)\n   # - Send/Recv (network monitoring)\n   \n   # Hook types:\n   # - Inline hooks (JMP instruction at function start)\n   # - IAT hooks (modified import table)\n   # - EAT hooks (modified export table)\n   ```\n\n5. SSDT/IDT ANALYSIS:\n   ```bash\n   # System Service Descriptor Table\n   volatility -f memory.raw --profile=Win10x64 ssdt\n   \n   # Interrupt Descriptor Table\n   volatility -f memory.raw --profile=Win10x64 idt\n   \n   # Look for:\n   # - Hooks pointing outside kernel modules\n   # - Unknown modules in hook addresses\n   # - Inconsistencies with clean system\n   ```\n\n6. KERNEL MODULE ANALYSIS:\n   ```bash\n   # List loaded drivers/modules\n   volatility -f memory.raw --profile=Win10x64 modules\n   volatility -f memory.raw --profile=Win10x64 modscan  # Include unlinked\n   \n   # Volatility 3\n   python3 vol.py -f memory.raw windows.modules\n   python3 vol.py -f memory.raw windows.modscan\n   \n   # Compare modules vs modscan\n   # Modules only in modscan = potentially hidden rootkit\n   \n   # Verify driver signatures\n   volatility -f memory.raw --profile=Win10x64 driverscan\n   ```\n\n7. SERVICE ANALYSIS:\n   ```bash\n   # List services from memory\n   volatility -f memory.raw --profile=Win10x64 svcscan\n   \n   # Look for:\n   # - Services with suspicious binary paths\n   # - Services running from temp/user directories\n   # - Services with unusual names\n   # - Disabled security services\n   \n   # Volatility 3\n   python3 vol.py -f memory.raw windows.svcscan\n   ```\n\n8. CALLBACKS AND TIMERS:\n   ```bash\n   # System callbacks (rootkit persistence)\n   volatility -f memory.raw --profile=Win10x64 callbacks\n   \n   # Types of callbacks:\n   # - PsSetCreateProcessNotifyRoutine (process creation)\n   # - PsSetLoadImageNotifyRoutine (image load)\n   # - CmRegisterCallback (registry)\n   # - ObRegisterCallbacks (object manager)\n   \n   # Timers (periodic execution)\n   volatility -f memory.raw --profile=Win10x64 timers\n   ```\n\n9. COMPREHENSIVE MALWARE HUNT:\n   ```bash\n   #!/bin/bash\n   # Malware hunting script\n   \n   MEMORY=\"$1\"\n   PROFILE=\"$2\"\n   OUTPUT=\"/forensics/malware_hunt\"\n   mkdir -p $OUTPUT\n   \n   echo \"[*] Running malfind...\"\n   volatility -f $MEMORY --profile=$PROFILE malfind > $OUTPUT/malfind.txt\n   volatility -f $MEMORY --profile=$PROFILE malfind -D $OUTPUT/malfind_dumps/\n   \n   echo \"[*] Checking API hooks...\"\n   volatility -f $MEMORY --profile=$PROFILE apihooks > $OUTPUT/apihooks.txt\n   \n   echo \"[*] Analyzing SSDT...\"\n   volatility -f $MEMORY --profile=$PROFILE ssdt > $OUTPUT/ssdt.txt\n   \n   echo \"[*] Scanning drivers...\"\n   volatility -f $MEMORY --profile=$PROFILE driverscan > $OUTPUT/drivers.txt\n   \n   echo \"[*] Comparing modules vs modscan...\"\n   volatility -f $MEMORY --profile=$PROFILE modules > $OUTPUT/modules.txt\n   volatility -f $MEMORY --profile=$PROFILE modscan > $OUTPUT/modscan.txt\n   diff $OUTPUT/modules.txt $OUTPUT/modscan.txt > $OUTPUT/hidden_modules.txt\n   \n   echo \"[*] Scanning callbacks...\"\n   volatility -f $MEMORY --profile=$PROFILE callbacks > $OUTPUT/callbacks.txt\n   \n   echo \"[*] Scanning services...\"\n   volatility -f $MEMORY --profile=$PROFILE svcscan > $OUTPUT/services.txt\n   \n   echo \"[*] YARA scanning...\"\n   if [ -d \"/rules\" ]; then\n       volatility -f $MEMORY --profile=$PROFILE yarascan -y /rules/ > $OUTPUT/yara_hits.txt\n   fi\n   \n   echo \"[*] Done. Review results in $OUTPUT\"\n   ```\n\nMALWARE ANALYSIS REPORT:\n```\nMalware Detection Analysis:\n\nDetection Summary:\n| Technique | Findings | Severity |\n|-----------|----------|----------|\n| Malfind | 3 injected regions | HIGH |\n| API Hooks | 5 hooks detected | CRITICAL |\n| Hidden Modules | 1 driver | CRITICAL |\n| YARA | 2 rule matches | HIGH |\n\nDetailed Findings:\n\n1. Code Injection (Malfind):\nProcess: explorer.exe (PID 2340)\nAddress: 0x7FFE0000\nProtection: PAGE_EXECUTE_READWRITE\nContent: MZ header + PE executable\nAssessment: Injected payload, likely DLL\n\n2. API Hooks Detected:\n| Function | Hooked By | Purpose |\n|----------|-----------|--------|\n| NtQueryDirectoryFile | Unknown | Hide files |\n| NtQuerySystemInformation | Unknown | Hide processes |\n| NtReadVirtualMemory | Unknown | Anti-debugging |\n\n3. Hidden Kernel Module:\nName: rootkit.sys\nVisible in modscan only (unlinked from list)\nSize: 45,056 bytes\nBase: 0xFFFFF802`12340000\n\n4. YARA Matches:\n- Rule: Cobalt_Strike_Beacon (PID 4532)\n- Rule: Mimikatz_Strings (PID 4532)\n\nIOCs:\n- SHA256 (injected code): abc123...\n- Hidden driver: rootkit.sys\n- C2 indicators in malfind dump\n\nRecommendations:\n1. Isolate system immediately\n2. Preserve memory dump for further analysis\n3. Extract malware samples for reverse engineering\n4. Search for same IOCs across network\n```\n\nDETECTION INDICATORS:\n- Malfind identifies injection\n- API hooks detected\n- Hidden modules found\n- YARA rules match\n\nCOMMON PITFALLS:\n- Only running malfind (miss hooks, rootkits)\n- Not comparing modules vs modscan\n- Missing kernel-mode malware\n- Not extracting samples for analysis\n\nFURTHER READING:\n- \"The Art of Memory Forensics\"\n- YARA documentation\n- Rootkit analysis papers",
      "tags": ["forensics", "memory", "malware", "rootkit", "code-injection", "dfir"],
      "related_tools": ["yara", "strings", "binwalk"]
    }
  ]
}
