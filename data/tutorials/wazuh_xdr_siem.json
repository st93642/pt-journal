{
  "id": "wazuh_xdr_siem",
  "title": "Wazuh Open Source XDR & SIEM",
  "description": "Comprehensive guide to Wazuh, the open-source XDR and SIEM platform covering deployment, agent management, rule creation, compliance monitoring, and threat detection.",
  "type": "tutorial",
  "steps": [
    {
      "id": "wazuh_architecture",
      "title": "Wazuh Architecture & Deployment",
      "content": "## Wazuh Platform Overview\n\nWazuh is a free, open-source unified XDR and SIEM platform providing threat detection, integrity monitoring, incident response, and compliance.\n\n### Core Components\n\n**1. Wazuh Server**\n- Analyzes data from agents\n- Processes events through decoders and rules\n- Generates alerts and security events\n- Manages agent configuration\n\n**2. Wazuh Indexer (OpenSearch)**\n- Stores alerts and events\n- Full-text search and analytics\n- Can be clustered for HA\n\n**3. Wazuh Dashboard**\n- Web interface for management\n- Visualization and reporting\n- Built on OpenSearch Dashboards\n\n**4. Wazuh Agent**\n- Deployed on endpoints\n- Collects system data\n- Monitors files, processes, network\n- Multi-platform (Windows, Linux, macOS)\n\n### Deployment Options\n\n**Docker Deployment**\n```bash\n# Clone Wazuh Docker repository\ngit clone https://github.com/wazuh/wazuh-docker.git -b v4.7.0\ncd wazuh-docker/single-node\n\n# Generate SSL certificates\ndocker-compose -f generate-indexer-certs.yml run --rm generator\n\n# Start Wazuh stack\ndocker-compose up -d\n```\n\n**Package Installation (Ubuntu/Debian)**\n```bash\n# Add Wazuh repository\ncurl -s https://packages.wazuh.com/key/GPG-KEY-WAZUH | gpg --dearmor -o /usr/share/keyrings/wazuh.gpg\necho \"deb [signed-by=/usr/share/keyrings/wazuh.gpg] https://packages.wazuh.com/4.x/apt/ stable main\" | tee -a /etc/apt/sources.list.d/wazuh.list\n\n# Install Wazuh manager\napt-get update && apt-get install wazuh-manager\n\n# Install Wazuh indexer\napt-get install wazuh-indexer\n\n# Install Wazuh dashboard\napt-get install wazuh-dashboard\n```\n\n### Agent Deployment\n\n**Linux Agent**\n```bash\n# Install agent\ncurl -so wazuh-agent-4.7.0-1.x86_64.rpm https://packages.wazuh.com/4.x/yum/wazuh-agent-4.7.0-1.x86_64.rpm\nWAZUH_MANAGER=\"<manager-ip>\" rpm -ivh wazuh-agent-4.7.0-1.x86_64.rpm\nsystemctl enable --now wazuh-agent\n```\n\n**Windows Agent**\n```powershell\n# Download and install\nInvoke-WebRequest -Uri https://packages.wazuh.com/4.x/windows/wazuh-agent-4.7.0-1.msi -OutFile wazuh-agent.msi\nmsiexec.exe /i wazuh-agent.msi /q WAZUH_MANAGER=\"<manager-ip>\"\n```\n\n### Architecture Diagram\n\n```\n[Endpoints]          [Manager]              [Indexer]         [Dashboard]\n   ↓                    ↓                       ↓                  ↓\n[Agent] ────────→ [Analysis Engine] ────→ [OpenSearch] ────→ [Web UI]\n   ↓                    ↓                       ↓                  ↓\n[Logs]            [Rules/Decoders]          [Storage]        [Analyst]\n```\n\n### Initial Configuration\n\n```xml\n<!-- /var/ossec/etc/ossec.conf -->\n<ossec_config>\n  <global>\n    <email_notification>yes</email_notification>\n    <email_to>soc@company.com</email_to>\n    <smtp_server>smtp.company.com</smtp_server>\n    <email_from>wazuh@company.com</email_from>\n  </global>\n  \n  <remote>\n    <connection>secure</connection>\n    <port>1514</port>\n    <protocol>tcp</protocol>\n  </remote>\n</ossec_config>\n```",
      "tags": ["soc", "wazuh", "xdr", "siem", "architecture"],
      "related_tools": ["sigma"]
    },
    {
      "id": "wazuh_threat_detection",
      "title": "Threat Detection & Rule Management",
      "content": "## Wazuh Detection Rules\n\nWazuh uses XML-based rules for threat detection with over 4,000 built-in rules covering common attack techniques.\n\n### Rule Structure\n\n```xml\n<rule id=\"100001\" level=\"10\">\n  <if_sid>5710</if_sid>\n  <match>^authentication failure</match>\n  <description>Authentication failure detected</description>\n  <group>authentication_failure,</group>\n  <mitre>\n    <id>T1078</id>\n  </mitre>\n</rule>\n```\n\n### Rule Elements\n\n| Element | Description | Example |\n|---------|-------------|--------|\n| `id` | Unique rule ID (100000+) | 100001 |\n| `level` | Alert severity (0-15) | 10 |\n| `if_sid` | Parent rule to match first | 5710 |\n| `match` | Pattern to match in log | authentication failure |\n| `regex` | Regular expression match | ^Failed password for |\n| `srcip` | Source IP field | 192.168.1.100 |\n| `user` | Username field | admin |\n| `frequency` | Trigger threshold | 5 |\n| `timeframe` | Time window (seconds) | 120 |\n\n### Custom Rule Examples\n\n**Brute Force Detection**\n```xml\n<rule id=\"100100\" level=\"10\" frequency=\"5\" timeframe=\"120\">\n  <if_matched_sid>5710</if_matched_sid>\n  <same_source_ip />\n  <description>Multiple authentication failures from same source</description>\n  <group>authentication_failure,brute_force,</group>\n  <mitre>\n    <id>T1110</id>\n  </mitre>\n</rule>\n```\n\n**Suspicious Process Execution**\n```xml\n<rule id=\"100200\" level=\"12\">\n  <if_sid>61603</if_sid>\n  <field name=\"win.eventdata.image\">mimikatz</field>\n  <description>Mimikatz execution detected</description>\n  <group>credential_access,</group>\n  <mitre>\n    <id>T1003</id>\n  </mitre>\n</rule>\n```\n\n**File Integrity Alert**\n```xml\n<rule id=\"100300\" level=\"8\">\n  <if_sid>550</if_sid>\n  <match>/etc/passwd</match>\n  <description>Critical system file modified: /etc/passwd</description>\n  <group>file_integrity,syscheck,</group>\n  <mitre>\n    <id>T1136</id>\n  </mitre>\n</rule>\n```\n\n### Rule Management Commands\n\n```bash\n# Test rule syntax\n/var/ossec/bin/wazuh-logtest\n\n# Restart manager after rule changes\nsystemctl restart wazuh-manager\n\n# Check rule matching\ncat /var/ossec/logs/alerts/alerts.log | grep \"rule_id\"\n\n# View active rules\n/var/ossec/bin/wazuh-analysisd -t\n```\n\n### Decoders for Log Parsing\n\n```xml\n<!-- Custom decoder for application logs -->\n<decoder name=\"custom_app\">\n  <program_name>myapp</program_name>\n  <regex>^(\\w+) (\\S+) (\\d+\\.\\d+\\.\\d+\\.\\d+) - (.+)$</regex>\n  <order>action,user,srcip,message</order>\n</decoder>\n```\n\n### MITRE ATT&CK Mapping\n\nWazuh rules are mapped to MITRE ATT&CK:\n\n- **T1078** - Valid Accounts\n- **T1110** - Brute Force\n- **T1003** - Credential Dumping\n- **T1059** - Command and Script Interpreter\n- **T1055** - Process Injection\n- **T1070** - Indicator Removal\n\n### Alert Levels\n\n| Level | Severity | Action |\n|-------|----------|--------|\n| 0-3 | Low | Log only |\n| 4-7 | Medium | Monitor |\n| 8-11 | High | Investigate |\n| 12-15 | Critical | Immediate response |",
      "tags": ["soc", "wazuh", "rules", "detection"],
      "related_tools": ["sigma", "yara"]
    },
    {
      "id": "wazuh_fim_sca",
      "title": "File Integrity Monitoring & Security Configuration Assessment",
      "content": "## File Integrity Monitoring (FIM)\n\nWazuh FIM detects file changes, additions, and deletions on monitored systems.\n\n### FIM Configuration\n\n```xml\n<!-- Agent ossec.conf -->\n<syscheck>\n  <disabled>no</disabled>\n  <frequency>43200</frequency>\n  <scan_on_start>yes</scan_on_start>\n  \n  <!-- Directories to monitor -->\n  <directories check_all=\"yes\" realtime=\"yes\">/etc</directories>\n  <directories check_all=\"yes\" realtime=\"yes\">/bin,/sbin</directories>\n  <directories check_all=\"yes\" realtime=\"yes\" report_changes=\"yes\">/var/www</directories>\n  \n  <!-- Windows paths -->\n  <directories check_all=\"yes\" realtime=\"yes\">C:\\Windows\\System32</directories>\n  \n  <!-- Ignore patterns -->\n  <ignore>/etc/mtab</ignore>\n  <ignore>/var/log</ignore>\n  <ignore type=\"sregex\">.log$</ignore>\n</syscheck>\n```\n\n### FIM Attributes\n\n| Attribute | Description |\n|-----------|-------------|\n| `realtime` | Real-time monitoring using inotify |\n| `whodata` | Track who made changes (Linux audit) |\n| `report_changes` | Include file content changes |\n| `check_all` | Monitor all attributes |\n| `check_md5sum` | MD5 hash verification |\n| `check_sha256sum` | SHA256 hash verification |\n\n### Who-data (Audit) Configuration\n\n```xml\n<syscheck>\n  <directories check_all=\"yes\" whodata=\"yes\">/etc</directories>\n</syscheck>\n```\n\nEnables tracking of:\n- User who made the change\n- Process that modified the file\n- Login session information\n\n### Security Configuration Assessment (SCA)\n\nSCA checks systems against security benchmarks (CIS, PCI-DSS, HIPAA).\n\n**Built-in Policies**\n```bash\n# List available policies\nls /var/ossec/ruleset/sca/\n\n# Example policies:\n# cis_debian_linux_10.yml\n# cis_win2019.yml\n# pci_dss_3.2.1.yml\n# hipaa.yml\n```\n\n**SCA Configuration**\n```xml\n<!-- Agent ossec.conf -->\n<sca>\n  <enabled>yes</enabled>\n  <scan_on_start>yes</scan_on_start>\n  <interval>12h</interval>\n  <skip_nfs>yes</skip_nfs>\n  <policies>\n    <policy>cis_debian_linux_10.yml</policy>\n    <policy>pci_dss_3.2.1.yml</policy>\n  </policies>\n</sca>\n```\n\n### Custom SCA Policy\n\n```yaml\n# /var/ossec/etc/custom_sca.yml\npolicy:\n  id: \"custom_security_baseline\"\n  file: \"custom_sca.yml\"\n  name: \"Custom Security Baseline\"\n  description: \"Organization-specific security requirements\"\n\nrequirements:\n  title: \"Check SSH configuration\"\n  description: \"Verify SSH server security settings\"\n  condition: all\n\nchecks:\n  - id: 10001\n    title: \"Ensure SSH Protocol is 2\"\n    description: \"SSH Protocol 1 is insecure\"\n    rationale: \"SSH Protocol version 1 has known cryptographic weaknesses\"\n    remediation: \"Set 'Protocol 2' in /etc/ssh/sshd_config\"\n    compliance:\n      - cis: \"5.2.4\"\n      - pci_dss: \"2.2.4\"\n    condition: all\n    rules:\n      - 'c:sshd -T -> r:^protocol\\s+2'\n```\n\n### SCA Result Analysis\n\nResults appear in Dashboard under:\n- **SCA → Agents → [Agent] → Security Configuration Assessment**\n\nCategories:\n- **Passed** - Configuration meets benchmark\n- **Failed** - Configuration needs remediation\n- **Not Applicable** - Check doesn't apply to system\n\n### FIM Alerts Query\n\n```json\n{\n  \"query\": {\n    \"bool\": {\n      \"must\": [\n        { \"match\": { \"rule.groups\": \"syscheck\" } },\n        { \"range\": { \"rule.level\": { \"gte\": 7 } } }\n      ]\n    }\n  }\n}\n```",
      "tags": ["soc", "wazuh", "fim", "sca", "compliance"],
      "related_tools": ["sigma"]
    },
    {
      "id": "wazuh_vulnerability_detection",
      "title": "Vulnerability Detection & Incident Response",
      "content": "## Wazuh Vulnerability Detection\n\nWazuh detects vulnerabilities on monitored endpoints by correlating installed packages against CVE databases.\n\n### Vulnerability Detector Configuration\n\n```xml\n<!-- Manager ossec.conf -->\n<vulnerability-detector>\n  <enabled>yes</enabled>\n  <interval>5m</interval>\n  <min_full_scan_interval>6h</min_full_scan_interval>\n  <run_on_start>yes</run_on_start>\n\n  <!-- Operating system vulnerability feeds -->\n  <provider name=\"nvd\">\n    <enabled>yes</enabled>\n    <update_interval>1h</update_interval>\n  </provider>\n\n  <provider name=\"canonical\">\n    <enabled>yes</enabled>\n    <os>focal</os>\n    <os>jammy</os>\n    <update_interval>1h</update_interval>\n  </provider>\n\n  <provider name=\"msu\">\n    <enabled>yes</enabled>\n    <update_interval>1h</update_interval>\n  </provider>\n</vulnerability-detector>\n```\n\n### Supported Vulnerability Feeds\n\n| Provider | Coverage | Systems |\n|----------|----------|--------|\n| NVD | National Vulnerability Database | All |\n| Canonical | Ubuntu CVEs | Ubuntu |\n| Debian | Debian Security Tracker | Debian |\n| Red Hat | RHEL/CentOS CVEs | RHEL family |\n| Amazon Linux | Amazon advisories | Amazon Linux |\n| MSU | Microsoft Security Updates | Windows |\n| Arch Linux | Arch Linux CVEs | Arch |\n\n### Vulnerability Severity Levels\n\n- **Critical** (CVSS 9.0-10.0): Immediate patching required\n- **High** (CVSS 7.0-8.9): Priority patching\n- **Medium** (CVSS 4.0-6.9): Scheduled patching\n- **Low** (CVSS 0.1-3.9): Monitor\n\n### Active Response Configuration\n\nAutomate responses to security events:\n\n```xml\n<!-- Manager ossec.conf -->\n<active-response>\n  <command>firewall-drop</command>\n  <location>local</location>\n  <rules_id>100100</rules_id>\n  <timeout>600</timeout>\n</active-response>\n\n<command>\n  <name>firewall-drop</name>\n  <executable>firewall-drop</executable>\n  <timeout_allowed>yes</timeout_allowed>\n</command>\n```\n\n### Built-in Active Response Scripts\n\n| Script | Action | Platform |\n|--------|--------|----------|\n| `firewall-drop` | Block IP with iptables/firewalld | Linux |\n| `route-null` | Null route IP | Linux |\n| `disable-account` | Disable user account | Linux |\n| `netsh` | Block IP with Windows Firewall | Windows |\n| `restart-service` | Restart a service | All |\n\n### Custom Active Response Script\n\n```bash\n#!/bin/bash\n# /var/ossec/active-response/bin/custom-block.sh\n\nACTION=$1\nUSER=$2\nIP=$3\nALERTID=$4\n\ncase $ACTION in\n  add)\n    # Block action\n    /sbin/iptables -I INPUT -s \"$IP\" -j DROP\n    logger -t wazuh-ar \"Blocked IP: $IP for alert $ALERTID\"\n    ;;\n  delete)\n    # Unblock action\n    /sbin/iptables -D INPUT -s \"$IP\" -j DROP\n    logger -t wazuh-ar \"Unblocked IP: $IP\"\n    ;;\nesac\n\nexit 0\n```\n\n### Incident Response Workflow\n\n```\n[Alert Generated]\n       ↓\n[Rule Evaluation]\n       ↓\n[Active Response Triggered]\n       ↓\n[Response Script Executed]\n       ↓\n[Event Logged]\n       ↓\n[Timeout Reached]\n       ↓\n[Response Reversed]\n```\n\n### Querying Vulnerabilities\n\n```bash\n# API query for vulnerabilities\ncurl -k -X GET \"https://localhost:55000/vulnerability/{agent_id}?pretty=true\" \\\n  -H \"Authorization: Bearer $TOKEN\"\n\n# Query by severity\ncurl -k -X GET \"https://localhost:55000/vulnerability/{agent_id}?severity=Critical\" \\\n  -H \"Authorization: Bearer $TOKEN\"\n```\n\n### Integration with SOAR\n\nWazuh can integrate with SOAR platforms:\n\n```xml\n<integration>\n  <name>slack</name>\n  <hook_url>https://hooks.slack.com/services/xxx</hook_url>\n  <level>10</level>\n  <alert_format>json</alert_format>\n</integration>\n\n<integration>\n  <name>pagerduty</name>\n  <api_key>xxx</api_key>\n  <level>12</level>\n</integration>\n```",
      "tags": ["soc", "wazuh", "vulnerability", "incident-response"],
      "related_tools": ["sigma"]
    },
    {
      "id": "wazuh_log_collection",
      "title": "Log Collection & Analysis",
      "content": "## Wazuh Log Collection\n\nWazuh collects and analyzes logs from multiple sources for security monitoring.\n\n### Agent Log Collection\n\n**Linux Logs**\n```xml\n<localfile>\n  <log_format>syslog</log_format>\n  <location>/var/log/syslog</location>\n</localfile>\n\n<localfile>\n  <log_format>syslog</log_format>\n  <location>/var/log/auth.log</location>\n</localfile>\n\n<localfile>\n  <log_format>apache</log_format>\n  <location>/var/log/apache2/access.log</location>\n</localfile>\n\n<localfile>\n  <log_format>json</log_format>\n  <location>/var/log/app/app.json</location>\n</localfile>\n```\n\n**Windows Events**\n```xml\n<localfile>\n  <location>Security</location>\n  <log_format>eventchannel</log_format>\n  <query>Event/System[EventID=4624 or EventID=4625 or EventID=4648]</query>\n</localfile>\n\n<localfile>\n  <location>Microsoft-Windows-Sysmon/Operational</location>\n  <log_format>eventchannel</log_format>\n</localfile>\n\n<localfile>\n  <location>Microsoft-Windows-PowerShell/Operational</location>\n  <log_format>eventchannel</log_format>\n</localfile>\n```\n\n### Remote Syslog Collection\n\n```xml\n<!-- Manager configuration -->\n<remote>\n  <connection>syslog</connection>\n  <port>514</port>\n  <protocol>udp</protocol>\n  <allowed-ips>10.0.0.0/8</allowed-ips>\n</remote>\n```\n\n### Log Formats Supported\n\n| Format | Description | Use Case |\n|--------|-------------|----------|\n| `syslog` | Standard syslog | Linux system logs |\n| `snort-full` | Snort IDS alerts | Network IDS |\n| `snort-fast` | Snort fast alerts | Network IDS |\n| `apache` | Apache access logs | Web server |\n| `iis` | IIS logs | Windows web server |\n| `squid` | Squid proxy logs | Proxy server |\n| `nmapg` | Nmap grepable | Network scanning |\n| `mysql_log` | MySQL logs | Database |\n| `postgresql_log` | PostgreSQL logs | Database |\n| `eventchannel` | Windows Event Log | Windows |\n| `json` | JSON formatted | Modern applications |\n| `multi-line` | Multi-line logs | Stack traces |\n\n### Custom Decoder Creation\n\n```xml\n<!-- /var/ossec/etc/decoders/local_decoder.xml -->\n<decoder name=\"custom-webapp\">\n  <parent>json</parent>\n  <prematch>\"app\":\"webapp\"</prematch>\n  <regex offset=\"after_parent\">\"action\":\"(\\w+)\",\"user\":\"(\\S+)\",\"ip\":\"(\\d+\\.\\d+\\.\\d+\\.\\d+)\"</regex>\n  <order>action,user,srcip</order>\n</decoder>\n\n<decoder name=\"custom-webapp-auth\">\n  <parent>custom-webapp</parent>\n  <regex>\"action\":\"(login|logout)\"</regex>\n  <order>action</order>\n</decoder>\n```\n\n### Agentless Monitoring\n\nMonitor devices without agents:\n\n```xml\n<!-- Manager configuration -->\n<agentless>\n  <type>ssh_integrity_check_linux</type>\n  <frequency>36000</frequency>\n  <host>admin@192.168.1.1</host>\n  <state>periodic</state>\n  <arguments>/bin /etc /sbin</arguments>\n</agentless>\n```\n\n### Cloud Log Integration\n\n**AWS CloudTrail**\n```xml\n<wodle name=\"aws-s3\">\n  <disabled>no</disabled>\n  <interval>10m</interval>\n  <run_on_start>yes</run_on_start>\n  <bucket type=\"cloudtrail\">\n    <name>my-cloudtrail-bucket</name>\n    <access_key>xxx</access_key>\n    <secret_key>xxx</secret_key>\n  </bucket>\n</wodle>\n```\n\n**Azure Log Analytics**\n```xml\n<wodle name=\"azure-logs\">\n  <disabled>no</disabled>\n  <interval>1m</interval>\n  <run_on_start>yes</run_on_start>\n  <log_analytics>\n    <application_id>xxx</application_id>\n    <application_key>xxx</application_key>\n    <tenantdomain>xxx.onmicrosoft.com</tenantdomain>\n    <request>\n      <tag>azure-activity</tag>\n      <query>AzureActivity</query>\n      <workspace>xxx</workspace>\n    </request>\n  </log_analytics>\n</wodle>\n```\n\n### Log Analysis Commands\n\n```bash\n# Test decoder matching\necho \"sample log line\" | /var/ossec/bin/wazuh-logtest\n\n# View real-time alerts\ntail -f /var/ossec/logs/alerts/alerts.log\n\n# Check archive logs\nzcat /var/ossec/logs/archives/2024/Jan/ossec-archive-01.log.gz | head\n```",
      "tags": ["soc", "wazuh", "logging", "analysis"],
      "related_tools": ["sigma"]
    },
    {
      "id": "wazuh_dashboard_api",
      "title": "Dashboard Operations & API Usage",
      "content": "## Wazuh Dashboard & API\n\nThe Wazuh Dashboard provides visualization and the API enables automation and integration.\n\n### Dashboard Navigation\n\n**Security Events**\n- Real-time alert monitoring\n- Event correlation timeline\n- Threat intelligence enrichment\n\n**Integrity Monitoring**\n- File change tracking\n- Registry modifications (Windows)\n- Permission changes\n\n**Security Configuration Assessment**\n- CIS benchmark compliance\n- PCI-DSS requirements\n- HIPAA controls\n\n**Vulnerability Detection**\n- CVE inventory\n- Severity distribution\n- Remediation tracking\n\n### Custom Visualizations\n\n**Alert Timeline**\n```json\n{\n  \"title\": \"Security Alerts Over Time\",\n  \"type\": \"line\",\n  \"params\": {\n    \"type\": \"line\",\n    \"grid\": { \"categoryLines\": false },\n    \"categoryAxes\": [{ \"id\": \"CategoryAxis-1\" }],\n    \"valueAxes\": [{ \"id\": \"ValueAxis-1\" }]\n  },\n  \"aggs\": [\n    {\n      \"id\": \"1\",\n      \"type\": \"count\",\n      \"schema\": \"metric\"\n    },\n    {\n      \"id\": \"2\",\n      \"type\": \"date_histogram\",\n      \"schema\": \"segment\",\n      \"params\": {\n        \"field\": \"@timestamp\",\n        \"interval\": \"auto\"\n      }\n    }\n  ]\n}\n```\n\n### Wazuh API Overview\n\n**Authentication**\n```bash\n# Get API token\nTOKEN=$(curl -u wazuh:wazuh -k -X POST \"https://localhost:55000/security/user/authenticate?raw=true\")\n\n# Use token in subsequent requests\ncurl -k -X GET \"https://localhost:55000/\" \\\n  -H \"Authorization: Bearer $TOKEN\"\n```\n\n### Common API Endpoints\n\n| Endpoint | Method | Description |\n|----------|--------|-------------|\n| `/agents` | GET | List all agents |\n| `/agents/{id}` | GET | Agent details |\n| `/agents/{id}/key` | GET | Agent key |\n| `/rules` | GET | List rules |\n| `/decoders` | GET | List decoders |\n| `/manager/status` | GET | Manager status |\n| `/syscheck/{id}` | GET | FIM data for agent |\n| `/vulnerability/{id}` | GET | Vulnerabilities |\n| `/sca/{id}` | GET | SCA results |\n\n### API Usage Examples\n\n**List Agents**\n```bash\ncurl -k -X GET \"https://localhost:55000/agents?pretty=true\" \\\n  -H \"Authorization: Bearer $TOKEN\"\n```\n\n**Get Agent Summary**\n```bash\ncurl -k -X GET \"https://localhost:55000/agents/summary/status?pretty=true\" \\\n  -H \"Authorization: Bearer $TOKEN\"\n```\n\n**Query Alerts**\n```bash\ncurl -k -X GET \"https://localhost:55000/alerts?pretty=true&limit=10&q=rule.level>10\" \\\n  -H \"Authorization: Bearer $TOKEN\"\n```\n\n**Restart Agent**\n```bash\ncurl -k -X PUT \"https://localhost:55000/agents/{agent_id}/restart\" \\\n  -H \"Authorization: Bearer $TOKEN\"\n```\n\n### Python API Client\n\n```python\nfrom wazuh_api import WazuhAPI\n\n# Initialize client\napi = WazuhAPI(\n    host='https://localhost:55000',\n    user='wazuh',\n    password='wazuh',\n    verify_ssl=False\n)\n\n# Get agents\nagents = api.get('/agents')\nfor agent in agents['data']['affected_items']:\n    print(f\"{agent['id']}: {agent['name']} - {agent['status']}\")\n\n# Get alerts\nalerts = api.get('/alerts', params={'limit': 100, 'q': 'rule.level>=10'})\nfor alert in alerts['data']['affected_items']:\n    print(f\"{alert['timestamp']}: {alert['rule']['description']}\")\n```\n\n### Automation with API\n\n**Bulk Agent Deployment Script**\n```python\nimport requests\nimport json\n\nWAZUH_API = \"https://wazuh-manager:55000\"\nTOKEN = \"<your_token>\"\n\nHOSTS = [\"server1\", \"server2\", \"server3\"]\n\nfor host in HOSTS:\n    response = requests.post(\n        f\"{WAZUH_API}/agents\",\n        headers={\"Authorization\": f\"Bearer {TOKEN}\"},\n        json={\"name\": host},\n        verify=False\n    )\n    agent_key = response.json()['data']['key']\n    print(f\"Agent key for {host}: {agent_key}\")\n```\n\n### Integration with SIEM Tools\n\nWazuh alerts can be forwarded to:\n- Splunk via syslog\n- Elastic via direct indexing\n- TheHive for case management\n- MISP for threat intelligence",
      "tags": ["soc", "wazuh", "dashboard", "api"],
      "related_tools": ["sigma"]
    }
  ]
}
