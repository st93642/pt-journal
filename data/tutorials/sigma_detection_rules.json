{
  "id": "sigma_detection_rules",
  "title": "Sigma Detection Rules Mastery",
  "description": "Comprehensive guide to Sigma detection rules - the universal format for SIEM detection rules. Learn to create, convert, and deploy Sigma rules across multiple SIEM platforms.",
  "type": "tutorial",
  "steps": [
    {
      "id": "sigma_introduction",
      "title": "Introduction to Sigma Rules",
      "content": "## What is Sigma?\n\nSigma is a generic and open signature format for SIEM systems. It's the YARA of log files - a universal detection rule format that can be converted to any SIEM query language.\n\n### Why Sigma Matters\n\n**Problems Sigma Solves:**\n- Vendor lock-in for detection content\n- Duplicate effort across organizations\n- Non-shareable detection rules\n- Platform-specific query languages\n\n**Sigma Benefits:**\n- Write once, deploy anywhere\n- Community-driven rule repository (3000+ rules)\n- MITRE ATT&CK mapped\n- Version controlled detection-as-code\n\n### The Sigma Ecosystem\n\n```\n[Sigma Rule (YAML)] → [Sigma Converter] → [SIEM Query]\n                                              ↓\n                            Splunk | Elastic | QRadar | Sentinel\n```\n\n### Sigma Rule Repository\n\nThe SigmaHQ repository contains:\n- **Generic Rules** - Platform-agnostic detections\n- **Threat Hunting Rules** - Broader hunting queries\n- **Emerging Threats** - Timely threat-specific rules\n- **Compliance Rules** - CIS, NIST mapping\n\n### Installation\n\n**Sigma CLI (pySigma)**\n```bash\n# Install sigma-cli\npip install sigma-cli\n\n# Verify installation\nsigma version\n\n# Install backend plugins\npip install pySigma-backend-splunk\npip install pySigma-backend-elasticsearch\npip install pySigma-backend-microsoft365defender\n```\n\n**Clone Sigma Repository**\n```bash\ngit clone https://github.com/SigmaHQ/sigma.git\ncd sigma\nls rules/\n```\n\n### Sigma vs Other Formats\n\n| Feature | Sigma | YARA | Snort |\n|---------|-------|------|-------|\n| Target | Log events | Files | Network |\n| Format | YAML | Custom | Custom |\n| Conversion | Multi-SIEM | N/A | N/A |\n| Community | 3000+ rules | Extensive | Extensive |\n\n### Getting Started\n\n1. Understand your SIEM's log sources\n2. Identify attack technique to detect\n3. Write or find Sigma rule\n4. Convert to your SIEM format\n5. Test and tune\n6. Deploy to production",
      "tags": ["soc", "sigma", "detection", "siem"],
      "related_tools": ["sigma"]
    },
    {
      "id": "sigma_rule_structure",
      "title": "Sigma Rule Structure & Syntax",
      "content": "## Anatomy of a Sigma Rule\n\nSigma rules are YAML files with a defined structure for detection logic.\n\n### Basic Rule Structure\n\n```yaml\ntitle: Suspicious PowerShell Execution\nid: 6e897651-f157-4d8f-aafd-7b8e9e7b9a82\nstatus: experimental\ndescription: Detects suspicious PowerShell command line arguments\nreferences:\n  - https://attack.mitre.org/techniques/T1059/001/\nauthor: John Doe\ndate: 2024/01/15\nmodified: 2024/06/01\ntags:\n  - attack.execution\n  - attack.t1059.001\nlogsource:\n  category: process_creation\n  product: windows\ndetection:\n  selection:\n    Image|endswith: '\\\\powershell.exe'\n    CommandLine|contains:\n      - '-enc'\n      - '-EncodedCommand'\n      - 'bypass'\n      - '-nop'\n  condition: selection\nfalsepositives:\n  - Administrative scripts\n  - Legitimate automation\nlevel: medium\n```\n\n### Rule Metadata Fields\n\n| Field | Required | Description |\n|-------|----------|-------------|\n| `title` | Yes | Short descriptive title |\n| `id` | Yes | Unique UUID |\n| `status` | No | experimental/test/stable |\n| `description` | Yes | Detailed description |\n| `author` | No | Rule author |\n| `date` | No | Creation date |\n| `modified` | No | Last modification |\n| `references` | No | External references |\n| `tags` | No | MITRE ATT&CK tags |\n| `level` | Yes | informational/low/medium/high/critical |\n| `falsepositives` | No | Known false positive scenarios |\n\n### Log Source Definition\n\n```yaml\nlogsource:\n  category: process_creation    # Generic category\n  product: windows              # Target product\n  service: security             # Service (optional)\n```\n\n**Common Categories:**\n- `process_creation` - Process execution\n- `file_event` - File operations\n- `network_connection` - Network activity\n- `registry_event` - Registry changes\n- `dns_query` - DNS lookups\n- `authentication` - Login events\n\n### Detection Section\n\n**Selection Keywords:**\n```yaml\ndetection:\n  selection_process:\n    Image|endswith: '\\\\cmd.exe'\n  selection_args:\n    CommandLine|contains|all:\n      - 'whoami'\n      - '/priv'\n  condition: selection_process and selection_args\n```\n\n**Modifiers:**\n| Modifier | Description | Example |\n|----------|-------------|--------|\n| `contains` | Substring match | `|contains: 'admin'` |\n| `startswith` | Prefix match | `|startswith: 'C:\\\\'` |\n| `endswith` | Suffix match | `|endswith: '.exe'` |\n| `all` | All values must match | `|contains|all:` |\n| `re` | Regex match | `|re: '.*admin.*'` |\n| `base64` | Base64 encoded | `|base64:` |\n| `base64offset` | Base64 with offset | `|base64offset:` |\n\n### Condition Logic\n\n```yaml\ndetection:\n  selection_a:\n    Image: 'cmd.exe'\n  selection_b:\n    CommandLine|contains: 'whoami'\n  filter:\n    User: 'SYSTEM'\n  condition: (selection_a and selection_b) and not filter\n```\n\n**Operators:**\n- `and` - Both must match\n- `or` - Either must match\n- `not` - Negation\n- `1 of selection*` - Any one selection\n- `all of selection*` - All selections\n- `1 of them` - Any defined selection",
      "tags": ["soc", "sigma", "rules", "syntax"],
      "related_tools": ["sigma"]
    },
    {
      "id": "sigma_writing_rules",
      "title": "Writing Effective Sigma Rules",
      "content": "## Detection Engineering with Sigma\n\nCreating effective Sigma rules requires understanding both the attack technique and available log data.\n\n### Rule Development Process\n\n1. **Identify Technique** - What attack to detect?\n2. **Research Indicators** - What artifacts exist?\n3. **Map to Log Sources** - What logs capture this?\n4. **Write Detection Logic** - Create the rule\n5. **Test Against Data** - Validate accuracy\n6. **Tune for FP** - Reduce false positives\n\n### Example: Credential Dumping Detection\n\n**Technique**: T1003.001 - LSASS Memory\n\n**Research**: Mimikatz accesses lsass.exe with specific access rights\n\n```yaml\ntitle: LSASS Memory Access by Unknown Process\nid: 0d894093-71bc-43c3-8c4d-ecfc28dcf5d9\nstatus: stable\ndescription: Detects processes accessing LSASS memory, potential credential dumping\nreferences:\n  - https://attack.mitre.org/techniques/T1003/001/\nauthor: Security Team\ndate: 2024/01/15\ntags:\n  - attack.credential_access\n  - attack.t1003.001\nlogsource:\n  category: process_access\n  product: windows\ndetection:\n  selection:\n    TargetImage|endswith: '\\\\lsass.exe'\n    GrantedAccess|contains:\n      - '0x1010'\n      - '0x1410'\n      - '0x1F0FFF'\n      - '0x1F1FFF'\n  filter_known:\n    SourceImage|endswith:\n      - '\\\\MsMpEng.exe'\n      - '\\\\csrss.exe'\n      - '\\\\wininit.exe'\n      - '\\\\vmtoolsd.exe'\n  condition: selection and not filter_known\nfalsepositives:\n  - Security products\n  - System processes\nlevel: high\n```\n\n### Example: Suspicious Scheduled Task\n\n```yaml\ntitle: Scheduled Task Created via Command Line\nid: 92626ddd-662c-49e3-ac59-f6535f12d189\nstatus: stable\ndescription: Detects scheduled task creation via schtasks.exe\nreferences:\n  - https://attack.mitre.org/techniques/T1053/005/\nauthor: Security Team\ndate: 2024/01/15\ntags:\n  - attack.persistence\n  - attack.t1053.005\nlogsource:\n  category: process_creation\n  product: windows\ndetection:\n  selection_tool:\n    Image|endswith: '\\\\schtasks.exe'\n  selection_create:\n    CommandLine|contains:\n      - '/create'\n      - '-create'\n  selection_suspicious:\n    CommandLine|contains:\n      - 'powershell'\n      - 'cmd.exe'\n      - 'wscript'\n      - 'cscript'\n      - 'mshta'\n  condition: selection_tool and selection_create and selection_suspicious\nfalsepositives:\n  - Administrative automation\n  - Software installation\nlevel: medium\n```\n\n### Example: DNS Tunneling Detection\n\n```yaml\ntitle: Potential DNS Tunneling - Long Query\nid: 1ec4b281-aa65-46a2-bdae-5fd830ed914e\nstatus: experimental\ndescription: Detects potentially suspicious long DNS queries indicative of DNS tunneling\nreferences:\n  - https://attack.mitre.org/techniques/T1071/004/\nauthor: Security Team\ndate: 2024/01/15\ntags:\n  - attack.command_and_control\n  - attack.t1071.004\nlogsource:\n  category: dns_query\n  product: windows\ndetection:\n  selection:\n    QueryName|re: '^[a-zA-Z0-9]{30,}\\\\..+$'\n  condition: selection\nfalsepositives:\n  - CDN services with long subdomains\n  - Cloud services\nlevel: medium\n```\n\n### Testing Rules\n\n```bash\n# Validate rule syntax\nsigma check rule.yml\n\n# Convert and test\nsigma convert -t splunk rule.yml\n\n# Run against log sample\nsigma convert -t splunk rule.yml | splunk search\n```\n\n### Rule Quality Checklist\n\n- [ ] Unique UUID generated\n- [ ] Descriptive title\n- [ ] MITRE ATT&CK tagged\n- [ ] References included\n- [ ] False positives documented\n- [ ] Appropriate severity level\n- [ ] Tested against real data\n- [ ] Filters for known FPs",
      "tags": ["soc", "sigma", "detection-engineering", "rules"],
      "related_tools": ["sigma", "yara"]
    },
    {
      "id": "sigma_conversion",
      "title": "Converting Sigma Rules to SIEM Queries",
      "content": "## Sigma Rule Conversion\n\nConvert Sigma rules to your SIEM's native query language using sigma-cli and backend plugins.\n\n### Supported Backends\n\n| Backend | SIEM Platform | Plugin |\n|---------|---------------|--------|\n| splunk | Splunk | pySigma-backend-splunk |\n| elasticsearch | Elastic/ELK | pySigma-backend-elasticsearch |\n| microsoft365defender | Microsoft Defender | pySigma-backend-microsoft365defender |\n| sentinelone | SentinelOne | pySigma-backend-sentinelone |\n| qradar | IBM QRadar | pySigma-backend-qradar |\n| carbonblack | Carbon Black | pySigma-backend-carbonblack |\n| crowdstrike | CrowdStrike | pySigma-backend-crowdstrike |\n\n### Basic Conversion\n\n```bash\n# Convert to Splunk\nsigma convert -t splunk rule.yml\n\n# Convert to Elasticsearch\nsigma convert -t elasticsearch rule.yml\n\n# Convert to Microsoft 365 Defender\nsigma convert -t microsoft365defender rule.yml\n```\n\n### Conversion with Pipeline\n\nPipelines transform field names and values for specific environments:\n\n```bash\n# Splunk with Windows pipeline\nsigma convert -t splunk -p sysmon rule.yml\n\n# Elasticsearch with ECS\nsigma convert -t elasticsearch -p ecs_windows rule.yml\n\n# Multiple pipelines\nsigma convert -t splunk -p sysmon -p splunk_windows rule.yml\n```\n\n### Example Conversions\n\n**Original Sigma Rule:**\n```yaml\ntitle: Mimikatz Command Line\nlogsource:\n  category: process_creation\n  product: windows\ndetection:\n  selection:\n    CommandLine|contains:\n      - 'sekurlsa'\n      - 'kerberos::'\n  condition: selection\n```\n\n**Splunk Output:**\n```spl\nCommandLine=\"*sekurlsa*\" OR CommandLine=\"*kerberos::*\"\n```\n\n**Elasticsearch Output:**\n```json\n{\n  \"bool\": {\n    \"should\": [\n      { \"wildcard\": { \"process.command_line\": \"*sekurlsa*\" } },\n      { \"wildcard\": { \"process.command_line\": \"*kerberos::*\" } }\n    ]\n  }\n}\n```\n\n**KQL (Microsoft Sentinel):**\n```kql\nSecurityEvent\n| where CommandLine contains \"sekurlsa\" or CommandLine contains \"kerberos::\"\n```\n\n### Batch Conversion\n\n```bash\n# Convert entire directory\nsigma convert -t splunk -r rules/windows/process_creation/ -o output/\n\n# Convert with specific format\nsigma convert -t splunk -f savedsearches rules/*.yml > splunk_searches.conf\n```\n\n### Custom Pipelines\n\n```yaml\n# custom_pipeline.yml\nname: Custom Environment Pipeline\npriority: 20\ntransformations:\n  - id: field_mapping\n    type: field_name_mapping\n    mapping:\n      Image: process_path\n      CommandLine: command_line\n      User: user_name\n  - id: index_prefix\n    type: add_condition\n    conditions:\n      - index: security_logs\n```\n\n```bash\n# Use custom pipeline\nsigma convert -t splunk -p custom_pipeline.yml rule.yml\n```\n\n### Output Formats\n\n| Format | Use Case | Flag |\n|--------|----------|------|\n| default | Query only | (none) |\n| savedsearches | Splunk saved search | `-f savedsearches` |\n| json | JSON structure | `-f json` |\n| yaml | YAML output | `-f yaml` |\n\n### Field Mapping Files\n\nMap Sigma fields to your environment:\n\n```yaml\n# fieldmapping.yml\nfieldmappings:\n  Image:\n    - process.executable\n    - Image\n  CommandLine:\n    - process.command_line\n    - CommandLine\n  User:\n    - user.name\n    - User\n```\n\n### Handling Conversion Errors\n\n```bash\n# Verbose output for debugging\nsigma convert -t splunk -vvv rule.yml\n\n# Skip unsupported rules\nsigma convert -t splunk --skip-unsupported rules/\n```",
      "tags": ["soc", "sigma", "conversion", "siem"],
      "related_tools": ["sigma"]
    },
    {
      "id": "sigma_deployment",
      "title": "Deploying Sigma Rules in Production",
      "content": "## Sigma Deployment Strategies\n\nMove from rule development to production deployment with proper testing and management.\n\n### Deployment Pipeline\n\n```\n[Write Rule] → [Test] → [Peer Review] → [Stage] → [Production] → [Monitor]\n```\n\n### GitOps for Detection Rules\n\n**Repository Structure:**\n```\ndetection-rules/\n├── rules/\n│   ├── windows/\n│   │   ├── process_creation/\n│   │   ├── file_event/\n│   │   └── registry_event/\n│   ├── linux/\n│   └── network/\n├── pipelines/\n│   ├── splunk.yml\n│   └── elastic.yml\n├── tests/\n│   └── test_data/\n├── .github/\n│   └── workflows/\n│       └── sigma-ci.yml\n└── README.md\n```\n\n### CI/CD Pipeline\n\n```yaml\n# .github/workflows/sigma-ci.yml\nname: Sigma Rule CI\n\non:\n  push:\n    paths: ['rules/**']\n  pull_request:\n    paths: ['rules/**']\n\njobs:\n  validate:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n      \n      - name: Setup Python\n        uses: actions/setup-python@v4\n        with:\n          python-version: '3.10'\n          \n      - name: Install sigma-cli\n        run: pip install sigma-cli\n        \n      - name: Validate Rules\n        run: sigma check rules/\n        \n      - name: Test Conversion\n        run: |\n          sigma convert -t splunk rules/*.yml\n          sigma convert -t elasticsearch rules/*.yml\n\n  deploy:\n    needs: validate\n    if: github.ref == 'refs/heads/main'\n    runs-on: ubuntu-latest\n    steps:\n      - name: Convert for Production\n        run: |\n          sigma convert -t splunk -f savedsearches rules/ > searches.conf\n          \n      - name: Deploy to Splunk\n        run: |\n          # API call to deploy saved searches\n          curl -k -u admin:${{ secrets.SPLUNK_PASS }} \\\n            -X POST https://splunk:8089/servicesNS/admin/search/configs/conf-savedsearches \\\n            -d @searches.conf\n```\n\n### Testing Rules Before Deployment\n\n**Unit Testing with Sample Data:**\n```yaml\n# tests/test_mimikatz.yml\ntitle: Test Mimikatz Detection\nrule: rules/windows/process_creation/mimikatz.yml\ntest_cases:\n  - name: should_detect_sekurlsa\n    data:\n      Image: C:\\\\temp\\\\mimikatz.exe\n      CommandLine: sekurlsa::logonpasswords\n    expected: match\n    \n  - name: should_not_detect_normal_process\n    data:\n      Image: C:\\\\Windows\\\\System32\\\\notepad.exe\n      CommandLine: notepad.exe document.txt\n    expected: no_match\n```\n\n**Run Tests:**\n```bash\npython -m pytest tests/ -v\n```\n\n### Splunk Deployment\n\n```python\n# deploy_to_splunk.py\nimport splunklib.client as client\nimport subprocess\nimport json\n\ndef deploy_sigma_to_splunk(rule_dir, splunk_config):\n    # Convert rules\n    result = subprocess.run(\n        ['sigma', 'convert', '-t', 'splunk', '-f', 'json', rule_dir],\n        capture_output=True, text=True\n    )\n    rules = json.loads(result.stdout)\n    \n    # Connect to Splunk\n    service = client.connect(\n        host=splunk_config['host'],\n        port=splunk_config['port'],\n        username=splunk_config['user'],\n        password=splunk_config['password']\n    )\n    \n    # Create saved searches\n    for rule in rules:\n        service.saved_searches.create(\n            name=rule['title'],\n            search=rule['query'],\n            **{'alert_type': 'number of events', 'alert_threshold': '0'}\n        )\n```\n\n### Elastic Deployment\n\n```python\n# deploy_to_elastic.py\nfrom elasticsearch import Elasticsearch\nimport subprocess\nimport json\n\ndef deploy_sigma_to_elastic(rule_dir, es_config):\n    # Convert rules\n    result = subprocess.run(\n        ['sigma', 'convert', '-t', 'elasticsearch', '-f', 'json', rule_dir],\n        capture_output=True, text=True\n    )\n    rules = json.loads(result.stdout)\n    \n    es = Elasticsearch([es_config['host']])\n    \n    for rule in rules:\n        es.index(\n            index='.siem-signals-default',\n            body={\n                'name': rule['title'],\n                'query': rule['query'],\n                'enabled': True,\n                'severity': rule.get('level', 'medium')\n            }\n        )\n```\n\n### Monitoring Rule Effectiveness\n\n```spl\n# Track detection rule hits\nindex=notable\n| stats count by rule_name\n| sort -count\n\n# False positive rate tracking\nindex=notable status=closed resolution=false_positive\n| stats count by rule_name\n| sort -count\n```\n\n### Rule Lifecycle Management\n\n1. **New** - Just created, experimental\n2. **Testing** - Undergoing validation\n3. **Stable** - Validated, low FP\n4. **Deprecated** - Being phased out\n5. **Retired** - No longer used",
      "tags": ["soc", "sigma", "deployment", "ci-cd"],
      "related_tools": ["sigma"]
    },
    {
      "id": "sigma_advanced",
      "title": "Advanced Sigma Techniques",
      "content": "## Advanced Sigma Rule Patterns\n\nMaster advanced techniques for complex detection scenarios.\n\n### Correlation Rules\n\nSigma supports correlated detections:\n\n```yaml\ntitle: Brute Force Followed by Successful Login\nid: d748a2f6-5e11-4e64-a8e0-c5d8d5a5f6e4\nstatus: experimental\ndescription: Detects successful login after multiple failures\ntype: correlation\nrules:\n  failed_logins:\n    title: Failed Login\n    logsource:\n      category: authentication\n      product: windows\n    detection:\n      selection:\n        EventID: 4625\n      condition: selection\n  successful_login:\n    title: Successful Login\n    logsource:\n      category: authentication\n      product: windows\n    detection:\n      selection:\n        EventID: 4624\n      condition: selection\ncorrelation:\n  type: event_count\n  rules:\n    - failed_logins\n  group-by:\n    - TargetUserName\n    - IpAddress\n  timespan: 5m\n  condition:\n    gte: 5\n  aliases:\n    TargetUserName: user\n    IpAddress: src_ip\n```\n\n### Aggregation Rules\n\n```yaml\ntitle: High Volume Outbound Connections\nid: 8f7e6d5c-4b3a-2f1e-9d8c-7a6b5e4d3c2b\nstatus: experimental\ndescription: Detects high volume of outbound connections from single host\ntype: aggregation\nlogsource:\n  category: network_connection\n  product: windows\ndetection:\n  selection:\n    Initiated: 'true'\n  condition: selection\naggregation:\n  field: DestinationIp\n  time: 5m\n  group:\n    - SourceIp\n  condition:\n    count: '>= 100'\nlevel: medium\n```\n\n### Near Rules (Proximity Detection)\n\n```yaml\ntitle: Reconnaissance Commands in Sequence\nid: 3e5d7c9a-2b4f-1e8d-6c7a-9b8e5d4c3f2a\nstatus: experimental\ndescription: Detects reconnaissance commands executed in sequence\ntype: near\nrules:\n  whoami_cmd:\n    logsource:\n      category: process_creation\n      product: windows\n    detection:\n      selection:\n        CommandLine|contains: 'whoami'\n      condition: selection\n  net_cmd:\n    logsource:\n      category: process_creation\n      product: windows\n    detection:\n      selection:\n        CommandLine|contains:\n          - 'net user'\n          - 'net group'\n      condition: selection\nnear:\n  timespan: 5m\n  rules:\n    - whoami_cmd\n    - net_cmd\n```\n\n### Value Modifiers for Encoding\n\n```yaml\n# Base64 encoded PowerShell commands\ndetection:\n  selection:\n    CommandLine|base64offset|contains:\n      - 'Invoke-Mimikatz'\n      - 'Invoke-Expression'\n```\n\n### Complex Condition Logic\n\n```yaml\ndetection:\n  selection_proc:\n    Image|endswith:\n      - '\\\\cmd.exe'\n      - '\\\\powershell.exe'\n  selection_args_download:\n    CommandLine|contains:\n      - 'DownloadString'\n      - 'DownloadFile'\n      - 'Invoke-WebRequest'\n  selection_args_exec:\n    CommandLine|contains:\n      - 'Invoke-Expression'\n      - 'IEX'\n      - '-enc'\n  filter_admin:\n    User|contains:\n      - 'SYSTEM'\n      - 'Administrator'\n    ParentImage|endswith: '\\\\services.exe'\n  condition: >\n    selection_proc and \n    (selection_args_download or selection_args_exec) and \n    not filter_admin\n```\n\n### Placeholder Rules\n\nDynamic values defined at conversion:\n\n```yaml\ntitle: Connection to Threat Intel IP\nid: 4b8c2d5e-7a9f-3c1d-8e6b-2f4a7c9d5e3b\nlogsource:\n  category: network_connection\ndetection:\n  selection:\n    DestinationIp|expand: '%threat_intel_ips%'\n  condition: selection\n```\n\n**At conversion:**\n```bash\nsigma convert -t splunk rule.yml --config threat_intel_ips=1.2.3.4,5.6.7.8\n```\n\n### STIX/Sigma Integration\n\n```python\n# Convert STIX indicator to Sigma\nfrom stix2 import Indicator\nimport yaml\n\ndef stix_to_sigma(indicator):\n    sigma_rule = {\n        'title': indicator.name,\n        'id': str(indicator.id).split('--')[1],\n        'description': indicator.description,\n        'logsource': {\n            'category': 'network_connection'\n        },\n        'detection': {\n            'selection': {},\n            'condition': 'selection'\n        },\n        'level': 'high'\n    }\n    \n    # Parse STIX pattern\n    if 'ipv4-addr' in indicator.pattern:\n        ip = extract_ip(indicator.pattern)\n        sigma_rule['detection']['selection']['DestinationIp'] = ip\n    \n    return yaml.dump(sigma_rule)\n```\n\n### Performance Optimization\n\n1. **Specific log sources** - Avoid `logsource: *`\n2. **Indexed fields first** - Filter on indexed fields\n3. **Avoid regex when possible** - Use `contains` instead\n4. **Limit time ranges** - Add timeframe constraints\n5. **Use filter clauses** - Exclude known good early",
      "tags": ["soc", "sigma", "advanced", "correlation"],
      "related_tools": ["sigma"]
    }
  ]
}
