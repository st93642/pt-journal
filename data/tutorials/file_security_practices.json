{
  "id": "file_security_practices",
  "title": "File Security Practices",
  "type": "tutorial",
  "steps": [
    {
      "id": "file_encryption_gpg",
      "title": "File Encryption with GPG",
      "content": "OBJECTIVE: Learn to encrypt and decrypt files using GPG (GNU Privacy Guard) for secure file protection.\n\nACADEMIC BACKGROUND:\nGPG is a free implementation of the OpenPGP standard for encrypting and signing data. It provides strong cryptographic protection for files, ensuring confidentiality and integrity through public-key and symmetric encryption.\n\nSTEP-BY-STEP PROCESS:\n\n1. GPG Installation and Setup:\n\nGetting Started with GPG:\n```bash\n# Install GPG (Ubuntu/Debian)\nsudo apt update\nsudo apt install gnupg\n\n# Check installation\ngpg --version\n\n# Generate your keypair\ngpg --gen-key\n# Follow prompts:\n# - Key type: RSA and RSA (default)\n# - Key size: 4096 bits\n# - Expiration: 0 (never)\n# - Name, email, comment\n\n# List your keys\ngpg --list-keys\n\n# Export public key\ngpg --export -a \"Your Name\" > public_key.asc\n\n# Import someone else's public key\ngpg --import public_key.asc\n```\n\n2. Symmetric Encryption:\n\nPassword-Based File Encryption:\n```bash\n# Encrypt a file with symmetric encryption\ngpg --symmetric --cipher-algo AES256 secret.txt\n# Enter passphrase when prompted\n# Creates: secret.txt.gpg\n\n# Decrypt the file\ngpg --decrypt secret.txt.gpg > decrypted.txt\n# Or output to stdout:\ngpg --decrypt secret.txt.gpg\n\n# Encrypt multiple files\ntar -czf archive.tar.gz files/\ngpg --symmetric archive.tar.gz\n\n# Encrypt with specific algorithm\ngpg --symmetric --cipher-algo CAMELLIA256 document.pdf\n\n# Use armor format (ASCII)\ngpg --symmetric --armor secret.txt\n# Creates: secret.txt.asc (text format)\n\n# Decrypt armor format\ngpg --decrypt secret.txt.asc\n```\n\n3. Asymmetric Encryption:\n\nPublic-Key File Encryption:\n```bash\n# Encrypt for a specific recipient\ngpg --encrypt --recipient \"recipient@email.com\" secret.txt\n# Creates: secret.txt.gpg\n\n# Encrypt for multiple recipients\ngpg --encrypt --recipient \"alice@email.com\" --recipient \"bob@email.com\" secret.txt\n\n# Sign and encrypt\ngpg --encrypt --sign --recipient \"recipient@email.com\" secret.txt\n\n# Decrypt (uses your private key)\ngpg --decrypt secret.txt.gpg\n\n# View encryption info\ngpg --list-packets secret.txt.gpg\n\n# Encrypt to self (for backup)\ngpg --encrypt --recipient \"your@email.com\" important.txt\n```\n\n4. Key Management:\n\nManaging GPG Keys:\n```bash\n# List all keys\ngpg --list-keys\n\n# List secret keys\ngpg --list-secret-keys\n\n# Export private key (for backup)\ngpg --export-secret-keys -a \"Your Name\" > private_key.asc\n\n# Import private key\ngpg --import private_key.asc\n\n# Change passphrase\ngpg --edit-key \"Your Name\"\n# At prompt: passwd\n\n# Delete a key\ngpg --delete-key \"Key ID\"\n\ngpg --delete-secret-key \"Key ID\"\n\n# Trust a key\ngpg --edit-key \"Key ID\"\n# At prompt: trust\n# Choose trust level\n\n# Search for keys on keyserver\ngpg --search-keys \"name or email\"\n\n# Refresh keys from keyserver\ngpg --refresh-keys\n```\n\n5. File Signing and Verification:\n\nDigital Signatures:\n```bash\n# Sign a file (creates detached signature)\ngpg --detach-sign document.txt\n# Creates: document.txt.sig\n\n# Verify signature\ngpg --verify document.txt.sig document.txt\n\n# Sign and encrypt in one step\ngpg --encrypt --sign --recipient \"recipient@email.com\" document.txt\n\n# Clear text signature\ngpg --clearsign document.txt\n# Creates signed document with signature embedded\n\n# Verify clear text signature\ngpg --verify document.txt.asc\n\n# Create ASCII armored signature\ngpg --detach-sign --armor document.txt\n# Creates: document.txt.asc\n```\n\n6. Batch Operations:\n\nProcessing Multiple Files:\n```bash\n# Encrypt all .txt files in directory\nfor file in *.txt; do\n    gpg --symmetric \"$file\"\ndone\n\n# Decrypt all .gpg files\nfor file in *.gpg; do\n    gpg --decrypt \"$file\" > \"${file%.gpg}\"\ndone\n\n# Encrypt entire directory\ntar -czf directory.tar.gz /path/to/directory\ngpg --symmetric directory.tar.gz\n\n# Recursive encryption\nfind /path/to/directory -type f -name \"*.txt\" -exec gpg --symmetric {} \\;\n\n# Batch verification\nfor sig in *.sig; do\n    file=\"${sig%.sig}\"\n    gpg --verify \"$sig\" \"$file\" && echo \"$file: GOOD\" || echo \"$file: BAD\"\ndone\n```\n\n7. Advanced GPG Features:\n\nSpecialized Operations:\n```bash\n# Create a key for signing only\ngpg --gen-key --expert\n# Choose options for signing capability\n\n# Use a keyserver\ngpg --keyserver hkps://keys.openpgp.org --send-keys \"Key ID\"\n\ngpg --keyserver hkps://keys.openpgp.org --recv-keys \"Key ID\"\n\n# Encrypt to hidden recipients\ngpg --hidden-recipient \"recipient@email.com\" --encrypt file.txt\n\n# Use custom hash algorithm\ngpg --digest-algo SHA512 --sign file.txt\n\n# Create a revocation certificate\ngpg --gen-revoke \"Your Name\" > revocation.asc\n\n# Compress before encrypting\ngpg --compress-algo BZIP2 --encrypt --recipient \"email\" file.txt\n\n# Use different cipher for symmetric encryption\ngpg --s2k-cipher-algo AES256 --s2k-digest-algo SHA512 --symmetric file.txt\n```\n\nWHAT TO LOOK FOR:\n- **Key Strength**: 4096-bit RSA or higher\n- **Passphrase Quality**: Strong, unique passphrases\n- **Key Trust**: Properly trusted public keys\n- **Algorithm Selection**: Modern ciphers (AES256)\n- **Signature Verification**: Always verify before trusting\n- **Key Backup**: Secure backup of private keys\n- **Regular Updates**: Keep keys current and revoke if needed\n\nSECURITY IMPLICATIONS:\n- **Data Confidentiality**: Encrypted files unreadable without key\n- **Authentication**: Digital signatures prove file origin\n- **Integrity**: Detects file tampering\n- **Non-Repudiation**: Sender cannot deny sending signed file\n- **Key Compromise**: Private key loss = data loss\n- **Trust Management**: Public key verification requirements\n\nCOMMON PITFALLS:\n- **Weak Passphrases**: Easy to crack passwords\n- **Key Loss**: No backup of private keys\n- **Untrusted Keys**: Encrypting to wrong public keys\n- **Old Algorithms**: Using deprecated ciphers\n- **No Verification**: Trusting unsigned files\n- **Public Key Exposure**: Sharing private keys\n\nTOOLS REFERENCE:\n- **gpg**: GNU Privacy Guard main tool\n- **gpg-agent**: Key management daemon\n- **keyserver**: Public key distribution\n- **paperkey**: Backup keys on paper\n- **caff**: Key signing helper\n- **pius**: Mass key signing\n\nFURTHER READING:\n- OpenPGP Standard: RFC 4880 specification\n- GPG Manual: Comprehensive command reference\n- Cryptographic Best Practices: Key management guidelines\n- Public Key Infrastructure: PKI concepts and implementation\n- Digital Signatures: Authentication and integrity\n- Key Escrow: Backup and recovery strategies",
      "tags": [
        "encryption",
        "gpg",
        "cryptography",
        "file-security",
        "public-key"
      ],
      "related_tools": [
        "hunter-io",
        "comparison_directory_fuzzers",
        "crunch",
        "impacket-scripts",
        "foremost"
      ]
    }
  ]
}