{
  "id": "incident_response_methodology",
  "title": "Incident Response Methodology",
  "description": "Complete incident response framework covering identification, containment, eradication, recovery, and lessons learned with practical tooling and documentation templates.",
  "type": "tutorial",
  "steps": [
    {
      "id": "ir_preparation",
      "title": "IR Preparation and Planning",
      "content": "OBJECTIVE: Establish incident response capabilities including team structure, communication plans, and toolkit preparation.\n\nACADEMIC BACKGROUND:\nEffective incident response requires preparation before incidents occur. This includes establishing roles, procedures, communication channels, and maintaining ready-to-deploy forensic toolkits. Organizations with mature IR programs respond faster and minimize damage.\n\nPREPARATION ELEMENTS:\n\n1. IR TEAM STRUCTURE:\n   ```\n   Incident Response Team Roles:\n   \n   Core Team:\n   | Role | Responsibilities |\n   |------|------------------|\n   | IR Lead | Coordinates response, escalation decisions |\n   | Forensic Analyst | Evidence collection, analysis |\n   | Malware Analyst | Reverse engineering, IOC development |\n   | Network Analyst | Traffic analysis, containment |\n   | System Admin | System recovery, containment actions |\n   | Communications | Internal/external communications |\n   \n   Extended Team:\n   | Role | When Involved |\n   |------|---------------|\n   | Legal Counsel | Data breach, law enforcement |\n   | HR | Insider threat, employee involvement |\n   | PR/Communications | Public disclosure required |\n   | Executive Sponsor | Major incidents, resource allocation |\n   | External IR Firm | Overflow, specialized expertise |\n   \n   Contact List Template:\n   | Name | Role | Phone | Email | Alternate |\n   |------|------|-------|-------|----------|\n   | J. Smith | IR Lead | 555-0100 | jsmith@... | M. Jones |\n   | ... | ... | ... | ... | ... |\n   ```\n\n2. COMMUNICATION PLAN:\n   ```\n   Communication Channels:\n   \n   Internal Communications:\n   - Secure chat (Signal, Slack - private channel)\n   - Out-of-band phone tree\n   - War room (physical/virtual)\n   - Ticketing system (restricted access)\n   \n   External Communications:\n   - Customer notification templates\n   - Regulatory notification procedures\n   - Law enforcement contacts\n   - External IR firm hotline\n   \n   Communication Rules:\n   1. Use secure channels only\n   2. Don't discuss on compromised systems\n   3. Document all communications\n   4. Single point for external communication\n   5. Regular status updates (hourly during active)\n   \n   Escalation Matrix:\n   | Severity | Notification | Timeframe |\n   |----------|--------------|----------|\n   | Critical | Executive, Legal | Immediate |\n   | High | IR Lead, Security Manager | 15 minutes |\n   | Medium | IR Team | 1 hour |\n   | Low | Assigned analyst | 4 hours |\n   ```\n\n3. IR TOOLKIT:\n   ```bash\n   # Jump Bag Contents (Physical):\n   # - Laptop with forensic tools\n   # - Write blockers (USB, SATA)\n   # - Blank drives (evidence storage)\n   # - Network cables, adapters\n   # - USB drives with bootable forensic OS\n   # - Camera (evidence documentation)\n   # - Labels, bags, chain of custody forms\n   # - Notepad, permanent markers\n   \n   # Forensic USB/ISO Contents:\n   # - CAINE Linux (forensic distribution)\n   # - Kali Linux (assessment)\n   # - Windows PE with tools\n   \n   # Tool Categories:\n   \n   # Memory Acquisition:\n   # - WinPmem, DumpIt, Magnet RAM Capture\n   # - LiME (Linux)\n   \n   # Disk Imaging:\n   # - FTK Imager\n   # - dc3dd, ewfacquire\n   \n   # Live Response:\n   # - KAPE (Kroll Artifact Parser)\n   # - CyLR\n   # - Velociraptor\n   \n   # Analysis:\n   # - Volatility\n   # - Autopsy/Sleuth Kit\n   # - RegRipper\n   # - Event Log Explorer\n   # - Wireshark, NetworkMiner\n   \n   # Malware Analysis:\n   # - YARA\n   # - PEStudio, PEView\n   # - Sandbox (Cuckoo, Any.Run)\n   \n   # Documentation:\n   # - Chain of custody forms\n   # - Incident report templates\n   # - Timeline templates\n   ```\n\n4. PLAYBOOK DEVELOPMENT:\n   ```\n   Playbook Structure:\n   \n   1. Scenario Description\n      - What: Type of incident\n      - Indicators: How detected\n      - Severity: Default classification\n   \n   2. Initial Response\n      - Who to notify\n      - Initial containment steps\n      - Evidence to collect immediately\n   \n   3. Investigation Steps\n      - Specific artifacts to analyze\n      - Tools to use\n      - Questions to answer\n   \n   4. Containment Options\n      - Quick containment\n      - Full containment\n      - Stakeholder approvals needed\n   \n   5. Eradication Checklist\n      - What to remove/clean\n      - Verification steps\n   \n   6. Recovery Steps\n      - Restore procedures\n      - Monitoring requirements\n   \n   7. Documentation Requirements\n      - Required artifacts\n      - Report format\n   \n   Common Playbooks:\n   - Ransomware\n   - Phishing compromise\n   - Malware infection\n   - Data breach\n   - Insider threat\n   - Web application attack\n   - DDoS\n   - Business email compromise\n   ```\n\n5. ENVIRONMENT PREPARATION:\n   ```bash\n   # Network segmentation\n   # - Ability to isolate systems quickly\n   # - Pre-defined VLAN for quarantine\n   \n   # Logging configuration\n   # - Centralized logging (SIEM)\n   # - Adequate retention (90+ days)\n   # - Critical systems: verbose logging\n   \n   # Windows logging checklist:\n   # - Enable PowerShell logging\n   # - Enable process creation (4688)\n   # - Enable object access auditing\n   # - Sysmon installed and configured\n   \n   # Network logging:\n   # - Firewall logs\n   # - DNS query logging\n   # - NetFlow/IPFIX\n   # - Full packet capture (security-critical segments)\n   \n   # Backup verification\n   # - Regular backup testing\n   # - Offline/immutable backups\n   # - Recovery time documented\n   \n   # Asset inventory\n   # - Current system inventory\n   # - Network diagrams\n   # - Critical system identification\n   # - Data classification\n   ```\n\n6. TABLETOP EXERCISES:\n   ```\n   Exercise Planning:\n   \n   Frequency: Quarterly minimum\n   Duration: 2-4 hours\n   Participants: Full IR team + stakeholders\n   \n   Exercise Scenario Template:\n   \n   Background:\n   \"On Monday morning, the security team receives\n   an alert that antivirus has quarantined a file\n   on WORKSTATION-01. Initial investigation shows\n   the file was downloaded via email attachment.\"\n   \n   Injects (timed reveals):\n   - T+15min: AV shows same file on 3 more workstations\n   - T+30min: Network shows C2 traffic to external IP\n   - T+45min: Executive laptop shows signs of infection\n   - T+60min: Ransomware note appears on file server\n   \n   Discussion Questions:\n   1. Who do you notify first?\n   2. What containment actions do you take?\n   3. What evidence do you collect?\n   4. When do you involve law enforcement?\n   5. How do you communicate with employees?\n   \n   After Action Review:\n   - What worked well?\n   - What needs improvement?\n   - Action items and owners\n   ```\n\nPREPAREDNESS CHECKLIST:\n```\nIR Preparation Assessment:\n\n[ ] Team and Contacts\n    [ ] IR team identified and trained\n    [ ] Contact list current and tested\n    [ ] Escalation matrix defined\n    [ ] Backup personnel identified\n\n[ ] Communications\n    [ ] Secure communication channels\n    [ ] Notification templates ready\n    [ ] External contacts (legal, PR, IR firm)\n    \n[ ] Tools and Resources\n    [ ] Forensic toolkit prepared\n    [ ] Tools tested on current OS versions\n    [ ] Evidence storage available\n    [ ] Documentation templates ready\n\n[ ] Procedures\n    [ ] Playbooks for common scenarios\n    [ ] Chain of custody procedures\n    [ ] Evidence handling guidelines\n    \n[ ] Infrastructure\n    [ ] Logging adequate and centralized\n    [ ] Network isolation capability\n    [ ] Backup integrity verified\n    \n[ ] Training and Testing\n    [ ] Team trained on tools\n    [ ] Tabletop exercise conducted (date: ___)\n    [ ] Lessons learned incorporated\n```\n\nDETECTION INDICATORS:\n- IR team knows their roles\n- Communication channels tested\n- Toolkit ready and current\n- Playbooks cover likely scenarios\n\nCOMMON PITFALLS:\n- Outdated contact information\n- Tools not tested on current systems\n- No practice/exercises\n- Missing stakeholder buy-in\n\nFURTHER READING:\n- NIST SP 800-61 (IR Handling Guide)\n- SANS IR Planning resources\n- \"Incident Response & Computer Forensics\" by Luttgens et al.",
      "tags": ["forensics", "incident-response", "preparation", "planning", "dfir"],
      "related_tools": []
    },
    {
      "id": "identification_detection",
      "title": "Identification and Detection",
      "content": "OBJECTIVE: Identify security incidents through various detection methods and perform initial triage to classify severity.\n\nACADEMIC BACKGROUND:\nIncident identification begins with detection - recognizing that a security event has occurred. Detection sources include automated alerts, user reports, and proactive threat hunting. Effective identification enables rapid response and appropriate resource allocation.\n\nDETECTION SOURCES:\n\n1. AUTOMATED DETECTION:\n   ```\n   Alert Sources:\n   \n   Endpoint Detection:\n   | Source | What It Detects |\n   |--------|----------------|\n   | Antivirus/EDR | Malware, suspicious behavior |\n   | Host IDS | File changes, policy violations |\n   | Application logs | Authentication failures, errors |\n   \n   Network Detection:\n   | Source | What It Detects |\n   |--------|----------------|\n   | IDS/IPS | Attack signatures, anomalies |\n   | Firewall | Blocked connections, policy violations |\n   | DNS logs | Malicious domains, tunneling |\n   | NetFlow | Traffic anomalies, exfiltration |\n   \n   Security Tools:\n   | Source | What It Detects |\n   |--------|----------------|\n   | SIEM | Correlated events, threshold alerts |\n   | DLP | Data exfiltration attempts |\n   | Email security | Phishing, malicious attachments |\n   | WAF | Web application attacks |\n   ```\n\n2. INITIAL TRIAGE:\n   ```bash\n   # Triage Questions:\n   # 1. What was detected?\n   # 2. When did it occur?\n   # 3. What systems are affected?\n   # 4. Is it ongoing?\n   # 5. What is the potential impact?\n   \n   # Quick System Triage (Windows)\n   # Network connections\n   netstat -ano | findstr ESTABLISHED\n   \n   # Running processes\n   tasklist /v\n   \n   # Scheduled tasks\n   schtasks /query /fo LIST /v\n   \n   # Services\n   wmic service get name,startmode,state,pathname\n   \n   # Startup items\n   wmic startup list full\n   \n   # Recent file changes\n   dir C:\\Users /s /b /a-d | findstr /i \".exe .dll .ps1\"\n   \n   # Quick System Triage (Linux)\n   # Network connections\n   netstat -tulpn\n   ss -tulpn\n   \n   # Running processes\n   ps auxf\n   \n   # Cron jobs\n   crontab -l\n   cat /etc/crontab\n   \n   # Recent modifications\n   find / -mtime -1 -type f 2>/dev/null\n   \n   # Login history\n   last -50\n   ```\n\n3. SEVERITY CLASSIFICATION:\n   ```\n   Incident Severity Matrix:\n   \n   Critical (P1):\n   - Active data exfiltration in progress\n   - Ransomware actively encrypting\n   - Critical system compromised\n   - Business operations halted\n   Response: All hands, immediate action\n   \n   High (P2):\n   - Confirmed compromise, contained\n   - Malware with C2 capability\n   - Privileged account compromised\n   - Multiple systems affected\n   Response: IR team engaged, rapid response\n   \n   Medium (P3):\n   - Suspicious activity requiring investigation\n   - Single system compromised\n   - Phishing click, no confirmed compromise\n   - Policy violation detected\n   Response: Assigned analyst, same-day response\n   \n   Low (P4):\n   - Isolated suspicious event\n   - False positive likely\n   - Minor policy violation\n   Response: Queue for investigation, 24-48 hours\n   \n   Factors Affecting Severity:\n   - System criticality\n   - Data sensitivity\n   - Scope (systems affected)\n   - Active vs. historical\n   - Attack sophistication\n   - Business impact\n   ```\n\n4. THREAT HUNTING:\n   ```bash\n   # Proactive Detection Techniques\n   \n   # Hypothesis-based hunting\n   # \"Attackers may use PowerShell for persistence\"\n   \n   # Windows Event Log hunting\n   # PowerShell execution (Event ID 4103, 4104)\n   wevtutil qe \"Microsoft-Windows-PowerShell/Operational\" \\\n            /q:\"*[System[(EventID=4104)]]\" /f:text | \\\n            grep -i \"encodedcommand\\|downloadstring\\|invoke-expression\"\n   \n   # Process creation hunting (requires advanced auditing)\n   # Event ID 4688\n   wevtutil qe Security /q:\"*[System[(EventID=4688)]]\" /f:text | \\\n            grep -i \"cmd.exe\\|powershell.exe\\|wscript.exe\"\n   \n   # Network anomaly hunting\n   # Unusual outbound connections\n   netstat -ano | findstr /v \"127.0.0.1\" | findstr ESTABLISHED\n   \n   # SIEM hunting queries\n   # Failed logins followed by success\n   # Unusual login times\n   # Large data transfers\n   # DNS queries to new domains\n   \n   # EDR hunting\n   # Process injection\n   # DLL side-loading\n   # Living-off-the-land binaries\n   ```\n\n5. INDICATORS OF COMPROMISE:\n   ```bash\n   # IOC Categories:\n   \n   Network IOCs:\n   - IP addresses (C2 servers)\n   - Domain names (malicious)\n   - URLs (payload delivery)\n   - JA3/JA3S hashes (TLS fingerprints)\n   - User agents (malware signatures)\n   \n   Host IOCs:\n   - File hashes (MD5, SHA256)\n   - File paths (typical malware locations)\n   - Registry keys (persistence)\n   - Mutex names (malware identifiers)\n   - Process names (masquerading)\n   \n   Behavioral IOCs:\n   - Encoded PowerShell execution\n   - Unusual parent-child process relationships\n   - Service installation\n   - Scheduled task creation\n   - Large outbound transfers\n   \n   # IOC Searching\n   # Search for IP\n   grep -r \"185.220.101.1\" /var/log/\n   \n   # Search for domain\n   grep -r \"malicious.com\" /var/log/\n   \n   # Search for hash (Windows)\n   Get-FileHash C:\\path\\file.exe -Algorithm SHA256\n   \n   # YARA rules\n   yara malware.yar /path/to/scan/\n   ```\n\n6. INCIDENT CLASSIFICATION:\n   ```\n   Incident Categories:\n   \n   Malware:\n   - Virus, worm, trojan\n   - Ransomware\n   - Cryptominer\n   - RAT/Backdoor\n   \n   Unauthorized Access:\n   - External intrusion\n   - Privilege escalation\n   - Account compromise\n   - Insider access abuse\n   \n   Data Breach:\n   - Data exfiltration\n   - Unauthorized disclosure\n   - Data destruction\n   \n   Denial of Service:\n   - Network DoS/DDoS\n   - Application DoS\n   - Resource exhaustion\n   \n   Web Application:\n   - SQL injection\n   - Cross-site scripting\n   - File inclusion\n   - Authentication bypass\n   \n   Social Engineering:\n   - Phishing\n   - Business email compromise\n   - Vishing/smishing\n   ```\n\n7. DOCUMENTATION:\n   ```\n   Initial Incident Report:\n   \n   Incident ID: INC-2024-0315-001\n   Detection Time: 2024-03-15 09:45:00 UTC\n   Detected By: EDR Alert\n   \n   Summary:\n   EDR platform generated alert for suspicious PowerShell\n   execution on WORKSTATION-01. Process spawned by\n   Microsoft Word, executing encoded command.\n   \n   Affected Systems:\n   - WORKSTATION-01 (192.168.1.100)\n   - User: jsmith\n   \n   Initial Classification:\n   - Category: Malware\n   - Severity: High (P2)\n   - Potential impact: Account compromise, data access\n   \n   Initial Actions Taken:\n   - 09:50 - Isolated system from network\n   - 09:55 - Initiated memory acquisition\n   - 10:00 - Notified IR Lead\n   \n   Initial IOCs:\n   - Parent: WINWORD.EXE\n   - Process: powershell.exe -enc [base64]\n   - Network: Connection to 185.220.101.1:443\n   \n   Next Steps:\n   - Complete memory acquisition\n   - Analyze decoded PowerShell\n   - Search for IOCs across environment\n   \n   Analyst: M. Johnson\n   Status: Under Investigation\n   ```\n\nIDENTIFICATION CHECKLIST:\n```\nIncident Identification:\n\n[ ] Detection\n    [ ] Alert source identified\n    [ ] Alert validated (not false positive)\n    [ ] Detection time recorded\n    \n[ ] Initial Triage\n    [ ] Affected systems identified\n    [ ] Scope assessed (single vs. multiple)\n    [ ] Activity status (active vs. historical)\n    \n[ ] Classification\n    [ ] Incident category assigned\n    [ ] Severity determined\n    [ ] Escalation decision made\n    \n[ ] Initial IOCs\n    [ ] Network indicators captured\n    [ ] Host indicators captured\n    [ ] IOCs shared with team\n    \n[ ] Documentation\n    [ ] Incident ticket created\n    [ ] Initial report completed\n    [ ] Timeline started\n```\n\nDETECTION INDICATORS:\n- Alert validated and understood\n- Affected systems identified\n- Severity appropriately classified\n- Initial IOCs extracted\n\nCOMMON PITFALLS:\n- Dismissing alerts as false positives\n- Under-classifying severity\n- Not documenting initial findings\n- Rushing to containment without understanding\n\nFURTHER READING:\n- MITRE ATT&CK Framework\n- SANS Threat Hunting resources\n- \"Intelligence-Driven Incident Response\" by Cloppert",
      "tags": ["forensics", "incident-response", "detection", "triage", "dfir"],
      "related_tools": ["yara"]
    },
    {
      "id": "containment_strategies",
      "title": "Containment Strategies",
      "content": "OBJECTIVE: Implement effective containment measures to limit incident scope while preserving evidence and enabling investigation.\n\nACADEMIC BACKGROUND:\nContainment aims to prevent further damage while enabling investigation. It must balance speed with evidence preservation and business continuity. Premature or incorrect containment can tip off attackers, destroy evidence, or unnecessarily impact operations.\n\nCONTAINMENT PRINCIPLES:\n\n1. CONTAINMENT DECISION FRAMEWORK:\n   ```\n   Containment Considerations:\n   \n   When to Contain Immediately:\n   - Active data exfiltration\n   - Ransomware spreading\n   - Attacker actively on system\n   - Critical system at risk\n   \n   When to Delay Containment:\n   - Need to understand scope first\n   - Evidence collection required\n   - Attacker may notice and escalate\n   - Business-critical system (need approval)\n   \n   Containment Impact Assessment:\n   | Action | Impact | Reversibility |\n   |--------|--------|---------------|\n   | Network isolation | High | Easy |\n   | Account disable | Medium | Easy |\n   | System shutdown | High | Medium |\n   | Firewall block | Low | Easy |\n   | Malware quarantine | Low | Easy |\n   \n   Decision Matrix:\n   | Scenario | Recommended Action |\n   |----------|-------------------|\n   | Ransomware active | Immediate isolation |\n   | C2 beacon detected | Block C2, monitor |\n   | Account compromise | Disable account |\n   | Web shell found | Block external, investigate |\n   | Data exfil detected | Network isolation |\n   ```\n\n2. NETWORK CONTAINMENT:\n   ```bash\n   # Network Isolation Methods:\n   \n   # VLAN isolation (preferred)\n   # Move system to quarantine VLAN\n   # Maintains power, allows remote analysis\n   \n   # Firewall blocking\n   # Block specific IPs/ports\n   # Windows Firewall\n   netsh advfirewall firewall add rule name=\"Block C2\" \\\n         dir=out action=block remoteip=185.220.101.1\n   \n   # Linux iptables\n   iptables -A OUTPUT -d 185.220.101.1 -j DROP\n   \n   # Physical disconnection\n   # Last resort - prevents remote analysis\n   # Only for active, severe threats\n   \n   # DNS sinkhole\n   # Redirect malicious domains\n   # Allows monitoring of infected systems\n   \n   # Network segmentation\n   # Isolate affected segment\n   # Prevent lateral movement\n   \n   # EDR network isolation\n   # Many EDR tools support remote isolation\n   # Maintains management connectivity\n   ```\n\n3. HOST CONTAINMENT:\n   ```bash\n   # Process Termination\n   # Windows\n   taskkill /PID 1234 /F\n   \n   # Linux\n   kill -9 1234\n   \n   # Service Disabling\n   # Windows\n   sc stop \"Malicious Service\"\n   sc config \"Malicious Service\" start=disabled\n   \n   # Linux\n   systemctl stop malicious.service\n   systemctl disable malicious.service\n   \n   # Account Disabling\n   # Windows AD\n   Disable-ADAccount -Identity \"compromised_user\"\n   Set-ADAccountPassword -Identity \"compromised_user\" -Reset\n   \n   # Local Windows\n   net user compromised_user /active:no\n   \n   # Linux\n   usermod -L compromised_user\n   passwd -l compromised_user\n   \n   # Persistence Removal (temporary)\n   # Remove scheduled tasks\n   schtasks /delete /tn \"MaliciousTask\" /f\n   \n   # Remove startup entries\n   reg delete \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\" /v \"MalwareName\" /f\n   \n   # Note: Document before removing!\n   ```\n\n4. EVIDENCE PRESERVATION:\n   ```bash\n   # Collect BEFORE Containment:\n   \n   # 1. Memory (most volatile)\n   winpmem_mini_x64.exe memory.raw\n   # or\n   sudo ./lime -f /forensics/memory.lime format=lime\n   \n   # 2. Network connections\n   netstat -ano > netstat_output.txt\n   \n   # 3. Running processes\n   tasklist /v > processes.txt\n   wmic process list full > wmic_processes.txt\n   \n   # 4. Active sessions\n   query user\n   query session\n   \n   # 5. Network shares\n   net use > net_use.txt\n   \n   # Collect During Containment:\n   \n   # 1. Full disk image if possible\n   # 2. Event logs\n   # 3. Registry hives\n   # 4. Browser data\n   # 5. Application logs\n   \n   # Quick Collection Script\n   mkdir C:\\IR_Collection\n   netstat -ano > C:\\IR_Collection\\netstat.txt\n   tasklist /v > C:\\IR_Collection\\processes.txt\n   ipconfig /all > C:\\IR_Collection\\network.txt\n   systeminfo > C:\\IR_Collection\\systeminfo.txt\n   copy C:\\Windows\\System32\\winevt\\Logs\\*.evtx C:\\IR_Collection\\logs\\\n   ```\n\n5. COMMUNICATION DURING CONTAINMENT:\n   ```\n   Containment Communication Plan:\n   \n   Internal Notifications:\n   - IR Team: Immediate (secure channel)\n   - IT Operations: Before network changes\n   - Management: Major containment actions\n   - Affected users: System unavailability\n   \n   Communication Template:\n   \n   TO: IT Operations Team\n   SUBJECT: URGENT - Incident Containment Action Required\n   \n   The Security team is responding to a security incident.\n   \n   Required Action:\n   - Isolate WORKSTATION-01 (192.168.1.100) to quarantine VLAN\n   - Time needed: Immediately\n   - Authorized by: [IR Lead Name]\n   \n   Do NOT:\n   - Power off the system\n   - Run antivirus scans\n   - Alert the user directly\n   \n   Contact: [IR Lead] at [phone] for questions\n   \n   ---\n   \n   User Notification (after containment):\n   \n   TO: [User]\n   SUBJECT: IT Maintenance - Temporary System Offline\n   \n   Your workstation is currently offline for IT maintenance.\n   A temporary workstation has been provided for business continuity.\n   \n   We apologize for any inconvenience.\n   Questions: IT Help Desk\n   ```\n\n6. CONTAINMENT MONITORING:\n   ```bash\n   # Verify Containment Effectiveness:\n   \n   # Network isolation verification\n   # From isolated system:\n   ping 8.8.8.8  # Should fail\n   nslookup google.com  # Should fail\n   \n   # From monitoring system:\n   # Check for any traffic from isolated system\n   tcpdump -i eth0 host 192.168.1.100\n   \n   # Account disable verification\n   # Attempt login with disabled account\n   # Check authentication logs\n   \n   # Process termination verification\n   tasklist | findstr \"malware\"\n   \n   # Monitor for Reinfection:\n   # - New processes spawning\n   # - Network connections resuming\n   # - Scheduled tasks recreating\n   # - Services restarting\n   \n   # EDR monitoring\n   # Watch for alerts on contained systems\n   # Alert on any execution attempts\n   ```\n\n7. CONTAINMENT DOCUMENTATION:\n   ```\n   Containment Action Log:\n   \n   Incident: INC-2024-0315-001\n   Date: 2024-03-15\n   \n   Action Timeline:\n   | Time | Action | By | Result |\n   |------|--------|------|--------|\n   | 09:55 | Memory acquisition started | M. Johnson | Complete |\n   | 10:00 | Network isolation requested | M. Johnson | Approved |\n   | 10:05 | System moved to quarantine VLAN | IT Ops | Verified |\n   | 10:10 | User account disabled | M. Johnson | Complete |\n   | 10:15 | C2 IP blocked at firewall | Network Team | Verified |\n   | 10:20 | Temp workstation provided to user | IT Ops | Complete |\n   \n   Systems Contained:\n   - WORKSTATION-01 (192.168.1.100) - Network isolated\n   - User: jsmith - Account disabled\n   \n   IOCs Blocked:\n   - 185.220.101.1 - Firewall rule #12345\n   - malicious.com - DNS sinkhole\n   \n   Evidence Collected Before Containment:\n   - memory.raw (SHA256: abc123...)\n   - netstat_output.txt\n   - processes.txt\n   \n   Business Impact:\n   - 1 user affected\n   - Temporary workstation provided\n   - No critical system downtime\n   ```\n\nCONTAINMENT CHECKLIST:\n```\nContainment Execution:\n\n[ ] Pre-Containment\n    [ ] Memory acquired\n    [ ] Volatile data collected\n    [ ] Stakeholder approval (if required)\n    [ ] Communication sent to IT Ops\n    \n[ ] Network Containment\n    [ ] Isolation method selected\n    [ ] Isolation implemented\n    [ ] Isolation verified\n    [ ] C2/IOCs blocked\n    \n[ ] Host Containment\n    [ ] Malicious processes identified\n    [ ] Persistence mechanisms documented\n    [ ] Account(s) disabled if needed\n    \n[ ] Verification\n    [ ] Containment effectiveness verified\n    [ ] No further spread observed\n    [ ] Monitoring in place\n    \n[ ] Documentation\n    [ ] All actions logged with timestamps\n    [ ] Evidence chain of custody maintained\n    [ ] Business impact documented\n```\n\nDETECTION INDICATORS:\n- Threat contained successfully\n- Evidence preserved\n- Spread prevented\n- Business impact minimized\n\nCOMMON PITFALLS:\n- Containing before evidence collection\n- Over-containment (unnecessary disruption)\n- Under-containment (threat persists)\n- Not verifying containment\n\nFURTHER READING:\n- NIST SP 800-61 Section 3.3\n- SANS IR Containment procedures\n- Incident response case studies",
      "tags": ["forensics", "incident-response", "containment", "isolation", "dfir"],
      "related_tools": ["bulk_extractor"]
    },
    {
      "id": "eradication_recovery",
      "title": "Eradication and Recovery",
      "content": "OBJECTIVE: Remove threat actors, malware, and persistence mechanisms, then safely restore systems to operational status.\n\nACADEMIC BACKGROUND:\nEradication removes all attacker presence from the environment. Recovery restores systems to normal operations. Both must be thorough - incomplete eradication leads to reinfection, and rushed recovery can reintroduce threats. Verification is essential at each step.\n\nERADICATION PROCESS:\n\n1. ERADICATION PLANNING:\n   ```\n   Eradication Requirements:\n   \n   Before Eradication:\n   - Complete investigation (understand full scope)\n   - All affected systems identified\n   - All persistence mechanisms documented\n   - All IOCs extracted\n   - Clean backups identified\n   - Recovery plan ready\n   \n   Eradication Decision:\n   | System State | Recommended Action |\n   |--------------|-------------------|\n   | Rootkit/bootkit | Reimage from gold image |\n   | Ransomware | Restore from backup |\n   | Known malware | Clean or reimage |\n   | Uncertain | Reimage (safest) |\n   | Critical server | Clean if possible, verify thoroughly |\n   \n   Eradication vs. Rebuild:\n   \n   Clean (remove malware):\n   + Faster recovery\n   + Preserves data and config\n   - May miss hidden persistence\n   - Risk of reinfection\n   \n   Rebuild (reimage):\n   + Guaranteed clean\n   + Fresh start\n   - Longer recovery\n   - Configuration rebuild needed\n   ```\n\n2. MALWARE REMOVAL:\n   ```bash\n   # If choosing to clean rather than reimage:\n   \n   # 1. Boot to Safe Mode or offline\n   # Prevents malware from running during cleanup\n   \n   # 2. Remove persistence\n   # Scheduled tasks\n   schtasks /query /fo LIST /v > tasks_before.txt\n   schtasks /delete /tn \"MaliciousTask\" /f\n   \n   # Services\n   sc query > services_before.txt\n   sc stop \"MaliciousService\"\n   sc delete \"MaliciousService\"\n   \n   # Registry Run keys\n   reg query HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\n   reg query HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\n   reg delete HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run /v MalwareName /f\n   \n   # Startup folder\n   dir \"C:\\Users\\*\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\"\n   del \"C:\\Users\\*\\..\\Startup\\malware.lnk\"\n   \n   # WMI subscriptions\n   Get-WmiObject -Class __EventConsumer -Namespace root\\subscription\n   \n   # 3. Remove malware files\n   del /f C:\\path\\to\\malware.exe\n   del /f C:\\path\\to\\webshell.php\n   \n   # 4. Remove malicious accounts\n   net user attacker_account /delete\n   \n   # 5. Reset compromised credentials\n   net user compromised_user NewP@ssw0rd!\n   ```\n\n3. SYSTEM REBUILD:\n   ```bash\n   # Reimaging Process:\n   \n   # 1. Prepare clean base image\n   # Gold image with latest patches\n   # No network connectivity during build\n   \n   # 2. Deploy image\n   # PXE boot to imaging server\n   # Or bootable USB\n   \n   # 3. Apply configurations\n   # Group Policy update\n   gpupdate /force\n   \n   # Install required software\n   # From trusted sources only\n   \n   # 4. Restore user data\n   # From clean backup\n   # Scan before restoring\n   \n   # 5. Reconnect to network\n   # Only after verification\n   \n   # Server Rebuild:\n   # - Document current configuration\n   # - Export certificates, keys (encrypted)\n   # - Install from scratch\n   # - Apply hardened configuration\n   # - Restore data from verified backup\n   # - Test functionality\n   ```\n\n4. CREDENTIAL RESET:\n   ```bash\n   # Credential Reset Scope:\n   \n   # Minimum (single user compromise):\n   # - Reset user password\n   # - Revoke sessions\n   # - Reset MFA tokens\n   \n   # Broader (admin compromise):\n   # - Reset affected admin accounts\n   # - Reset service accounts\n   # - Rotate API keys/secrets\n   # - Reset KRBTGT (twice, 10+ hours apart)\n   \n   # Domain-wide (domain admin compromise):\n   # - Reset all admin accounts\n   # - Reset KRBTGT (twice)\n   # - Reset all service accounts\n   # - Consider AD rebuild\n   \n   # Windows AD Password Reset\n   Set-ADAccountPassword -Identity user -Reset -NewPassword (ConvertTo-SecureString \"NewP@ss\" -AsPlainText -Force)\n   \n   # Force password change at next logon\n   Set-ADUser -Identity user -ChangePasswordAtLogon $true\n   \n   # KRBTGT Reset (careful!)\n   # First reset\n   Reset-ADServiceAccountPassword -Identity krbtgt\n   # Wait 10+ hours (TGT lifetime)\n   # Second reset\n   Reset-ADServiceAccountPassword -Identity krbtgt\n   ```\n\n5. RECOVERY STEPS:\n   ```bash\n   # Recovery Phases:\n   \n   # Phase 1: Restore Critical Systems\n   # - Domain controllers\n   # - Core infrastructure (DNS, DHCP)\n   # - Security tools (EDR, SIEM)\n   \n   # Phase 2: Restore Business Systems\n   # - Production servers\n   # - Business applications\n   # - Database servers\n   \n   # Phase 3: Restore End User Systems\n   # - Workstations\n   # - Laptops\n   # - Mobile devices\n   \n   # Recovery Verification:\n   # Before each system returns to production:\n   \n   # 1. Scan for IOCs\n   yara /rules/incident_iocs.yar /restored/system/ -r\n   \n   # 2. Verify no persistence\n   autoruns -a * > autoruns_check.txt\n   \n   # 3. Check for suspicious processes\n   tasklist /v > processes_after.txt\n   \n   # 4. Verify network connections\n   netstat -ano > netstat_after.txt\n   \n   # 5. Confirm security tools running\n   sc query \"EDR Service\"\n   ```\n\n6. POST-RECOVERY MONITORING:\n   ```bash\n   # Enhanced Monitoring Period:\n   # - Minimum 30 days increased monitoring\n   # - Lower alert thresholds\n   # - Focused IOC monitoring\n   \n   # IOC Monitoring Rules:\n   # - Alert on any connection to known C2 IPs\n   # - Alert on any access to IOC domains\n   # - Alert on execution of IOC file hashes\n   # - Alert on use of compromised accounts\n   \n   # SIEM Rules:\n   # - Authentication from previously compromised accounts\n   # - Process execution matching incident patterns\n   # - Network connections to IOC destinations\n   # - Similar attack patterns (TTPs)\n   \n   # Hunting Queries:\n   # - Search for incident IOCs daily\n   # - Review authentication anomalies\n   # - Check for new persistence mechanisms\n   # - Monitor rebuilt systems closely\n   ```\n\n7. RECOVERY DOCUMENTATION:\n   ```\n   Eradication and Recovery Report:\n   \n   Incident: INC-2024-0315-001\n   \n   Eradication Summary:\n   \n   Systems Rebuilt:\n   | System | Action | Date | Verified By |\n   |--------|--------|------|-------------|\n   | WORKSTATION-01 | Reimaged | 2024-03-16 | M. Johnson |\n   | FILESERVER-01 | Cleaned | 2024-03-16 | J. Smith |\n   \n   Malware Removed:\n   | File | Hash | Location | Action |\n   |------|------|----------|--------|\n   | payload.exe | abc123... | C:\\Users\\Public\\ | Deleted |\n   | shell.php | def456... | C:\\inetpub\\ | Deleted |\n   \n   Persistence Removed:\n   | Type | Name | Action |\n   |------|------|--------|\n   | Scheduled Task | UpdateTask | Deleted |\n   | Service | WinUpdate32 | Deleted |\n   | Registry Run | MicrosoftEdgeUpdate | Deleted |\n   \n   Credentials Reset:\n   | Account | Type | Action | Date |\n   |---------|------|--------|------|\n   | jsmith | User | Password reset | 2024-03-16 |\n   | svc_backup | Service | Password rotated | 2024-03-16 |\n   | admin_jsmith | Admin | Disabled, replaced | 2024-03-16 |\n   \n   Recovery Timeline:\n   - 2024-03-16 08:00: Eradication started\n   - 2024-03-16 12:00: WORKSTATION-01 rebuilt\n   - 2024-03-16 14:00: FILESERVER-01 cleaned and verified\n   - 2024-03-16 16:00: Systems returned to production\n   - 2024-03-16 17:00: Enhanced monitoring enabled\n   \n   Verification:\n   - All systems scanned for IOCs: Clean\n   - Persistence mechanisms verified removed: Yes\n   - Security tools operational: Confirmed\n   - Enhanced monitoring active: Confirmed\n   \n   Monitoring Period: 30 days (until 2024-04-16)\n   ```\n\nERADICATION/RECOVERY CHECKLIST:\n```\nEradication and Recovery:\n\n[ ] Pre-Eradication\n    [ ] Full scope understood\n    [ ] All IOCs documented\n    [ ] Clean backups identified\n    [ ] Recovery plan approved\n    \n[ ] Eradication\n    [ ] Persistence mechanisms removed\n    [ ] Malware files deleted\n    [ ] Malicious accounts removed\n    [ ] Credentials reset\n    \n[ ] System Recovery\n    [ ] Systems rebuilt/cleaned\n    [ ] Data restored from backup\n    [ ] Configurations restored\n    [ ] Security tools installed\n    \n[ ] Verification\n    [ ] IOC scan: clean\n    [ ] No persistence: verified\n    [ ] Security tools: operational\n    [ ] Network connectivity: verified\n    \n[ ] Post-Recovery\n    [ ] Enhanced monitoring enabled\n    [ ] IOC alerts configured\n    [ ] Documentation complete\n    [ ] Monitoring period defined\n```\n\nDETECTION INDICATORS:\n- All malware removed\n- Persistence eliminated\n- Credentials rotated\n- Systems verified clean\n\nCOMMON PITFALLS:\n- Incomplete eradication (reinfection)\n- Restoring infected backups\n- Missing credential resets\n- Inadequate post-recovery monitoring\n\nFURTHER READING:\n- NIST SP 800-61 Section 3.4\n- SANS Incident Handler's Handbook\n- Ransomware recovery guides",
      "tags": ["forensics", "incident-response", "eradication", "recovery", "dfir"],
      "related_tools": ["yara"]
    },
    {
      "id": "lessons_learned",
      "title": "Lessons Learned and Reporting",
      "content": "OBJECTIVE: Document incident findings, conduct post-incident review, and implement improvements to prevent recurrence.\n\nACADEMIC BACKGROUND:\nThe post-incident phase transforms an incident into organizational improvement. Thorough documentation preserves institutional knowledge, lessons learned meetings identify gaps, and recommendations drive security program enhancements. This phase often receives insufficient attention but provides significant value.\n\nPOST-INCIDENT ACTIVITIES:\n\n1. INCIDENT DOCUMENTATION:\n   ```\n   Final Incident Report Structure:\n   \n   1. Executive Summary\n      - Incident overview (2-3 paragraphs)\n      - Impact summary\n      - Key findings\n      - Recommendations\n   \n   2. Incident Timeline\n      - Chronological event sequence\n      - Key timestamps\n      - Response actions\n   \n   3. Technical Details\n      - Attack vector\n      - Affected systems\n      - IOCs\n      - TTPs (MITRE ATT&CK mapping)\n   \n   4. Impact Assessment\n      - Systems affected\n      - Data affected\n      - Business impact\n      - Financial impact\n   \n   5. Response Summary\n      - Detection\n      - Containment\n      - Eradication\n      - Recovery\n   \n   6. Root Cause Analysis\n      - How did this happen?\n      - What controls failed?\n      - What enabled the attack?\n   \n   7. Recommendations\n      - Immediate actions\n      - Short-term improvements\n      - Long-term strategy\n   \n   8. Appendices\n      - Detailed timeline\n      - IOC list\n      - Evidence inventory\n      - Communication log\n   ```\n\n2. TIMELINE DOCUMENTATION:\n   ```\n   Detailed Timeline Format:\n   \n   | DateTime (UTC) | Source | Event | Actor |\n   |----------------|--------|-------|-------|\n   | 2024-03-14 09:15 | Email Logs | Phishing email delivered | Attacker |\n   | 2024-03-14 09:45 | EDR | Malicious attachment opened | User |\n   | 2024-03-14 09:46 | Process Log | PowerShell execution | Malware |\n   | 2024-03-14 10:00 | Firewall | C2 communication started | Malware |\n   | 2024-03-14 10:30 | SMB Logs | Lateral movement to server | Attacker |\n   | 2024-03-15 09:45 | EDR | Alert generated | EDR |\n   | 2024-03-15 09:50 | IR Team | Investigation started | Analyst |\n   | 2024-03-15 10:05 | Network | System isolated | IR Team |\n   | 2024-03-16 12:00 | IT Ops | System rebuilt | IT Team |\n   | 2024-03-16 16:00 | IR Team | Recovery complete | IR Lead |\n   \n   Key Metrics:\n   - Dwell time: 24 hours (initial compromise to detection)\n   - Time to detect: 24 hours (compromise to first alert)\n   - Time to contain: 20 minutes (alert to containment)\n   - Time to eradicate: 26 hours (containment to clean)\n   - Total incident duration: 50 hours\n   ```\n\n3. MITRE ATT&CK MAPPING:\n   ```\n   Tactics, Techniques, and Procedures:\n   \n   Initial Access:\n   - T1566.001: Phishing - Spearphishing Attachment\n     Evidence: Malicious Word document via email\n   \n   Execution:\n   - T1059.001: PowerShell\n     Evidence: Encoded PowerShell command execution\n   - T1204.002: User Execution - Malicious File\n     Evidence: User opened malicious attachment\n   \n   Persistence:\n   - T1053.005: Scheduled Task\n     Evidence: Daily scheduled task created\n   - T1547.001: Registry Run Keys\n     Evidence: HKCU\\...\\Run entry created\n   \n   Defense Evasion:\n   - T1027: Obfuscated Files or Information\n     Evidence: Base64 encoded PowerShell\n   \n   Credential Access:\n   - T1003.001: LSASS Memory\n     Evidence: Mimikatz usage detected\n   \n   Lateral Movement:\n   - T1021.002: SMB/Windows Admin Shares\n     Evidence: ADMIN$ access to file server\n   \n   Command and Control:\n   - T1071.001: Web Protocols\n     Evidence: HTTPS C2 to external IP\n   \n   Exfiltration:\n   - T1041: Exfiltration Over C2 Channel\n     Evidence: 450 MB transferred to C2\n   ```\n\n4. LESSONS LEARNED MEETING:\n   ```\n   Post-Incident Review Agenda:\n   \n   Meeting Details:\n   - Date: [5-10 days post-incident]\n   - Duration: 2 hours\n   - Attendees: IR team, IT, Management, affected teams\n   \n   Agenda:\n   \n   1. Incident Overview (15 min)\n      - Presenter: IR Lead\n      - Timeline summary\n      - Impact summary\n   \n   2. What Went Well (20 min)\n      - Effective detection\n      - Quick containment\n      - Good communication\n      - Team collaboration\n   \n   3. What Needs Improvement (30 min)\n      - Detection gaps\n      - Response delays\n      - Tool limitations\n      - Process issues\n   \n   4. Root Cause Analysis (20 min)\n      - Why did this happen?\n      - What enabled the attack?\n      - What controls failed?\n   \n   5. Recommendations (20 min)\n      - Immediate actions\n      - Short-term improvements\n      - Long-term changes\n   \n   6. Action Items (15 min)\n      - Assign owners\n      - Set deadlines\n      - Define success criteria\n   \n   Ground Rules:\n   - Blameless discussion\n   - Focus on improvement\n   - Capture all input\n   - Prioritize actionable items\n   ```\n\n5. ROOT CAUSE ANALYSIS:\n   ```\n   5 Whys Analysis:\n   \n   Problem: User workstation compromised\n   \n   Why 1: Malware executed on workstation\n   Why 2: User opened malicious email attachment\n   Why 3: Email bypassed email security filters\n   Why 4: Attachment used novel evasion technique\n   Why 5: Email security rules not tuned for current threats\n   \n   Root Cause: Email security detection gap for macro-based attacks\n   \n   ---\n   \n   Fishbone/Ishikawa Analysis:\n   \n   Categories:\n   \n   People:\n   - User clicked malicious attachment\n   - Security awareness training gap\n   \n   Process:\n   - No process for macro-enabled document handling\n   - Delayed alert triage\n   \n   Technology:\n   - Email filter missed threat\n   - Endpoint detection delayed\n   - No macro blocking policy\n   \n   Policy:\n   - No policy restricting macro execution\n   - Insufficient access controls on file server\n   ```\n\n6. RECOMMENDATIONS:\n   ```\n   Remediation Recommendations:\n   \n   Immediate (0-30 days):\n   | # | Recommendation | Owner | Due |\n   |---|----------------|-------|-----|\n   | 1 | Block macro execution via GPO | IT | 7 days |\n   | 2 | Update email filter rules | Security | 7 days |\n   | 3 | Deploy IOCs to detection tools | SOC | Immediate |\n   | 4 | Phishing simulation for affected team | Security | 14 days |\n   \n   Short-term (30-90 days):\n   | # | Recommendation | Owner | Due |\n   |---|----------------|-------|-----|\n   | 1 | Implement application whitelisting | IT | 60 days |\n   | 2 | Enhance PowerShell logging | Security | 30 days |\n   | 3 | Deploy network segmentation | Network | 90 days |\n   | 4 | Security awareness training refresh | HR | 45 days |\n   \n   Long-term (90+ days):\n   | # | Recommendation | Owner | Due |\n   |---|----------------|-------|-----|\n   | 1 | Implement Zero Trust architecture | Security | 12 months |\n   | 2 | Deploy advanced email protection | IT | 6 months |\n   | 3 | Automate threat detection/response | Security | 9 months |\n   ```\n\n7. METRICS AND REPORTING:\n   ```\n   Incident Metrics:\n   \n   Detection Metrics:\n   - Mean Time to Detect (MTTD): 24 hours\n   - Detection source: EDR alert\n   - False positive rate: N/A\n   \n   Response Metrics:\n   - Mean Time to Respond (MTTR): 20 minutes\n   - Mean Time to Contain: 20 minutes\n   - Mean Time to Eradicate: 26 hours\n   - Mean Time to Recover: 50 hours (total)\n   \n   Impact Metrics:\n   - Systems affected: 2\n   - Users affected: 1\n   - Data volume potentially accessed: 5 GB\n   - Downtime: 30 hours\n   - Estimated cost: $X\n   \n   Trend Analysis:\n   | Quarter | Incidents | MTTD | MTTR |\n   |---------|-----------|------|------|\n   | Q1 2024 | 5 | 36h | 4h |\n   | Q2 2024 | 3 | 24h | 3h |\n   | Q3 2024 | 4 | 18h | 2h |\n   | Q4 2024 | 2 | 12h | 1h |\n   ```\n\n8. EVIDENCE ARCHIVAL:\n   ```\n   Evidence Retention:\n   \n   Archive Contents:\n   - Memory dumps\n   - Disk images\n   - Network captures\n   - Log exports\n   - Malware samples\n   - Analysis reports\n   - Communication logs\n   \n   Storage Requirements:\n   - Encrypted storage\n   - Access controls\n   - Integrity verification (hashes)\n   - Retention period: Per policy (typically 1-7 years)\n   \n   Archive Structure:\n   /incidents/\n     /INC-2024-0315-001/\n       /evidence/\n         memory_WORKSTATION-01_20240315.raw\n         disk_WORKSTATION-01_20240315.E01\n         pcap_network_20240315.pcap\n       /analysis/\n         volatility_report.txt\n         timeline.csv\n         iocs.txt\n       /reports/\n         incident_report_final.pdf\n         executive_summary.pdf\n       /communications/\n         email_log.txt\n         meeting_notes.txt\n       manifest.json\n       hashes.txt\n   \n   Manifest Contents:\n   - Case number\n   - Evidence inventory\n   - Chain of custody\n   - Retention requirements\n   - Access log\n   ```\n\nPOST-INCIDENT CHECKLIST:\n```\nPost-Incident Activities:\n\n[ ] Documentation\n    [ ] Final incident report complete\n    [ ] Timeline finalized\n    [ ] IOCs documented\n    [ ] ATT&CK mapping complete\n    \n[ ] Lessons Learned\n    [ ] Meeting scheduled\n    [ ] Meeting conducted\n    [ ] Action items assigned\n    [ ] Follow-up scheduled\n    \n[ ] Recommendations\n    [ ] Immediate actions implemented\n    [ ] Short-term items planned\n    [ ] Long-term items budgeted\n    \n[ ] Evidence\n    [ ] Evidence archived\n    [ ] Hashes verified\n    [ ] Retention period set\n    \n[ ] Closure\n    [ ] Incident ticket closed\n    [ ] Stakeholders notified\n    [ ] Metrics updated\n```\n\nDETECTION INDICATORS:\n- Complete documentation\n- Lessons captured\n- Recommendations implemented\n- Evidence preserved\n\nCOMMON PITFALLS:\n- Skipping lessons learned\n- Not implementing recommendations\n- Incomplete documentation\n- Not preserving evidence properly\n\nFURTHER READING:\n- NIST SP 800-61 Section 3.5\n- SANS Post-Incident Activity guide\n- \"Incident Response\" by Chris Prosise",
      "tags": ["forensics", "incident-response", "lessons-learned", "reporting", "dfir"],
      "related_tools": []
    }
  ]
}
