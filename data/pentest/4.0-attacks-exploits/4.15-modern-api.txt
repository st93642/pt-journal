# Domain 4.0 - Attacks and Exploits
# Subdomain 4.15 - Modern API & GraphQL Security
# Format: question|answer_a|answer_b|answer_c|answer_d|correct_idx|explanation|domain|subdomain

During a GraphQL security assessment, you discover that the /graphql endpoint accepts introspection queries. What is the PRIMARY security risk associated with enabled introspection in production?|Increased query complexity leading to DoS|Complete schema disclosure exposing all types, fields, and relationships|Unauthorized mutation execution|JWT token leakage through query parameters|1|GraphQL introspection allows attackers to retrieve the complete API schema, including all types, fields, relationships, and documentation. This provides a comprehensive attack surface map and reveals sensitive business logic, making it easier to craft targeted attacks.|4.0 Attacks and Exploits|4.15 Modern API & GraphQL Security

When testing for Broken Object Property Level Authorization (BOLA/API01), which technique is MOST effective for discovering unauthorized data access?|Testing for SQL injection in API parameters|Manipulating object IDs extracted from legitimate API responses|Fuzzing API endpoints with random JSON payloads|Analyzing HTTP response headers for information leakage|1|BOLA vulnerabilities are typically discovered by extracting object IDs from legitimate API responses and then modifying those IDs to attempt access to other users' data. This direct approach tests the core authorization mechanism rather than focusing on injection or fuzzing techniques.|4.0 Attacks and Exploits|4.15 Modern API & GraphQL Security

You discover a JWT token using the "none" algorithm (alg=None). What attack does this vulnerability enable?|Token replay attacks|Complete bypass of signature verification|Man-in-the-middle token interception|Brute force attacks on the signing key|1|The alg=None vulnerability allows attackers to completely bypass signature verification by setting the algorithm to "none". This means any modifications to the JWT payload will be accepted as valid, enabling privilege escalation and unauthorized access.|4.0 Attacks and Exploits|4.15 Modern API & GraphQL Security

In a WebSocket security assessment, which finding indicates the HIGHEST risk for data exfiltration?|Missing Origin header validation|Unencrypted WebSocket connections (ws://)|Lack of rate limiting on message frequency|Absence of message size restrictions|1|Missing Origin header validation allows any website to establish a WebSocket connection to the target application, enabling cross-origin attacks and data exfiltration through malicious JavaScript. While unencrypted connections and rate limiting issues are serious, the Origin validation bypass directly enables cross-site request forgery (CSRF) style attacks on WebSockets.|4.0 Attacks and Exploits|4.15 Modern API & GraphQL Security

When testing gRPC services, which technique provides the MOST comprehensive attack surface discovery?|Network port scanning for gRPC ports|Analyzing Protocol Buffer (.proto) files|Testing gRPC reflection service|Intercepting gRPC traffic with Burp Suite|2|The gRPC reflection service allows clients to dynamically discover all available services, methods, and message types at runtime. This provides the most comprehensive attack surface discovery, revealing the complete API interface without requiring access to .proto files or traffic interception.|4.0 Attacks and Exploits|4.15 Modern API & GraphQL Security

During an API security test, you identify a mass assignment vulnerability. What is the PRIMARY security impact?|SQL injection through parameter manipulation|Unauthorized modification of object properties|Cross-site scripting through API responses|Denial of service through large payloads|1|Mass assignment vulnerabilities allow attackers to modify object properties that should not be user-modifiable, such as role, isAdmin, or status fields. This can lead to privilege escalation and unauthorized data modification, making it a critical security issue.|4.0 Attacks and Exploits|4.15 Modern API & GraphQL Security

Which JWT attack specifically targets the mismatch between asymmetric and symmetric algorithms?|Brute force key cracking|Algorithm confusion attack|Token replay attack|Key substitution attack|1|Algorithm confusion attacks exploit the vulnerability where a server accepts tokens signed with different algorithms than intended. For example, converting an RS256 (asymmetric) token to HS256 (symmetric) and signing it with the server's public key, which the server then uses as the secret for verification.|4.0 Attacks and Exploits|4.15 Modern API & GraphQL Security

In GraphQL security testing, what is the PRIMARY purpose of query depth analysis?|To identify SQL injection vulnerabilities|To prevent denial of service through complex queries|To discover hidden fields and types|To test authentication bypasses|1|Query depth analysis is primarily used to prevent denial of service attacks that could be triggered by deeply nested GraphQL queries. Complex queries with excessive depth can consume significant server resources and potentially crash the application.|4.0 Attacks and Exploits|4.15 Modern API & GraphQL Security

When testing Single Page Applications (SPAs), which client-side storage mechanism poses the GREATEST security risk for sensitive data?|Cookies with HttpOnly flag|Session storage|Local storage|IndexedDB|2|Local storage persists data across browser sessions and is accessible to any JavaScript running on the same origin, making it the most risky for storing sensitive data like JWT tokens. Session storage is slightly safer as it clears when the tab closes, while HttpOnly cookies protect against JavaScript access.|4.0 Attacks and Exploits|4.15 Modern API & GraphQL Security

During OAuth 2.0 testing, which vulnerability allows an attacker to steal authorization codes?|Weak redirect URI validation|Missing state parameter|Insecure scope implementation|PKCE bypass|1|Weak redirect URI validation allows attackers to manipulate the redirect_uri parameter to point to a malicious server. When the authorization server redirects with the authorization code, the attacker can intercept and exchange it for an access token.|4.0 Attacks and Exploits|4.15 Modern API & GraphQL Security

In WebSocket security testing, which technique is MOST effective for testing authorization controls?|Message replay attacks|Cross-origin WebSocket connections|Protocol fuzzing|Message injection testing|1|Message replay attacks are highly effective for testing WebSocket authorization because they allow attackers to replay previously captured messages in different contexts to test if proper authorization checks are enforced on each message.|4.0 Attacks and Exploits|4.15 Modern API & GraphQL Security

Which gRPC security vulnerability is similar to REST API directory traversal?|Reflection service abuse|Message field manipulation|Service enumeration|Proto file exposure|2|Service enumeration in gRPC is similar to directory traversal in REST APIs because it allows attackers to discover all available services and methods, potentially revealing administrative functions or sensitive operations that should not be accessible.|4.0 Attacks and Exploits|4.15 Modern API & GraphQL Security

When testing API rate limiting, which bypass technique is MOST commonly effective?|Using HTTP HEAD instead of GET|Rotating source IP addresses|Modifying User-Agent header|Adding random query parameters|1|Rotating source IP addresses through proxies, VPNs, or botnets is the most common and effective technique for bypassing IP-based rate limiting. Other techniques like header modification or parameter addition may work against poorly implemented rate limiters but are less reliable.|4.0 Attacks and Exploits|4.15 Modern API & GraphQL Security

In GraphQL security, what is the PRIMARY risk of batch query aliases?|Increased attack surface through query complexity|Bypass of rate limiting mechanisms|SQL injection through parameter binding|Cross-site scripting in query responses|1|GraphQL aliases allow multiple queries to be executed in a single request, which can bypass rate limiting mechanisms that count requests rather than individual operations. This enables attackers to execute many more queries than intended.|4.0 Attacks and Exploits|4.15 Modern API & GraphQL Security

Which JWT claim is MOST critical to validate for preventing token replay attacks?|iss (issuer)|sub (subject)|jti (JWT ID)|aud (audience)|2|The jti (JWT ID) claim provides a unique identifier for each token, which is essential for preventing replay attacks. By maintaining a blacklist of used jti values, servers can reject tokens that have already been used, even if they haven't expired.|4.0 Attacks and Exploits|4.15 Modern API & GraphQL Security

During OAuth 2.0 testing, which scope-related vulnerability poses the GREATEST risk?|Overly permissive default scopes|Missing scope validation|Scope confusion between client types|Lack of scope documentation|1|Missing scope validation allows clients to request any scope they want, including highly privileged scopes like read:all, write:all, or admin. This can lead to complete account takeover when combined with other vulnerabilities.|4.0 Attacks and Exploits|4.15 Modern API & GraphQL Security

In WebSocket security assessments, which finding indicates the HIGHEST likelihood of successful man-in-the-middle attacks?|Missing Origin header validation|Unencrypted ws:// connections|Lack of authentication on connect|No rate limiting on subscriptions|1|Unencrypted ws:// connections are vulnerable to man-in-the-middle attacks as the traffic is transmitted in plaintext. An attacker on the same network can intercept, modify, or inject WebSocket messages, leading to data theft or session hijacking.|4.0 Attacks and Exploits|4.15 Modern API & GraphQL Security

When testing gRPC authentication, which bypass technique is MOST similar to JWT algorithm confusion?|Token substitution between services|Certificate validation bypass|Reflection service abuse|Message field manipulation|1|Token substitution between services in gRPC is similar to JWT algorithm confusion because it involves using tokens or credentials intended for one service to authenticate to another service, potentially bypassing security controls if validation is improperly implemented.|4.0 Attacks and Exploits|4.15 Modern API & GraphQL Security

Which API testing technique is MOST effective for discovering business logic flaws?|Fuzzing with random payloads|Analyzing API documentation|Testing edge cases and boundary conditions|Monitoring error messages|2|Testing edge cases and boundary conditions is most effective for discovering business logic flaws because these often reveal gaps in validation, authorization checks, or workflow controls that aren't apparent during normal usage or through fuzzing.|4.0 Attacks and Exploits|4.15 Modern API & GraphQL Security

In GraphQL security testing, which technique is BEST for identifying hidden mutations?|Schema introspection analysis|Brute force mutation name fuzzing|Analyzing GraphQL playground|Monitoring network traffic for mutation operations|1|Schema introspection analysis is the most comprehensive technique for identifying all available mutations, including those that might be hidden or undocumented. Brute force fuzzing might miss mutations with non-obvious names, while traffic analysis only shows currently used mutations.|4.0 Attacks and Exploits|4.15 Modern API & GraphQL Security
