[
  {
    "id": "yara",
    "name": "YARA",
    "summary": "Pattern matching engine for malware research and detection",
    "details": "Comprehensive guide for using YARA in penetration testing engagements.",
    "installation_guides": [
      {
        "platform": "Debian/Ubuntu",
        "summary": "Install YARA on Debian/Ubuntu systems",
        "steps": [
          {
            "detail": "Update package manager and install YARA",
            "copyable": true
          },
          {
            "detail": "Verify installation with version check",
            "copyable": true
          }
        ]
      },
      {
        "platform": "Kali Linux",
        "summary": "Install YARA on Kali Linux",
        "steps": [
          {
            "detail": "Use apt to install YARA on Kali",
            "copyable": true
          },
          {
            "detail": "Confirm installation",
            "copyable": true
          }
        ]
      },
      {
        "platform": "Docker/Container",
        "summary": "Run YARA in Docker container",
        "steps": [
          {
            "detail": "Pull Docker image containing YARA",
            "copyable": true
          },
          {
            "detail": "Run container with appropriate mounts",
            "copyable": true
          }
        ]
      }
    ],
    "quick_examples": [
      {
        "description": "Basic YARA execution",
        "command": "yara --help",
        "notes": [
          "Display help for YARA"
        ]
      },
      {
        "description": "Standard YARA scan",
        "command": "yara target",
        "notes": [
          "Run YARA against a target"
        ]
      }
    ],
    "common_flags": [
      {
        "flag": "--help",
        "description": "Display help message"
      },
      {
        "flag": "-v/--verbose",
        "description": "Verbose output"
      },
      {
        "flag": "-o/--output",
        "description": "Output file path"
      }
    ],
    "operational_tips": [
      "Always verify YARA is installed correctly before engagements",
      "Use YARA within scope boundaries defined in rules of engagement",
      "Document all YARA findings for reporting",
      "Review YARA output for false positives"
    ],
    "step_sequences": [
      {
        "title": "Basic YARA workflow",
        "steps": [
          {
            "title": "Prepare target",
            "details": "Identify target for YARA assessment",
            "command": "# Define your target"
          },
          {
            "title": "Execute YARA",
            "details": "Run YARA with appropriate options",
            "command": "yara target"
          },
          {
            "title": "Analyze results",
            "details": "Review YARA output for findings",
            "command": "# Review results"
          }
        ]
      }
    ],
    "workflow_guides": [
      {
        "name": "YARA integration workflow",
        "stages": [
          {
            "label": "Initialize YARA",
            "description": "Prepare YARA for use",
            "command": "yara init"
          },
          {
            "label": "Execute scan",
            "description": "Run YARA scan on target",
            "command": "yara scan target"
          },
          {
            "label": "Export results",
            "description": "Export YARA findings",
            "command": "yara export -o results.txt"
          }
        ]
      }
    ],
    "output_notes": [
      {
        "indicator": "[+] Rule_Name target_file",
        "meaning": "Rule matched the target file successfully",
        "severity": "high"
      },
      {
        "indicator": "String found: $string1",
        "meaning": "Specific pattern detected in file",
        "severity": "medium"
      },
      {
        "indicator": "No matches",
        "meaning": "File does not match any rules",
        "severity": "info"
      }
    ],
    "advanced_usage": [
      {
        "title": "Advanced YARA techniques",
        "scenario": "Complex YARA scenarios in advanced assessments",
        "command": "yara advanced-mode",
        "notes": [
          "Use for complex YARA scenarios"
        ]
      }
    ],
    "resources": [
      {
        "label": "YARA documentation",
        "url": "https://yara.readthedocs.io/",
        "description": "Official YARA documentation"
      },
      {
        "label": "Yara-Rules",
        "url": "https://github.com/Yara-Rules/rules",
        "description": "Community YARA rules collection"
      },
      {
        "label": "VirusTotal",
        "url": "https://www.virustotal.com/",
        "description": "YARA rule sharing via VT"
      }
    ],
    "installation": [
      {
        "platform": "Debian/Ubuntu",
        "summary": "Install YARA pattern engine",
        "steps": [
          {
            "detail": "sudo apt-get update && sudo apt-get install -y automake libtool make gcc pkg-config",
            "copyable": true
          },
          {
            "detail": "git clone --recursive https://github.com/VirusTotal/yara.git",
            "copyable": true
          },
          {
            "detail": "cd yara && ./bootstrap.sh && ./configure && make && sudo make install",
            "copyable": true
          },
          {
            "detail": "sudo ldconfig && yara --version",
            "copyable": true
          }
        ]
      },
      {
        "platform": "Kali Linux",
        "summary": "Install YARA on Kali",
        "steps": [
          {
            "detail": "sudo apt install -y yara",
            "copyable": true
          },
          {
            "detail": "yara --version",
            "copyable": true
          }
        ]
      },
      {
        "platform": "Docker",
        "summary": "Run YARA in Docker",
        "steps": [
          {
            "detail": "docker pull citizenstig/yara",
            "copyable": true
          },
          {
            "detail": "docker run --rm -v $(pwd):/home -w /home citizenstig/yara yara --version",
            "copyable": true
          }
        ]
      }
    ],
    "commands": [
      {
        "description": "Scan file with rule",
        "command": "yara rule.yar target_file",
        "notes": [
          "Returns matches"
        ]
      },
      {
        "description": "Scan directory",
        "command": "yara -r rule.yar /path/to/scan",
        "notes": [
          "-r flag for recursive"
        ]
      },
      {
        "description": "JSON output",
        "command": "yara -j rule.yar target_file",
        "notes": [
          "Parse with jq or Python"
        ]
      }
    ],
    "flags": [
      {
        "flag": "-r",
        "description": "Recursive directory scan"
      },
      {
        "flag": "-j",
        "description": "JSON output format"
      },
      {
        "flag": "-d",
        "description": "Print matching identifier"
      },
      {
        "flag": "-s",
        "description": "Print matching strings"
      },
      {
        "flag": "-m",
        "description": "Print metadata"
      }
    ],
    "tips": [
      "YARA rules are pattern signatures for malware detection",
      "Create rules for custom malware or IOCs",
      "YARA integrates with VirusTotal for threat intelligence",
      "Use for hunting in disk images, memory, or file systems",
      "Community rules available from Florian Roth and others"
    ],
    "sequences": [
      {
        "title": "Malware detection with YARA",
        "steps": [
          {
            "title": "Download rules",
            "details": "Obtain YARA rules from community sources",
            "command": "git clone https://github.com/Yara-Rules/rules.git"
          },
          {
            "title": "Create custom rule",
            "details": "Write rule for specific malware",
            "command": "cat > malware.yar << 'EOF'\nrule Trojan_Generic {\n  strings:\n    $hex1 = {4D 5A}\n    $string1 = \"malicious_function\"\n  condition:\n    $hex1 at 0 and $string1\n}\nEOF"
          },
          {
            "title": "Test rule",
            "details": "Validate rule syntax",
            "command": "yara -p malware.yar test_file.exe"
          },
          {
            "title": "Scan target",
            "details": "Execute scan against suspicious files",
            "command": "yara -r malware.yar /tmp/suspicious/"
          },
          {
            "title": "Review results",
            "details": "Analyze detections",
            "command": "yara -r -j malware.yar /tmp/suspicious/ | jq"
          }
        ]
      }
    ],
    "workflows": [
      {
        "name": "Threat hunting with YARA",
        "stages": [
          {
            "label": "Rule collection",
            "description": "Gather YARA rules for known threats",
            "command": "# Collect community and custom rules"
          },
          {
            "label": "Environment prep",
            "description": "Prepare systems for scanning",
            "command": "# Mount memory, disk images"
          },
          {
            "label": "Rule execution",
            "description": "Run YARA scans",
            "command": "yara -r rules/ /target/path"
          },
          {
            "label": "Result analysis",
            "description": "Review matches and false positives",
            "command": "# Investigate detections"
          },
          {
            "label": "IOC extraction",
            "description": "Extract indicators of compromise",
            "command": "# Document findings"
          },
          {
            "label": "Response action",
            "description": "Take remediation steps",
            "command": "# Isolate, remove, or observe"
          }
        ]
      }
    ],
    "advanced": [
      {
        "title": "Memory hunting",
        "scenario": "Scan memory dumps for malware artifacts",
        "command": "volatility -f image.mem --profile=Win7SP1x64 dump_scan | yara -r rules/ -",
        "notes": [
          "Combine with volatility",
          "Detect in-memory malware"
        ]
      }
    ]
  },
  {
    "id": "sigma",
    "name": "Sigma",
    "summary": "Generic and open signature format for detection rules",
    "details": "Comprehensive guide for using Sigma in penetration testing engagements.",
    "installation_guides": [
      {
        "platform": "Debian/Ubuntu",
        "summary": "Install Sigma on Debian/Ubuntu systems",
        "steps": [
          {
            "detail": "Update package manager and install Sigma",
            "copyable": true
          },
          {
            "detail": "Verify installation with version check",
            "copyable": true
          }
        ]
      },
      {
        "platform": "Kali Linux",
        "summary": "Install Sigma on Kali Linux",
        "steps": [
          {
            "detail": "Use apt to install Sigma on Kali",
            "copyable": true
          },
          {
            "detail": "Confirm installation",
            "copyable": true
          }
        ]
      },
      {
        "platform": "Docker/Container",
        "summary": "Run Sigma in Docker container",
        "steps": [
          {
            "detail": "Pull Docker image containing Sigma",
            "copyable": true
          },
          {
            "detail": "Run container with appropriate mounts",
            "copyable": true
          }
        ]
      }
    ],
    "quick_examples": [
      {
        "description": "Convert Sigma to Elasticsearch",
        "command": "sigma convert -t elasticsearch rule.yml",
        "notes": [
          "Outputs ES query"
        ]
      },
      {
        "description": "Validate Sigma rule",
        "command": "sigma check rule.yml",
        "notes": [
          "Check rule syntax"
        ]
      },
      {
        "description": "Convert multiple rules",
        "command": "sigma convert -t splunk -d rules/",
        "notes": [
          "Recursive directory conversion"
        ]
      }
    ],
    "common_flags": [
      {
        "flag": "--help",
        "description": "Display help message"
      },
      {
        "flag": "-v/--verbose",
        "description": "Verbose output"
      },
      {
        "flag": "-o/--output",
        "description": "Output file path"
      }
    ],
    "operational_tips": [
      "Sigma is generic detection rule format",
      "Rules are YAML-based and platform-agnostic",
      "Can be converted to Elasticsearch, Splunk, Snort, Suricata, etc.",
      "Used by SOC/SIEM teams for threat detection",
      "Complements YARA for log-based hunting"
    ],
    "step_sequences": [
      {
        "title": "Basic Sigma workflow",
        "steps": [
          {
            "title": "Prepare target",
            "details": "Identify target for Sigma assessment",
            "command": "# Define your target"
          },
          {
            "title": "Execute Sigma",
            "details": "Run Sigma with appropriate options",
            "command": "sigma target"
          },
          {
            "title": "Analyze results",
            "details": "Review Sigma output for findings",
            "command": "# Review results"
          }
        ]
      }
    ],
    "workflow_guides": [
      {
        "name": "Sigma integration workflow",
        "stages": [
          {
            "label": "Initialize Sigma",
            "description": "Prepare Sigma for use",
            "command": "sigma init"
          },
          {
            "label": "Execute scan",
            "description": "Run Sigma scan on target",
            "command": "sigma scan target"
          },
          {
            "label": "Export results",
            "description": "Export Sigma findings",
            "command": "sigma export -o results.txt"
          }
        ]
      }
    ],
    "output_notes": [
      {
        "indicator": "[+] Sigma execution successful",
        "meaning": "Sigma ran without errors",
        "severity": "info"
      },
      {
        "indicator": "[!] Sigma finding detected",
        "meaning": "Potential security issue found by Sigma",
        "severity": "medium"
      }
    ],
    "advanced_usage": [
      {
        "title": "Advanced Sigma techniques",
        "scenario": "Complex Sigma scenarios in advanced assessments",
        "command": "sigma advanced-mode",
        "notes": [
          "Use for complex Sigma scenarios"
        ]
      }
    ],
    "resources": [
      {
        "label": "Official Sigma documentation",
        "url": "https://example.com/sigma",
        "description": "Official guide for Sigma"
      },
      {
        "label": "Sigma GitHub repository",
        "url": "https://github.com/example/sigma",
        "description": "Source code and community discussions"
      }
    ],
    "installation": [
      {
        "platform": "Debian/Ubuntu",
        "summary": "Install Sigma tools",
        "steps": [
          {
            "detail": "pip3 install sigma-cli",
            "copyable": true
          },
          {
            "detail": "sigma --version",
            "copyable": true
          },
          {
            "detail": "git clone https://github.com/SigmaHQ/sigma.git",
            "copyable": true
          }
        ]
      },
      {
        "platform": "Docker",
        "summary": "Run Sigma in Docker",
        "steps": [
          {
            "detail": "docker run --rm -v $(pwd):/work -w /work ghcr.io/sigmahq/sigma:latest sigma --version",
            "copyable": true
          }
        ]
      },
      {
        "platform": "Python Virtual Environment",
        "summary": "Development install",
        "steps": [
          {
            "detail": "python3 -m venv sigma-env && source sigma-env/bin/activate",
            "copyable": true
          },
          {
            "detail": "pip install sigma-cli",
            "copyable": true
          }
        ]
      }
    ]
  },
  {
    "id": "loganalysis",
    "name": "Log Analysis & Threat Hunting",
    "summary": "Guide for analyzing logs and threat hunting activities",
    "details": "Comprehensive guide for using Log Analysis & Threat Hunting in penetration testing engagements.",
    "installation_guides": [
      {
        "platform": "Debian/Ubuntu",
        "summary": "Install Log Analysis & Threat Hunting on Debian/Ubuntu systems",
        "steps": [
          {
            "detail": "Update package manager and install Log Analysis & Threat Hunting",
            "copyable": true
          },
          {
            "detail": "Verify installation with version check",
            "copyable": true
          }
        ]
      },
      {
        "platform": "Kali Linux",
        "summary": "Install Log Analysis & Threat Hunting on Kali Linux",
        "steps": [
          {
            "detail": "Use apt to install Log Analysis & Threat Hunting on Kali",
            "copyable": true
          },
          {
            "detail": "Confirm installation",
            "copyable": true
          }
        ]
      },
      {
        "platform": "Docker/Container",
        "summary": "Run Log Analysis & Threat Hunting in Docker container",
        "steps": [
          {
            "detail": "Pull Docker image containing Log Analysis & Threat Hunting",
            "copyable": true
          },
          {
            "detail": "Run container with appropriate mounts",
            "copyable": true
          }
        ]
      }
    ],
    "quick_examples": [
      {
        "description": "Search logs",
        "command": "grep -E 'ERROR|WARN' /var/log/syslog",
        "notes": [
          "Basic log search"
        ]
      },
      {
        "description": "Aggregate logs",
        "command": "cat /var/log/*.log | sort | uniq -c | sort -rn",
        "notes": [
          "Count events"
        ]
      },
      {
        "description": "Parse JSON logs",
        "command": "jq '.message, .severity' app.log",
        "notes": [
          "Structure extraction"
        ]
      }
    ],
    "common_flags": [
      {
        "flag": "--help",
        "description": "Display help message"
      },
      {
        "flag": "-v/--verbose",
        "description": "Verbose output"
      },
      {
        "flag": "-o/--output",
        "description": "Output file path"
      }
    ],
    "operational_tips": [
      "Critical for threat hunting",
      "SIEM platforms automate analysis",
      "Combine with Sigma rules",
      "Splunk, ELK, Elastic are common platforms",
      "Log retention policies important"
    ],
    "step_sequences": [
      {
        "title": "Basic Log Analysis & Threat Hunting workflow",
        "steps": [
          {
            "title": "Prepare target",
            "details": "Identify target for Log Analysis & Threat Hunting assessment",
            "command": "# Define your target"
          },
          {
            "title": "Execute Log Analysis & Threat Hunting",
            "details": "Run Log Analysis & Threat Hunting with appropriate options",
            "command": "loganalysis target"
          },
          {
            "title": "Analyze results",
            "details": "Review Log Analysis & Threat Hunting output for findings",
            "command": "# Review results"
          }
        ]
      }
    ],
    "workflow_guides": [
      {
        "name": "Log Analysis & Threat Hunting integration workflow",
        "stages": [
          {
            "label": "Initialize Log Analysis & Threat Hunting",
            "description": "Prepare Log Analysis & Threat Hunting for use",
            "command": "loganalysis init"
          },
          {
            "label": "Execute scan",
            "description": "Run Log Analysis & Threat Hunting scan on target",
            "command": "loganalysis scan target"
          },
          {
            "label": "Export results",
            "description": "Export Log Analysis & Threat Hunting findings",
            "command": "loganalysis export -o results.txt"
          }
        ]
      }
    ],
    "output_notes": [
      {
        "indicator": "[+] Log Analysis & Threat Hunting execution successful",
        "meaning": "Log Analysis & Threat Hunting ran without errors",
        "severity": "info"
      },
      {
        "indicator": "[!] Log Analysis & Threat Hunting finding detected",
        "meaning": "Potential security issue found by Log Analysis & Threat Hunting",
        "severity": "medium"
      }
    ],
    "advanced_usage": [
      {
        "title": "Advanced Log Analysis & Threat Hunting techniques",
        "scenario": "Complex Log Analysis & Threat Hunting scenarios in advanced assessments",
        "command": "loganalysis advanced-mode",
        "notes": [
          "Use for complex Log Analysis & Threat Hunting scenarios"
        ]
      }
    ],
    "resources": [
      {
        "label": "Official Log Analysis & Threat Hunting documentation",
        "url": "https://example.com/loganalysis",
        "description": "Official guide for Log Analysis & Threat Hunting"
      },
      {
        "label": "Log Analysis & Threat Hunting GitHub repository",
        "url": "https://github.com/example/loganalysis",
        "description": "Source code and community discussions"
      }
    ]
  },
  {
    "id": "threat-hunting-cloud",
    "name": "Cloud Threat Hunting Guide",
    "summary": "Comprehensive methodology for hunting threats in cloud environments",
    "details": "Structured approach to threat hunting in AWS, Azure, and GCP environments, focusing on control plane abuse, data exfiltration, and lateral movement.",
    "installation_guides": [
      {
        "platform": "Cloud CLI Setup",
        "summary": "Configure cloud provider CLIs for hunting",
        "steps": [
          {
            "detail": "Install AWS CLI: pip install awscli",
            "copyable": true
          },
          {
            "detail": "Configure Azure CLI: az login",
            "copyable": true
          },
          {
            "detail": "Set up GCP SDK: gcloud auth login",
            "copyable": true
          },
          {
            "detail": "Configure CloudTrail/Event logging",
            "copyable": false
          }
        ]
      },
      {
        "platform": "SIEM Integration",
        "summary": "Set up centralized logging for correlation",
        "steps": [
          {
            "detail": "Install ELK Stack: docker-compose up -d",
            "copyable": true
          },
          {
            "detail": "Configure log shippers (Filebeat, Fluentd)",
            "copyable": true
          },
          {
            "detail": "Set up correlation rules and alerts",
            "copyable": true
          },
          {
            "detail": "Import threat hunting queries",
            "copyable": false
          }
        ]
      },
      {
        "platform": "Threat Hunting Tools",
        "summary": "Install specialized threat hunting utilities",
        "steps": [
          {
            "detail": "pip install sigma-cli yara-python",
            "copyable": true
          },
          {
            "detail": "git clone https://github.com/Neo23x0/sigma.git",
            "copyable": true
          },
          {
            "detail": "Configure YARA rules for cloud artifacts",
            "copyable": true
          },
          {
            "detail": "Set up automated hunting pipelines",
            "copyable": false
          }
        ]
      }
    ],
    "quick_examples": [
      {
        "description": "Check for unusual IAM activity",
        "command": "aws iam list-users --query 'Users[?CreateDate>\"2024-01-01\"]'",
        "notes": [
          "Look for recently created accounts"
        ]
      },
      {
        "description": "Monitor S3 bucket access",
        "command": "aws s3api list-buckets --query 'Buckets[?CreationDate>\"2024-01-01\"]'",
        "notes": [
          "Identify new storage resources"
        ]
      },
      {
        "description": "Check Azure role assignments",
        "command": "az role assignment list --query '[?createdOn > \"2024-01-01\"]'",
        "notes": [
          "Monitor privilege changes"
        ]
      }
    ],
    "step_sequences": [
      {
        "title": "Cloud Threat Hunting Lifecycle",
        "steps": [
          {
            "title": "Data Collection Setup",
            "details": "Configure comprehensive logging and monitoring",
            "command": "# Enable CloudTrail, VPC Flow Logs, etc."
          },
          {
            "title": "Baseline Establishment",
            "details": "Create normal behavior baselines",
            "command": "# Analyze historical data"
          },
          {
            "title": "Hypothesis Development",
            "details": "Formulate threat hunting hypotheses",
            "command": "# Define what to look for"
          },
          {
            "title": "Query Execution",
            "details": "Run hunting queries across data sources",
            "command": "# Execute searches"
          },
          {
            "title": "Analysis & Validation",
            "details": "Analyze results and validate findings",
            "command": "# Investigate anomalies"
          },
          {
            "title": "Response & Improvement",
            "details": "Respond to threats and improve detections",
            "command": "# Update controls"
          }
        ]
      }
    ],
    "workflow_guides": [
      {
        "name": "Cloud Control Plane Hunting",
        "stages": [
          {
            "label": "API Call Analysis",
            "description": "Monitor and analyze cloud API calls",
            "command": "# Query CloudTrail/Event logs"
          },
          {
            "label": "Resource Inventory",
            "description": "Maintain accurate resource inventory",
            "command": "# List all resources"
          },
          {
            "label": "Access Pattern Analysis",
            "description": "Analyze authentication and authorization patterns",
            "command": "# Review access logs"
          },
          {
            "label": "Data Movement Tracking",
            "description": "Monitor data ingress/egress patterns",
            "command": "# Check data flows"
          },
          {
            "label": "Privilege Escalation Hunting",
            "description": "Hunt for privilege escalation attempts",
            "command": "# Monitor role changes"
          }
        ]
      }
    ],
    "output_notes": [
      {
        "indicator": "Unusual API call pattern",
        "meaning": "API activity deviates from normal behavior",
        "severity": "medium"
      },
      {
        "indicator": "New resource creation spike",
        "meaning": "Sudden increase in resource provisioning",
        "severity": "high"
      },
      {
        "indicator": "Cross-account access",
        "meaning": "Unauthorized access between accounts",
        "severity": "high"
      },
      {
        "indicator": "Data exfiltration attempt",
        "meaning": "Large data transfers to external destinations",
        "severity": "high"
      }
    ],
    "advanced_usage": [
      {
        "title": "Multi-Cloud Threat Hunting",
        "scenario": "Coordinated hunting across multiple cloud providers",
        "command": "Correlate events across AWS, Azure, and GCP using SIEM",
        "notes": [
          "Use unified logging and correlation for complex attacks"
        ]
      }
    ],
    "resources": [
      {
        "label": "AWS Threat Detection",
        "url": "https://aws.amazon.com/security/threat-detection/",
        "description": "AWS security and threat detection services"
      },
      {
        "label": "Azure Sentinel Hunting",
        "url": "https://docs.microsoft.com/en-us/azure/sentinel/hunting",
        "description": "Azure threat hunting capabilities"
      },
      {
        "label": "GCP Security Command Center",
        "url": "https://cloud.google.com/security-command-center",
        "description": "Google Cloud threat detection platform"
      },
      {
        "label": "Cloud Threat Hunting Queries",
        "url": "https://github.com/Cloud-Security-Research/CloudThreatHunting",
        "description": "Collection of cloud threat hunting queries"
      }
    ],
    "installation": [
      {
        "platform": "AWS Hunting Tools",
        "summary": "Install AWS-specific threat hunting tools",
        "steps": [
          {
            "detail": "pip install boto3 awscli",
            "copyable": true
          },
          {
            "detail": "Configure AWS credentials",
            "copyable": true
          },
          {
            "detail": "Enable CloudTrail and GuardDuty",
            "copyable": true
          },
          {
            "detail": "Set up Athena for log analysis",
            "copyable": true
          }
        ]
      },
      {
        "platform": "Azure Hunting Tools",
        "summary": "Install Azure threat hunting utilities",
        "steps": [
          {
            "detail": "pip install azure-cli azure-identity",
            "copyable": true
          },
          {
            "detail": "az login --use-device-code",
            "copyable": true
          },
          {
            "detail": "Enable Azure Monitor and Log Analytics",
            "copyable": true
          },
          {
            "detail": "Configure KQL queries for hunting",
            "copyable": true
          }
        ]
      },
      {
        "platform": "GCP Hunting Tools",
        "summary": "Set up Google Cloud threat hunting",
        "steps": [
          {
            "detail": "pip install google-cloud-logging google-cloud-monitoring",
            "copyable": true
          },
          {
            "detail": "gcloud auth application-default login",
            "copyable": true
          },
          {
            "detail": "Enable Security Command Center",
            "copyable": true
          },
          {
            "detail": "Configure BigQuery for log analysis",
            "copyable": true
          }
        ]
      }
    ],
    "commands": [
      {
        "description": "Query AWS CloudTrail for suspicious activity",
        "command": "aws cloudtrail lookup-events --lookup-attributes AttributeKey=EventName,AttributeValue=CreateUser",
        "notes": [
          "Find user creation events"
        ]
      },
      {
        "description": "Check Azure sign-in logs",
        "command": "az monitor activity-log list --query '[?operationName.value==\"Microsoft.Graph.SignIn\"]",
        "notes": [
          "Monitor authentication events"
        ]
      },
      {
        "description": "GCP audit log analysis",
        "command": "gcloud logging read 'resource.type=gce_instance AND operation.producer=compute.instances.start'",
        "notes": [
          "Find instance start events"
        ]
      }
    ],
    "flags": [
      {
        "flag": "--query",
        "description": "Filter results using JMESPath (AWS/Azure)"
      },
      {
        "flag": "--filter",
        "description": "Apply filters to log queries (GCP)"
      },
      {
        "flag": "--start-time",
        "description": "Specify query time range start"
      },
      {
        "flag": "--end-time",
        "description": "Specify query time range end"
      }
    ],
    "tips": [
      "Cloud threat hunting requires understanding of cloud-specific attack vectors",
      "API call patterns are critical indicators in cloud environments",
      "Multi-account/multi-region hunting is essential for comprehensive coverage",
      "CloudTrail/Cloud Audit Logs are primary data sources",
      "Resource inventory accuracy is crucial for anomaly detection",
      "IAM changes are high-risk indicators to monitor closely",
      "Data exfiltration often occurs through storage services",
      "Cross-cloud attacks require unified logging and correlation"
    ],
    "sequences": [
      {
        "title": "IAM Privilege Escalation Hunt",
        "steps": [
          {
            "title": "Collect IAM data",
            "details": "Gather user, role, and policy information",
            "command": "aws iam list-users && aws iam list-roles"
          },
          {
            "title": "Analyze permissions",
            "details": "Review attached policies and permissions",
            "command": "aws iam list-attached-user-policies --user-name $USER"
          },
          {
            "title": "Check for privilege escalation paths",
            "details": "Look for ways to escalate privileges",
            "command": "# Review policy documents for * permissions"
          },
          {
            "title": "Monitor changes",
            "details": "Watch for policy modifications",
            "command": "aws cloudtrail lookup-events --lookup-attributes AttributeKey=EventName,AttributeValue=AttachUserPolicy"
          },
          {
            "title": "Validate findings",
            "details": "Test identified escalation paths",
            "command": "# Attempt privilege escalation in test environment"
          }
        ]
      },
      {
        "title": "Data Exfiltration Detection",
        "steps": [
          {
            "title": "Monitor storage access",
            "details": "Track S3 bucket and blob storage access",
            "command": "aws s3api list-objects-v2 --bucket $BUCKET --query 'Contents[?LastModified>\"2024-01-01\"]'"
          },
          {
            "title": "Check data transfer logs",
            "details": "Review CloudTrail for data movement events",
            "command": "aws cloudtrail lookup-events --lookup-attributes AttributeKey=EventName,AttributeValue=GetObject"
          },
          {
            "title": "Analyze egress traffic",
            "details": "Monitor VPC flow logs for unusual outbound traffic",
            "command": "# Query VPC flow logs in Athena"
          },
          {
            "title": "Correlate with user activity",
            "details": "Link data access to user authentication",
            "command": "# Join CloudTrail and authentication logs"
          },
          {
            "title": "Investigate anomalies",
            "details": "Research unusual data access patterns",
            "command": "# Check user behavior and context"
          }
        ]
      }
    ],
    "workflows": [
      {
        "name": "Cloud Incident Response Hunting",
        "stages": [
          {
            "label": "Alert Triage",
            "description": "Initial assessment of security alerts",
            "command": "# Review triggered alerts"
          },
          {
            "label": "Scope Determination",
            "description": "Define affected resources and accounts",
            "command": "# Identify compromised assets"
          },
          {
            "label": "Evidence Collection",
            "description": "Gather logs and forensic data",
            "command": "# Collect CloudTrail, VPC logs, etc."
          },
          {
            "label": "Containment Actions",
            "description": "Isolate affected resources",
            "command": "# Disable compromised accounts, isolate instances"
          },
          {
            "label": "Eradication",
            "description": "Remove malicious artifacts",
            "command": "# Delete backdoors, revoke keys"
          },
          {
            "label": "Recovery",
            "description": "Restore normal operations",
            "command": "# Rebuild compromised resources"
          },
          {
            "label": "Lessons Learned",
            "description": "Update prevention controls",
            "command": "# Improve monitoring and policies"
          }
        ]
      }
    ],
    "advanced": [
      {
        "title": "Serverless Threat Hunting",
        "scenario": "Detect threats in Lambda, Cloud Functions, and serverless environments",
        "command": "Monitor function invocations, environment variables, and network access patterns",
        "notes": [
          "Serverless introduces unique attack surfaces",
          "Focus on function permissions and runtime behavior"
        ]
      },
      {
        "title": "Container Threat Hunting",
        "scenario": "Hunt for threats in Kubernetes and containerized environments",
        "command": "Monitor pod creation, image pulls, and API server access",
        "notes": [
          "Container orchestration adds complexity",
          "Watch for privilege escalation and lateral movement"
        ]
      }
    ]
  }]