# Domain 5.0 - Post-exploitation and Lateral Movement
# Subdomain 5.1 - Persistence Mechanisms
# Format: question|answer_a|answer_b|answer_c|answer_d|correct_idx|explanation|domain|subdomain

What is persistence in post-exploitation context?|Data persistence|Maintaining access to compromised systems surviving reboots or credential changes|Persistent memory|Storage persistence|1|Persistence mechanisms maintain access after initial compromise surviving reboots, password changes, or remediation attempts enabling continued access for long-term operations.|5.0 Post-exploitation and Lateral Movement|5.1 Persistence Mechanisms

What is Windows Registry autorun persistence?|Registry optimization|Adding malicious executables to registry keys executed at startup or logon|Registry backup|Auto-start prevention|1|Registry autorun keys (Run, RunOnce, UserInit, Shell) execute programs at startup/logon. Attackers add malicious entries for persistent execution surviving reboots with HKLM for system-wide or HKCU for user-level persistence.|5.0 Post-exploitation and Lateral Movement|5.1 Persistence Mechanisms

What common registry keys are used for persistence?|Random keys|HKLM/HKCU\Software\Microsoft\Windows\CurrentVersion\Run and RunOnce|Backup keys|Temporary keys|1|Common autorun keys: Run, RunOnce (both HKLM and HKCU), Winlogon\Shell, Winlogon\Userinit, Explorer\Run, and Active Setup provide various startup execution opportunities for persistence.|5.0 Post-exploitation and Lateral Movement|5.1 Persistence Mechanisms

What is scheduled task persistence method?|Task scheduling|Creating scheduled tasks executing malicious payloads at specific times or system events|Task management|Schedule optimization|1|Scheduled tasks execute payloads at specific times, startup, logon, or system events providing flexible persistence. Windows Task Scheduler or cron (Linux) enable automated execution without manual intervention.|5.0 Post-exploitation and Lateral Movement|5.1 Persistence Mechanisms

What is service creation persistence technique?|Service management|Installing malicious Windows services executing with SYSTEM privileges at boot|Service optimization|Creation prevention|1|Creating Windows services provides high-privilege persistence executing at boot with SYSTEM privileges. Services run in background, less visible to users, and automatically restart after crashes.|5.0 Post-exploitation and Lateral Movement|5.1 Persistence Mechanisms

What is WMI event subscription persistence?|WMI management|Creating permanent WMI event consumers triggering malicious actions on system events|WMI optimization|Event management|1|WMI event subscriptions (filter + consumer) provide fileless persistence triggering on events (process start, logon, timer) without registry autoruns or scheduled tasks making detection harder.|5.0 Post-exploitation and Lateral Movement|5.1 Persistence Mechanisms

What is DLL hijacking persistence method?|DLL management|Placing malicious DLLs in search path locations loaded by legitimate applications|DLL optimization|Hijack prevention|1|DLL hijacking places malicious DLLs in directories searched before legitimate locations. Applications loading DLLs without full paths execute attacker code providing persistent execution when applications launch.|5.0 Post-exploitation and Lateral Movement|5.1 Persistence Mechanisms

What is COM hijacking persistence?|COM management|Modifying COM object registry entries redirecting to malicious DLLs|COM optimization|Hijack prevention|1|COM hijacking modifies HKCU\Software\Classes\CLSID registry redirecting COM object loading to malicious DLLs. When applications load hijacked COM objects, attacker DLL executes providing stealthy user-level persistence.|5.0 Post-exploitation and Lateral Movement|5.1 Persistence Mechanisms

What is cron job persistence on Linux?|Job scheduling|Adding malicious cron entries executing payloads at intervals or system events|Cron optimization|Job prevention|1|Cron jobs schedule recurring command execution (every minute, hourly, daily, or @reboot). Attackers add entries to user crontabs or system cron.d executing payloads periodically for Linux persistence.|5.0 Post-exploitation and Lateral Movement|5.1 Persistence Mechanisms

What is SSH key persistence technique?|Key management|Adding attacker SSH public keys to authorized_keys for password-less access|SSH optimization|Key prevention|1|Adding attacker SSH public key to ~/.ssh/authorized_keys provides password-less backdoor access surviving password changes. Legitimate-appearing access method difficult to distinguish from normal usage.|5.0 Post-exploitation and Lateral Movement|5.1 Persistence Mechanisms

What is web shell persistence benefit?|Shell decoration|Providing persistent web-accessible backdoor for command execution|Web optimization|Shell management|1|Web shells (PHP, ASP, JSP) uploaded to web servers provide persistent web-based access for command execution, file management, or pivoting surviving system reboots and accessible remotely.|5.0 Post-exploitation and Lateral Movement|5.1 Persistence Mechanisms

What is bootkit persistence advantage?|Boot speed|Persisting at boot level before OS loads making detection and removal difficult|Boot management|Kit optimization|1|Bootkits infect MBR, bootloader, or UEFI firmware loading before operating system providing extremely persistent access difficult to detect or remove as they execute before OS security controls.|5.0 Post-exploitation and Lateral Movement|5.1 Persistence Mechanisms

What is startup folder persistence method?|Folder organization|Placing malicious executables in Startup folders executed at user logon|Startup optimization|Folder management|1|Windows Startup folders (C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup and user-specific) execute contained programs at logon providing simple user-level persistence visible but often overlooked.|5.0 Post-exploitation and Lateral Movement|5.1 Persistence Mechanisms

What is account creation persistence technique?|User management|Creating hidden or backdoor user accounts for alternative access|Account optimization|Creation prevention|1|Creating local or domain accounts (with admin privileges, hidden via registry, or innocuous names like "Support") provides alternative access methods independent of initially compromised accounts.|5.0 Post-exploitation and Lateral Movement|5.1 Persistence Mechanisms

What is Golden Ticket persistence duration?|Ticket time|Up to 10 years default Kerberos ticket lifetime until krbtgt reset twice|One hour|One day|1|Golden Tickets forged with krbtgt hash remain valid for configured ticket lifetime (default 10 years) until krbtgt password is reset twice (current and previous hash). Provides extremely long-term domain persistence.|5.0 Post-exploitation and Lateral Movement|5.1 Persistence Mechanisms

What is skeleton key persistence in Active Directory?|Physical keys|Patching domain controller LSASS to accept master password for any account|Key management|Skeleton optimization|1|Skeleton key patches DC's LSASS memory allowing attacker's master password to authenticate as any user without changing passwords. Provides domain-wide backdoor until DC reboot or detection.|5.0 Post-exploitation and Lateral Movement|5.1 Persistence Mechanisms

What is backdoor account creation best practice?|Account limits|Creating accounts mimicking legitimate naming conventions with innocuous descriptions|Maximum accounts|Random names|1|Backdoor accounts should use naming matching organizational conventions (FirstnameLastname, IT Support), appropriate descriptions, last logon timestamps, and avoid obvious names like "admin2" or "backup" reducing detection risk.|5.0 Post-exploitation and Lateral Movement|5.1 Persistence Mechanisms

What is BITS (Background Intelligent Transfer Service) persistence?|File transfer|Using Windows BITS for persistent file download and execution at intervals|Transfer speed|Intelligence gathering|1|BITS creates jobs downloading and executing payloads at intervals. Legitimate Windows service less suspicious than custom scheduled tasks. Jobs survive reboots providing file-based persistence mechanism.|5.0 Post-exploitation and Lateral Movement|5.1 Persistence Mechanisms

What is AppInit DLLs persistence method?|Application DLLs|Registry keys forcing DLL loading into processes using User32.dll|App optimization|DLL prevention|1|AppInit_DLLs registry key (HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Windows) forces DLL loading into processes using User32.dll providing broad-scope persistence. Limited by security features in modern Windows.|5.0 Post-exploitation and Lateral Movement|5.1 Persistence Mechanisms

What is Image File Execution Options persistence?|Image editing|Registry debugger entries hijacking executable launches to run attacker code|File optimization|Execution management|1|IFEO Debugger registry value (HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\[exe]) hijacks program launches executing attacker code when target executable runs.|5.0 Post-exploitation and Lateral Movement|5.1 Persistence Mechanisms

What is accessibility feature backdoor?|User assistance|Replacing sethc.exe, utilman.exe, or other accessibility executables with cmd.exe|Accessibility improvement|Feature optimization|1|Replacing accessibility executables (Sticky Keys, Utility Manager) with cmd.exe provides SYSTEM shell at login screen via shortcut keys (5x Shift) without credentials. Classic persistence technique.|5.0 Post-exploitation and Lateral Movement|5.1 Persistence Mechanisms

What is logon script persistence?|Script management|Adding malicious commands to user or group policy logon scripts|Logon optimization|Script prevention|1|Logon scripts (user profiles, Group Policy) execute at logon. Attackers modify existing scripts or create new ones adding malicious commands for persistent execution across affected users.|5.0 Post-exploitation and Lateral Movement|5.1 Persistence Mechanisms

What is browser extension persistence benefit?|Extension management|Malicious browser extensions persist across reboots capturing data or credentials|Browser optimization|Extension prevention|1|Malicious browser extensions install persistent data capture, keylogging, cookie theft, or form grabbing capabilities. Extensions persist across reboots and execute whenever browser runs.|5.0 Post-exploitation and Lateral Movement|5.1 Persistence Mechanisms

What is port knocking persistence technique?|Port management|Configuring firewall rules opening backdoor ports only after specific packet sequence|Port optimization|Knocking prevention|1|Port knocking opens backdoor services only after receiving specific packet sequence hiding services from port scans. Legitimate-appearing firewall behavior making backdoor detection difficult.|5.0 Post-exploitation and Lateral Movement|5.1 Persistence Mechanisms

What is email rule persistence in compromised accounts?|Email management|Creating email forwarding or auto-response rules maintaining access to communications|Rule optimization|Email prevention|1|Email forwarding rules copy messages to attacker accounts or auto-respond with credentials. Persists in email account independent of system compromise maintaining intelligence gathering.|5.0 Post-exploitation and Lateral Movement|5.1 Persistence Mechanisms

What is netsh helper DLL persistence?|Network management|Loading malicious DLLs via netsh helper extending network functionality|Helper optimization|DLL prevention|1|Netsh helper DLLs extend netsh functionality. Malicious helpers registered in HKLM\SOFTWARE\Microsoft\NetSh load when netsh runs or system starts providing persistence via legitimate Windows component.|5.0 Post-exploitation and Lateral Movement|5.1 Persistence Mechanisms

What is Windows Management Instrumentation backdoor?|WMI management|Creating WMI permanent event consumers executing payloads on system events|Management optimization|WMI prevention|1|WMI permanent event subscriptions combine EventFilter (trigger), EventConsumer (action), and FilterToConsumerBinding providing fileless persistence triggering on events (startup, timer, process) without registry or file modifications.|5.0 Post-exploitation and Lateral Movement|5.1 Persistence Mechanisms

What is printer driver persistence technique?|Printer management|Installing malicious printer drivers loading at system start with SYSTEM privileges|Driver optimization|Printer prevention|1|Printer drivers load at system startup with SYSTEM privileges. Malicious drivers registered in HKLM\SYSTEM\CurrentControlSet\Control\Print\Environments execute with high privileges providing stealthy persistence.|5.0 Post-exploitation and Lateral Movement|5.1 Persistence Mechanisms

What is shortcut (LNK) modification persistence?|Shortcut management|Modifying legitimate shortcuts to execute attacker payload before target application|Shortcut optimization|LNK prevention|1|Modifying desktop, Start Menu, or taskbar shortcuts prepending attacker commands before legitimate targets. User launching shortcut executes malicious payload then normal application appearing legitimate.|5.0 Post-exploitation and Lateral Movement|5.1 Persistence Mechanisms

What is screensaver persistence method?|Screen protection|Setting malicious executable as screensaver executed after idle timeout|Screensaver optimization|Screen management|1|Registry HKCU\Control Panel\Desktop\SCRNSAVE.EXE pointing to malicious executable triggers after idle timeout. Less common but legitimate Windows feature providing user-level persistence.|5.0 Post-exploitation and Lateral Movement|5.1 Persistence Mechanisms

What is time provider DLL persistence?|Time management|Loading malicious DLLs as Windows Time Service providers|Provider optimization|Time prevention|1|Windows Time Service loads DLLs from HKLM\SYSTEM\CurrentControlSet\Services\W32Time\TimeProviders. Malicious time providers execute with high privileges when Windows Time service runs.|5.0 Post-exploitation and Lateral Movement|5.1 Persistence Mechanisms

What is application shimming persistence?|Application compatibility|Using Application Compatibility Shims to inject code into applications|Shim optimization|Application management|1|Application Compatibility Shim Database modifies application behavior. Malicious shims redirect DLL loading, inject code, or intercept API calls providing persistent code injection into targeted applications.|5.0 Post-exploitation and Lateral Movement|5.1 Persistence Mechanisms

What is LSA authentication package persistence?|Authentication management|Loading malicious DLLs as LSA security packages for credential access|LSA optimization|Package prevention|1|LSA authentication packages (HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Authentication Packages) load at system start with SYSTEM privileges accessing authentication attempts for credential capture or persistence.|5.0 Post-exploitation and Lateral Movement|5.1 Persistence Mechanisms

What is password filter DLL persistence?|Filter management|Registering password filter DLLs capturing password changes in plaintext|Password optimization|Filter prevention|1|Password filter DLLs (HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Notification Packages) receive plaintext passwords during password changes. Attackers register filters capturing new passwords providing credential access and persistence.|5.0 Post-exploitation and Lateral Movement|5.1 Persistence Mechanisms

What is Active Directory replication persistence?|AD management|Using DCSync rights to maintain credential access via AD replication|Replication optimization|AD prevention|1|Accounts with Directory Replication permissions perform DCSync extracting password hashes without domain controller access. Persistence through replication rights maintaining credential harvesting capability.|5.0 Post-exploitation and Lateral Movement|5.1 Persistence Mechanisms

What is Group Policy Object persistence?|Policy management|Modifying Group Policies to execute malicious scripts or deploy backdoors domain-wide|GPO optimization|Policy prevention|1|GPO modification deploys persistence domain-wide through startup scripts, scheduled tasks, registry settings, or software installation affecting all computers/users in scope.|5.0 Post-exploitation and Lateral Movement|5.1 Persistence Mechanisms

What is driver installation persistence advantage?|Driver management|Kernel-level code execution with highest privileges and boot-time loading|Driver optimization|Installation prevention|1|Malicious drivers execute in kernel mode (ring 0) with highest privileges, load at boot before security software, and persist across reboots. Requires administrative privileges and often code signing bypass.|5.0 Post-exploitation and Lateral Movement|5.1 Persistence Mechanisms

What is container escape persistent access?|Container management|Escaping containers to install persistence on underlying host system|Escape optimization|Container prevention|1|Container escape exploits misconfigurations or vulnerabilities accessing host filesystem for installing persistence surviving container destruction. Compromises host rather than ephemeral container.|5.0 Post-exploitation and Lateral Movement|5.1 Persistence Mechanisms

What is cloud instance metadata persistence?|Metadata management|Modifying instance user data or launch templates for persistent compromise|Cloud optimization|Metadata prevention|1|Modifying EC2 user data, launch templates, or auto-scaling configurations embeds persistence in infrastructure-as-code ensuring new instances launch pre-compromised.|5.0 Post-exploitation and Lateral Movement|5.1 Persistence Mechanisms

What is serverless function backdoor persistence?|Function management|Deploying malicious Lambda functions or modifying existing ones for persistent access|Serverless optimization|Backdoor prevention|1|Malicious serverless functions (Lambda, Azure Functions) provide persistent code execution triggered by events, APIs, or schedules. Difficult to detect in large serverless environments.|5.0 Post-exploitation and Lateral Movement|5.1 Persistence Mechanisms

What is DNS poisoning persistence benefit?|DNS management|Modifying DNS records redirecting traffic for ongoing man-in-the-middle or phishing|Poisoning prevention|DNS optimization|1|Persistent DNS poisoning through compromised DNS servers or authoritative records redirects traffic to attacker infrastructure for credential harvesting, malware delivery, or data interception.|5.0 Post-exploitation and Lateral Movement|5.1 Persistence Mechanisms

What is firmware modification persistence?|Firmware management|Modifying BIOS/UEFI firmware for pre-OS persistence surviving disk formatting|Firmware optimization|Modification prevention|1|Firmware modification provides ultimate persistence surviving OS reinstallation, disk replacement, or most remediation efforts. Requires physical access or specific vulnerabilities but extremely difficult to detect/remove.|5.0 Post-exploitation and Lateral Movement|5.1 Persistence Mechanisms

What is hidden filesystem persistence technique?|File management|Using alternate data streams, hidden partitions, or rarely-checked locations for payload storage|Filesystem optimization|Hidden prevention|1|Alternate Data Streams (ADS), hidden partitions, or obscure filesystem locations (C:\$Recycle.Bin, C:\System Volume Information) hide persistent payloads from casual inspection.|5.0 Post-exploitation and Lateral Movement|5.1 Persistence Mechanisms

What is remote access tool (RAT) persistence?|Remote management|Installing full-featured remote access tools providing comprehensive persistent backdoor|RAT prevention|Access optimization|1|RATs (Cobalt Strike, Meterpreter, commercial tools) provide comprehensive persistent access with command execution, file management, pivoting, and self-updating capabilities.|5.0 Post-exploitation and Lateral Movement|5.1 Persistence Mechanisms

What is Office macro persistence method?|Macro management|Creating auto-executing macros in startup templates or frequently-accessed documents|Office optimization|Macro prevention|1|Macros in Word/Excel startup templates or documents from trusted locations execute automatically providing persistent code execution when Office applications run.|5.0 Post-exploitation and Lateral Movement|5.1 Persistence Mechanisms

What is certificate-based persistence technique?|Certificate management|Installing attacker certificates enabling man-in-the-middle or authentication persistence|Certificate optimization|Cert prevention|1|Installing trusted root CA certificates enables persistent man-in-the-middle on HTTPS, code signing bypass, or authentication using attacker-issued certificates.|5.0 Post-exploitation and Lateral Movement|5.1 Persistence Mechanisms

What is package manager persistence in Linux?|Package management|Creating malicious packages or modifying package sources for persistent updates|Manager optimization|Package prevention|1|Trojanized packages, malicious package repositories, or apt/yum pre/post-install scripts provide persistent execution during package installation or updates.|5.0 Post-exploitation and Lateral Movement|5.1 Persistence Mechanisms

What is systemd service persistence on Linux?|Service management|Creating systemd service units for automatic execution at boot or timers|Systemd optimization|Service prevention|1|Systemd services (/etc/systemd/system/ or /lib/systemd/system/) execute at boot, with dependencies, or timer-based providing flexible Linux persistence with service management integration.|5.0 Post-exploitation and Lateral Movement|5.1 Persistence Mechanisms

What is kernel module persistence on Linux?|Module management|Loading malicious kernel modules for rootkit-level persistence|Kernel optimization|Module prevention|1|Kernel modules provide ring 0 access, can hide processes/files/connections, and persist via /etc/modules, /etc/modprobe.d/, or init scripts. Requires root and may need Secure Boot bypass.|5.0 Post-exploitation and Lateral Movement|5.1 Persistence Mechanisms

What is backdoor compilation into binaries?|Compilation management|Replacing system binaries with trojanized versions including backdoors|Binary optimization|Compilation prevention|1|Trojanizing system binaries (ls, ps, netstat, sudo) embeds backdoors or hides malicious activity. Requires matching file hashes if integrity checking exists.|5.0 Post-exploitation and Lateral Movement|5.1 Persistence Mechanisms
