{
  "id": "elastic_siem_security",
  "title": "Elastic Security & SIEM Operations",
  "description": "Comprehensive guide to Elastic Security (formerly Elastic SIEM) covering ES|QL queries, detection rules, alerts, machine learning, and threat hunting capabilities.",
  "type": "tutorial",
  "steps": [
    {
      "id": "elastic_security_overview",
      "title": "Elastic Security Architecture & Setup",
      "content": "## Elastic Security Platform Overview\n\nElastic Security provides unified SIEM and XDR capabilities built on the Elastic Stack (Elasticsearch, Kibana, Beats, Logstash).\n\n### Core Components\n\n**1. Elasticsearch**\n- Distributed search and analytics engine\n- Stores and indexes security data\n- Powers fast queries across petabytes\n\n**2. Kibana**\n- Visualization and management interface\n- Security app for SOC operations\n- Dashboard creation and sharing\n\n**3. Elastic Agent**\n- Unified data collection agent\n- Replaces individual Beats\n- Fleet-managed for centralized control\n\n**4. Elastic Defend (EDR)**\n- Endpoint Detection and Response\n- Malware prevention and behavioral analysis\n- Process, file, and network visibility\n\n### Deployment Options\n\n```yaml\n# Docker Compose quick start\nversion: '3'\nservices:\n  elasticsearch:\n    image: docker.elastic.co/elasticsearch/elasticsearch:8.12.0\n    environment:\n      - discovery.type=single-node\n      - xpack.security.enabled=true\n    ports:\n      - 9200:9200\n      \n  kibana:\n    image: docker.elastic.co/kibana/kibana:8.12.0\n    ports:\n      - 5601:5601\n    depends_on:\n      - elasticsearch\n```\n\n### Data Sources for Security\n\n| Integration | Data Type | Use Case |\n|------------|-----------|----------|\n| Windows | Event Logs, Sysmon | Authentication, Process execution |\n| Linux/Auditbeat | Audit logs, System | File integrity, Authentication |\n| Network | Packetbeat, Zeek | Traffic analysis, Protocol decoding |\n| Cloud | AWS, Azure, GCP | Cloud audit logs, API activity |\n| Endpoint | Elastic Defend | Malware, Behavior, Telemetry |\n\n### Elastic Security Features\n\n- **Detection Engine** - Rule-based threat detection\n- **Machine Learning** - Anomaly detection jobs\n- **Timeline** - Investigation and correlation\n- **Cases** - Incident management\n- **Entity Analytics** - User and host risk scoring\n- **Attack Discovery** - AI-powered threat analysis\n- **Osquery** - Live endpoint queries\n\n### Index Patterns for Security\n\n```\nlogs-*              # All log data\nwinlogbeat-*        # Windows events\nfilebeat-*          # Generic log collection\npacketbeat-*        # Network traffic\n.alerts-security.*  # Detection alerts\n```",
      "tags": ["soc", "elastic", "siem", "architecture"],
      "related_tools": ["sigma"]
    },
    {
      "id": "esql_fundamentals",
      "title": "ES|QL Query Language Fundamentals",
      "content": "## ES|QL - Elastic's New Query Language\n\nES|QL (Elasticsearch Query Language) is the modern query language for Elastic, designed for security operations.\n\n### Basic ES|QL Syntax\n\n```sql\nFROM logs-*\n| WHERE event.action == \"login\"\n| STATS count = COUNT(*) BY user.name\n| SORT count DESC\n| LIMIT 10\n```\n\n### Core Commands\n\n**FROM** - Specify data source\n```sql\nFROM logs-windows.sysmon_operational-*\n```\n\n**WHERE** - Filter data\n```sql\nFROM logs-*\n| WHERE event.code == 4625\n| WHERE @timestamp > NOW() - 24 hours\n```\n\n**STATS** - Aggregate data\n```sql\nFROM logs-*\n| STATS \n    login_count = COUNT(*),\n    unique_users = COUNT_DISTINCT(user.name)\n  BY host.name\n```\n\n**EVAL** - Create computed fields\n```sql\nFROM logs-*\n| EVAL size_mb = file.size / 1048576\n| EVAL is_large = size_mb > 100\n```\n\n**SORT & LIMIT**\n```sql\nFROM logs-*\n| STATS count = COUNT(*) BY source.ip\n| SORT count DESC\n| LIMIT 20\n```\n\n### Security-Focused Queries\n\n**Failed Authentication Analysis**\n```sql\nFROM logs-*\n| WHERE event.category == \"authentication\" AND event.outcome == \"failure\"\n| STATS \n    failures = COUNT(*),\n    unique_sources = COUNT_DISTINCT(source.ip)\n  BY user.name\n| WHERE failures > 5\n| SORT failures DESC\n```\n\n**Process Execution Monitoring**\n```sql\nFROM logs-windows.sysmon_operational-*\n| WHERE event.code == 1\n| EVAL parent = process.parent.name, child = process.name\n| STATS count = COUNT(*) BY parent, child\n| SORT count DESC\n```\n\n**Network Connection Analysis**\n```sql\nFROM logs-*\n| WHERE event.category == \"network\"\n| STATS \n    bytes_total = SUM(network.bytes),\n    connections = COUNT(*)\n  BY destination.ip, destination.port\n| SORT bytes_total DESC\n```\n\n**Privilege Escalation Detection**\n```sql\nFROM logs-windows.security-*\n| WHERE event.code IN (4672, 4673, 4674)\n| EVAL privilege_type = CASE(\n    event.code == 4672, \"special_privileges\",\n    event.code == 4673, \"privileged_service\",\n    event.code == 4674, \"privileged_object\"\n  )\n| STATS count = COUNT(*) BY user.name, privilege_type\n```\n\n### ES|QL vs KQL Comparison\n\n| Feature | ES|QL | KQL |\n|---------|-------|-----|\n| Aggregations | Built-in STATS | Limited |\n| Joins | ENRICH | Not supported |\n| Computed fields | EVAL | Not supported |\n| Piped syntax | Yes | No |\n| Time functions | Full support | Basic |\n\n### ES|QL Best Practices\n\n1. Filter early with WHERE clauses\n2. Use specific index patterns\n3. Limit results for large datasets\n4. Use EVAL for complex transformations\n5. Combine with ENRICH for context",
      "tags": ["soc", "elastic", "esql", "queries"],
      "related_tools": ["sigma"]
    },
    {
      "id": "elastic_detection_rules",
      "title": "Detection Rules & Alert Management",
      "content": "## Detection Engineering in Elastic Security\n\nElastic Security provides multiple rule types for threat detection with MITRE ATT&CK mapping.\n\n### Rule Types\n\n**1. Custom Query Rules**\n```json\n{\n  \"name\": \"Brute Force Authentication Attempt\",\n  \"description\": \"Detects multiple failed login attempts\",\n  \"risk_score\": 50,\n  \"severity\": \"medium\",\n  \"type\": \"query\",\n  \"query\": \"event.category:authentication AND event.outcome:failure\",\n  \"threshold\": {\n    \"field\": [\"user.name\", \"source.ip\"],\n    \"value\": 10\n  }\n}\n```\n\n**2. EQL (Event Query Language) Rules**\n```eql\nsequence by user.name with maxspan=5m\n  [authentication where event.outcome == \"failure\"] with runs=5\n  [authentication where event.outcome == \"success\"]\n```\n\n**3. Machine Learning Rules**\n- Anomaly detection jobs\n- Rare process detection\n- Unusual network activity\n- User behavior analysis\n\n**4. Threshold Rules**\n```json\n{\n  \"type\": \"threshold\",\n  \"query\": \"event.code:4625\",\n  \"threshold\": {\n    \"field\": \"source.ip\",\n    \"value\": 20,\n    \"cardinality\": [\n      { \"field\": \"user.name\", \"value\": 5 }\n    ]\n  }\n}\n```\n\n**5. Indicator Match Rules**\n- Match against threat intelligence\n- IOC correlation\n- Automated enrichment\n\n### MITRE ATT&CK Mapped Rules\n\n**T1078 - Valid Accounts**\n```eql\nany where event.action == \"user-account-created\" and\n  not user.name in (\"SYSTEM\", \"LOCAL SERVICE\")\n```\n\n**T1059.001 - PowerShell**\n```eql\nprocess where event.type == \"start\" and\n  process.name : \"powershell.exe\" and\n  process.args : (\"*-enc*\", \"*-e *\", \"*bypass*\", \"*hidden*\")\n```\n\n**T1003 - Credential Dumping**\n```eql\nprocess where event.type == \"start\" and\n  process.name : (\"procdump*.exe\", \"mimikatz.exe\") or\n  (process.name : \"rundll32.exe\" and\n   process.args : \"*comsvcs.dll*MiniDump*\")\n```\n\n**T1055 - Process Injection**\n```eql\nprocess where event.type == \"start\" and\n  process.parent.name : \"notepad.exe\" and\n  not process.name : \"notepad.exe\"\n```\n\n### Prebuilt Detection Rules\n\nElastic provides 700+ prebuilt rules covering:\n- Initial Access\n- Execution\n- Persistence\n- Privilege Escalation\n- Defense Evasion\n- Credential Access\n- Discovery\n- Lateral Movement\n- Collection\n- Command and Control\n- Exfiltration\n- Impact\n\n### Rule Management\n\n1. **Enable Prebuilt Rules**: Security → Detections → Rules → Load Elastic prebuilt rules\n2. **Tune Rules**: Adjust risk scores, add exceptions\n3. **Create Custom Rules**: Define organization-specific detections\n4. **Monitor Performance**: Check rule execution times\n5. **Export/Import**: Share rules across environments\n\n### Alert Actions\n\n- Email notifications\n- Slack/Teams webhooks\n- PagerDuty integration\n- ServiceNow tickets\n- Custom webhooks",
      "tags": ["soc", "elastic", "detection", "rules"],
      "related_tools": ["sigma", "yara"]
    },
    {
      "id": "elastic_machine_learning",
      "title": "Machine Learning & Anomaly Detection",
      "content": "## ML-Powered Threat Detection\n\nElastic Security includes built-in machine learning for automated anomaly detection and behavioral analysis.\n\n### ML Job Types\n\n**1. Anomaly Detection Jobs**\n- Detect unusual patterns in time series data\n- No training data required (unsupervised)\n- Real-time scoring of incoming events\n\n**2. Data Frame Analytics**\n- Classification and regression\n- Feature importance analysis\n- Supervised learning models\n\n### Security ML Jobs (Prebuilt)\n\n| Job Name | Detection | MITRE ATT&CK |\n|----------|-----------|---------------|\n| auth_high_count_logon_events | Authentication anomalies | T1078 |\n| auth_rare_hour_for_user | Unusual login times | T1078 |\n| packetbeat_dns_tunneling | DNS exfiltration | T1071.004 |\n| linux_rare_sudo_user | Privilege escalation | T1548 |\n| windows_rare_user_runas | Unusual RunAs activity | T1134 |\n| v3_windows_anomalous_process | Rare process execution | T1059 |\n\n### Creating Custom ML Jobs\n\n**Job Configuration**\n```json\n{\n  \"analysis_config\": {\n    \"bucket_span\": \"15m\",\n    \"detectors\": [\n      {\n        \"function\": \"high_count\",\n        \"field_name\": \"event.code\",\n        \"by_field_name\": \"user.name\"\n      }\n    ],\n    \"influencers\": [\"user.name\", \"host.name\"]\n  },\n  \"data_description\": {\n    \"time_field\": \"@timestamp\"\n  },\n  \"datafeed_config\": {\n    \"indices\": [\"logs-windows.security-*\"],\n    \"query\": {\n      \"bool\": {\n        \"filter\": [\n          { \"term\": { \"event.code\": \"4625\" } }\n        ]\n      }\n    }\n  }\n}\n```\n\n### Anomaly Scoring\n\n- **Score 0-25**: Typical behavior\n- **Score 25-50**: Warning level\n- **Score 50-75**: Minor anomaly\n- **Score 75-100**: Critical anomaly\n\n### Entity Risk Scoring\n\n```json\n// Risk calculation considers:\n{\n  \"risk_factors\": {\n    \"alert_severity\": 0.4,\n    \"anomaly_score\": 0.3,\n    \"threat_intel_match\": 0.3\n  },\n  \"risk_levels\": {\n    \"low\": \"0-30\",\n    \"medium\": \"30-60\",\n    \"high\": \"60-80\",\n    \"critical\": \"80-100\"\n  }\n}\n```\n\n### Behavioral Analytics\n\n**User Behavior Analysis**\n- Login patterns (time, location, device)\n- Data access patterns\n- Privilege usage\n- Application usage\n\n**Host Behavior Analysis**\n- Process execution patterns\n- Network communication\n- File system activity\n- Service modifications\n\n### ML Job Tuning\n\n1. **Adjust bucket_span** - Match to data frequency\n2. **Set influencers** - Important context fields\n3. **Configure model_memory_limit** - Resource allocation\n4. **Tune calendars** - Account for scheduled events\n5. **Review model_plot_config** - Visualization settings\n\n### Operationalizing ML\n\n```mermaid\n[ML Job] → [Anomaly Detection] → [Alert Generation] → [SOC Triage] → [Investigation]\n```\n\n1. Enable relevant ML jobs\n2. Create ML-based detection rules\n3. Set appropriate thresholds\n4. Monitor false positive rates\n5. Adjust based on feedback",
      "tags": ["soc", "elastic", "machine-learning", "anomaly-detection"],
      "related_tools": ["sigma"]
    },
    {
      "id": "elastic_timeline_investigation",
      "title": "Timeline & Investigation Workflows",
      "content": "## Investigation Tools in Elastic Security\n\nElastic Security provides powerful investigation capabilities including Timeline, Cases, and Osquery integration.\n\n### Timeline Investigation\n\nTimeline allows drag-and-drop correlation of security events:\n\n**Creating an Investigation**\n1. Navigate to Security → Timelines\n2. Create new timeline\n3. Add events from alerts or searches\n4. Filter and correlate\n5. Add notes and documentation\n\n**Timeline Query Examples**\n\n```kql\n# Find all authentication events for a user\nuser.name: \"suspicious_user\" and event.category: \"authentication\"\n\n# Process execution on a host\nhost.name: \"WORKSTATION01\" and event.category: \"process\"\n\n# Network connections to external IPs\nevent.category: \"network\" and not destination.ip: \"10.0.0.0/8\"\n```\n\n### Event Correlation\n\n**Sequence Detection with EQL**\n```eql\nsequence by host.name with maxspan=30m\n  [process where process.name == \"cmd.exe\"]\n  [process where process.name == \"powershell.exe\"]\n  [network where destination.port == 443]\n```\n\n**Parent-Child Process Analysis**\n```kql\nprocess.parent.name: \"winword.exe\" and \nevent.category: \"process\" and\nnot process.name: (\"splwow64.exe\", \"FLTLDR.exe\")\n```\n\n### Cases Management\n\nOrganize investigations into cases:\n\n1. **Create Case** - Document incident details\n2. **Add Alerts** - Attach related alerts\n3. **Add Timeline** - Include investigation timeline\n4. **Collaborate** - Assign to team members\n5. **Integrate** - Push to ServiceNow, Jira\n\n### Osquery Integration\n\n**Live Endpoint Queries**\n```sql\n-- Check running processes\nSELECT name, pid, path, cmdline FROM processes;\n\n-- Find listening ports\nSELECT * FROM listening_ports WHERE port < 1024;\n\n-- Check scheduled tasks\nSELECT * FROM scheduled_tasks;\n\n-- Registry persistence\nSELECT * FROM registry \nWHERE path LIKE '%\\Run\\%';\n```\n\n**Scheduled Queries (Osquery Packs)**\n```json\n{\n  \"queries\": {\n    \"processes\": {\n      \"query\": \"SELECT * FROM processes\",\n      \"interval\": 300,\n      \"description\": \"Running processes\"\n    }\n  }\n}\n```\n\n### Investigation Workflow\n\n```\n[Alert Triggered]\n       ↓\n[Triage in Alerts Queue]\n       ↓\n[Create Timeline]\n       ↓\n[Add Related Events]\n       ↓\n[Query Endpoints (Osquery)]\n       ↓\n[Document Findings]\n       ↓\n[Create Case if Incident]\n       ↓\n[Remediation Actions]\n       ↓\n[Close with Lessons Learned]\n```\n\n### Response Actions\n\nElastic Defend provides response capabilities:\n\n- **Isolate Host** - Network isolation\n- **Kill Process** - Terminate malicious process\n- **Suspend Process** - Pause for analysis\n- **Get File** - Retrieve for analysis\n- **Execute Script** - Run response scripts\n\n### Investigation Documentation\n\n```markdown\n## Incident: Suspicious PowerShell Activity\n### Timeline\n- 14:32:15 - Initial PowerShell execution detected\n- 14:32:45 - Network connection to C2\n- 14:35:22 - Data exfiltration attempt\n\n### Affected Systems\n- WORKSTATION01 (192.168.1.100)\n\n### Actions Taken\n- Host isolated at 14:40:00\n- Process terminated\n- Memory acquisition completed\n```",
      "tags": ["soc", "elastic", "investigation", "timeline"],
      "related_tools": ["sigma"]
    },
    {
      "id": "elastic_threat_hunting",
      "title": "Threat Hunting with Elastic",
      "content": "## Proactive Threat Hunting in Elastic Security\n\nUse Elastic's search capabilities for proactive threat hunting beyond automated detection.\n\n### Hunting with ES|QL\n\n**Reconnaissance Hunting**\n```sql\nFROM logs-*\n| WHERE event.category == \"network\"\n| STATS \n    unique_ports = COUNT_DISTINCT(destination.port),\n    unique_hosts = COUNT_DISTINCT(destination.ip)\n  BY source.ip\n| WHERE unique_ports > 100 OR unique_hosts > 50\n| SORT unique_ports DESC\n```\n\n**Lateral Movement Detection**\n```sql\nFROM logs-windows.security-*\n| WHERE event.code == 4624 AND winlog.logon.type == \"Network\"\n| STATS \n    hosts_accessed = COUNT_DISTINCT(host.name)\n  BY user.name\n| WHERE hosts_accessed > 10\n```\n\n**Persistence Hunting**\n```sql\nFROM logs-windows.sysmon_operational-*\n| WHERE event.code == 13 AND \n  registry.path : \"*\\\\Run\\\\*\" OR registry.path : \"*\\\\RunOnce\\\\*\"\n| STATS count = COUNT(*) BY registry.path, process.name\n```\n\n### EQL Hunting Queries\n\n**Living Off the Land Binaries (LOLBins)**\n```eql\nprocess where event.type == \"start\" and\n  process.name : (\"certutil.exe\", \"mshta.exe\", \"regsvr32.exe\", \n                  \"rundll32.exe\", \"wmic.exe\", \"cscript.exe\") and\n  not process.parent.name : \"explorer.exe\"\n```\n\n**Encoded PowerShell Commands**\n```eql\nprocess where event.type == \"start\" and\n  process.name : \"powershell.exe\" and\n  process.args : (\"*-e *\", \"*-enc *\", \"*-EncodedCommand *\") and\n  length(process.command_line) > 500\n```\n\n**Suspicious Network Connections**\n```eql\nnetwork where event.type == \"start\" and\n  destination.port in (4444, 5555, 6666, 8080, 8443) and\n  not process.name : (\"chrome.exe\", \"firefox.exe\", \"msedge.exe\")\n```\n\n**Credential Access Indicators**\n```eql\nprocess where event.type == \"start\" and\n  (process.name : \"procdump*.exe\" and process.args : \"*lsass*\") or\n  (process.name : \"rundll32.exe\" and process.args : \"*comsvcs*MiniDump*\")\n```\n\n### Hunt Hypotheses\n\n| Hypothesis | Data Source | Query Focus |\n|-----------|-------------|-------------|\n| Attackers using scheduled tasks | Windows Events | Event code 4698, 4699 |\n| PowerShell downloading payloads | PowerShell logs | DownloadString, IEX |\n| DNS tunneling for C2 | DNS logs | Long query strings, high frequency |\n| WMI persistence | Sysmon | Event code 19, 20, 21 |\n| Service-based persistence | Windows Events | Event code 7045 |\n\n### Hunting Dashboard\n\nCreate hunting dashboards with:\n\n1. **Rare Process Names** - Execution anomalies\n2. **Unusual Parent-Child** - Process lineage\n3. **Network Beaconing** - C2 patterns\n4. **New Services** - Persistence indicators\n5. **Failed Logins** - Access attempts\n\n### Automated Hunting\n\n```json\n// Scheduled hunting query\n{\n  \"rule_type\": \"query\",\n  \"query\": \"process.name:powershell.exe AND process.args:*-enc*\",\n  \"interval\": \"1h\",\n  \"actions\": [\n    { \"type\": \"email\", \"params\": { \"to\": \"soc@company.com\" } }\n  ]\n}\n```\n\n### Hunt Documentation\n\nDocument hunts in a structured format:\n\n1. **Hypothesis**: What are we looking for?\n2. **Data Sources**: What data do we need?\n3. **Query**: ES|QL or EQL query\n4. **Results**: Findings from the hunt\n5. **Actions**: Detections created, remediation",
      "tags": ["soc", "elastic", "threat-hunting", "detection"],
      "related_tools": ["sigma", "yara"]
    },
    {
      "id": "elastic_integrations",
      "title": "Data Integrations & Fleet Management",
      "content": "## Elastic Integrations for Security\n\nElastic Agent and Fleet provide centralized management of data collection across your infrastructure.\n\n### Fleet Architecture\n\n```\n[Elastic Agent] → [Fleet Server] → [Elasticsearch] → [Kibana]\n```\n\n### Key Security Integrations\n\n**Windows Integration**\n```yaml\ndata_streams:\n  - winlog.security        # Security events\n  - winlog.system          # System events\n  - winlog.application     # Application events\n  - winlog.powershell      # PowerShell logs\n  - winlog.sysmon          # Sysmon data\n```\n\n**Linux Integration**\n```yaml\ndata_streams:\n  - log.syslog             # Syslog messages\n  - log.auth               # Authentication logs\n  - auditd.log             # Audit daemon\n  - system.auth            # System auth\n```\n\n**Cloud Integrations**\n\n| Provider | Integration | Data |\n|----------|-------------|------|\n| AWS | AWS CloudTrail | API activity, IAM events |\n| AWS | AWS GuardDuty | Threat findings |\n| Azure | Azure Activity | Platform events |\n| Azure | Azure AD | Authentication, MFA |\n| GCP | GCP Audit | Cloud audit logs |\n\n**Network Integrations**\n- **Zeek** - Network protocol analysis\n- **Suricata** - IDS/IPS alerts\n- **Cisco ASA** - Firewall logs\n- **Palo Alto** - NGFW events\n\n### Elastic Agent Policies\n\n```yaml\n# Example agent policy\nname: Windows Servers\ndescription: Policy for Windows server endpoints\nnamespace: default\nagent:\n  monitoring:\n    enabled: true\n    logs: true\n    metrics: true\nintegrations:\n  - name: windows\n    enabled: true\n    inputs:\n      - winlog:\n          - name: Security\n            event_id: ['4624', '4625', '4648', '4672']\n          - name: System\n          - name: Microsoft-Windows-Sysmon/Operational\n  - name: endpoint\n    enabled: true\n    policy:\n      windows:\n        malware:\n          mode: prevent\n        behavior_protection:\n          mode: prevent\n```\n\n### Fleet Enrollment\n\n```bash\n# Install Elastic Agent\ncurl -L -O https://artifacts.elastic.co/downloads/beats/elastic-agent/elastic-agent-8.12.0-linux-x86_64.tar.gz\ntar xzvf elastic-agent-8.12.0-linux-x86_64.tar.gz\ncd elastic-agent-8.12.0-linux-x86_64\n\n# Enroll with Fleet\nsudo ./elastic-agent install \\\n  --url=https://fleet-server:8220 \\\n  --enrollment-token=<token> \\\n  --insecure\n```\n\n### Ingest Pipelines\n\nProcess data before indexing:\n\n```json\n{\n  \"description\": \"Security enrichment pipeline\",\n  \"processors\": [\n    {\n      \"geoip\": {\n        \"field\": \"source.ip\",\n        \"target_field\": \"source.geo\"\n      }\n    },\n    {\n      \"user_agent\": {\n        \"field\": \"user_agent.original\"\n      }\n    },\n    {\n      \"set\": {\n        \"if\": \"ctx.event?.outcome == 'failure'\",\n        \"field\": \"event.risk_score\",\n        \"value\": 25\n      }\n    }\n  ]\n}\n```\n\n### Transform for Analytics\n\n```json\n{\n  \"source\": {\n    \"index\": \"logs-*\"\n  },\n  \"dest\": {\n    \"index\": \"security-analytics\"\n  },\n  \"pivot\": {\n    \"group_by\": {\n      \"user.name\": { \"terms\": { \"field\": \"user.name\" } }\n    },\n    \"aggregations\": {\n      \"total_events\": { \"value_count\": { \"field\": \"@timestamp\" } },\n      \"unique_hosts\": { \"cardinality\": { \"field\": \"host.name\" } }\n    }\n  }\n}\n```\n\n### Data Retention\n\n```json\n// Index Lifecycle Management (ILM)\n{\n  \"policy\": {\n    \"phases\": {\n      \"hot\": { \"actions\": { \"rollover\": { \"max_size\": \"50gb\" } } },\n      \"warm\": { \"min_age\": \"30d\", \"actions\": { \"shrink\": { \"number_of_shards\": 1 } } },\n      \"cold\": { \"min_age\": \"90d\", \"actions\": {} },\n      \"delete\": { \"min_age\": \"365d\", \"actions\": { \"delete\": {} } }\n    }\n  }\n}\n```",
      "tags": ["soc", "elastic", "integrations", "fleet"],
      "related_tools": ["sigma"]
    }
  ]
}
